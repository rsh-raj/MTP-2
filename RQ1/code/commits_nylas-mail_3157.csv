Hash,Date,Author,Message,IsMerge
e16cb1982e944ae7edb69b1abef1436dd16b442d,2018-06-04 03:56:00,Ben Gotow,Add an Issue Template noting that Nylas Mail is unmaintained,False
653ff9b44a16468ef37dc109a39ef604d1369ff9,2017-09-07 02:32:01,Evan Morikawa,Change Nylas Mail to MIT License,False
f60437ff0c0ab7351031833212d62c596895f696,2017-09-07 02:30:40,Ben Gotow,Update README to fix links to packages/client-app/,False
cb1a75534e2e6651a6559ab959053649d63e06ae,2017-09-07 02:28:00,Ben Gotow,Update README to fix hardcoded links to nylas-mail-all,False
b70e2db1cbef182c82ca2a1309ddcd1a454d84a8,2017-08-23 00:37:56,Juan,"Merge pull request #2: Cleanup in preparation for open sourcing

Cleanup in preparation for open sourcing",True
8d700e74f6045f6c79d600fb438b7c25b90286d1,2017-07-29 04:21:25,Ben Gotow,[Sentry] Remove DSN - don’t want errors from OSS,False
ac5dd64823b68302c89b3fc61948875eed92f262,2017-07-27 10:25:30,Ben Gotow,[*] README: Preserve blog posts and add them to resources,False
a8cd8db7b5c20a2dc5dd19c0a27700cc103b6b42,2017-07-27 10:17:28,Ben Gotow,[*] README: Move explore source section beneath Running subhead,False
cae19b190cba052b2c297380b612887681570a01,2017-07-27 10:14:29,Ben Gotow,[*] README: Replace horrible themes screenshot with a better one,False
8ae2d00634724a3632c860bf93840f3dcff11730,2017-07-27 09:46:09,Ben Gotow,[*] README: Fix broken Kleinstein link,False
7177ef51adb94d2d996a5be1d2707836a6f45003,2017-07-27 09:44:04,Ben Gotow,"[*] Update README to make deprecation more clear, add videos",False
5b49a298e35a1e6d36ad80d2e17ddc1c2b3e8798,2017-07-27 09:34:13,Ben Gotow,"[*] Update READMEs, remove Nylas-specific cloud instructions",False
548b17f5e70d4831d873f06bbb1706f38c65198d,2017-07-26 22:55:25,Ben Gotow,[client-app] Remove remaining references to upload-client build step,False
ea643a0bbd2fb3ecc817108c54a65622c763603e,2017-07-26 22:55:10,Ben Gotow,[client-app] Add screenshot,False
b2edfa67e8b3b688b98863523202ed56590b156b,2017-07-26 21:50:33,Ben Gotow,[cloud-*] Remove development config tied to Nylas,False
25a3e6723933b426eaa3985c63d25f0e00a6946e,2017-07-26 07:26:49,Ben Gotow,"[*] Add missing(?) config files, make entire `npm test` suite run green",False
34d474710f61e4fdaa62627c0468a5573dddaece,2017-07-26 06:49:27,Ben Gotow,[client-app] Disable specs failing for unknown reasons,False
7e963e3d466502f8e177f12df717448820503d58,2017-07-26 06:36:28,Ben Gotow,[client-app] Fix broken specs,False
360d8161e2e821ea684b9ce424deb5d032070e66,2017-07-26 01:08:05,Ben Gotow,[client-app] Fix double handling of unhandled rejections,False
2ea7c18b27ebf4544719e8fb14802a11e06bab25,2017-07-26 00:49:24,Ben Gotow,"[client-app] Always send a password, even if no identity is present",False
a40a87d6a35e3bae20fc2df7fa40f4ea2d74ff46,2017-07-25 10:26:32,Ben Gotow,[client-app] Link to gh-pages from docs folder,False
e84ad9b3b89eb069cb63c367d382c199584168ad,2017-07-25 10:18:14,Ben Gotow,[client-app] Remove the “identity” tab for managing your subscription,False
472a76c0d41e187b70dcf31fcb9907a16951a813,2017-07-25 10:13:21,Ben Gotow,[client-app] Disable snooze by default since it requires cloud support as well,False
294d1535f1e58bf53cba20dc6eaab5001e261882,2017-07-25 10:10:33,Ben Gotow,[client-app] Only use account presence to decide whether to open onboarding,False
6d68fe0c62955b81f7ecf1823a0555511c27bc19,2017-07-25 10:07:40,Ben Gotow,[client-app] Remove old “Edegehill” API used to proxy clearbit,False
3270077baaad1bb4abd5a0add28b5565410eaa44,2017-07-25 09:59:48,Ben Gotow,[client-app] Remove newsletter signup in preferences,False
be3badb769e8eb2173e21438316d3d8d55bc173d,2017-07-25 09:52:39,Ben Gotow,[client-app] Rename the send-later plugin for consistency,False
2d419765f412b1212989f037b9546d8eb9d5e4b8,2017-07-25 09:49:50,Ben Gotow,[client-sync] Stop sending sync performance metrics to Honeycomb,False
6507e831ba3df61a72a532bb164a77dc8d46c46e,2017-07-25 09:46:20,Ben Gotow,"[client-app] Remove welcome tutorial, which depicts cloud plugins",False
a782d72a2c508f52b7e2ec8ed9b6a37d5fdb879c,2017-07-25 09:44:15,Ben Gotow,"[client-app] By default, disable plugins that require a Nylas ID",False
367161a620fb308fc222f28bc01077c758e6a26e,2017-07-25 09:40:24,Ben Gotow,[client-app] Skip “Nylas ID” step upon sign-in,False
bdd5683b6834d9c1e3e5feddf7ac98c050090bb7,2017-07-25 09:28:14,Ben Gotow,[client-app] Remove autoupdates tied to Nylas server,False
e47fecb15761763d9e236e9e5d6b19a0ef9333eb,2017-07-25 09:21:11,Ben Gotow,[client-app] Remove analytics package,False
ecac79fe78ed3879a35eb2f058dc97b7841bbbe2,2017-07-25 09:21:02,Ben Gotow,[client-app] Remove signing / uploading of builds,False
820eba1797fbbecff0a19f05b0f88cb691a81765,2017-07-25 09:20:38,Ben Gotow,[client-app] Move private plugins into the client-app tree,False
4ca35bf24ac4ce43ece0de078ca01435765ce9d7,2017-05-09 23:52:31,Juan Tejada,[client-app] Update changelog,False
fec7941677c405754c89f572c4eb59d4a2594379,2017-05-01 21:40:06,Nylas Coffee Machine,bump(version): 2.0.32,False
fad4b9b181ed29f1abac7d3cb05590a040c674f6,2017-04-29 06:21:20,Evan Morikawa,"[client-app] remove unnecessary tracking events

Summary:
These events have massively spammed our Mixpanel.
Retry send task alone fired 6,000,000 events in the past week!
Since we pay per event, this really, really sucks.

These events made up a vast majority of our events

Test Plan: manual

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4517",False
e675debac1978b532fc2513abedaebfca47d3c0a,2017-04-29 00:50:06,Nylas Coffee Machine,bump(version): 2.0.31,False
135c123d406ed1fbe26b664261d95e2733c2fdd6,2017-04-29 00:49:37,Halla Moore,[client-sync] Use decryptedCredentials instead,False
2bbc20e3c6cfa282a3456700a022207ac43b0f36,2017-04-29 00:37:02,Nylas Coffee Machine,bump(version): 2.0.30,False
c6a11a78d182a64139e8f40eb82710d3bd254d61,2017-04-29 00:36:29,Halla Moore,"[client-sync] Keep track of when SendTaskRunners expire

Summary:
Although we check if the account needs a new token before each send,
we failed to consider that the token in the account might not match
the token used in the SendTaskRunner. This could happen if the token
was refreshed somewhere outside the SendTaskManager (e.g. the sync
loop). This diff adds an `expiresAtInMs` field to the SendTaskRunner
so that the SendTaskManager can determine whether it needs an
updated SendTaskRunner or not.

Test Plan: manual

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D4515",False
abb3852599b2654127c17dc8ea12952bb68838f2,2017-04-28 23:13:24,Evan Morikawa,"Revert ""[*] fix google auth expiry date""

This reverts commit af22c676f95ea3f4fea4f7c66029b5f3cf1d6ae2.",False
ee65d5d0065e988d0b401f861b2825cd9e765bde,2017-04-28 10:29:37,Nylas Coffee Machine,bump(version): 2.0.29,False
af22c676f95ea3f4fea4f7c66029b5f3cf1d6ae2,2017-04-28 10:28:49,Evan Morikawa,"[*] fix google auth expiry date

Summary: EVERYTHING IN MS!!!!!!!!!!

Test Plan: manual

Reviewers: khamidou, spang, juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D4512",False
21da07b7cfb2a9ef4a724f95a37cc93e9cfd7223,2017-04-28 00:07:59,Evan Morikawa,"[cloud-core] fix leaking redis connections & cleanup

Summary:
The broadcast client was getting re-built (without ever getting cleaned
up) erroneously every time anyone closed a delta connection. This led to
leaking delta connections.

There were also several functions that were never used anywhere!

Test Plan: Manual local

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4508",False
8d1764a7678379554572052956074a538e43bbd5,2017-04-27 10:32:20,Juan Tejada,[client-app] Update changelog,False
37242ab1bdf8f7fb95bbd0eab7b22e4e2ed7645a,2017-04-27 06:57:41,Nylas Coffee Machine,bump(version): 2.0.28,False
30aaae5adc5e21b43d4e7ab3e3012d08eff7a4d0,2017-04-27 06:56:52,Evan Morikawa,"[*] fix send later with open/link tracking

Summary: See above

Test Plan: manual

Reviewers: juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D4504",False
44f98bdc36bc1351b9a23e96caf7d2af18196366,2017-04-27 06:55:38,Evan Morikawa,"[*] remove draft syncback to fix send later with tracking

Summary:
Removes draft syncback
Fixing open link tracking with send later

Test Plan: manual

Reviewers: juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D4502",False
c3bfca9524e6da4b3df815424cae8fdbf6712c81,2017-04-27 02:59:39,Juan Tejada,[client-app] Update changelog,False
7f54939d15e0eae38ddd33ee9c40e9eb63d066ef,2017-04-27 01:10:10,Nylas Coffee Machine,bump(version): 2.0.27,False
be9cc46151c4f4c8cba860fcc21a8104f92c6e4f,2017-04-27 01:08:54,Evan Morikawa,[iso-core] fix atob dependency,False
303210c38a2ca621861ba4e00c781639bc5a64f8,2017-04-27 01:02:06,Juan Tejada,[client-app] Update changelog,False
4a4e34a7e2ef1841e18baa2ead5572343e1edeaa,2017-04-27 00:56:33,Evan Morikawa,[cloud-core] fix logger error,False
05f73e5b39f44b383d4766f7e4bdcb15c58d8e03,2017-04-27 00:42:38,Mark Hahnenberg,"[client-app] Don't throw error when search query has trailing whitespace

Summary:
We throw an error if there is leftover stuff after parsing since that
means there was stuff we didn't recognize. Unfortunately, we weren't
consuming any trailing whitespace which was causing us to spuriously
throw errors. Sad times.

Test Plan: Run locally, run tests

Reviewers: evan, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4500",False
9f1e8fadffd5481f1d3bddf20efdde8d60f5c492,2017-04-27 00:40:22,Evan Morikawa,[cloud-core] use correct logger when logging Redis connections,False
393300846c10a07825988986afe3b9ac8ab38536,2017-04-27 00:24:58,Nylas Coffee Machine,bump(version): 2.0.26,False
33648ba8dd826c4f31ce7cc148a9f2bd365d53dc,2017-04-27 00:08:13,Evan Morikawa,"[*] consolidate TrackingUtils & better documentation

Summary:

Test Plan:

Reviewers:

Subscribers:",False
8fa5b0013eef4ee8ab3ee651ae4fd452587e8a7f,2017-04-26 23:12:51,Nylas Coffee Machine,bump(version): 2.0.25,False
f674b250a5e961b193627eda326879f1458205a8,2017-04-26 23:06:28,Evan Morikawa,"[*] fix self-triggering open and link tracking

Summary:
This fixes an issue with our link tracking regex begin too restrictive and
not allowing `?` or `=` characters.

Also cleans up the code and adds comments to better explain what's going
on with the link and open tracking code

Test Plan: manual

Reviewers: juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D4498",False
315ff56d1b5fb6de304018d7336aac3f326c63b1,2017-04-26 03:39:22,Juan Tejada,bump(version): 2.0.24,False
00575c066396eb365a42153a3396b726a00b5509,2017-04-26 03:35:14,Juan Tejada,"[client-app] Speed up sending per recipient

Summary:
Speed up sending-per-recipient ever so slightly by sending in parallel.
We don't really need to send each message serially, we just need to wait
until all of them have sent, so let's do this in parallel with
Promise.all.

This should be especially helpful when sending to a lot of recipients
with big attachments

Test Plan: manually verify that sending per recipient still works as expected

Reviewers: evan, mark, halla

Reviewed By: mark, halla

Differential Revision: https://phab.nylas.com/D4497",False
c3e52dd22ef1d8d978c2576765cd51d371d36fc6,2017-04-26 03:34:19,Juan Tejada,"[client-app] Fix tracking when sending per recipient

Summary:
When sending custom bodies per recipient for tracking, we used to copy
the message model, and then update the copy's body with the custom
body that contains the tracking links for each recipient.

However, due to recent changes that store message bodies in flat files on
disk, copying an instance of a message would actually update the body of
the original message because they both pointed to the same message body
file on disk, which is obviously not what this code initially intended
to do.

This caused all messages to go out with the tracking links of the first
recipient, causing open tracking to misreport who had actually opened a
message.

The fix for now is to not make a copy of the message model, but rather
just of its values, which we can use for sending.

Test Plan: manually test that send-per-recipient and tracking works as expected

Reviewers: evan, halla, mark

Reviewed By: halla, mark

Differential Revision: https://phab.nylas.com/D4496",False
f3f9e7ef0826be0b86ac3928f2a97d30f77f8d10,2017-04-25 23:08:45,Juan Tejada,[client-app] Update changelog,False
dcb95ec95d9280c00d26270a7f3f654eed67f557,2017-04-25 23:07:18,Juan Tejada,bump(version): 2.0.23,False
ca1e6f4d675f4e3997e50d8f6f11d620c1f9e67d,2017-04-25 23:06:29,Juan Tejada,"[client-app] Properly retry retryable errors in syncback tasks

Summary:
When the syncback task runner was refactored (https://github.com/nylas/nylas-mail-all/commit/ba37a5c7118c298b0c527764880c6c029be766a0#diff-fe83d2d1f5995869631059a5d6221f32L182), we stopped retrying
retryable errors because we ended up incorrectly marking them as failed.

This commit ensures that we mark them as NEW and that we re-throw the
error so that the sync loop is restarted and we retry the task

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4494",False
e750f092283133c2a13c43603c5e2b6413ba69dc,2017-04-25 23:06:28,Evan Morikawa,"[*] remove old email references

Summary: Removing references

Test Plan: manual

Reviewers: juan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4493",False
1fb4853965fcf9dea28eaec393c663fdf2961820,2017-04-25 23:06:28,Juan Tejada,bump(version): 2.0.22,False
fe8a8ee547ccccd593cab7498ac1515dd9ae1bb5,2017-04-25 23:06:28,Juan Tejada,"Revert ""[iso-core] Fix interruptible throwing errors""

This reverts commit 2e0f231cc1c57a15e45e73e3263a010aebdbe56a.

This commit is causing errors to be swallowed",False
d286611ecbf6dfa8eecb8149e90b017a63616f97,2017-04-25 23:06:28,Juan Tejada,[client-app] Update changelog,False
e4bb64343704261de55ceb7d1ea4325514a7e34c,2017-04-25 23:06:28,Juan Tejada,bump(version): 2.0.21,False
3d932cecc0e3517d05ff320aadb3ef58f63a2c9e,2017-04-25 23:06:27,Juan Tejada,"[iso-core] Fix interruptible throwing errors

Summary:
If the promise that was `yield`ed to the interruptible rejects, we need
to re-throw the error inside the stack of the code the generator is
running, otherwise any error handling code inside that code wont be ran.

See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator/throw
and https://github.com/tj/co/blob/master/index.js#L79 for example usage

Test Plan: manual (plan to test it more before landing)

Reviewers: spang, mark, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4491",False
5f8b8ea1e9236cc3a13f2b290b1ebb10156f9076,2017-04-25 23:06:27,Evan Morikawa,"[client-sync] fix sending when racing syncing of Gmail sent folder

Summary:
On gmail if you sent a message to multiple people with big attachments,
the send could take several minutes.

In the meantime, some of your individually sent messages would show up in
your Gmail's sent folder.

When the send completed, we'd try and create a new message object with the
same ID and fail.

This changes it to upsert instead

TODO to see how this behaves with replies

Test Plan: manual

Reviewers: juan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4490",False
9afa9d695b9e69e68faa13f5ff73a7d414e9357f,2017-04-25 23:06:27,Juan Tejada,"[client-app] Increment max upload size

Summary: see title

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4489",False
9ff4e1b2677bcd4bd3e69c5f1d0beafc25341c4e,2017-04-25 23:06:27,Juan Tejada,[client-app] Update changelog,False
7840f5ef5eff7cc6c0fa322a2389faebb230f40f,2017-04-25 23:06:27,Juan Tejada,bump(version): 2.0.20,False
f1999fb4d1f4e19c9a4005d221ea1cc520d7b591,2017-04-25 23:06:26,Juan Tejada,[iso-core] Correctly pass connSettings to convertSmtpError,False
c07994d833bc6dea196253bbb3d91f136dd74cff,2017-04-25 23:05:19,Juan Tejada,"[client-app] Fix attachment previews

Summary:
See title

Test Plan:
manually check that we can still generate file previews.

Reviewers: halla, spang, mark, khamidou, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4487",False
1f84b4fb0f69cd41034b2fcfddbb3d420b78feea,2017-04-25 00:02:21,Evan Morikawa,"[client-app] only poll for identity every hour instead of every 10 min

Summary:
We used to poll for the identity every 10 minutes (which create quited a
bit of load on the billing site). The reason we polled was to get updates
for feature usage. If you used up all of your usage on 1 computer, the
  other needed to get updated eventually.

I don't think this needs to be every 10 minutes. Futhermore, when you make
a request against feature usage right now, it'll optimistcally refresh

Test Plan: manual

Reviewers: juan, spang, halla, khamidou

Reviewed By: khamidou

Differential Revision: https://phab.nylas.com/D4486",False
4086b23d709ee943e3eaf70252e15286ec3e3804,2017-04-25 00:01:41,Evan Morikawa,"[cloud-api] remove auth requirement against billing

Summary:
The Cloud API used to be dependent on the billing site to access the
redwood database for the Nylas ID. Upon further thought, there's no reason
this has to be true. We already authenticate against the account token
thereby mitigating the main concern of having unfettered access to the
metadata API. Only /metadata and /delta auth anyway.

This dramatically simplifies this code reduces this dependency and reduces
the usage of the billing API

Test Plan: Boot up app locally. Auth accounts. Ensure deltas & metadata still work.

Reviewers: spang, halla, juan, khamidou

Reviewed By: juan, khamidou

Subscribers: khamidou

Differential Revision: https://phab.nylas.com/D4485",False
d87b699d6d6c48b74a9dd11bc409d2d61daf06ad,2017-04-24 23:37:02,Evan Morikawa,"[client-app] fix link editor jumping away from you

Summary:
When you opened up the link box, 1 second later, the spellcheck extension
would mutate the dom, which would grab the selection back and blur the
link editor. This made it impossible to type links into the link editor!

Test Plan: manual

Reviewers: juan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4479",False
e36149812d5fd8a6b49d7766aefd75651ce68ba4,2017-04-22 02:29:22,Juan Tejada,"[iso-core] Fix certificate error msg

Summary: see title

Test Plan: manual

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4481",False
1378b0ca92ea0da31ca4aa14a67d47d4aabea624,2017-04-22 01:02:51,Juan Tejada,"[client-app] Detect smtp cert errors and relax condition to detect them

Summary: see title

Test Plan: manual

Reviewers: mark, spang, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4478",False
db4b18a3422356ec35397a8b75f886ccbe0caeae,2017-04-21 21:22:55,Juan Tejada,[client-app] Update 2.0.19 changelog to match public release,False
f143728c3921be840c05893442b8edc3bb3fac81,2017-04-21 21:18:25,Juan Tejada,bump(version) 2.0.19,False
8eff17299cd9ff65bd113c5d94c308eb2a59e895,2017-04-21 21:17:27,Juan Tejada,[client-app] Update changelog to reflect actual public releases,False
4e286cb3d00726f71ff0a30c12594b33961c615b,2017-04-21 21:09:25,Evan Morikawa,bump(version): 2.0.18,False
a6ef2f159d43a1f1644bd4f0f6f4bba3611cc9c9,2017-04-21 20:33:22,Evan Morikawa,"[client-app, cloud-api] track all auth errors & correlate to email

Summary:
We weren't recording the email address of the account that actually
errored on Mixpanel. This made it impossible to tell what email produced
what error!

We also weren't recording when Gmail errored. This makes the cloud API now
send to Mixpanel when this happens. This way our ""Email Account Auth
Failed"" event is the singular authoritative truth on account login
failures

Test Plan: manual

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4475",False
14aa0b781f9cd80e64edfc23afd6f31569351114,2017-04-21 20:33:09,Evan Morikawa,"[iso-core] update imap provider settings to match Mozilla ISPDB

Summary:
See:
https://github.com/nylas/imap-provider-settings/compare/2fdcd34d59b2a4cca6f522234a26c3c791758ebe...master

This increases the number of providers from 143 to 787. A 4.5x increase

Test Plan: Manual

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4467",False
3e44c96b4840eb63267fa85857ed30d8cb434d79,2017-04-21 06:26:32,Halla Moore,"[client-sync] Remove deprecated /send routes

Summary: We use Actions instead of http requests for these now.

Test Plan: manual

Reviewers: mark, evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D4438",False
ba37a5c7118c298b0c527764880c6c029be766a0,2017-04-21 06:25:46,Halla Moore,"[client-app, client-sync] Change the send task infrastructure

Summary:
This diff attempts to improve our send time performance by changing
the send task infrastructure. The major differences are:

- We now have a separate `SendTaskManager`/`SendTaskRunner` pair,
    instead of using `SyncWorker`/`SyncbackTaskRunner`. This makes it
    so that we don't have to wait for the sync loop to interrupt and do its
    various housekeeping.

- Communication between client-app and client-sync for sending is
    now done through an Action (`runSendRequest`) instead of the API.
    The API was adding a couple hundred milliseconds to our send time
   (maybe because of hapi magic or bad performance in the `request`
   library).

- We no longer store syncbackRequests for send inside client-sync.
    The only reason we needed persisted data across app sessions was
    to know when the app was closed mid-send, but now client-app can
    do that on its own with the new `performRemoteAlreadyCalled`
    property. Not having to wait for database saves on the syncback-
    Request helps our send time.

Part of T7949

Test Plan:
[x] always throw a retryable error in send and make sure it retries (indefinitely)
[x] throw a retryable error the first 5 times within send and make sure it eventually succeeds
[x] throw a retryable error the first 5 times within a non-send task and make sure it eventually succeeds
[x] throw a non retryable error in send, make sure dialog pops up
[x] throw a non retryable error in a non-send task, make sure dialog pops up
[x] put in a really long delay and make sure the syncbackTask timeout doesn't interrupt it, since it's not retryable
[x] close app in middle of sending
[x] one recipient no tracking
[x] one recipient with tracking
[x] multiple people with tracking

Reviewers: mark, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4437",False
dd3d4ea80e120e57628d1064103954731a275e8c,2017-04-21 06:25:06,Halla Moore,"[client-sync] Don't save the status of non-retryable SyncbackTasks twice

Summary:
Updating the status of a SyncbackRequest is slow. Previously, we always
set the status to `INPROGRESS-RETRYABLE` and then updated it a second
time if it should actually be `INPROGRESS-NOTRETRYABLE`. This diff makes
it so that we figure out which status it should be during the first
update and eliminates the second update.

Part of T7949

Test Plan: manual

Reviewers: mark, juan, evan

Reviewed By: mark, juan, evan

Differential Revision: https://phab.nylas.com/D4440",False
b0c5647bdf79a1360b81a224a80f6664e60da6ac,2017-04-21 06:24:10,Halla Moore,"[client-sync] Move call to `_cleanupOrphanMessages()`

Summary:
This should be called within `_peformSync` so that it isn't always
run when sync is interrupted. Not only does this add time to how
long it takes us to get back to the sync loop on interrupt, but it
also might remove messages that we were in the middle of
changing.

Test Plan: Made sure the function was still called at end of loop

Reviewers: mark, evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D4443",False
1ddc209c9249ca30dfe2cad214faca894116d8a0,2017-04-21 06:21:55,Halla Moore,"[client-sync] Debounce on the leading edge

Summary:
When creating a syncbackRequest from the API, we use a debounced
`wakeWorkerForAccount` to interrupt the sync loop. Previously, this
debounce was done on the trailing edge, which means we had to wait
500ms before the function was even called. This diff changes the
parameters so that we debounce on the leading edge instead, calling
`wakeWorkerForAccount` immediately if there haven't been any other
calls in the past 500ms.

Test Plan: manual

Reviewers: evan, mark, juan

Reviewed By: mark, juan

Differential Revision: https://phab.nylas.com/D4436",False
092554181bdd42cea1e6198b8f434f62e36df47d,2017-04-21 04:54:42,Halla Moore,"[*] Fix the specs

Summary:
Turns out that there was a spec for the IdentityStore that made the
spec runner exit immediately without an error code. I'm not sure what
exactly causes that, so for now I've disabled the spec. This diff
also fixes some specs that have gotten out-of-date since then.

Test Plan: Ran the specs

Reviewers: juan, evan, mark

Reviewed By: evan, mark

Differential Revision: https://phab.nylas.com/D4474",False
b2147703dbc39dc80118a73b94b470f27e8eaf0a,2017-04-21 04:45:43,Juan Tejada,"[client-app] Allow auth for all providers to bypass cert validation upon cert failure

Summary:
This commit modifies the the account auth settings page to show a special error message
when auth fails with a certificate validation error.

In this case, the new view will allow users to connect even if we can't
validate the certificate by re-running the auth request and forcing it
to trust the certificate using the options new options added in D4470

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4473",False
efd6e7c1044d58a207f0533e53e29c85d91afb8a,2017-04-21 04:45:04,Juan Tejada,"[client-app] Allow gmail auth to bypass cert validation upon cert failure

Summary:
This commit modifies the OauthSigninPage to show a special error message
when auth fails with a certificate validation error.

In this case, the new view will allow users to connect even if we can't
validate the certificate by re-running the auth request and forcing it
to trust the certificate using the options new options added in D4470

NOTE:
When this scenario occurs it means that the client **can't** trust the
certificate, but our cloud servers **can**. If the user decides
to manually trust the certificate, it means that the account settings in
the client and the cloud will be different. This shouldn't be a problem
as long as both can auth with gmail.

Depends on D4470

Test Plan:
Manually throw certificate error, verify that we use the correct credentials
that would bypass cert validation

Reviewers: spang, evan, halla

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4471",False
70c37fb98038cd3ea6b5878fa245eb10fe9e8310,2017-04-21 04:44:35,Juan Tejada,"[iso-core] Let /auth take options to use insecure tls settings for all providers

Summary:
Specifically let the /auth endpoint for all providers take
`imap_allow_insecure_ssl` and `smtp_allow_insecure_ssl` options so that
the client can bypass verifying certificates if it wants to.

Custom IMAP already takes these options, so we had to add them to gmail
and office365

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4470",False
aa375560ca2c463d61c4fe72bb9bf955699d909d,2017-04-21 04:44:06,Juan Tejada,"[client-app] Include host in cert error msg and use status code 495

Summary: see title

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4465",False
99891b59f218f4c1e9d03b17a4986a465fd54014,2017-04-21 04:43:05,Juan Tejada,"[client-app] Don't double report auth errors

Summary:
All NylasAPIRequest failures are already reported, so by reporting here
we were double reporting the error

Test Plan: manual

Reviewers: evan, halla, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4464",False
af3de338267fd7fedb4b2e263adc58a54d5b1374,2017-04-21 04:00:53,Mark Hahnenberg,"[client-sync, client-app] Remove forceWrite optimization for message bodies

Summary:
It's not that much more expensive to just write the bodies while saving
to the DB in edgehill, and it's much less likely to cause unintended
side effects. E.g. this was causing empty bodies to be sent due to not
forceWrite-ing when re-saving later versions of a draft because the
local file already existed on disk.

Test Plan: Run locally, send a draft

Reviewers: evan, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4468",False
bdde2eacaef766a48fc0f8083991b22bd8b6f7e5,2017-04-20 22:17:56,Juan Tejada,[client-app] Update changelog,False
d9230ef714cf407c172c45fd8884c2b9f9f1fb4c,2017-04-20 07:49:16,Juan Tejada,bump(version): 2.0.17,False
c61b758cb52e531605c5f4e520a4d9b4ce3dfe95,2017-04-20 07:48:20,Juan Tejada,[dev] Prevent from running daily when untracked files present in dir,False
0e715774adcd6cbdde4e1bc896edc23837870a0a,2017-04-20 06:37:00,Evan Morikawa,"[client-app] record error location to Mixpanel

Summary:
When the client reports an auth error to mixpanel, it could be because the
cloud encountered an error and then reported that back to the client,
which then reported it to mixpanel.

Before we had no way to know where the error came from.

This may help us diagnose errors that come from the client (due to local
ISPs and such) and those that come from the cloud (an AWS environment)

Test Plan: manual

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4463",False
49304294aa20102eeef7d741542dca013e3878c1,2017-04-20 06:36:46,Evan Morikawa,"[iso-core] cleanup auth helpers connect fn

Summary:
No logical change. Just code re-org and comments to make it much clearer
what's going on

Test Plan: manual

Reviewers: spang, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4460",False
62bfc0fdd49fc7d27e1fa84c6fa60980eb8e10fd,2017-04-20 06:36:25,Evan Morikawa,"[iso-core] always default to showing an error message

Summary:
Don't show the ""Unknown error contact support"" thing anymore. Show the raw
error. Also add the message we show the user and the code we think the
error is to the status page

Test Plan: manual

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4458",False
edf46a303a4475451a2f995089c35cf3766b1cd3,2017-04-20 04:46:26,Juan Tejada,"[iso-core] Update copy for cert errors

Summary: see title

Test Plan: manual

Reviewers: evan, halla, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4461",False
95842b3e31221164305c362efa2c8386feb51708,2017-04-20 04:04:09,Juan Tejada,"[iso-core] Correctly identify more certificate errors

Summary: see title

Test Plan: manual

Reviewers: halla, evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4459",False
9a10e614bfd3f983464842363520fecdd9ce8aa3,2017-04-19 22:39:18,Juan Tejada,"[client-app] Upgrade `is-online` package - fix online detection behind proxy

Summary:
Thus upgrade includes https://github.com/sindresorhus/is-online/pull/39
which should fix the offline notification status issues we are seeing in
T8174 for people running Nylas behind a firewall or proxy

Test Plan: manual

Reviewers: mark, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4455",False
af2b451de241a34284091bb126bad38a20698adf,2017-04-19 11:55:05,Juan Tejada,[client-app] Update changelog,False
b9765e4ade05e4ae5c7a0830648cba24116a5b9f,2017-04-19 05:44:16,Halla Moore,"[client-sync, iso-core] Use MIME encoded-word syntax on attachment filenames

Summary:
MIME encoded-word syntax is `=?{charset}?{encoding}?{encoded text}?=`. We need
to decode this syntax when syncing attachments from providers that properly
encode their filenames, and we need to encode our own uploads this way to be
able to load them once the message has been sent.

Fixes T7959

Test Plan:
Synced attachments from O365, sent attachments from NM, tested various
strings with the encode/decode functions (decoding `null` returns an empty string)

Reviewers: khamidou, evan, juan

Reviewed By: juan

Maniphest Tasks: T7959

Differential Revision: https://phab.nylas.com/D4454",False
17802fad0e11f113e387aabb3da2f0032608c8bd,2017-04-19 04:57:21,Halla Moore,"[client-app] Add folder mapping to preferences

Summary:
Adds a preferences page where users can change what categories are
assigned certain roles. This will help fix accounts where we have been
unable to detect sent or trash folders.

Addresses T7905/T7658

Test Plan: manual

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4301",False
0903195ab3de2d1bb5abfd8bac4763e09aa12899,2017-04-19 04:57:04,Halla Moore,"[client-sync] Update categories route to handle role updates

Summary:
When a `PUT` request is made with a `role` param, we will remove that
role from any other categories in the account that currently have that
role, and then add it to the target category.

Part of T7905/T7658

Test Plan: manual

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4300",False
250275582b6479c3bdad6738b34f0fe34ab5f240,2017-04-19 04:56:39,Halla Moore,"[client-app] Implemement a generic dropdown menu

Summary:
Useful for fancier rendering than what can be achieved with a `select`
tag. Will be used in another diff for a category selector that has a
search bar at the top.

Test Plan: manual

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4299",False
f27ee937598cf1d1f5d3a8c814d4ec2808ba6f20,2017-04-19 03:17:16,Juan Tejada,bump(version): 2.0.16,False
7a41980e090877303113001bbb702fdc85c0dcad,2017-04-19 02:44:55,Evan Morikawa,"[client-app] better handling of startup errors

Summary:
We ALWAYS popped open the damn inspector panel if there was a startup
error in the browser window. This would happen when we got EPERM issues
from the compile cache :(

Reporting from here is tricky since the browser windows don't setup their
error reporter until the NylasEnv.initialize call. Instead we send it to
the backend main process to handle and report.

Since there are multiple windows booting up at once, I needed only 1 of
them to pop up the dialog to users. Calling app.quit() from all 3 windows
in a row with 3 dialog boxes caused the app to not exist since the dialog
boxes stops proper code execution. This would leave the backend process
dead and the windows as zombies forever :(

This can be fixed by only having 1 window show the error message. I chose
just the ""work"" window since this error tends to happen to all windows and
it's the window most likely to be started on launch.

Test Plan:
Manually threw an error in the index.js and asserted that the error
reporter in the backend main process properly received it and emitted.
Also ensured that there was only 1 dialog box and that it fully quit the
app with all windows.

Reviewers: halla, juan

Reviewed By: juan

Subscribers: gleb

Differential Revision: https://phab.nylas.com/D4453",False
a09139332970af0fcab2b0aadbffcd29a92a8087,2017-04-19 02:15:31,Evan Morikawa,"[client-app] fix occasional EPERM issues on boot on Windows

Summary:
Fixes T8128
See comment on fn

Test Plan: Need steps to reproduce. This is just a defensive solution.

Reviewers: halla, juan

Reviewed By: juan

Maniphest Tasks: T8128

Differential Revision: https://phab.nylas.com/D4449",False
57c3d0132806d200617b4cf61d795fece98a731f,2017-04-19 01:42:53,Mark Hahnenberg,"[client-sync] Fix Message building when sending

Summary:
Saving the body to disk while sending was failing because of the
property initialization order issue in Sequelize. Now we build the
instance with only the ID and then assign the other props right after.

Test Plan: Test locally by sending messages

Reviewers: evan, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4451",False
4d8aa749379b34360b294621447a6da8bdc3597b,2017-04-19 01:05:24,Mark Hahnenberg,"[client-sync] Reduce CPU limits for historical sync

Summary:
Using 100% cpu can spin up people's fans. Since we have proper
throttling now, let's reduce the CPU limits for historical sync so that
we avoid doing so. We can also reduce historical battery sync more as
well.

Test Plan: Run locally, verify reduced CPU use

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4428",False
08d45f4721134f6476cf3f3759585e64a5cc69d8,2017-04-19 01:04:55,Mark Hahnenberg,"[client-app] Fix search parser to handle nested queries properly

Summary: We weren't properly handling queries like (A B) AND (C).

Test Plan: Run locally, verify search works for these types of queries.

Reviewers: evan, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4450",False
cbcb4d2807d7da8c1d7dbd06c5574aaae7a5a2ad,2017-04-19 00:08:09,Christine Spang,[client-app] Remove some more references to N1,False
437cacd60be3e3b00ed23f5daaccbc84888d3ca4,2017-04-18 11:09:33,Juan Tejada,"[client-sync] Correctly pass path when processing bodies

Summary: see title

Test Plan: manual

Reviewers: mark

Differential Revision: https://phab.nylas.com/D4447",False
a9cde5dcc38a39e86a83dd10f3a9cb957706e282,2017-04-18 06:21:32,Juan Tejada,"[*] postinstall: Don't try to link cloud specs if pkgs don't exist

Summary: see title

Test Plan: manual

Reviewers: evan, spang, mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4446",False
460e0347c49623c535895c6d3f0f8fcae58e971c,2017-04-18 06:10:15,Juan Tejada,"[*] Postinstall should install client-sync regardless of private plugins

Summary: see title

Test Plan: manual

Reviewers: spang, evan, mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4445",False
a255272e4618e38067cc41d6c4f1123d880129e2,2017-04-18 04:16:56,Mark Hahnenberg,"[client-app, client-sync] Move messages out of db into compressed flat files

Summary:
Previously we stored message bodies uncompressed inside two different
databases. This was bad for a few reasons:

* Duplicate data in multiple places is an obvious waste of disk space
* Uncompressed data also made the disk footprint bigger than it might
  otherwise be
* Storing these large message bodies in the database made the db file
  larger than it otherwise could have been, increasing the size of
  tables and slowing down queries.

This diff adds support for storing message bodies outside of the
database in compressed flat files. It changes the use of the body column
in the K2 database and the MessageBody table in the edgehill database to
contain a blob of JSON that contains a path to the file on disk. We
use the new format in an incremental fashion without having to perform an
actual database migration by first checking if the body matches our expected
JSON format and treating it appropriately if it doesn't. Both databases refer
to the same file on disk, thus deduplicating the messages bodies. We also
transparently support gzipping the message bodies stored on disk when we
read from/write to the files. The real world space savings depends on the
compressibility of the messages, but we've seen up to ~60% improvement in disk
space usage for certain inboxes. Typical savings are closer to 20%. Also, by
storing messages as separate files on disk we can potentially integrate with
Spotlight search at some point in the future.

Test Plan:
Run locally, make sure that upgrade to this doesn't hose things,
look at size of DB, read emails

Reviewers: evan, spang, halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D4422",False
0a10c40f57a7e7db5ffee6e7676fd5375e29fcef,2017-04-18 02:40:33,Evan Morikawa,[cloud-api] fix step param on worker admin dash,False
825005d15af7cdfe32ee50545f0120dd8894ddcd,2017-04-18 01:46:08,Evan Morikawa,"[cloud-api] revamped worker dashboard

Summary: New worker dashboard

Test Plan: manual

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4435",False
20ced8310ae9c7d9bf2d06a2df1e0e45c4f0a438,2017-04-18 00:12:00,Juan Tejada,[client-app] Update changelog,False
e9711da6990e0365c455563e25e250687870246d,2017-04-17 23:59:02,Mark Hahnenberg,"[client-app] Fix benchmark mode

Summary:
We weren't passing benchmarkMode through in the default window options,
so the worker window (or any other spawned window) would think it wasn't in
benchmark mode.

Test Plan:
Run locally, verify that the worker window thinks it's in
benchmark mode

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4427",False
c770c809f3fc0256b3356b53032a88b63eead57b,2017-04-17 23:16:44,Nylas Coffee Machine,bump(version): 2.0.15,False
03921db62ff5f4f65f29050f988beeca2ac126fe,2017-04-17 23:15:39,Juan Tejada,"[client-app] Database malformed errors shouldn't be retryable

Summary:
Given that this error is unrecoverable it shouldn't be retryable.
Additionally, this commit improves error handling for this error in a
few ways:

- Don't delete all databases, just edgehill.db which is the one we know is corrupted. (Use `handleDatabaseUnrecoverableError` instead of `Actions.resetEmailCache`)
- Message the user about the database being reset so the app doesn't restart without notice, and make sure that this message is only displayed once by moving it to the main process

Test Plan: manual

Reviewers: mark, spang, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D4433",False
2aa49dfd34391d14779ffbc5ae12e2ba30809e5d,2017-04-17 23:02:08,Juan Tejada,"[client-app] When resetting database, make sure to re-init db reader

Summary: see title

Test Plan: manual

Reviewers: halla, mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4432",False
09f8561a2c4c47292c8d510a0788ee7a3fb1c95e,2017-04-17 23:00:15,Juan Tejada,"[client-app] Correctly handle db malformed errors in main process

Summary:
This commit addressess issue T8135, which prevents the app from
starting.

This was happening because when 3111c166 landed, we added database
access from the main (backend) electron process to be able to read the
identity now stored in the database: https://github.com/nylas/nylas-mail/commit/3111c166#diff-1efa26fa0ae1603366b2c0033d971028R44
However, we omitted to add any error handling, so if the database failed to open
due to a database malformed error (which it does:
https://sentry.io/nylas/nylas-mail/?query=is%3Aunresolved+release%3A2.0.14+malformed&statsPeriod=14d), the app will just fail to start,
given that this happens during the initialization of the main process.
Additionally, the fact that we had no error handling increased the error
reports for malformed errors given that we would never handle them, so
every-time we opened the app we would report the same error

This commit adds the same error handling we have in the DatabaseStore
and moves the code around so it's available both in the main and
renderer processes.

After this commit, if the database fails to open during main process
initialization, due to malformed errors or others, we will correctly
inform the user that the database is corrupted, rebuild it, and restart
the app.

Test Plan:
manually throw errors during setup, verify that we handle them
correctly

Reviewers: mark, spang, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D4431",False
c54c978768ca3883456975535ec9bb1988a501b5,2017-04-17 22:47:34,Juan Tejada,"[client-app] Remove dead mail rules code

Summary:
Which was arguably already a code smell being inside the
DatabaseStore

Test Plan: manual

Reviewers: mark, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4430",False
11493dfa017fb39e8a9fb5fb57860fffacf6b2fc,2017-04-15 02:07:01,Juan Tejada,[client-app] Update changelog,False
3b5468433ade6c91a47f7eff8aff0e126938df82,2017-04-15 02:06:31,Juan Tejada,[client-app] Update changelog,False
8c3dc8152e6efca9827f15ae8a4b9eda55a21b7d,2017-04-15 00:55:57,Nylas Coffee Machine,bump(version): 2.0.14,False
17882eb9ecd0dbc96942127d06ca50be6dd7d9c7,2017-04-15 00:54:27,Juan Tejada,"[client-sync] Prevent duplicate accounts and sync workers

Summary:
After https://github.com/nylas/nylas-mail-all/commit/008cb4c, the shape of
account.connectionSettings changed, which means that ids for accounts
will also change, given that they are based on the connection settings (see
Account.hash()).

This is fine in most cases, except for accounts that were running on a
version of Nylas Mail before 008cb4c, then upgraded to a version
after 008cb4c, and then re-authed their account.
In this scenario, re-authing the account will create a second account with
a different `id` but with the same email address, along with an extra
sequelize database, and will start a second SyncWorker for the same
account. App-side, the `AccountStore` will correctly overwrite the first account,
so users would correctly see just 1 account in the sidebar. However, given
that 2 SyncWorkers would be running for the same account,
message ids would collide in edgehill.db and this would cause
threads to disappear from the ui as if they were being deleted.

To fix this, we need to do 2 things:

- Upon app start, we remove any duplicate accounts that might have been created due to this bug before starting any sync workers
- If we detect that we are going to create a duplicate account upon auth success, we delete the old account first. This will effectively cause sync to restart for the account.

Test Plan:
Verified problem: Checked out a commit before 008cb4c, authed an account, checked out master, re-authed account, verified that duplicate accounts are created.

Then test 2 scenarios:
- With duplicate accounts present, checked out this commit, verified that duplicate account would be removed and sync would function normally.
- With an account authed on a build before 008cb4c, checked out this commit, re-authed the account, and verified that duplicate account wouldn't be created

Reviewers: mark, halla, khamidou, spang

Reviewed By: spang

Subscribers: tomasz

Differential Revision: https://phab.nylas.com/D4425",False
9763b8684e81a9d149643dec2414075afc0a8a67,2017-04-14 23:48:23,Juan Tejada,"[client-sync] Correctly remove sync worker reference when destroying it

Summary:
By nullifying the key inside `workersByAccountId` we would attempt to
access accountIds that no longer existed in other parts of the code by
using Object.keys()

This makes it so we correctly completely remove the record from the map

Test Plan: manual

Reviewers: halla, spang, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4426",False
0a9f4445e3d3fb8b352aa8bacf71c82efc27274f,2017-04-14 10:07:00,Juan Tejada,[client-sync] Init SyncProcessManager with Identity,False
120eddcc247ef55c865e66b8051ff25ab6b3d608,2017-04-14 05:15:12,Mark Hahnenberg,"[client-sync] Fix contact ranking error

Summary:
This was showing up in Sentry. Check to see if the recipient has an email
before calling toLowerCase.

Test Plan: yolo

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4423",False
c853cad0c31acb04279118da6ec348ea1d74f6db,2017-04-14 02:32:24,Juan Tejada,[client-app] Update changelog,False
a1612c7897b8a9e747c257cd3f402b93954b5b53,2017-04-14 01:57:28,Juan Tejada,[client-app] Update changelog,False
b7cdb415243949ce5844999788d458d7eefe11f4,2017-04-14 01:02:00,Nylas Coffee Machine,bump(version): 2.0.13,False
db752260d7e3eebca8d6bf35b66e04040f4de768,2017-04-14 00:59:29,Juan Tejada,"[client-app] Upload nupkg with correct name for win32 autoupdater to work

Summary: See title

Test Plan: manual

Reviewers: spang, khamidou, halla

Reviewed By: khamidou, halla

Differential Revision: https://phab.nylas.com/D4421",False
2b41b1eb8452148726515d13f2310d36028a3a19,2017-04-14 00:24:27,Juan Tejada,"[client-app] Correctly handle window.unhandledrejection events

Summary:
It seems that sometimes we get events that don't have `event.detail.reason`.
This commits tries to make our best guess, or report info about the event shape

Test Plan: manual

Reviewers: mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4420",False
3e52af21c52eda85d8db7ec9b7e9768cb1f64fcf,2017-04-13 23:55:50,Juan Tejada,[client-app] Update changelog,False
564177e2b72ba6536e53fc7fa5dd30ac64f8ba53,2017-04-13 23:39:03,Nylas Coffee Machine,bump(version): 2.0.12,False
2e041c469b6a7c21327a669b8c3d0e38014a5979,2017-04-13 23:37:16,Juan Tejada,"[client-app] Prevent NM from overwriting N1 binary on windows

Summary:
This changes the `name` option we pass to `electron-windows-installer`,
which makes it so that the app is installed under
`AppData\Local\NylasMail` instead of `AppData\Local\Nylas` where the
old N1 binary lives

Test Plan: manually tested the builds from `ci-test-4` branch on the surface machine

Reviewers: mark, spang, khamidou, halla

Reviewed By: khamidou, halla

Differential Revision: https://phab.nylas.com/D4419",False
3f13b5fe8005f792602ba029140b4e081f72c284,2017-04-13 23:19:08,Juan Tejada,"[client-app] Fix runtime error in FetchFolderList

Summary: See title

Test Plan: manual

Reviewers: mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4418",False
9076bd007ed16118cabe7700e1cd3528f5c62d8d,2017-04-13 09:18:40,Juan Tejada,"[client-app] Prevent old N1 config from getting wiped when installing Nylas Mail

Summary:
Due to a legacy migration system, users that had previously installed
old N1 (1.5.0) would get their N1 config wiped after installing Nylas
Mail (2.0) in most cases.

See https://github.com/nylas/nylas-mail/blob/n1-pro/src/browser/nylas-pro-migrator.es6 for details

Fixes T8096

Test Plan: manual

Reviewers: halla, spang, mark

Reviewed By: mark

Maniphest Tasks: T8096

Differential Revision: https://phab.nylas.com/D4417",False
06289a1bb5b2cdf7b94b98337cc8ad7c9e7cb7df,2017-04-13 08:28:06,Juan Tejada,"[*] Remove useless docs

Summary:
This makes grepping the codebase really painful. We don't need these
docs here

Test Plan: manual

Reviewers: mark halla spang evan

Subscribers:",False
b922523f51a49a28aac8eb9a15170f4a33d1878d,2017-04-13 01:42:24,Juan Tejada,[client-app] Update changelog,False
4686bdd913509c70dfcf4a113f1809d7fbad0329,2017-04-13 00:43:03,Nylas Coffee Machine,bump(version): 2.0.11,False
c24740bf4ec3dfc6f37dffcebf52298dd03adea9,2017-04-13 00:41:49,Mark Hahnenberg,"[client-sync] Dispose of mail listener connection before getting new one

Summary:
When we had to refresh our credentials for the mail listener connection we
weren't disposing of the old connection which caused us to slowly leak
connections from the IMAP connection pool, eventually requiring a
restart. Now we always dispose of the connection prior to requesting a
new one from the pool.

Test Plan: Run locally always refreshing credentials, verify we don't get stuck

Reviewers: spang, evan, halla, juan

Reviewed By: halla, juan

Subscribers: halla

Differential Revision: https://phab.nylas.com/D4414",False
ce189cea0cda785fd58b9f2d1b405936e056bb35,2017-04-13 00:38:24,Juan Tejada,"Revert ""[client-sync] Poll for gmail attribute changes from `_mailListenerIMAPConn`""

This reverts commit d864efe76dd1d85efee1de3a7fd05b4737d8356d.

See https://phab.nylas.com/D4410 for details on why it was reverted",False
21e962fc2de56a836b20b781ad816dd2605e73b3,2017-04-13 00:36:22,Juan Tejada,"[client-app] Don't double report unhandled rejections

Summary:
We listen for unhandled rejections on both the `process` and the `window`. From
my understanding, both are necessary because some errors might escape
one or the other. However, most errors get caught by both handlers, so
we don't want to double report them to sentry (or the console).

To prevent this, this commit debounces the unhandled rejection handler
for a very short time so that the same error only gets reported once.
Additionally, it rate limits reports to sentry based on the stack trace

Test Plan: manual

Reviewers: mark, halla

Reviewed By: mark, halla

Differential Revision: https://phab.nylas.com/D4413",False
e19ed52fbc3c57343c8c027bf4cd73f16a26ff7a,2017-04-13 00:35:07,Juan Tejada,"[client-app] Fix unhandled rejection handling (fix ipc parse error)

Summary:
Previously, we were listening for unhanlded rejections on both the
`window` and the `process`. However, the window handler didn't receive
an error as a parameter, but rather a window event. When trying to
report this event and sending it over IPC we would get an ipc parse
error.

This commit makes it so we correctly report the error instead of the
window event.

Test Plan: manual

Reviewers: mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4412",False
068847af36cd4a4b610e36e5468d7e7fb65e27bb,2017-04-13 00:34:11,Juan Tejada,"Revert ""[client-sync] Transaction-ify processMessage""

Summary:
This reverts commit e764545bd856467885ed60446b31ace27ab6f489.

Adding an overarching transaction to `processMessage` is causing
database locked errors when processing deltas, specifically when trying
to write to the Transaction table, given that that write happens
asynchronously inside the execution of `processMessage`, but doesn't
have access to its transaction. See T8117

Given that the performance gains from wrapping messgae processing in a
transaction were not significant, let's revert this to prevent db
locking issues

Test Plan: manual

Reviewers: halla, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4411",False
7b8e8ed3a68bf9db2a5751c4de1f7f8e4ac18c42,2017-04-12 05:06:48,Juan Tejada,"[client-app] Rate limit database malformed error reports to sentry

Summary:
We were reporting 1m+ of these events, heavily contributing towards our
quota

Test Plan: manual

Reviewers: halla, mark

Reviewed By: halla, mark

Differential Revision: https://phab.nylas.com/D4406",False
90ab24aca433c597502526153b31d86d121ff09c,2017-04-12 04:11:30,Juan Tejada,[client-app] Update changelog,False
cbc7d0c0c8b48b420afa1bf4be880f7ebc616d0f,2017-04-12 02:04:47,Nylas Coffee Machine,bump(version): 2.0.10,False
7966dd7117a2ca3cbe2a8b3ad43ee9bb2d605475,2017-04-12 01:06:39,Juan Tejada,"[client-sync] Ensure allmail folder exists before trying to access it

Summary:
When checking for flag updates for gmail accounts, when syncing for the
first time the all mail folder won't be available because we haven't
fetched the folder list, so it will throw a runtime error

Test Plan: manual

Reviewers: mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4405",False
41835cf18e7db68a33805cf0579c9ca7c4731b00,2017-04-12 00:52:57,Halla Moore,"[client-app] Fix SyncbackMetadataTask dependency

Summary:
Add a sequentialId check in isDependentOnTask() so that the first
SyncbackMetadataTask won't get blocked on other SyncbackMetadataTasks
in the queue for the same pluginId.

Addresses T8112

Test Plan: Manual

Reviewers: spang, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4404",False
eb4af5a13051c62b4fbe19da1b5d8243105a3bd4,2017-04-11 23:39:39,Halla Moore,[isomorphic-core] Add missing .default to require,False
3f7d0976130e657f587dfdd140ff3a081ca64fe0,2017-04-11 23:19:58,Halla Moore,"[isomorphic-core] Move buildMime to MessageUtils, add includeBcc option

Summary:
Since buildMime isn't always used explictly for the send operation (we
mostly use it for stuffing the sent folder, which is a separate
operation), move it to MessageUtils. Additionally, add an includeBcc
option. We don't want the BCC header to be visible on outbound messages,
but it needs to be present on the version that is saved to the sent
folder.

When we weren't including the BCC header in the sent folder version, we
were getting an id mismatch between our optimistic message and the
message that gets processed by the sync loop (because we include the bcc
participants when computing the id hash). When the sent message was a
reply, the optimistic message included the threadId, and this had the
side effect of leaving both versions of the sent message in the thread.
Since the optimistic message never receieved it's imap UID, any action
performed on the thread would fail with the missing UID error as seen in
T7941. Adding this BCC header will allow us to compute the proper id
hash and reconcile the synced message with the optimistic message.

Test Plan: manual

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4365",False
4ba48489d64075444790ce35d121285b93821ba1,2017-04-11 23:19:30,Halla Moore,"[*] MessageFactory -> MessageUtils, SendUtils -> ModelUtils

Summary: Rename some util files

Test Plan: manual

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4364",False
3ca0bfb48be84063e3dcd47a130f6f857ca3a203,2017-04-11 23:15:09,Halla Moore,"[client-sync] Don't report stuck sync processes to Sentry

Summary: Just to mixpanel. Addresses T8095

Test Plan: Meh

Reviewers: mark, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4403",False
9d497041b94bab2105518d4aee179ddd8c5260d8,2017-04-11 23:07:13,Juan Tejada,[client-app] Update changelog,False
b5b1a3a8a65a09b1c7066a1b2b54c0edc4190d87,2017-04-11 20:42:13,Nylas Coffee Machine,bump(version): 2.0.9,False
d864efe76dd1d85efee1de3a7fd05b4737d8356d,2017-04-11 04:16:02,Halla Moore,"[client-sync] Poll for gmail attribute changes from `_mailListenerIMAPConn`

Summary:
Normally, the imap connection emits an 'update' event when there are any
flag changes. Gmail, however, only emits the 'update' event when there
are new or removed messages. If there's a fairly large batch size being
synced in the sync loop, we don't want to wait until the end of that to
check if the highestmodseq has changed. To get around this, this diff
updates the new mail listener connection to periodically poll for the
highestmodseq and trigger the same update handler when changes are
detected.

Test Plan: manual

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4397",False
80bebe5c0c1b19667eba79e4b477c08165c24855,2017-04-11 04:14:26,Halla Moore,"[client-app] Re-add imap to the onboarding accounts page

Summary:
Put the IMAP option back on the provider selection page within
onboarding. Also remove the 'hidden' property on account types since I
don't think we'll be using it for any other providers, and remove the
'Add Custom IMAP Account' from the application menu.

Addresses T8097

Test Plan: Manual

Reviewers: spang, mark, juan

Reviewed By: mark, juan

Differential Revision: https://phab.nylas.com/D4402",False
fa3fd488c37c2b743ef9f418c176fce4f75f1a86,2017-04-11 03:38:48,Juan Tejada,"[client-app] Fix delta streaming connection retries

Summary:
Previously, every time our NylasLongConnection changed its status to
`connected`, we would reset our backoff scheduler, assuming that
every time our status changed to `connected` it meant that we would not
receive any errors.

However, if our backend is down or overloaded (or returning 401s like in
our recent outage), we would do the following:

1. Establish connection, change status to `connected`
2. Reset backoff scheduler
3. Receive error
4. Close connection
5. Schedule next retry using backoff scheduler. Delay will be 1s or less, because scheduler was reset in 2.
6. Retry after delay,
7. Repeat from 1., ad infinitum

This caused us to consistantly hammer our servers and render our
exponential backoff useless.

This commit makes it so we conly reset the backoff scheduler when we
actually receive deltas, and increments the max backoff to 10 minutes

Test Plan:
run against local n1Cloud, manually return 401s from the api, verify that we
didn't backoff at all before this diff, verify that we backoff correctly after
this diff

Reviewers: mark, spang, halla

Reviewed By: mark, spang, halla

Differential Revision: https://phab.nylas.com/D4401",False
1cd9e7e23e10cca4056bc58830b5aeed76fedf70,2017-04-11 01:10:22,Halla Moore,"[isomorphic-core] Handle weird MIME edge case with @ symbol

Summary:
Something weird happens with the mime building when the participant name
has an @ symbol in it (e.g. a name and email of hello@gmail.com turns
into 'hello@ <gmail.com hello@gmail.com>'), so replace it with
whitespace.

Test Plan: manual

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4363",False
ac7743b4999a0c7a59cfaade4303999083d94275,2017-04-10 23:42:36,Halla Moore,"[cloud-workers] Reminders: add 'SINCE' to imap search query

Summary:
Reminders have been seeing a lot of socket timeouts, and we have a hunch
that it's because we're spending a lot of time in the imap search. To
prevent us from having to search the entire Inbox or All Mail box, this
diff adds a 'SINCE' argument to the search query. Any new replies will
be after the original message was sent. We also search a day past that
to avoid any potential timezone issues.

Test Plan: manual

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4396",False
fe77466356d370e9bb80420cdd8668bdf540f190,2017-04-08 06:07:31,Evan Morikawa,[cloud-workers] add DataDog StatsD for heartbeats,False
6b22d1e7e529655897d7efde297540fde082167c,2017-04-08 04:03:57,Mark Hahnenberg,"[client-app] Add benchmark mode

Summary:
There are some settings that apply to dev and prod modes that we don't want
to use while benchmarking. E.g. the folder where we store messages,
whether we generate long stack traces in our bluebird promises, etc.
This diff adds a benchmark mode so that we can change these settings to
something that works better for benchmarking.

Test Plan: Run locally, verify it works

Reviewers: evan, juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D4374",False
e764545bd856467885ed60446b31ace27ab6f489,2017-04-08 03:39:25,Mark Hahnenberg,"[client-sync] Transaction-ify processMessage

Summary:
We do lots of writes while processing a single message. To reduce the
write churn from lots of mini-transactions, this diff threads one
overarching transaction to everything in processMessage.

Test Plan: Run locally

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4394",False
54c9e826bec8d0dc8f3c15b9440f23f9d2ed0a99,2017-04-08 01:38:13,Mark Hahnenberg,"[client-sync] Increase sqlite page_size and cache_size

Summary:
The defaults are a little low. edgehill.db already does this. There's no
obvious effect on smaller dbs, but we should at least make the two
consistent.

Test Plan: Run locally

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4395",False
3212faa0ce1264fd7eb0f69b315d35d8a2f988c7,2017-04-08 01:36:06,Evan Morikawa,[cloud-workers] restart automatically on unhandeld rejections,False
3844c4e0c4d4f53d67077797c0efd0ced141486a,2017-04-08 00:44:51,Juan Tejada,[client-app] Update changelog,False
3e0b575de59e2160a505e9aea00c9e9a9ff264a7,2017-04-08 00:12:30,Nylas Coffee Machine,bump(version): 2.0.8,False
0b167e3700601fef16834028a608d46968f309e9,2017-04-08 00:11:21,Juan Tejada,"[client-app] Ensure SyncbackMetadataTask dependency to prevent version conflicts

Summary:
Previously, SyncbackMetadataTasks for the same plugin did not depend on
each other, so they could try to modify the same piece of metadata
concurrently, which would likely produce version conflict errors.

This was happening with send reminders because we were queuing 2 of
these tasks back to back upn send success. Adding this dependency fixes
the version conflict errors when setting the metadata

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4393",False
919a6675353e3e0c843c97040cb231a57d8dd64d,2017-04-08 00:07:09,Halla Moore,"Revert ""[client-app] Fix version conflict with send-reminders""

This reverts commit fa678425067a963b722f55c65ae896240c58b570.

The actual problem was that SyncbackMetadataTasks needed a dependency
structure",False
726140a52d1515741bc3b7533f869df41458347b,2017-04-07 23:48:40,Halla Moore,"[client-private-plugins] Reminders: make sure accountId query isn't null

Summary:
There was a call to `asyncBuildMetadata` that didn't pass in an
accountId and caused the query to fail. Rather than pulling the
accountId out of the message separately wherever we call this function,
just pull the accountId out of the message within `asyncBuildMetadata`
itself.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4392",False
20353c19a7d9085661325ee640b748fb8ceabffc,2017-04-07 08:02:30,Juan Tejada,bump(version): 2.0.7,False
de2b7ad9c821054678b5d3f038e67fb6972e8da3,2017-04-07 07:27:16,Karim Hamidou,"[cloud-workers] [send-later] Fix send later token expiration

Summary:
Fixes T8076. So, the Gmail OAuth API returns us an expiration time in milliseconds, but we convert it to seconds everywhere, except in the cloud-api. This caused us to never refresh tokens because we'd be comparing seconds to milliseconds.

Fix this by converting the `expiry_date` from our credentials to seconds.

Test Plan: Tested manually. Will do more testing tomorrow, after my credentials expire.

Reviewers: evan, juan

Reviewed By: evan, juan

Maniphest Tasks: T8076

Differential Revision: https://phab.nylas.com/D4390",False
4e727761c6a5ad0af09653785c56d214cdb8b1d2,2017-04-07 07:25:30,Juan Tejada,"[client-plugins] Correctly scope categories by acct when setting reminder

Summary:
Previously, if you had a Gmail account and an O365 account,
and set a reminder on an O365 message that wasn't in the inbox (e.g. a
completely new draft, or a draft in sent), we would set the metadata for
that message incorrectly indicating that the folder name was `[Gmail]/All Mail`

This was because we were querying for Categories not scoped by accountId

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4391",False
8473f96a19698a0b5a4eba49fe99f3c1ca8e75bc,2017-04-07 06:52:29,Evan Morikawa,"[iso-core, cloud-*] catch JSON parse errors in DB columns

Summary:
MySQL would insert bad JSON due to emoji errors. This would cause JSON
parse errors and prevent us from ever reading objects from the DB. We now
catch and return null instead with an error which will at least let the
query complete to let us isolate and deal with the malformed obeject (like
destroy it)

Test Plan: manual

Reviewers: spang, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4389",False
e876c36898bbda4d71d55232054ad2e3b97f5cf8,2017-04-07 06:12:00,Evan Morikawa,"[cloud-workers] rename ExpiredDataWorker -> CloudWorker & rearrange src

Summary:
- ExpiredDataWorker is now CloudWorker
- `/workers` got moved under `src`

Test Plan:
Manual
I also checked for usages of `path`, `require`, `__dirname` in each of the
workers

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4388",False
8aa983a9594c551c08b0a688b6536a8ca8648b7b,2017-04-07 05:22:48,Christine Spang,"[cloud-*] Fix options for setting MySQL connection charset

FML: https://github.com/sequelize/sequelize/issues/1220",False
9cf20e119af21bba8e2b075d1c04dc7cebed9af2,2017-04-07 04:55:09,Christine Spang,"[cloud-*] Switch MySQL charset to utf8mb4

Summary:
We need this in order to be able to store 4-byte emoji and other
extended unicode characters in the database.

Test Plan: deploy to staging - need the change that sets the connection charset on staging :(

Reviewers: khamidou, juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D4387",False
4e9bb587f7c3c0009e6cf339ae89c58f50bed86f,2017-04-07 04:42:23,Nylas Coffee Machine,bump(version): 2.0.6,False
94cb722ec0b3a976cdc8ae003402e67b7cacffc2,2017-04-07 04:41:24,Juan Tejada,"[client-plugins] Delete drafts after they are sent later

Summary:
This commit adds a new module to the send-later plugin that listens to
all drafts with send later metadata and destroys them whenever it
detects that their expiration was cleared, not by the user

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4386",False
83320348626d5fba144e5eb9659703624b6cc48f,2017-04-07 03:48:33,Evan Morikawa,[cloud-workers] fix connection typo,False
10301111ae8406596acd503329df3c1e40bbb8ef,2017-04-07 03:46:14,Evan Morikawa,[cloud-api] change worker admin color,False
fe21ae891e64731fe9366dc5f4f2b789f0f360a7,2017-04-07 03:45:21,Karim Hamidou,"[cloud-workers][send-later] 🔪 with 🔥 duplicate sent messages

Summary: Finally figured out the right way to get Gmail to remove duplicated sent messages.

Test Plan: Tested manually.

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4385",False
9d43a5c56d133a801f527f175a3109f1ef686c92,2017-04-07 03:39:19,Evan Morikawa,"[cloud-workers] add a retryAt field to do exponential backoffs

Summary:
Add exponetial backoff and cleaned up some functions in the worker.
We now have a `retryAt`. Didn't use the `ExponentialBackoff` class because
that needs to stay in memory the whole time and isn't designed to be
backed by a retryAt field. Just implemented 2^x backoff.

Test Plan: Manual. Threw a `RetryableError`

Reviewers: juan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4384",False
fa678425067a963b722f55c65ae896240c58b570,2017-04-07 03:38:17,Halla Moore,"[client-app] Fix version conflict with send-reminders

Summary:
The 409 version conflict error was due to an actual version conflict
when we were syncing back metadata. When you set a reminder on a draft
that hasn't been sent yet, we initially set just the expiration date in
the metadata. Then, when the draft is actually sent, we update the
metadata with some fields that aren't finalized until after the send
(e.g. messageIdHeader, subject, replyTo). However, this second update
was being made before we received the delta for the first update, so the
version number in the second update was incorrect.

To fix this, this diff adds some special handling in the metadata route
to detect if the metadata version is off by one. If data was only added,
not changed, then we merge the two versions together.

Test Plan: manual, specs

Reviewers: juan, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4383",False
6ca21c4d89e5ee5e48d8a1e4964eb73478138c33,2017-04-07 03:30:00,Evan Morikawa,"[cloud-workers] implement IMAP connection pool

Summary: Adds IMAP connection pool to workers

Test Plan: manual

Reviewers: mark, spang, halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D4379",False
111bc09d96b4e67b58a034a07700ddb0ffdccda2,2017-04-07 03:04:31,Juan Tejada,"[dev] Ensure daily script grabs current version after pulling latest changes

Summary: see title

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4378",False
79565662fa92e291e1a0220aa32e0ac032b05557,2017-04-07 02:54:24,Juan Tejada,"[cloud-workers] Fix runtime error trying to iterate over undefined

Summary: see title

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4382",False
3519c80d13b19f9e502e5c2a5ed278edb50540e7,2017-04-07 02:53:48,Juan Tejada,"[cloud-workers] Properly generate metadata deltas when clearing expiration

Summary:
Apart from not making bulk updates to metadata, we need to update both
the expiration column and the expiration field inside the json value

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4381",False
d24205bee65b132d339e94a878677fb8f878bbee,2017-04-07 01:58:09,Juan Tejada,"[client-app] Always fetch and update identity regardless of env

Summary:
This was annoying because we wouldn't fetch the identity when running `local`
env which produced all sorts of errors

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4380",False
1d03114772f500bbc41bd020bddae854e4865c80,2017-04-07 00:26:10,Nylas Coffee Machine,bump(version): 2.0.5,False
604342bd19b479d9b999500363f2440ed99ceaa2,2017-04-07 00:24:30,Juan Tejada,"[cloud-workers] Don't use bulk updates in foreman in order to generate deltas

Summary: see title

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4373",False
d8377ad4b1e0e30ad85d7e0985dd54c800e98208,2017-04-07 00:24:00,Juan Tejada,"[cloud-workers] Increment default imap conn socket timeout in cloud workers

Summary:
We are seeing a lot of imap connection timeout errors. Let's increment
this to a high timeout to account for a large variety of imap servers.

Test Plan: manual

Reviewers: mark, halla, evan, spang

Reviewed By: evan, spang

Differential Revision: https://phab.nylas.com/D4371",False
de39d03f5a83c47e3cf97a3a29c3e6e068206333,2017-04-07 00:24:08,Evan Morikawa,"[cloud-*] add account to logging & fix typo

Summary:
So our logs can have an email and provider field. Also most workers need
the account

Test Plan: manual

Reviewers: halla, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D4377",False
6dd4917b0fb46d29163f2845c08eb8f75f7c6e51,2017-04-07 00:23:55,Evan Morikawa,"[cloud-workers] make send later not retryable after successful send

Summary: mark the task as not retryable

Test Plan: manual

Reviewers: halla, juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D4376",False
2bfa04487eb674131c03a920b64b6ad2e1aa3e43,2017-04-07 00:23:39,Evan Morikawa,"[iso-core, cloud-*] move generate XOAuth2 & fix first auth usage

Summary:
We were not generating the XOAuth2 token on the first go when connecting
accounts. This would cause the first send later to fail. Since this
happens in ISO core, we needed to move the function out of cloud-core and
import from other places that use it

Test Plan: Manual

Reviewers: khamidou, juan, halla, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4375",False
a79456e7abe9c468e97619883a094717852a5db1,2017-04-06 23:32:40,Evan Morikawa,[cloud-workers] fix stauts -> status,False
19e45c2e59c68deeb33bf8c31facb6dc75b69f07,2017-04-06 23:31:59,Evan Morikawa,[cloud-workers] adjust retry constants & fix orphan cleanup,False
bc1cef82a48478874dda34e7389cccc693de87ca,2017-04-06 23:02:42,Juan Tejada,"[isomorphic-core] Ensure IMAPConnPool uses updated account credentials

Summary:
Previously, we would initialize an `AccountPool` with an account
instance and reference the account as an instance variable. Then,
every time we created a connection, we used the account we had a
reference to obtain the credentials.

However, if the credentials on the account changed, e.g. when we refresh
the access token for gmail accounts, the connection pool would never
realize that the account had new credentials and always try to create
the connection with the old credentials, causing the sync worker to
enter an error loop of `Invalid credentials` errors

To fix this, we could reload the account every time we try to create a
connection, but it seems that the fresh credentials should just be
passed every time we create connections without the pool having to be
aware of potential changes under the rug.

This commit makes it so the pool no longer holds a reference to the
account, but rather it is passed in every time we check out a connection

Test Plan: manual. how did this even work before? :(

Reviewers: evan, halla, spang, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4370",False
e71cc1af001cff1474f01e1945c0fcd1b64c316a,2017-04-06 06:24:09,Nylas Coffee Machine,bump(version): 2.0.4,False
dfe59d417cdf11b01cd5e7d6e8831216bb0714d1,2017-04-06 06:22:04,Juan Tejada,"[client-plugins] Correctly syncback metadata for send later

Summary:
Turns out we still need to call `Actions.ensureDraftSynced` so that the
metadata gets synced to n1Cloud. The correct way to do this is just to
queue the correct SyncbackMetadata tasks, because we don't actually
syncback drafts at all, but in the interest of releasing, let's fix it
like this

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4369",False
b55aa84320348a9e2f01aa2ef4968b4af1c00ca9,2017-04-06 06:21:11,Nylas Coffee Machine,bump(version): 2.0.3,False
008cb4cd9c0016ba14a338a2793a2f946dceae1b,2017-04-06 06:19:43,Christine Spang,"[*] Revamp SSL options (including user-facing)

Summary:
Previously, the generic IMAP auth screen presented one security option to
users: ""Require SSL"". This was ambiguous and difficult to translate into
the correct security options behind the scenes, causing confusion and problems
connecting some accounts.

This patch does the following:
* Separates security settings for IMAP and SMTP, as these different protocols
  may also require different SSL/TLS settings

* Reworks the generic IMAP auth page to allow specifying security settings
  with higher fidelity. We looked at various different email apps and decided
  that the best solution to this problem was to allow more detailed
  specification of security settings and to ease the burden of more options
  by having sane defaults that work correctly in the majority of cases.
  This new screen allows users to pick from ""SSL / TLS"", ""STARTTLS"", or ""none""
  for the security settings for a protocol, and also to instruct us that
  they're OK with us using known insecure SSL settings to connect to their
  server by checking a checkbox.

  We default to port 993 / SSL/TLS for IMAP and port 587 / STARTTLS for SMTP.
  These are the most common settings for providers these days and will work
  for most folks.

* Significantly tightens our default security. Now that we can allow folks to
  opt-in to bad security, by default we should protect folks as best we can.

* Removes some now-unnecessary jank like specifying the SSLv3 ""cipher""
  in some custom SMTP configs. I don't think this was actually necessary
  as SSLv3 is a protocol and not a valid cipher, but these custom
  configs may have been necessary because of how the ssl_required flag was
  linked between IMAP and SMTP before (and thus to specify different
  settings for SMTP you'd have to override the SMTP config).

* Removes hard-coding of Gmail & Office365 settings in several
  locations. (This was a major headache while working on the patch.)

This depends on version 2.0.1 of imap-provider-settings, which has major
breaking changes from version 1.0. See commit for more info:
https://github.com/nylas/imap-provider-settings/commit/9851054f9153476b6896d04893a40b4febc8986e

Among other things, I did a serious audit of the settings in this file and
""upgraded"" a few servers which weren't using the SSL-enabled ports for their
provider to the secure ones. Hurray for nmap and openssl.

Test Plan: manual

Reviewers: evan, mark, juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D4316",False
573388258e8f29832a79e96a6727048df6348884,2017-04-06 04:34:42,Halla Moore,bump(version): 2.0.2,False
861301009a58ef46fd2ac4b10fee76c2ab43b314,2017-04-06 04:32:53,Evan Morikawa,"[client-app] Updates to feature limiting

This is a squash of a bunch of commits releated to feature limiting.
Includes making the upgrade path seamless by accessing billing through a
WebView and making sure that the feature is enabled after upgrading, or
canceled if the upgrade path is stopped by the user in any way.

Included diffs
---------------
Differential Revision: https://phab.nylas.com/D4078
Differential Revision: https://phab.nylas.com/D4136
Differential Revision: https://phab.nylas.com/D4137
Differential Revision: https://phab.nylas.com/D4143
Differential Revision: https://phab.nylas.com/D4147
Differential Revision: https://phab.nylas.com/D4171
Differential Revision: https://phab.nylas.com/D4173",False
3a37d0f59fd2e68ed1d09bdb5202f6c86b6b8848,2017-04-06 04:29:17,Mark Hahnenberg,"[client-app] Some final benchmark fixes

Summary: See title

Test Plan: Run on the coffee machine

Reviewers: juan, evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4368",False
a89612d878b14ea33c0402dbc5ceecc5e4734b8c,2017-04-06 04:27:26,Evan Morikawa,[cloud-api] basic view of CloudJobs,False
9c83b145c3d96b5668d1c0d113b8648e5e3c3374,2017-04-06 04:14:13,Halla Moore,"[client-sync] Fix syncWorker arg

Summary: It needs to be wrapped in an object.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4367",False
55beda2d630abf95751e1967b5c6f1a16ef0451c,2017-04-06 03:42:40,Evan Morikawa,[cloud-workers] fixes to metadata on workers,False
e0adfd7619585fc5a4f657f528c47bdc43772631,2017-04-06 02:40:01,Juan Tejada,"[client-sync] Fix runtime error when getting sync activity for account

Summary:
Make sure SyncActivity.getLastSyncActivityForAccount returns a sensible
default to prevent runtime errors when the SyncProcessManager uses it

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4366",False
6b175515768ad84fa77e6f8d95e6428d88fb18b3,2017-04-05 23:51:56,Nylas Coffee Machine,bump(version): 2.0.1,False
fc5edd24356dda267b3e39b284eb23464589d607,2017-04-05 23:40:41,Juan Tejada,"[iso-core] IMAPConnectionPool now correctly disposes connections `onDone`

Summary:
Previously, calling the IMAPConnectionPool `onDone` callback when checking out a connection would just return the connection to the pool without re-establishing it the next time we checked it out of the pool.

When the `onDone` callback was called in an error scenario, this had the unintended consequence of returning a bad connection to the pool, and then re-using this bad connection. The only scenario when the connection was re-established was if `onConnected` threw an error, but if the connection was kept open outside the scope of onConnected, this logic would never run.

To make things simpler and more consistent, `onDone` will always destroy all connections and connections will always be re-established from scratch every time they are checked out of the pool. The pool acts more as a limit to the number of connections per account, than an actual shared pool of connections.

Test Plan: manual

Reviewers: evan, spang, halla, mark

Reviewed By: halla, mark

Differential Revision: https://phab.nylas.com/D4360",False
fdc654b7b2396a458f741c0399bf55a8a8a1911c,2017-04-05 23:38:20,Juan Tejada,"[client-sync] Prevent IMAP connection leaking in sync worker

Summary:
When the sync worker got stuck inside `performSync`, we would never
release the connection back to the connection pool. We would then try to
start a new sync worker, and it would claim a new connection. If this
happened enough times, we would eventually exhaust the whole pool and
keep the sync worker blocked forever.

Test Plan: manual

Reviewers: evan, spang, halla, mark

Reviewed By: halla, mark

Differential Revision: https://phab.nylas.com/D4359",False
6e0b5181603f758df097c042a23d39ad93c0680c,2017-04-05 23:24:42,Evan Morikawa,"[cloud-worker] worker refactor

Summary:
This is a refactor of the workers to make it a bit more robust on cloud
infrastructure.

Since our tasks are crazy flaky, and the workers may be restarted at
anytime, and there may be several workers running at once, this
uses a new `CloudJob` table in the database to back every task that
happens.

Backing everything on the DB (not in Metadata) will hopefully make this
substantially more robust to failing tasks, multiple workers across
multiple processes and boxes, and easy to visualize the state of the
workers' tasks

Sorry for the HUGE diff, this was definitely a bit of a hurried effort to
get this on staging today.

Test Plan: Manual

Reviewers: spang, khamidou, halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D4355",False
0c5e54d813289529d3bd104c6c7e63e071eda037,2017-04-05 23:21:38,Evan Morikawa,"[cloud-*] remove old SignalFX reporter & add docs

Summary:
This removes the old SignalFX reporter that we weren't using
Adding documentation around logging

Test Plan: manual

Reviewers: juan, halla, spang

Reviewed By: juan, halla, spang

Differential Revision: https://phab.nylas.com/D4341",False
664198e59dbbd9bfdefa6c48849be8632da10230,2017-04-05 23:18:35,Evan Morikawa,"[cloud-workers] make log an `error` not `fatal`

Summary: Also remove unused underscore

Test Plan: manual

Reviewers: juan, spang, halla

Reviewed By: spang, halla

Differential Revision: https://phab.nylas.com/D4340",False
210d2e62744d4e6f53a72af9324f4464f348e606,2017-04-05 23:17:56,Evan Morikawa,"[cloud-*] log errors according to bunyan specs

Summary:
According to bunyan, https://github.com/trentm/node-bunyan, errors are
treated special. They either need to be the first argument of a log, or
they need to be attached to the special `err` (NOT `error`) key of the
logger object.

Test Plan: manual

Reviewers: halla, juan, spang

Reviewed By: halla, juan, spang

Differential Revision: https://phab.nylas.com/D4337",False
c27ecea32bbf24906feadc7490269892851b8500,2017-04-05 23:08:53,Halla Moore,"[client-private-plugins] Rename onSendLater to onAssignSendLaterDate

Summary: See title

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D4351",False
565cafc9cda6f6c99d2be48f47ed6feaf5817a59,2017-04-05 21:52:00,Juan Tejada,[client-sync] :art: logging,False
a73b96459b611416e690158128dfd8cdfcf2767c,2017-04-05 10:07:55,Juan Tejada,"[client-app] Add better logging when restarting stuck sync worker

Summary: see title

Test Plan: manual

Reviewers: halla, mark, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4358",False
a60cf149f44890f0e3f8fbe90f7e5b0125fbc820,2017-04-05 10:04:20,Juan Tejada,"[iso-core] Remove unused vars from IMAPConnectionPool

Summary: see title

Test Plan: manual

Reviewers: mark, halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4357",False
4b932e2ba5400b372f50789961d54eb220673ac3,2017-04-05 08:43:47,Juan Tejada,"[client-plugins] Fix send later button saving state and sending action

Summary:
There were 2 things wrong with the send later button:

1. We were not displaying the `saving` state correctly-- we only showed
the button as saving for a brief moment while we called `authPlugin`, but
we didn't show it for when we were creating the draft and uploading
attachments to s3 which could take a long time. So if you had
attachments and sent later, the composer just looked unresponsive for a
very long time.

2. When clearing a send later date, we were unnecessarily re-creating
the draft body and uploading attachments to s3, also making the app feel
unresponsive. When clearing the send later date, the only thing we need
to do is set `expiration` to null

Test Plan: manual

Reviewers: khamidou, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4356",False
bb6221d20352d2c5b3a55058807908c72f09b12e,2017-04-05 08:42:07,Halla Moore,"[client-private-plugins] Don't syncback drafts for send later

Summary:
The SyncbackDraftTask doesn't currently do anything, so don't
bother queuing it.

Test Plan: manual

Reviewers: evan, halla

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4352",False
af1063b5efea484e4d92817d1b238c88dd301b87,2017-04-05 08:41:06,Juan Tejada,"[cloud-workers] :art: linting

Summary: see title

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4354",False
b09d6f8a644a9454a54d8dbca69e6fae03de7206,2017-04-05 06:23:13,Juan Tejada,"[client-sync] :art: sync worker

Summary: Just renaming some stuff

Test Plan: manual

Reviewers: mark, spang, evan, halla

Reviewed By: spang, evan, halla

Differential Revision: https://phab.nylas.com/D4342",False
fcda02a1f5373b8765523a394afcec1d308a1456,2017-04-05 05:13:05,Halla Moore,"[client-app] Fix the unapply transformation for overlaid components

Summary:
The unapply transformation was incorrectly passing the props parameter
to buildAnchorTag() as a string, even though it expects an object.
buildAnchorTag() goes on to stringify this parameter, which causes extra
surrounding quotations and escape slashes in front of all the other
quotations. The unapply transform is applied on several re-renders,
which causes the number of escape characters to unboundedly increase.
Firstly, this was causing inline images to not appear properly in the
draft, and secondly, the large number of escape characters was making
the draft body large enough to make the app unresponsive.

This generally wasn't an issue because the unapply transformation is
only applied when there has been an apply transformation, and this is
triggered by the SyncbackDraftTask. This task was previously only queued
upon send, in which case the user never re-opens the draft. Now,
enabling send-later on a draft will queue the task, and these issues
appear if the user re-opens the draft for editing.

This diff makes it so that the unapply transform passes in the props as
an object, like the buildAnchorTag function expects.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D4348",False
d2a6bba6c644e4b265354e5ca9dfe65a12372e84,2017-04-05 05:06:39,Halla Moore,"[client-app] Allow the packageMigrationManager to re-enable packages

Summary:
Remove packages from the disabled package list when they have been
migrated to be enabled by default.

Also, the last migration would not have worked properly anyways because
the daily channel was already on 1.0.56, and we check for greater-than
rather than equal-to. Bump that version to match the next update.

Test Plan: manual

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D4335",False
77e72fbb29e0d12c8137b9ccb9a80bc6711bab89,2017-04-05 05:00:52,Juan Tejada,"[client-app] Make sure to fetch latest update url every time we check for updates

Summary:
Previously, is you signed out of your NylasID, you would not pick up new
updates because we never updated the autoupdater url to use the new id.

Test Plan: manual

Reviewers: mark, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4346",False
19d35a9fd1c87a06d094f035ab7ecacf1c69bca9,2017-04-05 05:00:34,Halla Moore,"[client-private-plugins] Don't record usage when changing feature time

Summary:
We should only count the initial enabling as a feature usage.
This diff only changes send-later and send-reminders. Snooze is more
complicated, since it's a thread-level action but the metadata is stored
on the messages, and I'm probably just gonna punt it for now.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D4349",False
52a3e6ef815d52232b12521e3d5ba878b5e14812,2017-04-05 04:56:32,Juan Tejada,"[client-app] Prevent from making any requests when NylasID isn't present

Summary:
Sometimes, when logging out of your NylasID and restarting the app, we
would continue making some requests from the worker window that required a
NylasID. This would make the app enter a restart loop and become
completely unresponsive because when we made a request without a
NylasID, we would force the user to log out and restart the app, and
then we would again make the requests without the id, ad infinitum.

To fix this, we make sure we have a NylasID before making any requests
that require it

Test Plan: manual

Reviewers: halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4344",False
bab3b8159f78c8bb122137f2886fbf7c2c8125b5,2017-04-05 03:54:01,Christine Spang,"[scripts] Batch upload each row

Makes the script like 4x faster.",False
2f8eca29353fbcff00d32aca13d833321ecbfcba,2017-04-05 03:37:08,Mark Hahnenberg,"[client-app] Add script to run benchmarks once per day at specified time

Summary: See title

Test Plan: Run locally

Reviewers: juan, evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4345",False
2809a250ce311edfa550ccad2293e56b43374704,2017-04-05 03:34:03,Christine Spang,"[scripts] Add script to upload benchmark data to Google Sheets

Test Plan: ran locally (need client secret for this)

Reviewers: mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4343",False
a50904f21a5bdb6850648d6876076547110e0218,2017-04-05 01:58:46,Mark Hahnenberg,"[client-app] Fix benchmark script

Summary:
We weren't changing into the directory of the git repository, so running
the script from anywhere but inside the git repo didn't work. We also
weren't pulling before checking for the latest commit. Now we do both of
these things.

Test Plan: Run locally

Reviewers: spang, juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4339",False
d15556fe661c0e9d3ae0c88f02b861aed3df0f89,2017-04-05 01:57:43,Juan Tejada,"[client-sync] Ensure we use refreshed access token for mail listener conn

Summary:
Before this commit, we would just establish a single mail listener imap
connection and never check if we needed to re-connect it due to an
expired access token. Even though we correctly refreshed the access
token at the beggining of each sync loop (hidden under
`ensureSMTPConnection`), we would never re-establish the mail listener
connection with the new access token.

This would cause the app to enter an `Invalid Credentials` error loop in
the sync loop, preventing from syncing any mail at all (T8064)

Test Plan: manual

Reviewers: spang, halla, mark, evan

Reviewed By: mark, evan

Differential Revision: https://phab.nylas.com/D4338",False
4aa7da887a74417b9191b0ad1a3b97c09acfa053,2017-04-05 01:57:04,Juan Tejada,"[client-sync] Fix mail listener imap connection

Summary:
Given that we keep the imap mail listener conenction open outside of the
imap connection pool, it might close itself after a while or after
putting your computer to sleep.

Previously, if we had the connection object we just assumed it was
connected and proceeded with sync, and if it wasn't, we would fall into
an error loop in the sync worker preventing it from syncing at all (T8065)

To fix this, we just call `connect` every time to ensure the connection is open.
(This was the case before we introduced the connection pool)

Test Plan: manual

Reviewers: mark, spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4334",False
0abdd33cadba81583637ae81b1bd5c323342366b,2017-04-05 01:19:00,Mark Hahnenberg,"[client-app] Remove sudo from benchmark-initial-sync.sh

Summary:
We created the process so we can also kill it with no problems. This
makes it easier to automatically run benchmarks without human
intervention.

Test Plan: Run locally

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4332",False
ebc12810924f4f63b5adc874e3f1471685fadd45,2017-04-05 01:18:04,Mark Hahnenberg,"[client-app] Limit search to focused perspective

Summary:
Previously we would always search all mail. Now, if the user has focused
a particular folder we will limit our search to that folder. The inbox
is an exception--it will always search all mail unless the user
explicitly uses an ""in:"" clause.

Test Plan: Run locally, verify that searching folders returns the correct results.

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4328",False
64769f4ae56a76388ad752d2d976d18cff21f12c,2017-04-04 21:35:53,Evan Morikawa,bump(version): 2.0.0,False
25d8179d2d6dd3ea3164af91f303602085775f5a,2017-04-04 21:33:34,Nylas Coffee Machine,bump(version): 1.0.56,False
e2d5ef8ff3c7caff86603f5639793293f10ec232,2017-04-04 05:42:02,Mark Hahnenberg,"[client-app] Fix sqlite build for older versions of clang

Summary: See title

Test Plan: Run locally on older version of clang

Reviewers: juan, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4329",False
d8822059625b87f59d845d03ff8420870dc6c6ef,2017-04-04 05:34:25,Halla Moore,"[client-sync] Don't assign duplicate roles in folder fetch

Summary:
Check that there aren't any other categories with a role before we try
to assign it to the current category.

Addresses T7835

Test Plan: manual

Reviewers: juan, evan, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4298",False
f3f4bd9b045b3fdd6e9a0586262e55ab28db5cb3,2017-04-04 05:14:09,Evan Morikawa,[cloud-workers] fix worker exception,False
f22be308d532bb4f25c11290665605e947cc1667,2017-04-04 05:14:01,Evan Morikawa,"[client-app] re-setup IdentityStore in new window

Summary:
Before this patch, the IdentityStore would initialize in our empty hot
window. However, hot windows don't receive any `action-bridge-message`s,
which include DB updates. Since the hot window loads first, it was with a
stale verison of the Identity. The main window fetches a fresh identity,
but that fresh update failed to get to new composers because the hot
window wasn't listening to changes to the DB.

This makes it such that the IdentityStore properly boots up when the
window props change.

Test Plan: manual

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4327",False
3becf34a64fbb62784b12f880ebc3533b76c46a9,2017-04-04 04:08:47,Evan Morikawa,"[client-app] add feature limits to reminders and send later

Summary:
This adds feature limit modals (graphics pending) for reminders and send
later

Test Plan: manual

Reviewers: juan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4322",False
784e483a9ecb97bfef433bc878f5544aa45f42d3,2017-04-04 04:08:31,Evan Morikawa,"[client-app] enable snooze, send later, reminders on 1.0.56

Summary: This enables packages on 1.0.56

Test Plan: manual

Reviewers: juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D4320",False
abe05459556f2c49ddf2021fcff1f59c5b568f08,2017-04-04 02:37:29,Juan Tejada,[client-app] Remove rogue scripts-tmp folder,False
9cca715a0c5914c529ff160bc35a6d05b4bae4b7,2017-04-01 06:11:22,Juan Tejada,[client-app] Update changelog,False
4b7fec549e629bd9109db5b5ddaae45ddd7b90e7,2017-04-01 06:08:22,Juan Tejada,"[client-app] Remove unecessary db setup for mail rules

Summary: This shaves off ~150ms trying to issue this query

Test Plan: manual

Reviewers: evan, spang, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4317",False
f0a1e05f83730271e9b9ac403277bca064864d1f,2017-04-01 04:44:55,Nylas Coffee Machine,bump(version): 1.0.55,False
b1c1e68877377d00f9ef355f1e4bbf50ee9ec1eb,2017-04-01 04:43:52,Evan Morikawa,"[client-app] don't override existing bodies on K2

Summary:
Bodies that already exist on K2 shouldn't be overridden.
See the comment for how this caused open/link tracking to fail in certain
cases when a lot of messages were being sent

Test Plan: manual

Reviewers: halla, mark, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4319",False
f1ce2874da151bb6bd24836328e35606c1fa78b3,2017-04-01 04:04:52,Halla Moore,[client-sync] Add comment about reason for try/catch block,False
6b037c82ec085e5256a14d5afb08b4b33517a7ff,2017-04-01 03:59:20,Mark Hahnenberg,"[client-sync] Split Contact ranking query

Summary:
We were using a join for the contact ranking query and for whatever
reason on large databases this was extremely slow in SQLite. This diff
splits the query into first finding the sent Folder/Label and then
searching for non-draft Messages in that category.

Test Plan: Run locally, verify the query is faster

Reviewers: juan, evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4315",False
18511fff1968d32e9de9b27e0bfb38ba17d5f895,2017-04-01 03:31:10,Juan Tejada,[client-app] Update changelog,False
e1626fd0fcdca1fce829f939459571bcf89982f2,2017-04-01 03:19:31,Mark Hahnenberg,"[client-app] Remove getUnindexedAccounts

Summary: It was really slow, and we no longer need it.

Test Plan: Run locally, verify that we no longer do that super slow query

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4312",False
35a1e62621c0f2c6a6032598310fd21f183ddbec,2017-04-01 03:15:14,Evan Morikawa,"[client-app] remove the `ANALYZE` in favor of `pragma.optimize`

Summary:
Removes some VERY long running `ANLAYZE` queries. Was taking up to 50
seconds on my 9GB database on every boot
https://sqlite.org/pragma.html#pragma_optimize

Test Plan:
I tested to make sure the app still quits quickly. It does. The SQLite
docs also say this should be fast.

Reviewers: halla, spang, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4314",False
730145ed51daec09c35d8415ef346ee3e30bf027,2017-04-01 00:52:21,Nylas Coffee Machine,bump(version): 1.0.54,False
5620a8e8780cedfc84ccb044fb039a8bf891fff1,2017-04-01 00:49:58,Mark Hahnenberg,"[client-sync] Simplify Contact ranking query

Summary:
We were using a couple of left outer joins to avoid checking whether we
should be joining on Labels or Folders. We can greatly simplify the query
by just checking which we should use and issuing the correct inner join.

Test Plan: Run locally, verify contact ranking still works.

Reviewers: spang, juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D4310",False
fcf332f7f7d1aea2fcf2f6aee12ba5a917106122,2017-04-01 00:47:34,Evan Morikawa,"[client-app] delay building new hot window to improve win perf

Summary:
This improves window open times by about 70ms
We would spend a very long time in the backend browser process building a
new hot window when we didn't need to do that until much later

Test Plan: manual

Reviewers: halla, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4311",False
9d30efda8a7698018727cddbcec85c050966e686,2017-04-01 00:39:20,Juan Tejada,"[client-app] Don't imeout removing sync worker when removing an account

Summary:
Most of the times when removing a sync worker (i.e. when removing an
account), we would see database errors in the console. This happened
because more often than not we would interrupt in the middle of message
processing, but `processMessage` is not interruptible, which means that
the worker would be interrupted right after processing its current
message. However, if `processMessage` would take more than 500ms (the
current timeout for stopping the worker), we would destroy the database
before processing was done and it would throw a bunch of errors.

To fix this, we just don't set a timeout when removing the worker as a consequence
of removing an account. However, when we are removing the worker when we
detect that it is stuck, we set a time out of 5 seconds.

Test Plan: manually test removing accounts, verify that it doesn't error

Reviewers: mark, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4308",False
ae55ff0c55b760ed942139277a83a6b0da4fc80f,2017-04-01 00:38:48,Juan Tejada,"[client-app] Ensure sync worker can never continue running after being destroyed

Summary:
Previously, it was possible for the sync worker to continue running after being
interrupted, e.g. it would break out of `performSync` and then try to run
`onSyncCompleted`. This is fine if we were just interrupting to restart the loop,
but when we stop it we don't want it to continue running anything at all.

This also refactors the syncworker to have a single `destroy` method, which sets
a `destroyed` flag and uses that one exclusively instead of the `stopped` flag.

Test Plan: manually check it works

Reviewers: spang, halla, mark, evan

Reviewed By: mark, evan

Differential Revision: https://phab.nylas.com/D4307",False
90165c413a0962839edf0258e8ca8362145228de,2017-03-31 23:51:56,Juan Tejada,"[client-app] Don't hit contact rankings endpoint until account is ready

Summary:
This prevents us from hitting the endpoint before the database for that
account is initialized and it's actually syncing.

Before this commit, we would throw errors upon adding an account

Test Plan: manually add, remove accounts, run benchmark script

Reviewers: mark, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4305",False
9c38ad38b6d43077b40d33f04ddd88c44e029597,2017-03-31 23:42:50,Halla Moore,"[client-sync] Wrap more syncWorker args

Turns out the SyncWorker isn't the only one who initiates SyncTasks",False
3d11970b71a29b6c4d477f943d01edbe8dc50593,2017-03-31 23:28:16,Halla Moore,"[client-sync] Properly wrap the SyncWorker arg in an object

The argument structure for runTask() changed and needs it this way.",False
9c173558fb26a6d18384aa3f38ea79c81e9e9863,2017-03-31 23:22:42,Halla Moore,"[client-sync] Fix the new syncback-task structure

Summary:
- Change files to .es6 so they recognize the syntax
- Pass arguments down to _run()
- Make sure the responses get returned

Test Plan: manual, even though that somehow failed before. :(

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4309",False
703a3ec8a9480dd81d71e2818f885a4dc90f5eb4,2017-03-31 21:37:20,Nylas Coffee Machine,bump(version): 1.0.53,False
49d073b636c4f0b8736803972d4983d4c587080c,2017-03-31 06:08:32,Evan Morikawa,"[client-app] add `DatabaseStore.write` which doesn't use Transactions

Summary:
Creates a new `DatabaseStore.write` method alongside
`DatabaseStore.inTransaction` that doesn't always wrap trivial queries in
a transaction. SQLite does this automatically.

Test Plan: manual

Reviewers: spang, mark, halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D4303",False
0dc1671593650fb51df840f107f5d48dd19c2dca,2017-03-31 06:08:07,Evan Morikawa,"[client-app] rename DatabaseTransaction -> DatabaseWriter

Summary: Renamed in prep for next few diffs

Test Plan: manual

Reviewers: juan, mark, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4302",False
8c4ebf21a03e5d750b9907e53a9ed3637c4ebc0c,2017-03-31 05:56:33,Evan Morikawa,"[client-app] use debug library for DB

Summary:
Use the wonderful `debug` library instead of all our random flags.
You can now do things like: `DEBUG=""app:*,sync:*"" npm start` to print out
everything.

Test Plan: manual

Reviewers: mark, halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4297",False
ffe7b6bc16935ec7148969960b91b1acd28604b1,2017-03-31 05:42:54,Halla Moore,"[cloud-api] Add awaits in thread metadata reconciliation test

The created_at order matters when reconciling metadata, so add awaits to
ensure they get created in the expected order.",False
23dc771117ab1d73ce86f8c9340f0725e554385b,2017-03-31 04:54:32,Halla Moore,[client-sync] Add provider to syncbackTask perf metric,False
6e0010b9dde840cd1f472b3eac9fcd8bc34c5201,2017-03-31 04:45:09,Halla Moore,"[client-sync] Report metrics about SyncbackTask runs

Summary:
Report how long they take and if they're stopped (due to timeout).

Part of T7978

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D4272",False
7eb75c5bdec93d57bfe4b0f549cd47f0af890b14,2017-03-31 04:41:49,Mark Hahnenberg,"[client-app] Add script that benchmarks new commits

Summary:
We want to setup the initial sync benchmark to run automatically with each
commit on a separate machine. This script does just that and dumps the
results to a directory. We can then have a separate script process them
and upload them to whichever service we want.

Test Plan: Run locally

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4296",False
ec385ebe8765c0fb5319b243127e948755673ead,2017-03-31 04:41:19,Mark Hahnenberg,"[client-app] Add search support for ""has:attachment""

Summary: See title

Test Plan: Run locally, verify that attachments are returned

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4293",False
614495975b11f62358edc0e9bf1c82b92ae2aa42,2017-03-31 04:21:25,Halla Moore,"[client-sync] Convert syncback tasks to interruptible generators

Summary:
Make `run()` functions generators and change most awaits to yields

Part of T7978

Test Plan: specs from D4269, but really needs some heavy QA

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4270",False
f8542122cd4cd29b94b3a50d477a0902a6bfcf93,2017-03-31 04:20:34,Halla Moore,"[client-sync] Interrupt long-running syncback tasks

Summary:
Interrupt retryable syncback tasks that are taking too long so that we can
return control to the sync loop. The sync loop will retry the task later.
This diff adds a `forceReject` param to `interrupt()` so that we can return
control immediately instead of waiting for the current operation to finish
(for instance, the syncback task could be stuck in an imap operation, and a
normal interrupt would still have to wait for that to finish before returning
control to the callee)

Part of T7978

Test Plan: specs

Reviewers: evan, spang, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4269",False
c9a875960e4ac6baa4c54b2f50ef6869bb2b0a36,2017-03-30 22:48:48,Juan Tejada,[client-app] Update changelog,False
9b9c000df913100080ffdd59eb10f8447f23a058,2017-03-30 22:06:07,Evan Morikawa,"[client-app] Add silent flag to DB persists for thread indexing

Summary:
Every persistModel would trigger a large number of downstream updates.
These weren't necessary for thread indexing and causing a lot of
unnecessary DB thrashing. This adds a `silent` flag to `persistModel` and
its ilk that just does the write.

significantly improve performance, and also contribute to T8046

Test Plan: manual

Reviewers: spang, mark, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4295",False
cf441c41e3b662fd4c075b6c01d13eb2a486c9c0,2017-03-30 22:02:52,Evan Morikawa,"[client-app] Add better DB logging with ENABLE_SEQUELIZE_DEBUG_LOGGING

Summary:
This adds better logging to the DB

You can use `ENABLE_SEQUELIZE_DEBUG_LOGGING=true` and
`ENABLE_RXDB_DEBUG_LOGGING=true` to spit out the raw queries of both DBs.

Test Plan: manual

Reviewers: mark, halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4294",False
9752208ff5c119bc9d2805f658e07b1cb266168c,2017-03-30 12:20:58,Nylas Coffee Machine,bump(version): 1.0.52,False
9437da80e0175d5ddef3ff2bf2e6bbded2e6bf42,2017-03-30 05:30:40,Mark Hahnenberg,"[client-app] Fix thread reindexing loop

Summary:
We would mark modified threads for reindexing, the thread search indexer
would reindex them, which would trigger a notification that the thread
had been modified, so we would mark the thread for reindexing, ...

Now we keep track in memory of which threads we've marked for reindexing
so we avoid re-marking them when the update notification arrives later.

Test Plan:
Run locally, verify same threads aren't getting continuously
reindexed and that the in-memory set doesn't grow unboundedly

Reviewers: spang, juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D4289",False
a186d728e2747bead1c72f124bba28678f367389,2017-03-30 04:41:44,Mark Hahnenberg,"[client-app] Add initial sync benchmarking script

Summary:
We want to be able to benchmark initial sync, so this diff adds two
scripts. The first, drop-stuff.sh, drops all data from the app and sync
databases that isn't related to account credentials. The second,
benchmark-initial-sync.sh, runs a fixed number of iterations (current 5) that
invokes drop-stuff.sh then opens the app, waits a fixed amount of time
(currently 120 seconds), and then kills the app and measures how many messages
it synced which it prints to the console. This is sufficient for us to start
measuring how quickly we can sync messages. This diff also includes the
sqlite3 amalgamation which drop-stuff.sh requires to function correctly
due to depending on the FTS5 extension which doesn't come built-in on
some platforms.

Test Plan: Run benchmark locally

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4275",False
4608f1c44561f0dc78ce7a2e98e8af87ba4dadc6,2017-03-30 04:21:09,Juan Tejada,"[client-app] Fix references to RetryableError imports

Summary: See title

Test Plan: manual

Reviewers: spang, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4292",False
aff463ff28f98d1234c8dd2a9b5ff5ebc7fc4abb,2017-03-30 03:31:31,Juan Tejada,"[client-app] Log duration of db ANALYZE query

Summary: See title

Test Plan: manual

Reviewers: mark, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4290",False
89e21da9937455b5b07c540734d344d9df8619ab,2017-03-30 03:31:07,Juan Tejada,"[client-app] Improve logging for queries

Summary:
This commit makes a few changes to how we log database queries:

- We log queries in 2 different places now:
  - When `DatabaseStore._executeLocally` takes longer than 100ms. This might be due to the actual db operation taking long, or it might be due to our retry logic, or potentially other factors.
  - When the actual raw database operation takes more than 100ms.
- When raw database queries take more than 100ms, we log out the query plan if it is a `SELECT` query and we are in dev mode.
- If `DEBUG_TO_LOG` is true, we always log all queries (including background queries)

Test Plan: manual

Reviewers: mark, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4288",False
e667ecec49ad2402235f0ccc22ca79fc7c3d4d6b,2017-03-30 03:30:44,Juan Tejada,"[client-app] Improve logging for background database queries

Summary:
- Rename `databaseAgent` usage to `background`, in the code and in the logs, which I
believe is less confusing. Often times found myself asking what was this agent thing in
the logs.
- Make messaging more explicit

Test Plan: manual

Reviewers: evan, mark, halla

Reviewed By: mark, halla

Differential Revision: https://phab.nylas.com/D4285",False
b4a54dad27bf3f30e9d5520ba64f85cac4a9ef2c,2017-03-30 03:30:12,Juan Tejada,"[client-app] Reduce max retry delay for db queries

Summary:
This commit makes it so that when we retry database queries after
encountering a db locked error, we back off for at most 500ms, instead
of the current max of 3s. This meant that a single query could
potentially take 3+ seconds and block the transaction queue for that long.

Test Plan: manual

Reviewers: evan, mark, halla

Reviewed By: mark, halla

Differential Revision: https://phab.nylas.com/D4283",False
da0aa024b80f257464e683ca82bb03474e7625e0,2017-03-30 03:29:34,Juan Tejada,"[client-app] Don't delay db queries unless we are retrying

Summary:
After introducing retry logic, we would always defer db queries to the
next tick even if there was no retry delay present.

This would cause almost all db queries take more than 100ms even if the
actual db operation was really fast. This affected app performance
negatively

Test Plan: manual

Reviewers: evan, halla, mark

Reviewed By: halla, mark

Differential Revision: https://phab.nylas.com/D4282",False
7de7a3ee81f3b944a7be709be01b53a90a02f1ae,2017-03-30 03:23:57,Evan Morikawa,"[client-app] ensure gmail msg to 1 person get tracking stripped

Summary:
The problem actually was that we weren't applying the transform for Gmail
messages sent to 1 recipient

Test Plan: manual

Reviewers: halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D4291",False
e2917292d1bd75dad8cc58722f7ce449d26afe71,2017-03-30 03:23:40,Evan Morikawa,"[client-app] don't trigger your own opens & link clicks

Summary:
We weren't stripping link and open items from messages we sent properly.
While we stripped it from the first outgoing message, when the sync loop
came back around it would have them back in. This adds it in the message
processor to extra ensure that ANYTHING that comes from us (or one of our
aliases) gets the open/link tracking stripped

Test Plan: New tests

Reviewers: juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D4287",False
0c1196ba4c79ab8c18270976fd2f826177acac1a,2017-03-30 03:23:20,Evan Morikawa,"[client-app] index expiration field on Metadata

Summary:
@vlad manually added the expiration index on the Metadata model. This
reflects that in code. @vlad also made sure the index name matches what
Sequelize will auto generate

Test Plan: Manual

Reviewers: juan, spang, halla

Reviewed By: spang, halla

Subscribers: vlad

Differential Revision: https://phab.nylas.com/D4281",False
710bddd9fcb63db973dd321397c767d6e158cdf0,2017-03-30 02:18:46,Mark Hahnenberg,"[client-sync] Fix ""in:"" for IMAP search

Summary:
Prior to this diff, the ""in:"" search query syntax didn't work for IMAP.
This diff implements ""in:"" by changing the IMAP search backend to take
folder context into account and emit the appropriate queries for each
folder. Queries that include ""in:foo"" will replace the corresponding AST
nodes with 'ALL' or 'NOT ALL' depending on whether or not the current folder
is ""foo"". We also now filter which folders we search based on which
folders are referenced in the query.

Test Plan: Run locally, verify that in: works quickly

Reviewers: evan, juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D4284",False
7efe2dcc2447909bdcf62c2c4b7fb85a94b747df,2017-03-30 00:25:28,Mark Hahnenberg,"[client-app] Reindex threads when they're updated

This commit is the same as 7d409f5.

This commit was accidentally reverted in 95ec679, because I (juan) was being
dumb. So I'm re-committing here.

Summary:
We weren't doing that, so we would have accurate search index info for
threads when they were, e.g., moved to another folder.

Test Plan: Run locally

Reviewers: spang, evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D4260",False
b36a31cbd51db2703f0a1ed053a4621514108330,2017-03-29 23:42:47,Christine Spang,"[dev] Default billing server URL to staging for development, allow override

Summary:
By default, the 'local'/'development' environment assumes that all services
are running locally. This makes sense.

However, if you're not making changes to auxiliary services such as
billing.nylas.com and hence do not have them running locally, firing up
Nylas Mail with the 'local' env will not work. It's a bit of a pain to
get a local billing service running locally, especially if you're not
making any changes to that service. To ease development, change the
default billing URL during development to staging, and allow manually
overriding the billing server URL to point to localhost in the case
that you're making changes to the billing service also.

To override the billing URL for local development, run like this:

    npm run cloud -- --env billing_local
    BILLING_URL=http://billing.lvh.me:5555 npm start

This is both a problem that I've run into during development as well as
(my hunch) why Karim accidentally landed a global override of the
billing server URL.

Test Plan: manual

Reviewers: evan, khamidou, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4202",False
2e188b373ecb040f7f7454e87976143a7d1d8882,2017-03-29 23:22:37,Juan Tejada,[client-app] Update changelog,False
143b727a6e1873b919816d1f4e8564a8850638b3,2017-03-29 11:37:37,Nylas Coffee Machine,bump(version): 1.0.51,False
95ec679da606b01136173b758808472feba68dd5,2017-03-29 06:20:59,Juan Tejada,"[client-sync] Make sure to attach route files ending in .es6 to local-api

Summary:
This prevented the /health endpoint from being available in the
local-api

Test Plan: manual

Reviewers: mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4280",False
027f590fbbf0b8daf5ced8412b5c432c2ad0bf89,2017-03-29 05:32:45,Christine Spang,[dev] One more newline in deploy-it output,False
e42b9f97ce5c972c4d0f95060a367c936dd69529,2017-03-29 05:30:18,Christine Spang,[dev] Make deploy-it print link to the EB console,False
c47f6a83586362f418c1ca2c353c7ca95c989bb7,2017-03-29 05:29:02,Christine Spang,[dev] Make deploy-it say what it's doing instead of hanging silently,False
6079efc51e49ddd5666cdba01c3d92247e9c5915,2017-03-29 05:17:02,Christine Spang,[dev] Make help message better on deploy-it,False
79cfc9218558fe7554af4efc21635887bce00a9a,2017-03-29 05:01:27,Evan Morikawa,[client-app] add SHOW_HOT_WINDOW env for prod debugging of window launches,False
fdaab3cb4cf80aae3ce295ff1472682508c740e6,2017-03-29 04:45:02,Evan Morikawa,[client-app] properly relaunch windows on autoupdate,False
18a020146f031e52afff3d1dd98129309ff1084e,2017-03-29 04:30:06,Juan Tejada,"[client-sync] Fix runtime error introduced in 08975c0

Summary:
If `gmailInitialUIDsRemaining` was defined, we need to set `initialUids`
to that value. We were previously setting it to a key in
`folder.syncState` that didn't exist, which caused a runtime error.

This was introduced in https://github.com/nylas/nylas-mail-all/commit/08975c0c68760c125a7bfe8660804d73d40324a0

Test Plan: manual

Reviewers: spang, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4279",False
10e066d26844221f7e97fdd08213fb74e8673225,2017-03-29 04:17:44,Christine Spang,"[cloud-api] Verify SMTP credentials in /auth endpoint

Summary:
This patch will prevent users from being able to connect accounts which sync
mail but fail to send.

This commit includes a couple pieces:
* Adds a call to nodemailer's `verify()` function in the /auth endpoint
* Adds Error object conversion for SMTP errors. Since we don't implement our
  own connection object or connection pool for SMTP, we simply wrap the couple
  places we call functions from nodemailer that connect to SMTP, namely
  SendmailClient's _send() and the new verify() call in /auth.
* Moves RetryableError to the 'errors' module since it's now a base class for
  retryable IMAP //and// SMTP errors.
* Moves the main `smtpConfig()` logic which used to live on the Account model
  into AuthHelpers so it can be shared between the Account model and the verify
  code.
* Converts a few different places to use `import` syntax instead of
  `require` syntax for module imports. Apologies for not splitting this out
  into a separate diff—would have been a fair amount of work and looks not too
  difficult to skim over in the context of the rest of the patch.
* Fixing a bug in a previous commit where erroring sends would crash because of
  using `this._transporter.options` instead of `this._transporter.transporter.options`

Test Plan: manual

Reviewers: evan, halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D4200",False
1e625474c2c28c850d49c4b76a9852d065c13596,2017-03-29 02:39:41,Juan Tejada,"[client-app] Correctly listen for new mail in between sync loops

Summary:
When using the IMAPConnectionPool in the sync-worker, we requested 2
connections from the pool: 1 to listen for new mail, and 1 to actually
operate on the mailbox. These 2 connections would be closed and returned
to the pool at the end of each sync loop iteration.

However, we never want to close the connection to listen for new mail.
Closing this connection caused us to not listen for new mail in between
sync loops, which was especially noticeable when initial sync was done
because the delay between sync loops is 5 minutes.

This commit makes it so we request the 2 connections separately from the
connection pool, and keep the listener connection always open until we
dispose of the sync-worker.

Test Plan:
manually make sure that I got new mail event listeners in between
sync loops :(

Reviewers: evan, spang, halla, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4276",False
f9732cf47e4e348220594b0f22d6d81ed89d0ddc,2017-03-29 02:31:02,Juan Tejada,[client-sync] :art: typo,False
2f89aa57454f78a2a50a1abba0fb54142c68b240,2017-03-29 02:30:29,Juan Tejada,"[dev] Correctly ignore node_modules in .ebignore for faster deploys

Summary: See https://github.com/lovell/sharp/issues/373#issuecomment-226849756

Test Plan: manual

Reviewers: khamidou, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4273",False
d165b294c60efa1f9fb9ece63ba18b6daf2bf9d5,2017-03-29 02:29:55,Juan Tejada,"[dev] Only bootstrap specific pkgs in postinstall for faster installs

Summary:
This commit makes it so postinstall.es6 only bootstraps the packages we
are interested in based on a new env variable, `INSTALL_TARGET`.

`INSTALL_TARGET` can be set to `cloud`, `client` or `all`, or not set at all,
and our postinstall will bootstrap the packages accordingly. This will make
build and deploy times faster.

Test Plan: manual

Reviewers: spang, halla, evan, khamidou

Reviewed By: evan, khamidou

Differential Revision: https://phab.nylas.com/D4271",False
08975c0c68760c125a7bfe8660804d73d40324a0,2017-03-28 23:55:21,Mark Hahnenberg,"[client-sync] Also prioritize sent label for initial Gmail sync

Summary:
Sent mail is important for initial sync because it's used for contact
ranking. Prior to this diff we would delay syncing sent mail because we
would prioritize the inbox label over all other labels (including sent).
This diff includes the sent folder in the initial set of messages to sync.

Test Plan: Run locally, verify we get sent mail quickly

Reviewers: evan, spang, juan

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4268",False
7d359dae912f6b7006ec7f0c2c50cfb1bf68cedc,2017-03-28 23:23:31,Mark Hahnenberg,"[client-app] Report battery state changes to Mixpanel

Summary:
This diff will give us insight into how people use Nylas Mail on their
computers with respect to how mobile they are (i.e. whether they use NM
on battery or plugged in).

Test Plan: Run locally

Reviewers: evan, spang, juan

Reviewed By: juan

Subscribers: gleb

Differential Revision: https://phab.nylas.com/D4267",False
390d81bc25fce7af609d56fd39ddeb6a2019467d,2017-03-28 23:22:34,Mark Hahnenberg,"[client-sync] Don't throttle while syncing first 500 threads

Summary:
We want to get to a usable inbox as quickly as possible, and throttling
prevents this. We should basically only be throttling for historical
mail syncing.

Test Plan: Run initial sync benchmark, it's 117% faster on battery

Reviewers: evan, juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D4266",False
3ba551e50e7f7995b3ea94bc9913f6c9d6983aab,2017-03-28 23:21:24,Mark Hahnenberg,"[client-sync] Implement the /contacts/rankings endpoint

Summary:
Prior to Nylas Mail, the Nylas Cloud API provided an endpoint that
returned rankings for contacts which it computed based on how frequently
and how recently a user sent mail to a recipient. This diff reimplements
that functionality in Nylas Mail. This should improve contact
auto-complete when composing emails to frequently contacted recipients.

Test Plan: Run locally, verify that frequent contacts are suggested earlier

Reviewers: spang, evan, juan

Reviewed By: evan, juan

Maniphest Tasks: T7948

Differential Revision: https://phab.nylas.com/D4253",False
247dec4942c7dd431704ea2141680f588ecc031c,2017-03-28 22:26:29,Evan Morikawa,[client-app] change file description on Windows,False
09f4396a4c6bfadc579e510bd585c0a177e84a6b,2017-03-28 21:53:00,Juan Tejada,[client-app] Update changelog,False
589096f8627e553d3ab48cbe78a6c3603d8408c3,2017-03-28 21:48:03,Nylas Coffee Machine,bump(version): 1.0.50,False
c9d11ae18f2b37f72fac2147f93f7a9cff7eaad6,2017-03-28 21:45:03,Juan Tejada,"[client-app] Fix runtime error in FetchMessagesInFolderTask

We were accessing `this._db.accountId` before `this._db` was set, which
caused an error when attempting to run the task",False
30d6edcd815e48a4cb6c87cb0fe9a86f4ea2012f,2017-03-28 21:40:15,Juan Tejada,[client-app] Update changelog,False
f528f793709deb18b261bcde1d9d3336bfd30326,2017-03-28 21:39:39,Juan Tejada,"[client-app] Fix importing SyncActivity

In some places we were not accessing `.default` when using `require`,
and when using `import` we couldn't really destructure unless we
accessed `.default` too, or if the functions were regular exports
instead of properties on a default exported object.

This was causing our sync loop to error.

To remain consistent, we always just `require` or `import` the
SyncActivity singleton and access that",False
3032b5bba4f78fab8a122fe9f1ff82651932f5a7,2017-03-28 11:10:10,Nylas Coffee Machine,bump(version): 1.0.49,False
e769b48f3a15e0e5f041bb6b0689f2acacd2ae80,2017-03-28 10:19:56,Halla Moore,"[client-sync] Change where we report sync activity

Summary:
These locations will provide enough activity for monitoring and are also
more helpful in helping us debug what the sync loop was doing when it
got stuck.

Test Plan: manual

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4274",False
19a486c1dde1c81fd73724f23bbbdc24e8e5bdae,2017-03-28 06:49:50,Evan Morikawa,[client-app] add better documentation to windows update,False
91c85a59310b70efed5a87474f0d75acab18c061,2017-03-28 06:36:11,Evan Morikawa,[client-app] directly call windows relaunch on squirrel update,False
fd00e2eabb832629954d8e4f74cd5bf1f60fec5c,2017-03-28 05:43:42,Evan Morikawa,[client-app] remap windows dev shortcuts,False
05592649130191fde8d538c1f037a37e27ec02ff,2017-03-28 05:30:38,Evan Morikawa,[client-app] only re-install for optional deps on mac,False
f5e1c9c23c05e0e31e532665d24fdecc948cfc12,2017-03-28 04:15:33,Halla Moore,"[client-app, client-sync] Add specs for detecting stuck sync/worker window

Summary: See title. Part of T7681.

Test Plan: ran the specs

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4264",False
34b0471b30ee5901d26cfe4c0f0ee14db58b35d3,2017-03-28 04:12:18,Halla Moore,"[client-app] Detect when the worker window is unavailable

Summary:
Periodically ping client-sync's /health endpoint and store the latest
sync activity. If we get an ECONNREFUSED error, the worker window is
unavailable. Report the last known activity and restart the worker
window. Part of T7681.

Test Plan: manual, specs

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4263",False
a9dc3e76d9050549919810bed1ee81a8129cd9a6,2017-03-28 04:11:31,Halla Moore,"[client-sync] Detect when sync workers are stuck

Summary:
Periodically check the latest sync activity times to determine if a sync
worker has been inactive for too long. If it has been too long, discard
the worker and create a new one for that account. Part of T7681.

Test Plan: manual, specs

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4262",False
d27c20588e57345d259759c9a8d0d904c9150caf,2017-03-28 04:09:53,Halla Moore,"[client-sync] Report latest sync activity

Summary:
Add infrastructure to report and retrieve the latest sync activity, and
start reporting when we download a message or detect that a folder
has no new messages. This will be used to detect if the sync loop is
stuck. Part of T7681.

Test Plan: manual, specs

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4261",False
14e0d5d4305181d69d8eddc448ea7f4a52cd4e3a,2017-03-28 03:52:28,Halla Moore,"[client-app] Retry queries when database is locked

Summary:
We still don't know exactly what scenarios cause us to get 'database is
locked' errors, but generically this means that we have multiple
processes trying to access the database at the same time. In an attempt
to handle this gracefully, this diff makes it so that we retry the
queries in these cases. Theoretically, the database should free up once
the other process is done using it, and the erroring process just needs
to wait its turn. We still throw an error after 5 retries, so if there's
a larger issue, we'll still be able to tell in Sentry.

Addresses T7992

Test Plan:
I opened a transaction in the worker window and then tried to
do the same in the main window. If I didn't release the transaction in
the worker window, the main window eventually errored. If I did release
the transaction, the main window continued creating its own transaction.

Reviewers: mark, juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D4254",False
8bfa27e2b56b88e663af6468c995a3ed1736a009,2017-03-28 03:10:28,Evan Morikawa,[*] add ONLY_CLIENT=false support for cloud & regular install,False
d17febc9a3c07fb8cc75bbca26051b3bb16d685e,2017-03-28 00:43:34,Juan Tejada,"[cloud-api] Timeout streaming API connections every 15 minutes

Summary: Should help a fair bit with our redis connection pileup.

Test Plan: Tested manually.

Reviewers: mark, spang, juan, evan

Reviewed By: mark, spang, evan

Differential Revision: https://phab.nylas.com/D3916",False
17706dff5221a823727f14a4dfb15465c66cfff8,2017-03-27 23:41:18,Christine Spang,"[iso-core] Add indexes from SQL review

Summary:
These only really matter for n1cloud, and are being added manually in
production, so no migration file necessary. I am adding them to the
model definitions to prevent them getting out of sync with production
for development.

See T7999 for full SQL review

Test Plan: ship it

Reviewers: evan, khamidou, juan

Reviewed By: juan

Subscribers: vlad, jerm

Differential Revision: https://phab.nylas.com/D4230",False
ec7cbdb5c52bf7d38f8e21ae9b53e38d18c581ce,2017-03-27 21:07:34,Juan Tejada,[client-app] Update changelog,False
5a0ce1c81d85a68b38fec5b5b405e4a599ea16ef,2017-03-27 12:34:26,Nylas Coffee Machine,bump(version): 1.0.48,False
7d409f52f1ce0b60b427c9b70b222fd4ab249a6d,2017-03-25 03:44:58,Mark Hahnenberg,"[client-app] Reindex threads when they're updated

Summary:
We weren't doing that, so we would have accurate search index info for
threads when they were, e.g., moved to another folder.

Test Plan: Run locally

Reviewers: spang, evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D4260",False
e57df5b185a53197e7d5abdd17143039e3df6821,2017-03-25 02:34:44,Juan Tejada,[client-app] Fix in identity store,False
7396d35fdab9a19f96245c40f2b85fa894e173f6,2017-03-25 01:36:47,Juan Tejada,"[client-app] Don't try to restart sync on every IdentityStore change

Summary:
The IdentityStore can trigger any number of times, but we only want to
start sync if we previously didn't have an identity available

Test Plan: manual

Reviewers: spang, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D4246",False
6e81290c6e9b5bca2c3f1105a7fe37935a639c7f,2017-03-25 01:33:28,Juan Tejada,"[client-app] Correctly remove inline images with x button

Summary:
Before this commit, it was impossible to remove inline images via the x
button

Test Plan: manual

Reviewers: mark, halla

Reviewed By: mark, halla

Differential Revision: https://phab.nylas.com/D4257",False
c707e8e3d88045669e38f34a92b36c52bb127639,2017-03-24 22:51:03,Juan Tejada,[ei] Update changelog,False
d3142dedfc5ed9ed024e26797d2ebf130a8ce2a2,2017-03-24 11:25:20,Nylas Coffee Machine,bump(version): 1.0.47,False
658eb0649c0045597a4e9af95eddf35ee5c72487,2017-03-24 03:48:27,Karim Hamidou,"[client-app] Report hard crashes using Electron's built-in crash reporter

Summary:
I had a bit of downtime this morning so I decided to look into how to store Electron crash data. Electron, like Chromium, stores crash data in an arcane file format named minidump.

There's a bunch of services you can use to store files formatted in this format, like Mozilla's Socorro or zcbenz's own mini-breakpad-server but they're all pretty hard to install. Luckily, it turns out there's a Ruby gem to process minidump files and send them to Sentry! Seeing that, I whipped up a quick sinatra service and hosted it on Heroku – you can take a look at the source code here if you're curious: https://github.com/khamidou/electron-breakpad-sentry

This diff adds the client-side code we need to start sending crash reports.

Test Plan: Tested manually.

Reviewers: juan, evan

Reviewed By: juan, evan

Maniphest Tasks: T7926

Differential Revision: https://phab.nylas.com/D4259",False
5c1d767548b488ae64d135826e81b7471fb1a271,2017-03-24 01:56:28,Juan Tejada,"[client-app] Consolidate file download metric reporting

Summary: See title

Test Plan: manual

Reviewers: gleb, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4256",False
9cb157c753c04b849fb67c0d9ef91c08cac01d8c,2017-03-24 00:53:34,Juan Tejada,[client-app] Update changelog,False
60ca01117fbb264b942f5483b6f5f3dd7b65a29e,2017-03-24 00:03:53,Mark Hahnenberg,"[client-sync] Don't handle IMAP timeouts in the connection pool

Summary:
Different clients can have different policies for retrying after
timeouts.

Test Plan: Run locally, run tests

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4247",False
523347484af9e408691b3574e037031fcde43299,2017-03-24 00:02:19,Mark Hahnenberg,"[client-app] Record file download times

Summary:
We'd like to get an idea of how long the client app is having to wait
when requesting a file. Waiting can cause things like inline image
attachments to appear very slow to load.

Test Plan: Run locally

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4255",False
2d3af7d51be694486fc90f068b81971719a44537,2017-03-23 10:58:54,Nylas Coffee Machine,bump(version): 1.0.46,False
1761fececf634072b8c3daa21b7a9daa39e4e7a5,2017-03-23 05:47:08,Halla Moore,"[client-app] Rename downloadDataForFile(s) -> getDownloadDataForFile(s)

Summary:
The original name seems like it's initiating the download, when really
it's just returning the data of an already in-progress/completed
download.

Test Plan: Manual, specs

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4251",False
372d808dc265e8a2fa2edbd86641da552aa3ce14,2017-03-23 00:35:35,Halla Moore,"[client-app] Ensure files get transferred in forwarded messages

Summary:
We need to download the files and then treat them as uploads. Rather
than using an actual Upload object, which would require another data
transfer, we create an object with all the necessary Upload-like
properties and point it to the downloaded file.

Addresses part of T7960

Test Plan: Manual, some specs

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4249",False
c23803ce990d3e7af79a3a22db917e0214a0acdd,2017-03-23 00:33:11,Karim Hamidou,"Switch type of Metadata value column

Summary:
Found a funny send-later bug I didn't catch when testing on staging: sometimes the data we're saving in the metadata table overflows. That's because MySQL's TEXT column are at most 64k, which is easy to reach when you have a draft + clearbit information and additional stuff.

To work around this, I decided to switch the database type of the metadata table to LONGTEXT. Since it can store 4Gb of text, we should be good. This diff makes those code changes. Obviously, we'll have to run migrations both on staging and prod.

Test Plan: Ran a basic smoke test. Shouldn't break anything.

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4250",False
2f3e4df27ab22c1d627b0ce0edb2327dc574bd11,2017-03-22 23:36:59,Karim Hamidou,"Fix build condition

On the server the env var is defined but set to false.",False
e17f1664173bd7f9ea5cbc4ec0805e5beb329e97,2017-03-22 04:16:48,Halla Moore,"[client-app] Fix DraftFactory specs

Summary: Using `await` instead of `advanceClock()` fixes all the things!

Test Plan: Ran the spec file

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4248",False
59995a9650d7bd009e602900d8fb478d068db934,2017-03-22 00:45:40,Mark Hahnenberg,"[client-sync] Refactor sync worker IMAPConnectionPool callbacks

Summary: In preparation for removing timeout handling from the IMAPConnectionPool.

Test Plan: Run locally

Reviewers: spang, evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D4245",False
8d08c1f118915a73cec5cedbf7652bbc7b6d4393,2017-03-22 00:15:30,Juan Tejada,[client-app] :art: comment,False
7639f54d5d75e5cfa30878151fda00b748c3972e,2017-03-22 00:14:48,Juan Tejada,"[client-app] Correctly sign out of NylasID

Summary:
This fixes T7995.

Previously, attempting to log out from your NylasID would just
automatically sign you back in with the same NylasID because the webview
session was preserved.

Now, instead of relaunching the windows, we restart the app to clear the
webview session

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Maniphest Tasks: T7995

Differential Revision: https://phab.nylas.com/D4224",False
f762fedd875100a9123ec116846825920f68844f,2017-03-22 00:13:41,Juan Tejada,"[client-app] Don't report non-reportable errors in delta connection

Summary:
Previously, the logic for deciding wether to report an APIError lived
inside NylasAPIRequest and depended on an array of ignorable
statusCodes. However, when handling APIErrors, NylasAPIRequest would
convert special error codes (for offline errors) into a statusCode of 0,
which would automatically be ignored.

Given that the delta streaming connection didn't convert status codes to
0, it wouldn't actually ignore the error and end up reporting it,
flooding sentry.

This commit makes it so that that logic lives inside APIError, and
anyone who handles APIErrors can check wether to report them or not,
including the delta streaming connection

Test Plan: manual :(

Reviewers: spang, evan, halla

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4235",False
9ad7d202b179381ebe7c7a11a54b89bc2efe378a,2017-03-21 23:38:34,Karim Hamidou,"[send-later][cloud-workers] Fix S3 attachment upload

Summary:
I spent a long time looking for this bug. The problem boils down to our MIME generation library not accepting run of the mill buffer or streams made out of buffers. Amusingly, the author of this library also decided it to make it semi-private; it's on npm but doesn't have any github sources.

To work around this issue I decided to simply write the contents to a temporary file on the workers machine, then read from this file. Works great, even though it's very hackish.

Test Plan: Tested manually.

Reviewers: juan, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4241",False
fe85f3cb6f470f4e74c47a9d6326e615cb05acf9,2017-03-21 23:09:40,Juan Tejada,[client-app] Update changelog,False
a95f86642cb483d7e5554af5b5fdbc31165c448a,2017-03-21 22:00:12,Nylas Coffee Machine,bump(version): 1.0.45,False
2216935c3244010d8de95474d2ef1827023f8a68,2017-03-21 21:59:46,Juan Tejada,[dev] Actually fix tmp dir path in daily,False
b021723f41e2b8a742333898efedd8e43c2e61a1,2017-03-21 21:55:46,Juan Tejada,[dev] Fix temp dir path in daily,False
140efdd41ad1972eefbccfcb8b299c09c2ff4567,2017-03-21 04:46:46,Juan Tejada,"[client-app] Fix passing cursor to delta streams

Summary:
Currently, when we auth an account for the first time in Nylas Mail (or
we blow away the database), the app is going to request transactions
since cursor `null` from the /delta/streaming endpoint and from the local-sync
delta observable, instead of requesting transactions since cursor `0`

This is due to a subtle bug with the use of default values when
destructuring an object. Our coded did the following:
```
const {cursor = 0} = this._state
```
Which at a glance seems correct. However, this will only work as
expected if `this._state` has the following shape:
```
{cursor: undefined}
```
And unfortunately, our `this._state` looked like this when authing an
account for the first time:
```
{cursor: null}
```

Which would make `cursor === null` instead of `0`.
This is because when using default values, null is considered an
intentional argument/value, as opposed to not passing any argument/value
(which will mean that the argument is undefined).

This was a regression introduced in d60a23c and 8bc2ec5

Test Plan: manual, will add regression test in upcoming diff

Reviewers: evan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4243",False
6eba94e1d8387be5c310865a66105350e1bd0faf,2017-03-21 04:09:24,Juan Tejada,"[cloud-api] Fix query for delta stream transactions

Summary:
When querying transactions for the delta stream, if no cursor is provided,
we should default to 0. Otherwise this will generate a query like:
```
WHERE `transaction`.`id` > ‘null’
```
Which is obviously wrong

Test Plan: manual

Reviewers: evan, halla, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4242",False
8d80b6d35cfa563e94ab55fdc82646fdcc0e9922,2017-03-20 21:07:27,Nylas Coffee Machine,bump(version): 1.0.44,False
35d0144b50712c50262be8a998c6474145b3dee3,2017-03-19 03:56:08,Jeremy Price,"[deploy-it] temp override for deploy branch rules

for ei-prod only.  I set up the ei EB env as prod level, but
have been working on launch changed in master branch. Easy enough to undo,
but I didn't wan't to mess with prod branch until done because
the launch scripts affect all the n1cloud-related environments.",False
e80f893fbc3b8f1a75884b5b880817e5333ee5ed,2017-03-19 02:44:26,Jeremy Price,"[n1cloud][executiveintro][docker] updating docker

launch file to be more flexible. We now have a case statement
to take the AWS_SERVICE_NAME we pass in via Dockerfile and run
a definitive list of commands, rather than having to key off the
interpreted command line directly. Makes it lots easier to add/change
commands

Added symlinks to the pm2-prod-api/workers.yml files for clearer naming
within the script, ie pm2-prod-n1cloud-api/workers.yml.  Anticipating
pm2-prod-ei-{task}.yml files to come. Didn't just rename them on the off
chance something else depends on them

Also added some minimal logging",False
881644eb516f86f845a84b88a074e07ce6255064,2017-03-18 02:29:37,Juan Tejada,"[client-sync] Add error handling when creating syncback requests

Summary: see title. also convert to es6

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4225",False
4ee60b5287c8878f1da4fcee71771e4b38c0836e,2017-03-17 23:29:40,Juan Tejada,[client-app] Update changelog,False
9b8019b752e22d4ab5d2bab1a63892adc73cea8e,2017-03-17 23:19:46,Juan Tejada,[client-app] Update changelog,False
769f9d1d3f2cb8b8bb1e68dbc0f150aed543ad8d,2017-03-17 22:38:00,Juan Tejada,[dev] Fix path for tmp dir in daily script,False
3290c3f58e4fec711ac13a2da6a11ebbcf8bef32,2017-03-17 20:08:47,Nylas Coffee Machine,bump(version): 1.0.43,False
34d6505058a465f1b30c0b002c7fedbe7ca34c45,2017-03-17 03:39:09,Christine Spang,"Revert ""[iso-core] Upgrade nodemailer""

This reverts commit e3e3cd20e54ec351442862a0d6af2a01467251a7.

Reason for revert: breaks Send Later. Needs more testing.",False
69915cf13b25c4673f938e891d16cd94a2fea6a1,2017-03-17 00:56:42,Halla Moore,"[client-app] Don't show non-existent children on folder creation

Summary:
Previously, after creating a new folder, the UI would indicate that the new
folder had children, even though it didn't. This was caused by duplicate models
in our `MutableQueryResultSet` for the user's categories. Basically, we would
sync the server version of the folder before the `SyncbackTask` for the new
folder returned its `serverId`. Without the `serverId`, the synced version of
the folder couldn't yet be tied to the optimistic folder, so a second row was
created in the database. This second row is removed when the `syncbackTask`
does return the `serverId`, because we persist the optimistic folder with a
`REPLACE INTO` query. (This deletes other rows with the same id.) However,
since this was done inside a `persist` change with the `serverId` and no
`unpersist` was ever recorded for the `clientId`, our `MutableQueryResultSet`
never removed the `clientId` model.

To address this, this diff adds a check in `updateModel` to see if the
`serverId` is being added. If it is, and both the `serverId` and `clientId`
exist in the `_ids` list, we remove the `clientId`.

The children indicator does still briefly show up while there are still two
separate rows for that folder in the database. If we want to get rid of this
completely, we would have to ensure that we do not sync the folder before the
`syncbackTask` returns the `serverId`. However, this would probably be pretty
involved, and for not much gain. This fix is much simpler and reduces most of
the issue.

Test Plan: manual

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4228",False
26389a32aff40a41b317c4ba05a3d33eb81a32b6,2017-03-17 00:55:56,Halla Moore,"[client-sync] Only update lastReceivedDate if the message was actually received

Summary:
We don't want to bump threads to the top of the inbox when a user sends a
reply. We originally used `!isSent` to prevent this, but that was removed in
a diff that made sure messages showed up in the inbox when users send emails
to themselves. In order to implement both of these cases properly, this diff
introduces `isReceived` and uses that to determine whether lastReceivedDate
should be updated. Addresses T7991.

Also changes the order of some `or` statements, so that we actually check that
the variable exists before comparing against it.

Test Plan: manual

Reviewers: evan, juan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4226",False
d50393f30537a8189c82686e03563c43978acf4c,2017-03-17 00:44:19,Nylas Coffee Machine,bump(version): 1.0.42,False
d560939dca69c13613ccec1b7d6db813d073470e,2017-03-17 00:37:05,Evan Morikawa,[client-app] don't exclude source maps,False
35aaf086a75fe17becd4493bcc0c4a51b0f83711,2017-03-16 22:35:48,Nylas Coffee Machine,bump(version): 1.0.41,False
e3e3cd20e54ec351442862a0d6af2a01467251a7,2017-03-16 04:54:32,Christine Spang,"[iso-core] Upgrade nodemailer

Summary:
We were using a version that was ~9 months old and a lot of development has
happened since.

v3 is not compatible w/v2, but it looks like we aren't using any of the
features that had breaking changes:

    http://nodemailer.com/about/migrate/

I chose not to switch to the new built-in OAuth2 token refresh support
because we already have a mechanism for refreshing oauth tokens and
adding a different implementation specifically for SMTP would introduce
more opportunities for bugs.

Since mailcomposer is no longer a dependency of nodemailer, I added this
dependency as well.

Test Plan: manual - sent a message, sent a message w/an attachment

Reviewers: evan, khamidou, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4201",False
cf30555289d92ae44701660ac95bb2648b0d3ec5,2017-03-15 19:04:12,Nylas Coffee Machine,bump(version): 1.0.40,False
79699073c63099037d0d6130cf61e3a365b809ad,2017-03-15 02:09:56,Evan Morikawa,"[client-app] don't bootsrap cloud stuff when building the client

Summary:
We don't need to spend the time running script/bootstrap in our cloud-*
folders!

Test Plan: manual

Reviewers: spang, juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D4214",False
7fea0ff2a5f2c91ca607e1e439937f6f92e7d33f,2017-03-15 02:09:40,Evan Morikawa,"[client-app] update files ignored in build

Summary:
The ignore list was very old. It included several dozen MB of docs_src and
other crap in our builds

Test Plan: manual

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4213",False
11e6b52534e96fa3ac9e079c16ef5cf21e15e1bc,2017-03-15 02:05:09,Evan Morikawa,"[client-app] upload nupkg for Windows autoupdater

Summary: We need to upload the nupkg for the Windows autoupdater to work

Test Plan: manual

Reviewers: juan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4219",False
e384415f1a2e84a3a6d8ac972f1d962e3108c81b,2017-03-15 00:54:04,Karim Hamidou,"[send-later] Add support for attachments

Summary:
This is going to be a diff way shorter than the previous one! Basically, it adds a new endpoint, `/blobs` to our API to store send later attachments. When a user schedules a draft to be sent, we send all attachments to this endpoint. Separately, we store the rest of the message as metadata.

When it's time to send the message, we fetch the attachments from S3, fetch the metadata and merge them together to get a message we can send.

Test Plan: Tested manually. Will make a final QA pass before landing.

Reviewers: juan, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4196",False
f114a7dbc4fb7edcb8764e6c4c81789b1c8eb7b9,2017-03-14 23:25:25,Evan Morikawa,"[client-app] ""two panel"" -> ""Reading Pane On""

Summary: Minor copy change via Sachin

Test Plan: manual

Reviewers: juan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4218",False
36e49062800c6cacfcce2e6939fefe530667078e,2017-03-14 23:14:15,Nylas Coffee Machine,bump(version): 1.0.39,False
f34843e506b32cdfecc2fa5e7d9ad0ade4e2a15e,2017-03-14 23:12:30,Juan Tejada,[client-app] Fix missing depedency for imap-provider-settings,False
50f59fb16dfe55d4dfec3abb76b646ac9e26bc6d,2017-03-14 23:07:24,Evan Morikawa,"[client-app] only upload 7 characters of the commit hash

Summary:
On windows running `git rev-parse --short HEAD` does in fact now give you
9 characters instead of 7 like it does on Mac. This will ensure that
builds get uploaded to the same folder and help ensure we don't post a
version that doesn't exist on the release page.

Test Plan: Manual

Reviewers: juan, halla, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4217",False
fd1f5ad7569a0085967bb4e1baf1c040d43c744d,2017-03-14 21:49:10,Juan Tejada,[client-app] Update changelog,False
6056bd191e74197d3f22b5a7f792685e6adf2197,2017-03-14 11:28:30,Nylas Coffee Machine,bump(version): 1.0.38,False
a9501cda98e39883db5612fcc7f4b31dc9b73e0f,2017-03-14 11:14:09,Juan Tejada,"[client-app] Restart sync when computer awakes from sleep

Summary:
Use electron's `powerMonitor` module to detect when the computer resumes
from sleep, and restart the sync loop when that happens in order to
sync the inbox immediately, in case we received any new mail events
while the computer was asleep

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4216",False
36982c66d65518764dab1701481a8b9d125faf45,2017-03-14 11:12:52,Juan Tejada,"[client-app] Make resetEmailCache work without forcing re sign-in

Summary:
This commit makes it so `resetEmailCache` works as expected, i.e. it
removes all databases, without forcing the user to re sign-in to their
accounts or NylasID

Previously, this method removed the database without removing the
accounts, left users in an un-authed state that was hard to recover
from. This was fixed in D4212 which makes sure that when we get a new
identity, sync and deltas are restarted

However, resetEmailCache would still force you to log in to yoru NylasID
because it was deleted from the database. However, if we reuse the
command `application:relaunch-to-initial-windows` instead of manually
deleting the database, we can relaunc the app while preserving the users
NylasID session, so they don't have to sign back in manually.

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4215",False
80f24652c3ed96c8a4cde81739f2e2c4c8815416,2017-03-14 08:30:59,Juan Tejada,"[client-app] Don't start sync or delta connections without an identity

Summary:
This prevents the app from entering a restart loop when there's no
identity.

Specifically, when a user logs out of their identity, or when she resets the
email cache, or any other scenario that leaves the app without an
identity but with accounts added, the sync loop (and deltas) will start
without an Identity.

This will cause NylasAPIRequest to throw an error that
forces the user to close the app. When the app restarts, sync will start
again without an identity, and the user will be forced to close the app
again, and so on and so forth for the rest of eternity

Relevant error:
https://github.com/nylas/nylas-mail-all/blob/master/packages/client-app/src/flux/nylas-api-request.es6#L165-L174

Additionaly, this makes sure that after resetting the email cache, the sync
process starts when the identity becomes available

This solves T7989

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4212",False
6a7829008b4920a283b326fc22a3c67f5b42734d,2017-03-14 08:27:58,Juan Tejada,"[client-sync] Correctly wait for sync to stop before resetting email cache

Summary:
Previously, while resetting the email cache, we would try to stop sync
and just wait for an arbitraty amount of time for it to stop and the
proceed to blow away the database.

This commit makes it so we correctly wait for sync to stop, and then we
blow away the db. It adds a timeout anyway in case sync is stuck and we
can't stop it

Depends on D4207

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: spang, halla

Differential Revision: https://phab.nylas.com/D4209",False
94d989992fce9835681995b147224e84f6f2eaaa,2017-03-14 08:26:37,Juan Tejada,"[client-sync]: Fix error in SyncProcessManager._resetEmailCache

Summary:
We no longer keep `this._accounts` state, which was being accessed
inside `_resetEmailCache`

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: spang, halla

Differential Revision: https://phab.nylas.com/D4207",False
7f41a384630436ae584c1d46f9ab3ee06aa201c9,2017-03-14 08:21:02,Juan Tejada,[client-app] Update changelog,False
929ef698a5be7e7d237a4b7ba3900d58e084d4f6,2017-03-14 04:35:50,Evan Morikawa,[client-app] fix travis env variables,False
a30a48e50c39125a5584a10c6996f53f303795ed,2017-03-14 04:18:45,Evan Morikawa,"[client-app] run windows build separately

Summary:
build-client, aka packaging, aka bundling is now separate from uploading.
This is both to compartmentalize our tasks a bit more and so we can add a
non-grunt windows task inbetween packaging and uploading.

No more heavily-overloaded PUBLISH_BUILD flag.
Added SIGN_BUILD flag instead.
No more TRAVIS and TRAVIS_PULL_REQUEST flag.

Test Plan: Manual

Reviewers: halla, juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D4208",False
975b27c46cafd6b29c0602b3192f0bb646db5186,2017-03-14 04:17:58,Evan Morikawa,"[client-app] remove ability to run specs

Summary:
This removes specs from the build production version.

One of the major issues with the windows build was that one of the package
specs included a .node compiled file that the codesigner attempte to sign,
but couldn't find for some reason.

In testing, removing the specs from the build prod version fixed this.

While we could just remove the one offending test, I think we should just
remove the whole suite from the build version. That'd save in the number
of files we have to ship, save download time, save build time, and have
less chance for some symlinked issue failling a build in the future.

Test Plan: Manual

Reviewers: khamidou, halla, juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D4206",False
ac688d0117902ef687bd61b1e12136baa2b3d722,2017-03-14 02:28:30,Christine Spang,"[iso-core] Pin imap-provider-settings package version

I'm about to make backwards-incompatible changes to this data in
preparation for supporting setting the 'ssl' bit separately for IMAP /
SMTP.",False
3ec60a8e0905026f9df546c5d8bdea863b783b4c,2017-03-14 00:54:46,Christine Spang,"[client-app] Don't check for key membership on null

This bug snuck in when I landed the DeveloperBarCurlRequest fix
for the Content-Type header.",False
3a24ea0432e9d75fa1e8fa6581a406a9bb0ceb18,2017-03-14 00:20:43,Christine Spang,"[client-app] Some wording improvements in IMAP onboarding

Summary:
It always drives me crazy when folks use ""setup"" (no space) as a verb,
because the verb version has a space in it.

Also remove the word ""Setup"" from the displayName for custom IMAP accounts
because it doesn't make sense for how we use this field, e.g.

https://github.com/nylas/nylas-mail-all/blob/f47c0a3e19a6f85775c2c751a624801777981a15/packages/client-app/internal_packages/onboarding/lib/page-account-onboarding-success.jsx#L27

will display ""Sucessfully connected to IMAP / SMTP Setup!"" with the old
wording when you successfully auth a custom IMAP account.

Test Plan: manual

Reviewers: evan, juan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4199",False
a25ad1e7ad78a2d0baa015d1f3d6c391e5c5372a,2017-03-14 00:16:09,Christine Spang,"[dev] On Linux, don't run redis if already running

Summary:
Dunno what the default behaviour is on Ubuntu, but on my system (Debian
sid) when I have the redis-server package installed it starts up
automatically on system boot. In this case, placate pm2 by having the
launch script sleep forever.

Otherwise, the 'redis' process startup will fail repeatedly and spam the
console.

Test Plan: manual

Reviewers: halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4203",False
8d43c68b36d6a1c94a3e7ca8f50f1acaf74ba03a,2017-03-14 00:12:14,Christine Spang,"[dev] Make 'arc lint' shut up about long lines

We don't warn about this in JS, so we shouldn't warn about this in coffeescript either.",False
dc42b5a843ce42c3883566eb7a78543206357eec,2017-03-14 00:08:06,Christine Spang,"[client-app] Specify Content-Type in developer bar curl commands

Summary:
Dunno if I'm the only one having this problem, but I spent at least an
hour over the last two days wondering why hapi just sits there and hangs
in the Joi validation step when I copy-paste calls to /auth from the
developer bar to my terminal. It turns out that if you fail to send the
correct Content-Type when sending a JSON payload, Joi just hangs
forever. (WTF!)

Test Plan: manual

Reviewers: halla, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4204",False
f5a3895cc4efa0409a9d91c98bf660b539ad0f64,2017-03-13 07:23:18,Christine Spang,[dev] Fix 'arc lint',False
f47c0a3e19a6f85775c2c751a624801777981a15,2017-03-11 22:27:06,Christine Spang,"[cloud-api] Remove global override of billing identity URL

This was mistakenly landed by Karim with the Send Later implementation,
and would be REALLY BAD if it ever got deployed to production.",False
2d1c30b8752bbf47b04f15369b07d7d51e235dd7,2017-03-11 07:15:24,Nylas Coffee Machine,bump(version): 1.0.37,False
ca2d1bb48e31232ee953067d442c0402460c0a5c,2017-03-11 07:09:35,Mark Hahnenberg,"[client-sync] Fix queueMessageForProcessing

Summary:
We were always incrementing the queue length and resolving the promise
in the constructor :-/

Test Plan: Run locally, make sure queue doesn't start rejecting messages

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4198",False
28e25beb6b74eca75c5c8c02d9fc626d1c05a8a4,2017-03-11 05:26:41,Juan Tejada,"[client-app] Correctly show auth error when we can't connect to n1cloud

Summary:
Previously, n1 cloud auth errors were stuffed into an account's
syncState. The problem with that is that the sync loop manages that
state, and as long as the sync loop is running it will set that state to
running. However, it might be the case that the sync loop is running but
we can't connect to n1Cloud, so even though we would set the `syncState`
to `n1_cloud_auth_failed`, the sync loop would just set it back to
'running', and the user wouldn't see the error notification indicating
that it can't connect to n1Cloud

This commit makes it so we keep tracj of the auth failure state for
n1Cloud in a separate field, and makes sure that the error notification
component shows that error.

Test Plan: manual

Reviewers: mark, spang, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D4172",False
6683de8c15e226f70c00b43514080fa2f1c88e02,2017-03-11 05:01:29,Juan Tejada,"[client-app] Fix runtime error during send error handler

Summary:
On rare occasions, the api error would not have a body, and we would try
to access the message prop on the body, which would in turn throw an
error.

This commit prevents this error, and adds better messaging to the sentry
report

Test Plan: manual

Reviewers: mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4194",False
a5e1a78e709eeaabafff466a727b170fa7c22ac0,2017-03-11 04:08:42,Juan Tejada,[client-app] Update changelog,False
151b581e447fd64276f141516bdde6d31df72035,2017-03-11 03:36:30,Juan Tejada,[none] (dev) Fix changelog path in daily script,False
4662e6ff1cbba678834bbba2a2e3c399abf8ab21,2017-03-11 03:36:30,Juan Tejada,[client-app] Update changelog,False
9c52546468bc17795cea0692c0d8aa1a0626684c,2017-03-11 03:32:02,Juan Tejada,"[client-app] Measure and report inline composer open times + consolidate timers

Summary:
This commit adds a new perf metric for inline composer times.

Additionally, it consolidates the timer logic for all other types of draft
creation (mailto links, dropping a file in the app dock icon, etc).

Test Plan: manual

Reviewers: halla, evan, mark

Reviewed By: evan, mark

Differential Revision: https://phab.nylas.com/D4186",False
2fc84b02f7888506195061c9a543c71afe2566e1,2017-03-11 03:11:54,Mark Hahnenberg,bump(version): 1.0.36,False
f49acc1a42fa6b8fc386966874ce647b472eac2d,2017-03-11 03:10:37,Mark Hahnenberg,"[iso-core] Increase the IMAP connection pool size

Summary:
Previously we limited it to 3. Gmail supports up to 15, many IMAP
servers support 10 by default. So let's bump it for those folks.

Test Plan: Run locally, verify things still work.

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4175",False
b62852f62e6e8cabb5f618c3204bbbe96137e810,2017-03-11 03:10:04,Mark Hahnenberg,"[client-sync] Refactor MessageProcessor to be more robust to errors

Summary:
Errors in the MessageProcessor were causing sync to get stuck
occasionally. This diff refactors queueMessageForProcessing and friends
so that they're more robust to errors during promise construction.

Test Plan: Run locally

Reviewers: juan, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4190",False
c4691439bbafad14f8215f55157dddc5057773a5,2017-03-11 03:09:27,Mark Hahnenberg,"[client-sync] Shim sequelize to timeout after 1 minute

Summary:
Sequelize can sometimes return promises that will never resolve or
reject. We can wrap the promises we get back from sequelize in a
bluebird promise which gives us the ability to timeout these abandoned
promises. This way, we can track down issues in sequelize as well as
unblocking stuck sync loops.

Test Plan: Run locally, verify that timeouts occur

Reviewers: juan, evan, spang

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4192",False
8be2fccc61cc507164c4f275a2b2903d217d4453,2017-03-11 03:03:03,Juan Tejada,[client-app] Update changelog,False
7d577effdd7c553930af7c5dae4c7c4a29943896,2017-03-10 11:34:18,Nylas Coffee Machine,bump(version): 1.0.35,False
41f8eaaa84fbaab6815d1e3d5c1f41ba57f697e1,2017-03-10 11:20:39,Juan Tejada,"[client-app] Make sure we retry delta connection when reauthing account

Summary: See title

Test Plan: manual

Reviewers: halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4176",False
d07b9320655026d7bb94b72ddbd9ffa1fbdd71d8,2017-03-10 10:52:07,Juan Tejada,"[client-app] More defensive error handling to prevent sync from halting

Summary:
This commit adds error handling to the sync-loop's `onSyncError` and
`scheduleNextSync`.

These functions generally don't fail, as they are in the `catch` and
`finally` blocks respectively of the sync loop. But as we've seen in
D4152, the datbase can sometime error if it's in a bad state. If it
errors inside these functions, we will never schedule the next run of
the sync loop.

Depends on D4152

Test Plan: manual

Reviewers: evan, spang, mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4153",False
16fce8fc806265818b802df9a081a651ff690351,2017-03-10 04:58:23,Juan Tejada,"[client-app] Prevent delta streaming connection from retrying too much

Summary:
Before this commit, we would call .close() onError and when the
connection closed. We also closed the connection onError, even though
NylasLongConnection had also closed it, so we ended up calling close a
bunch of times. This would cause us to set a bunch of timeouts to retry
unecessarilly.

This commit makes it so we ensure there's only one retry timeout and
consolidates the logic that calls .close() so we don't call it so many
times unnecessarily

Test Plan: manual

Reviewers: spang, mark, evan

Reviewed By: mark, evan

Differential Revision: https://phab.nylas.com/D4166",False
1cfb70db1c9e5e20379fc69193d98dc87c5c8bd4,2017-03-10 04:57:06,Juan Tejada,"[client-app] Consolidate delta connection stores, rm deltas internal_pkg

Summary:
This commit consolidates the `DeltaConnectionStatusStore` and the
`DeltaConnectionStore` which kept track of very similar state and made
sense to be the same store (as per feedback in D4118#77647)

Given that this state needs to be available app-wide for plugins to
query the status of delta connections, `internal_packages/deltas` was
removed (given that it only activated that store), in favor of having the
unified store inside `src/flux/stores` and available via `nylas-exports`

The `deltas` package also contained some contacts-ranking code, which is
no longer in use until we restore that fetaure, so I created a
`internal_packages/contact-rankings` which contains this unused code for
now.

Test Plan:
manually open, close, end delta connections, verify that I'm getting
correct results. unit tests to come

Reviewers: halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4145",False
6536e0e6fd7f42ce99c236294fe820b94db57bb0,2017-03-10 04:54:43,Juan Tejada,"[client-app] :art: Rename NylasSyncStatusStore to FolderSyncProgressStore

Summary: see title

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4141",False
2fa50fa96daae3959db1d7ee1b5ef787d0e3551f,2017-03-10 04:54:06,Juan Tejada,"[client-app] Consolidate apierror status code that we should not report

Summary:
This DRY's up code that use these status codes

Depends on D4130

Test Plan: manual

Reviewers: spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4140",False
5cefd108095a93b2fdb4663553d02ca6ced91d09,2017-03-10 04:52:34,Juan Tejada,"[client-app] Fix error when attempting to report a fetch id error

Summary:
When reporting error inside `IdentityStore._fetchIdentity`, we would
pass null as the `extra` parameter for `reportError`. This would cause
us to try to assign something to null and throw an error while reporting
the error.

(Even though `extra` has a default value of `{}` (see
declaration of `NylasEnv.reportError`), passing null will be interpreted
as a valid arg and it wont get assigned the default value)

Thankfully, the second error /is/ reported to sentry: https://sentry.io/nylas/nylas-mail/issues/230589717/

Test Plan: manual

Reviewers: mark, halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4150",False
c8a974566f08246f5bcca342cdda85755b6ebd88,2017-03-10 04:52:08,Juan Tejada,"[client-app] Rate limit error reporting for message processing errors

Summary:
This should prevent us from flooding Sentry with errors like this one:
https://sentry.io/nylas/nylas-mail/issues/230605150/

Test Plan: manual

Reviewers: spang, mark, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4151",False
956084b1eb1e4687503d68a088f1ae0902659ae4,2017-03-10 04:51:07,Juan Tejada,"[client-app] Prevent `database malformed` error restart loop

Summary:
This error is can flood Sentry pretty badly: https://sentry.io/nylas/nylas-mail/issues/230629801/

My initial thought was to rate limit it, but rate limiting wouldn't
do any good because when we get that error we destroy the databases and
restart the app, and we will loose the in-memory rate limiting data.

The real fix, and reason why Sentry is being flooded with this error by
a single user, is that once you encounter this error the app will enter
a restart loop that constantly throws this error. The reason being that
we weren't properly awaiting for the K2 account databases to be dropped
before closing the app, so on restart, the database would still be
malformed.

The fix is to properly `await` for the database drops

Test Plan: manual

Reviewers: spang, mark, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4127",False
9f1024459fcf4b6696b1b5221432639d1a6b1409,2017-03-10 04:17:07,Mark Hahnenberg,"[client-sync] Refactor file download IMAP pool use

Summary:
This is in preparation for removing the ability of the IMAP pool to
automatically handle timeout errors.

Test Plan: Run locally, verify file download still works

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4167",False
b26798d6c314fec519c5b690f0fb61312dcfcd19,2017-03-10 04:16:51,Mark Hahnenberg,"[client-sync] Refactor raw message IMAP connection pool use

Summary: In preparation for removing timeout handling from IMAPConnectionPool.

Test Plan: Run locally

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4168",False
57a858fa6c4a62483370c1a7377f66901b35f6f8,2017-03-10 03:56:06,Mark Hahnenberg,"[client-sync] Refactor _search Observable

Summary:
We had this weird nesting where we would keep the IMAPConnection open
beyond the scope of the connection pool and return the created
Observable. This diff inverts that relationship and flattens out some of
the indentation, making the code easier to read. This is in preparation
for refactoring the IMAPConnectionPool to no longer automatically handle
timeouts.

Test Plan: Run locally, make sure search still works

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4165",False
d24ffc607f1e4cbd79101d741e8a6a8c9850b469,2017-03-10 01:56:34,Christine Spang,"[client-app] Don't report incorrect username or password to Sentry

Summary:
This is not a bug. Maaaybe we want to report this to MixPanel for individual
user debugging (how do we do that?), but it doesn't make sense to report this
error to Sentry.

Example:

https://sentry.io/nylas/nylas-mail/issues/230530818/

Test Plan: yolo

Reviewers: mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4130",False
22091a00540e859f9707e83c29d4a17746d32ea0,2017-03-10 01:55:54,Mark Hahnenberg,"[client-sync] Make cancelling SyncUnknownUIDs actually work

Summary: Misspelled INPROGRESS-NOTRETRYABLE :-(

Test Plan: Run locally, make sure things get cancelled

Reviewers: juan

Differential Revision: https://phab.nylas.com/D4163",False
7a09158df93e1b3ea86066487c04a0eeb655d8d0,2017-03-10 01:44:16,Evan Morikawa,"[client-app] don't re-close dev tools

Summary:
If you have the console open and are looking at the Source panel or
something, this will constantly bring you back to the Console panel. Won't
do that anymore with this chec

Test Plan: manual

Reviewers: spang, mark, halla, juan

Reviewed By: mark, halla, juan

Differential Revision: https://phab.nylas.com/D4162",False
f82772e84091e66bcf17a0d68ea5fe4971a620b1,2017-03-10 01:41:36,Evan Morikawa,"[client-app] fix circular errors and logging

Summary:
Errors weren't getting reported because of a circular reference causing
JSON.stringify to fail.

We can't add the whole API `response` object onto the error object,
because sometimes (like when the delta connection errors with a 401), the
`response` object is circular. We only use it to the extract the status
code anyway and it's a huge object. This diff excludes them from the
APIError objects.

We also have code to recover just in case JSON.stringify errors for some
other weird reason. It'll still attempt to report the error prefixed with
`Recovered Error`

Finally, we used to spit only the `error.stack` to the console. This meant
what we saw in the console didn't properly include the error messages
being incredibly not useful.

It's better to console.error the whole error object since that'll more
nicely display on the inspector console

Test Plan: manual

Reviewers: juan, spang, mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4154",False
9df1223143379c84e64f5b16c5d870218a38d6bb,2017-03-10 01:17:18,Mark Hahnenberg,"[client-sync] Gracefully handle large amounts of unknown UIDs from search

Summary:
Previously if we got back a huge number of unknown UIDs from IMAP search
we would try to sync all of them at once. This could lead to hanging the sync
loop trying to download tons of messages. This diff limits the UIDs we're
willing to sync per task to 500 and splits each task up into chunks of 25
messages so that we don't try to download all of them at once. If we need
to sync more than 500 uids then at the end of the syncback task it will
queue another task to run the next time the sync loop rolls back around.

Test Plan:
Run locally, verify that we gracefully handle various situations
including cancelling during the syncback task, cancelling between syncback
tasks, huge numbers of results, etc

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4142",False
72445575edcaf67f05ea4f6f2e82cb3b06c28b85,2017-03-10 00:37:38,Mark Hahnenberg,"[client-sync] Make SyncUnknownUIDs NOTRETRYABLE

Summary:
We don't want to constantly retry to sync a bunch of random UIDs if
we're not longer in the search perspective so make these syncback tasks
not retryable.

Test Plan: Run locally, verify that we don't retry

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4149",False
5794a2a1e8db03b5f2c64895d0f41445a8763bf5,2017-03-10 00:29:23,Juan Tejada,[client-app] Correctly set process title,False
4c58758f0cfb2289dd438655c51ec8ec6b37af19,2017-03-09 23:23:30,Juan Tejada,[client-app] Update changelog,False
0c6ea3506fd007b90685c11e64d53b13cc7b5806,2017-03-09 21:52:28,Juan Tejada,[client-app] Update changelog,False
9dc00017f9deb10b010ae73404a571e886e44b88,2017-03-09 21:50:49,Juan Tejada,"[client-sync] Bump sequelize version - Ensure it doesn't halt sync

Summary:
This commit bumps the version of sequelize to point to the latest
version in our fork. This version bump also includes latest updates from
upstream sequelize since the last time we bumped the version.

Notably, it includes a critical fix that will prevent the sync
loop from getting stuck on rare occasions.

Specifically, sequelize's `Query.prototype.run` could in some cases return a
Promise that would /never/ resolve or reject, effectively halting the
execution of any code that was waiting for that promise. This was due to
a lack of error handling inside a the query's `afterExecute` function; if an
error was thrown there, the enclosing Promise would never reject, and
the error would just remain uncaught. An example of such an error that
could cause this scenario is: T7742 - https://sentry.io/nylas/nylas-mail/issues/230016155/

Sync getting halted in this way can produce a variety of user facing
bugs like not being able to send or it taking an absurd amount of time
(hours), tasks never finishing or taking an absurd amount of time to
complete, new mail not arriving, among others

The commit that fixes this is: https://github.com/nylas/sequelize/commit/0deeda9e1ae058c6ce8d5bb29f4eea1a590f17f3
The full set of changes introduced by this version bump are: https://github.com/nylas/sequelize/compare/nylas-3.30.0...nylas-3.40.0

**Note:**
It is important to note that sequelize might still halt the sync loop if
there are other places in the code that can return Promises that never
resolve or reject under certain circumstances. I can consistently reproduce this
scenario when an error is thrown inside `afterExecute`, and I've seen it
happen in the wild, but I've also ran into this type of sync loop halting (db
promises never resolve) without any sequelize errors being thrown, which
suggests that there are other places in the sequelize code that might end
up returning a Promise that will halt sync.

Unfortunately, we don't have a good way to detect and report when this
happens yet, but we are adding one in upcoming diffs in order have data
on how many people are running into this, and/or if this patch completely
fixes the issue. Otherwise, we'd need to audit sequelize's code.

Should resolve T7837 and T7767

Test Plan: manual

Reviewers: spang, mark, halla, khamidou, evan

Reviewed By: evan

Subscribers: mg, tomasz

Maniphest Tasks: T7767, T7837

Differential Revision: https://phab.nylas.com/D4152",False
19ff57bbefb9b91b5b4a4281eec402f259d4e8d1,2017-03-09 12:02:47,Juan Tejada,[none] (dev) Fix npm version bump path in script/daily,False
342fa95145472fd883a4922b007485261c005f51,2017-03-09 11:58:39,Juan Tejada,bump(version): 1.0.34,False
a18030c0dc124f6f71e276fd27c662c6385b0ac8,2017-03-09 11:54:17,Juan Tejada,[none] (dev) Fix paths in scripts/daily,False
12ccef7715c77ca9e3d53dbfc397460589e9b595,2017-03-09 03:48:44,Mark Hahnenberg,"[client-sync] Refactor message processing throttling

Summary:
We want to enable code to control whether fetching is throttled or not.
We basically only want to throttle syncing the historical message
archive. New messages, initial inbox sync, and unknown search results
should not be throttled. Also some drive-by code refactoring.

Test Plan: Run locally, verify that things still work

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4126",False
d60a23c448150d9bf83b6b089289d8d08427e4c7,2017-03-09 01:42:50,Juan Tejada,"[client-app] (deltas P6) Split local and cloud deltas

Summary:
This commit splits apart the `AccountDeltaConnection` class, which was
in charge of listening to both cloud /and/ local deltas by way of an
artificial interface, `DeltaStreamingInMemoryConnection`.

Splitting this into 2 modules with separate responsibilities will hopefully
make this code easier to reason about and reduce some cruft and unnecessary
indirection.

Specifically, this commit makes it so:

- `DeltaConnectionManager` is only in charge of starting and ending `DeltaStreamingConnection`s, which are solely in charge of listening to deltas from the cloud api
- `LocalSyncDeltaEmitter` no longer unnecessarily emits events for the `deltas` package to listen to but rather directly processes and saves those deltas from the K2 db to edgehill.db
- `LocalSyncDeltaEmitter` is also in charge of keeping track of the latest received cursor, under its own JSONBlob key in edgehill.db. This migrates localSync cursors saved under the old key.
- `LocalSyncDeltaEmitter` is now instantiated and managed from within the `SyncProcessManager` as opposed to the `SyncWorker`. Apart from removing extra state from the `SyncWorker`, this removes dependencies on the client-app environment from the sync-worker.
- `DeltaStreamingInMemoryConnection` and `AccountDeltaConnection` are now gone

(Sorry for the big diff! This one was a little hard to split up without landing something broken)

Depends on D4121

Test Plan: manual + unit tests planned in upcoming diff

Reviewers: halla, mark, evan, spang

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4122",False
049a3c2c389bd86ff0d4b0c52dce2fc7c682f1d6,2017-03-09 01:39:31,Juan Tejada,"[client-app] (deltas P5) Move DeltaProcessor to nylas-exports

Summary:
This is to make it available to all plugins in the app
Depends on D4120

Test Plan: manual

Reviewers: halla, mark, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4121",False
8bc2ec5384ae86b441c3132df09e7036be08aa9a,2017-03-09 01:38:41,Juan Tejada,"[client-app] (deltas P4) Fixup DeltaStramingConnection + retry on close

Summary:
This commit completely refactors `DeltaStreamingConnection`, notably
introducing the following changes:

- Right now, `AccountDeltaConnection` establishes both delta connections to the cloud api and to the `client-sync` database (K2). This class is meant to disapper in favor of splitting into two different classes meant for syncing with the n1Cloud api and the local database. Specifically, `DeltaStreamingConnection`'s only responsibility is now to connect to the n1Cloud API and establish an http streaming connection for metadata deltas, etc. This class no longer unecessarily inherits from `NylasLongConnection`, which removes a lot of unecessary callback indirection.
- The statuses of the n1Cloud delta streaming connections are now stored in as JSONBlobs in edgehill.db under new keys. This commit ensures that the data is correctly migrated from the old key (`NylasSyncWorker:<account_id>`).
- The `DeltaStreamingConnection` now correctly retries when closed or errors. This logic previously existed, but was removed during the K2 transition: https://github.com/nylas/nylas-mail/blob/n1-pro/internal_packages/worker-sync/lib/nylas-sync-worker.coffee#L67
- Delta connection retries now backoff using the `ExponentialBackoffScheduler`
- Attempt to restore the delta connection whenever the app comes back online

Depends on D4119

Test Plan: manual + planned unit tests in upcoming diff

Reviewers: halla, mark, evan, spang

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4120",False
b4d3da1e4df1caaa5a08dbe5aa610e3cf518d884,2017-03-09 01:32:08,Juan Tejada,"[client-app] (deltas P3) Change `onResults` interface in NylasLongConnection

Summary:
For legacy reasons, NylasLongConnection did not take the `onResults`
callback as an option, but rather it was a method you had to call on the
connection, which took the callback, and which you had to call after
instantiating the connection. This was an annoying and clunky interface.

This commit makes it so NylasLongConnection takes an `onResults` option
as one would expect it to, and updates any references to the old
interface

Depends on D4118

Test Plan: manual

Reviewers: halla, mark, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4119",False
92bf048754c655eeafc237121788f88608b95854,2017-03-09 01:30:07,Juan Tejada,"[client-app] (deltas P2) :art: Split up NylasSyncStatusStore

Summary:
Turns out, NylasSyncStatusStore doesn't need to concern itself with the
status of delta connections.

This is legacy cruft from the days when this store used to provide the
online status of the app based on the delta connections. Now we have an
OnlineStatusStore, so we don't need this at all

Instead of stuffing that state in that store, this commit adds a small
DeltaConnectionStatusStore to provide an easy way to listen to changes
on the status of delta connections. The only part of the app concerned
with that state is the DeveloperBarStore in order to render the green
circles for delta connections in the worker window.

Depends on D4117

Test Plan: manual

Reviewers: mark, halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4118",False
ffb00c7a4a6c171a53f0602527f8a5aacab755ad,2017-03-09 01:28:25,Juan Tejada,"[client-app] (deltas P1) :art: Fixup AccountDeltaConnectionPool

Summary:
- Rename to `DeltaConnectionManager`
- Convert main.coffee to main.es6
- Use async/await

Test Plan: manual

Reviewers: halla, mark, evan, spang

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4117",False
47742f31eda51118c7117f614630787f36906128,2017-03-09 01:24:49,Juan Tejada,"[none] (dev) Add script/daily

Summary:
Generating the daily build always takes a bit of effort, so I wrote the
script to automate the process and allow anyone to do it as well.

This script will:

- Check your current working directory is in a good state
- Bump the version number in package.json
- Edit CHANGELOG.md with the git log diff between current master and the last version tag (you can also manually edit it). This is so writing the CHANGELOG before a release takes less effort; you will just need to open the CHANGELOG file and edit the commit messages.
- Commit the changes with a commit message of: bump(version) <next_version>
- Add new version tags to nylas-mail and k2
- Push the changes to Github
- If provided with the flag, it will build the app. This is intended to be used in our mac mini machine

There are a few TODO's left in here, like updating the daily channel,
and emailing a notification when the channel is updated with the buid urls.

When this lands, we will configure our mac mini to run this script daily/nightly.
Also, any engineer should be able to trigger a daily build easily by just
running this script.

For sample output, see this commit which was generated by this script:
https://github.com/nylas/nylas-mail/commit/4041e59f465fda276826a134bf65a11c1eea7bcd

Test Plan: manually running it

Reviewers: halla, spang, mark, khamidou, evan

Reviewed By: evan

Subscribers: tomasz

Differential Revision: https://phab.nylas.com/D4123",False
2da350fefa84d75692b3b5aa51ab4874e68abb17,2017-03-09 00:47:28,Juan Tejada,"[client-app] Handle errors when opening imap box correctly

Summary:
If an error is thrown while opening an imap box, we need to make sure to
set the `_isOpening` back to false

Test Plan: manual

Reviewers: mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4134",False
673e47f62c8455f717be328bbc8a8df82dc92341,2017-03-09 00:27:22,Christine Spang,"[iso-core] Provide better info to Sentry on send errors

Summary:
In many cases when send fails, the server settings may be incorrect.
Send this data to Sentry with the original error in order to help us
diagnose.

I think the grouping will only contain settings for a single user
getting the same error, but should still be good enough to do further
investigation, e.g. https://sentry.io/nylas/nylas-mail/issues/230529222/

We can always go look up the requests in the n1Cloud logs if more info is
needed.

Test Plan: yolo

Reviewers: mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4131",False
fc271b4f820c6c09a9f8df6343c540b47e0430bf,2017-03-08 12:36:28,Juan Tejada,bump(version) 1.0.33,False
09949b81a2e9dd9e7d0584f222c51865df41d3bd,2017-03-08 08:11:26,Christine Spang,"[client-app] Differentiate APIError by URL also

Summary:
We have a bunch of different endpoints and it'd be helpful to know which
endpoints are failing, not just which status codes are being thrown. e.g. while
trying to reproduce send failures, I've been able to cause /auth to fail with a
504, but I couldn't tell which endpoint was failing with the 504 until I added
this extra differentiator.

Test Plan: manual

Reviewers: mark, juan

Reviewed By: mark, juan

Differential Revision: https://phab.nylas.com/D4128",False
ee0e0ded3bb0ee93b09cb3a1df4aabdfe7901a55,2017-03-08 07:11:33,Christine Spang,"[client-app,cloud-{api,workers}] Bump raven version

Sentry is complaining that we're sending events using an old SDK.",False
f279898275666741a617d8d7ee5f75d389e904bc,2017-03-08 06:51:29,Karim Hamidou,"Revert ""Revert ""[feat] Add support for send later""""

Arc land messed up and landed a not fully merged branch. (Seriously – I
had merged a copy of my branch with master to see how easy it would be.
Because I didn't want to merge the whole thing, I blindly committed my
changes and switched back to my real branch). To my great surprise, arc
decided to use the wrong branch when landing it.

Original commit message:

Summary:
    Finally, here it is! Send later, with support for open tracking but
without support for attachments yet. It took me some time to find the
right way to do things.

    **The send later dilemna**

    There's two ways we could handle send later:
    1. do everything on the client
    2. process the message in the cloud

    1. is very tempting because it would make the cloud server very
simple. Unfortunately, it has some serious limitations, for example,
setting the ""Date"" message header. That's why I chose to go with 2. When
a user presses the ""Send Later"" button, we save the open/link tracking
metadata and fills in all the required fields. I added a custom endpoint
to the K2 API to do this, `/drafts/build`. After that, we save the JSON
contents of the message as metadata.

    When we process metadata, we simply create a MIME message from the
JSON and send it.

    **Limitations**

    Right now, send later doesn't support and attachments. There's also
some minor code duplication which needs to be refactored away.

Test Plan: Tested manually. Checked that regular send still worked, too.

Reviewers: mark, spang, halla, juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4054",False
9c9a26f7d88dcbfaec094e9b9abc97c44e33853b,2017-03-08 05:48:25,Karim Hamidou,"Revert ""[feat] Add support for send later""

This reverts commit 1f2061e0a7ee9cb268d489a4e5f27be779ccc07a.",False
1f2061e0a7ee9cb268d489a4e5f27be779ccc07a,2017-03-08 05:36:30,Karim Hamidou,"[feat] Add support for send later

Summary:
Finally, here it is! Send later, with support for open tracking but without support for attachments yet. It took me some time to find the right way to do things.

**The send later dilemna**

There's two ways we could handle send later:
1. do everything on the client
2. process the message in the cloud

1. is very tempting because it would make the cloud server very simple. Unfortunately, it has some serious limitations, for example, setting the ""Date"" message header. That's why I chose to go with 2. When a user presses the ""Send Later"" button, we save the open/link tracking metadata and fills in all the required fields. I added a custom endpoint to the K2 API to do this, `/drafts/build`. After that, we save the JSON contents of the message as metadata.

When we process metadata, we simply create a MIME message from the JSON and send it.

**Limitations**

Right now, send later doesn't support and attachments. There's also some minor code duplication which needs to be refactored away.

Test Plan: Tested manually. Checked that regular send still worked, too.

Reviewers: mark, spang, halla, juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4054",False
a482961f7aed5f5ffdec1fa218dd0f0052d5da0b,2017-03-08 04:45:52,Juan Tejada,[client-app] :art: rename for consistency,False
fdc4a92aeb03e09745fd0421c9aa7e1e3aa99b19,2017-03-08 02:03:29,Juan Tejada,[none] (dev) Fix script name,False
68d12a95ba25dd618d882aec10e584f65268191e,2017-03-08 01:30:35,Mark Hahnenberg,"[env] Don't generate sourceMapCache in prod mode

Summary:
Keeping a sourceMapCache uses a great deal of memory. Don't do it if we
don't have to.

Test Plan: Run locally, verify that we no longer generate a sourceMapCache

Reviewers: evan, juan, spang

Reviewed By: evan, juan, spang

Differential Revision: https://phab.nylas.com/D3964",False
f5171adc2091e5e435973df87c4642cbc530ef81,2017-03-08 01:24:50,Evan Morikawa,"[client-app] also upload a next-version to S3 for autoupdate testing

Summary:
We never want to ship the last release we'll ever ship.
This can happen if the new version's autoupdater is broken.
To test this we upload to a version n+1 higher than the current one.

Test Plan: manual

Reviewers: juan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4125",False
b2bf7771840e06322dd2e91a30fe9d299f54d1ec,2017-03-08 01:24:30,Evan Morikawa,"[dev] change npm script names

Summary:
`npm run cloud` felt nicer than:
`npm run start-cloud`

Test Plan: manual

Reviewers: juan, spang, mark, khamidou, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4124",False
a653f01e43f29a24104181ed3c99fe2129c65894,2017-03-08 01:20:34,Evan Morikawa,"[dev] use .cmd versions for Windows

Since spawn on Windows can't accept scripts like exec can :(",False
8a48cf3eb6e311bb215ecf4cc3969cd24e8afea4,2017-03-08 01:13:45,Evan Morikawa,"[dev] fix AppVeyor lerna bootstrap command

Needs to include `.cmd` for windows lerna builds",False
17804c72f2a35fe67b4679d1f7c4672ee7225b34,2017-03-08 01:04:19,Mark Hahnenberg,"[client-sync] Don't throttle message processing when syncing specific UIDs

Summary:
This diff adds a timeout parameter to queueMessageForProcessing that can
be used to override the CPU-throttled-by-default timeout used by the
message processing queue. The FetchMessagesInFolder sync task now
overrides with a timeout of 0 when it is queuing specific UIDs that it
has downloaded. The thinking here is that if we've requested a specific
set of UIDs, it's very important to sync those quickly as this indicates
a higher priority (e.g. initial inbox sync, search result syncing, etc).

Test Plan: Run locally, verify that initial sync and search syncing run faster

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4114",False
313ad4fed19741bb93ec98c68bd32dbaa5ad649e,2017-03-08 01:00:58,Mark Hahnenberg,"[client-sync] Fetch unknown search results

Summary:
When searching using IMAP/Gmail commands we sometimes get back UIDs for
messages that we have yet to sync. Previously we would just ignore these
results, which would decrease the quality search results for quite some
time during initial sync. This diff enables us to eagerly sync the unknown
messages we get back from the provider by creating a syncback task which
interrupts the sync loop and runs a sync task for the unknown UIDs.

Test Plan: Run locally, verify that we sync unknown messages

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4101",False
90de279f2ed7d0e33d4a815c3f3fde604cea1374,2017-03-08 00:41:16,Evan Morikawa,"[*] use hardlinked .babelrc for AppVeyor

Since babel-node won't work on AppVeyor if the babelrc is symlinked",False
a8a553d52232e3dffbdf86550c419fde255da1bf,2017-03-07 15:12:13,Juan Tejada,[client-app] Update changelog,False
89ced414248868bbe46df748de05d88feb2742ac,2017-03-07 14:15:45,Juan Tejada,bump(version) 1.0.32,False
dd2730cba75408ba25c9b7e39578cfba281b6b0a,2017-03-07 13:54:07,Juan Tejada,wip,False
f6312573e01a58d694b7d8e32606a60055f84380,2017-03-07 02:29:09,Juan Tejada,[client-app] :art: DRY a few lines of code,False
4af5b713924e78d866ca2f861476a61fcaf3f62b,2017-03-07 02:21:38,Juan Tejada,"[client-app] Report provider when reporting remove-from-threads-from-list

Summary: see title

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4103",False
dc1527956afbc6eb84f06518d43fd709d02b5802,2017-03-07 02:20:57,Juan Tejada,"[client-app] Report provider when reporting send perf metrics

Summary: see title

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4102",False
ad566813f07163d08171b05be5462757f2f6eeb7,2017-03-07 02:05:56,Evan Morikawa,[client-app] use forked lerna for better npm logging,False
2413f59b1c411c602869bd59251d1bb0fd8904e0,2017-03-07 01:06:03,Juan Tejada,"[client-app] Fix build, add jasmine to iso-core deps",False
a34cf8fb07d1ae7e03972210b8371ce735161994,2017-03-07 00:43:12,Evan Morikawa,[*] remove travs_wait now bootstrap more verbose,False
649b5555211bf8bcbbbc87d1a1a527ffbf7f76e6,2017-03-07 00:26:20,Juan Tejada,"[client-app] Add basic rate limiting to Sentry

Summary:
This commit adds a new option to the `reportError` interface to allow
to rate limit specific kinds of errors that are known to be reported a
lot if they fall in a loop for example.

For now, it only allows to impose a fixed reporting rate per hour for a specific
error, and will not report any errors past that rate before an hour has
passed.

Depends on D4099

Test Plan:
manually check that it reports and does not report errors based on the rate
limit data passed

Reviewers: khamidou, mark, evan, halla, spang

Reviewed By: evan, halla, spang

Differential Revision: https://phab.nylas.com/D4100",False
d20700e06817888fdd2742cc605b64700820163c,2017-03-06 23:25:25,Juan Tejada,"[client-sync] Improve reporting of refresh access token errors

Summary:
Add better messaging and logging to the console.

Depends on D4098

Test Plan: manual

Reviewers: evan, khamidou, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4099",False
12256ad0a1c8ce3bd4e4aedd305485fe8d8069c0,2017-03-06 23:24:51,Juan Tejada,"[client-sync] Don't double report refresh access token API errors

Summary:
Given that NylasAPIRequest reports all APIErrors for requests that
return 5xx, we were double reporting access token errors, which caused 2
groups in sentry and makes it difficult to track.

This commit removes the extra reporting for that error in the sync loop

Test Plan: manual

Reviewers: evan, khamidou, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4098",False
ec3f39f4ce5af7c034bca3e1dde7a0ae89535ecd,2017-03-06 23:20:47,Juan Tejada,"[client-sync] Sync accounts when app comes back online

Summary:
Given that we backoff exponentially in the sync loop when we encounter
RetryableErrors (e.g. network errors), if the app goes offline and
reaches the maximum retry backoff of 5 minutes, and if then the app comes
back online, in the worst case, the sync loop will idle for 5 minutes before trying to
sync, which is undesireable.

To mitigate this, everytime we come online we can wake all of the sync
workers. This shouldn't have any adverse effects

Test Plan: manual

Reviewers: evan, mark, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4097",False
82cd2d91e3bacd4c7f25f9fe91e8f46b18fe0287,2017-03-06 22:47:30,Evan Morikawa,[*] increase loglevel for lerna bootstrap,False
5ecd9346e728812c33cfe44962473f1dd565d267,2017-03-06 22:45:17,Juan Tejada,"[client-app] Include node-mac-notifier in build

Summary:
Given that `lerna bootstrap` does not install optional dependencies, we
need to manually run `npm install` inside `client-app` so
`node-mac-notifier` get's correctly installed and included in the build

See https://github.com/lerna/lerna/issues/121

Fixes T7887

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Maniphest Tasks: T7887

Differential Revision: https://phab.nylas.com/D4076",False
3bed544fed783072b9279a65f03836d64f747190,2017-03-06 22:07:01,Evan Morikawa,[*] add `travis_wait` to build,False
1b6fd1a6c0e9597613fef2c72b8e206adb0d1d62,2017-03-06 20:12:59,Evan Morikawa,[client-app] resolve symlinks in spec,False
b8c9aaccfdb81440458af2428ea7fac63c559f6a,2017-03-06 12:47:20,Juan Tejada,"[client-sync] Use ExponentialBackoffScheduler for sync loop retries

Summary:
This is mostly to clean up the logic here a little bit.

Specifically:

- The backoff when encountering retryable errors is now truly exponential
- When encountering a permanent error, we back off for a minute
- If we don't encounter consecutive RetryableErrors, we clear the exponential backoff. Previously, we would just clear it when sync completed without errors.

Test Plan: manual

Reviewers: khamidou, spang, evan, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4086",False
bc53fb958a388d885f419aa28259de6f4885924e,2017-03-06 12:44:49,Juan Tejada,"[client-app] Prevent noisy uncaught errors when closing long connection

Summary:
This commit makes it so we /always/ catch errors thrown in the request
established inside `NylasLongConnection`. Specifically, it catches an
uncaught `socket hang up` error which is flooding Sentry unnecessarily
(https://sentry.io/nylas/nylas-mail-old-1030/issues/213178758/).

This error is thrown when the long connection is manually ended before
any data was received from the request (which happens most times during
search when you clear the search query).

The problem was that when we end the long connection, we remove all event listeners
from the request, and /then/ the error is thrown, at which point there is no error
handler to catch it. The solution is simply to always have an error handler attached to
the request object.

This commit also adds extra error handling that seems to have been missing.

Test Plan:
manually check that delta connection is still working, and that error
is no longer thrown when you search and then immediately clear the search

Reviewers: mark, evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4096",False
a09d706e607e394a03410a4cdb3ee49fa47c8ac2,2017-03-06 12:43:44,Juan Tejada,"[client-app] Correctly listen and report `abort` and `aborted` events in NylasAPIRequest

Summary:
We want to listen to both `abort` and `aborted`

- `abort` happens when we manually abort a request client side, so we don't want to report this to sentry
- `aborted` happens when the server aborts the request, so we /do/ want to report in this case

Test Plan: manual

Reviewers: spang, mark, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D4073",False
5ee3b889af4d3b2b3a1b0da232cc3f94b70ffa97,2017-03-04 03:58:59,Evan Morikawa,[client-app] fix hardcoded babelrc path for appveyor,False
99da583c5c726b0715c11d62586edc15bdfe819a,2017-03-04 03:52:38,Evan Morikawa,"[client-app] update appveyor

Summary:
This updates the appveyor file to get the app building on windows too!

See https://ci.appveyor.com/project/nylas/nylas-mail-all

Test Plan: Run https://ci.appveyor.com/project/nylas/nylas-mail-all

Reviewers: juan, spang, jerm

Differential Revision: https://phab.nylas.com/D4000",False
756fabaeea262d44882b97819d3c638039d35287,2017-03-04 03:47:39,Evan Morikawa,[isomorphic-core] move devDependencies from iso-core to repo root,False
90481f8dc6a8c13b07bb05fc024e5d57045d533f,2017-03-03 07:26:09,Evan Morikawa,[client-app] fix keychain issue on OSX build,False
6ba39639326a3efc8ff556d272537b4c46afc210,2017-03-03 06:57:07,Mark Hahnenberg,"[client-sync] Refactor GmailSearchClient to use X-GM-RAW

Summary:
Previously we used the Gmail REST API to get search results. This API
returns the X-GM-MSGID which is different from the folder UID. Gmail also
offers the X-GM-RAW extension for IMAP's UID SEARCH command which allows
us to pass through the raw search query. This enables us to vastly
simplify the GmailSearchClient by having it subclass ImapSearchClient
and override a few select methods. Yay!

Test Plan: Run locally, verify that Gmail search queries still work

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D4094",False
936c22ff7e88420e995e13d7ec7b068aacc2e9aa,2017-03-03 06:50:50,Christine Spang,"[client-private-plugins] Update Sentry DSN

Summary:
Previous releases contained errors that were spamming our Sentry project
and running us out of quota. Sentry.io supports rate limits per project,
so in order to ensure quota availability for new releases, we are
switching to a new Sentry project in conjunction with adding client-side
rate limiting for errors that could be submitted repeatedly in a loop
(sync loop errors, API errors etc.)

Test Plan: ship it

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4092",False
4504a1e8b0aaa8a00fc310fc30b8672119bd74ab,2017-03-03 04:20:35,Mark Hahnenberg,"[client-app] Add proper IMAP search backend

Summary:
Previously for IMAP we just grabbed the search text and fed it into a TEXT
query. Now we have a proper backend that generates the appropriate
search criteria according to the IMAP spec. Important to note that we
don't support 'in:' yet, which is complicated due to the way that IMAP
search is scoped to the currently selected folder.

Test Plan: Run tests, run locally and verify IMAP search still works.

Reviewers: evan, juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D4071",False
dc933b9480e3db00ccb0edd562275be29be06520,2017-03-03 04:15:34,Juan Tejada,"[iso-core] :art: Rename imap-pool.es6 to imap-connection-pool

To be consistent with the name of the exported module",False
08513d2113ed6418c9528424cc597de6c0c00c0e,2017-03-03 01:40:50,Juan Tejada,bump(version) 1.0.31,False
3497bc30bd92a9ed6b5de72bd43a14e33ca54e43,2017-03-03 00:26:03,Halla Moore,"[*] Change the symlink location for the isomorphic-core specs

Summary:
Put them in the client-app/spec folder instead of
client-app/internal_packages

Test Plan: Ran the tests

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4080",False
c811d8446d761e52e391bba7f2e6646a066517d1,2017-03-02 23:22:30,Halla Moore,"[client-app, client-private-plugins] Update the pending send-reminders UI

Summary:
- Add an icon to threads that have reminders set
- Show the pending reminder message header in all perspectives, rather than
    just the Reminders perspective
- Add the ability to clear the reminder from the message header
- Condense the message header text

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Subscribers: sdw

Differential Revision: https://phab.nylas.com/D4052",False
a41f8bb32a2522dbb0c4748ba2ac60919b3f458f,2017-03-02 06:49:21,Juan Tejada,"[iso-core] Fix IMAPConnection.openBox

Set _isOpeningBox to true at the right moment",False
701a913f2a12e8c520c1631d9d6d1cf29d3677c6,2017-03-02 06:27:03,Juan Tejada,"[none] Update .eslintrc

Ignore `no-unresolved` errors when importing from isomorphic-core",False
e8f14a1e1fc9667d9917fb39c60553ddfba15664,2017-03-02 05:18:16,Juan Tejada,[client-sync] :art: lint errors,False
1dbd4accda0c1b6c314a72ff1ea52c967bc975cc,2017-03-02 04:57:21,Juan Tejada,"[cloud-*] (imap) :art: Fixup imap settings resolution in gmail auth

Summary: `generateXOAuth2Token` seems to be better placed inside gmail-oauth-helpers

Test Plan: none :(

Reviewers: khamidou, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D4048",False
eac121fe8b04576f9c40bb2577f681a6df4cf68a,2017-03-02 04:55:10,Juan Tejada,"[iso-core] Protect from operating on IMAP connection while opening a box

Summary: See title

Test Plan: manual

Reviewers: spang, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4072",False
93b1dceddf9083283c5c6139c9c280c5ea17ee01,2017-03-02 04:26:25,Juan Tejada,"[client-app] Report 100% of search performed events

Summary:
Gleb mentioned that we need the sample size of search events to be
bigger, so let's report all search events

Test Plan: manual

Reviewers: evan, gleb, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4077",False
e511970790a73804d026a0cbdb70f197b6541607,2017-03-02 03:36:00,Juan Tejada,[client-app] Correctly import nylas-api-helpers,False
03c79539426a7ac1c2d299235e687d1cef3944a2,2017-03-02 01:54:58,Mark Hahnenberg,"[client-sync] Scale sync batch size based on folder SELECT duration

Summary:
If it's expensive for us to SELECT a folder (which happens a lot for
large gmail accounts), we should try to sync more messages so that we
don't waste a ton of time SELECT-ing during initial sync. This speeds up
initial sync quite a bit.

Test Plan: Run locally, verify batches are properly computed

Reviewers: evan, juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D4050",False
e3ecc19c15f290211439d19a95729284377ba052,2017-03-02 01:46:54,Evan Morikawa,"[client-app] replace `setImmediate` with `setTimeout` as Promise scheduler

Summary:
This changes the scheduler from `setImmediate` to `setTimeout`. The HUGE
difference is that Chrome's async stack traces works with `setTimeout` but
does NOT work with `setImmediate`. These two functions are adjacent to
each other in the Node event loop, so nothing should depend on the change
in ordering.

Test Plan: manual

Reviewers: mark, spang, halla, juan

Reviewed By: spang, halla

Differential Revision: https://phab.nylas.com/D4068",False
eff0202c748641addfbc5d2d00767601437d2651,2017-03-02 01:45:46,Evan Morikawa,"[client-app] use new Bluebird preferred `longStackTraces` syntax

Summary: Bluebird changed the way you call `longStackTraces`. This uses the latest

Test Plan: manual

Reviewers: spang, halla, juan

Reviewed By: spang, halla

Differential Revision: https://phab.nylas.com/D4067",False
f2e16b16e4c62778fad7a38f32ce32dc0735c081,2017-03-02 01:45:18,Evan Morikawa,"[client-app] remove unused async message body loading & `returnsModel`

Summary:
We no longer optimistically fetch messages when we load their bodies. We
always get the full message with bodies returned via the in memory delta
stream

Test Plan: manual

Reviewers: spang, halla, juan

Reviewed By: spang, halla, juan

Differential Revision: https://phab.nylas.com/D4066",False
0e133b8adcc8f41a5956a10ca1b725b3c955f18a,2017-03-02 01:43:08,Evan Morikawa,"[client-app] deprecate `returnsModel` param for `nylas-api-request`

Summary:
We no longer need to use the `returnsModel` param since we get all of our
models through the in memory delta stream. There were a ton of places
unnecessarily passing `returnsModel: false` when it defaults to false in
the first place

Depends on D4057

Test Plan: manual

Reviewers: halla, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D4065",False
f2aeaca7482ae38ea89a42cf90e430af93e88ae9,2017-03-02 01:42:28,Evan Morikawa,"[client-app] deprecate `ensureOnce` for NylasAPI requests

Summary:
We no longer use the `ensureOnce` bit.

Depends on D4057

Test Plan: manual

Reviewers: spang, halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D4064",False
d7e4007f4014e50d997eb3e408900577a1d6237f,2017-03-02 01:41:59,Evan Morikawa,"[client-app] deprecate `beforeProcessing` in `nylas-api-request`

Summary:
This removes the last reference to a now unused `beforeProcessing` feature
of the Nylas API Request.

Depends on D4057

Test Plan: manual

Reviewers: spang, halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D4063",False
6009914acd9f0616655714ab677c2b0a25ee1342,2017-03-02 01:41:13,Evan Morikawa,"[client-app] have account store handle API auth errors

Summary:
The old  NylasAPIRequest helper class used to do all sorts of run-time
requiring to attempt to notify of auth errors when 401s and 403s came up
in a request. We now move that logic to the AccountStore where it belongs.

Depends on D4057

Test Plan: Manual

Reviewers: spang, halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D4060",False
ea64f7901fc383a00c81a441c79efbf175a201ae,2017-03-02 01:40:38,Evan Morikawa,"[client-app] refactor nylas-api-request

Summary:
This greatly refactors the NylasAPIRequest object to be more single
purpose, easier to read, async-ified.

It also fixes issues where long stack traces weren't being reported bcause
`reportError` was being called before the error had time to make it
through Bluebird's rejection handler (which adds back in the long stack
traces).

This also fixes an issue where ignorable errors (like 404s,
ESOCKETTIMEDOUT) were being reporting to Sentry.

This also fixes subtle conditions where the request run would throw mixed
error types (sometimes regular `Error`s, sometimes `APIError`s).

The old class used to handle logging people out on 401s. This is now moved
to the AccountStore in a different diff.

We've also deprecated the `returnsModel` param in a separate diff.

This deprecates the `PriorityUICoordinator` since we no longer need to
worry about frequently making expensive API requests to pull down data
like we used to in the old cloud-based API.

This deprecates `ensureOnce` param in a separate diff.

Test Plan:
Manually boot app. Check regular 404s don't throw. Check requests get
through. Check special ESOCKETTIMEDOUT type errors are properly handled

Reviewers: juan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4057",False
1dda0d36171193220c3dd710d9e626cdc71c0135,2017-03-02 01:23:03,Mark Hahnenberg,"[client-app] Refactor search query codegen into proper backend

Summary:
Previously we were using the raw visitors that were confined to the flux
attributes directory. We're going to add more search query backends, so this
is mostly just moving things to a new, more general place.

Test Plan:
Run locally, verify parser specs still work, verify in-app search
still works.

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4053",False
a461efe76fd1456be5cd8ae872e102e52bfcf9cb,2017-03-02 00:42:10,Halla Moore,"[*] Add cloud specs to node scripts

Summary:
Implements `test-cloud` to cd into each cloud package and run `npm test`.
It's easier this way because of the relative paths in the Jasmine configs,
and this also ensures that the tests can always be run within their
individual packages too.

Also calls `test-cloud` from `test` so people don't forget about it. If
someone wants to test just the client, they can explicitly do so with
the `test-client` script.

Depends on D4058, D4059, D4061, and D4062

Test Plan: Ran the tests

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4031",False
35e693c7e5d91783468acb00d284b35e106436db,2017-03-02 00:40:41,Halla Moore,"[isomorphic-core] Make sure specs can run without electron

Summary:
Isomorphic-core should be functional outside of the client environment

Depends on D4056

Test Plan: Run the test suite

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D4062",False
7203870879db02d1b64555578113a0daf7da4bd5,2017-03-02 00:40:09,Halla Moore,"[cloud-workers] Implement spec runner

Summary: Depends on D4056

Test Plan: Run the (non-existent) test suite (and see that it ran 0 of 0 tests)

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D4061",False
e0cc52fb22be6c4317e6023ca38b689033ce354d,2017-03-02 00:39:39,Halla Moore,"[cloud-core] Run specs without electron

Summary: Depends on D4056

Test Plan: run the test suite

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D4059",False
96c327f0a3b24c081747e35e99871512050220de,2017-03-02 00:39:07,Halla Moore,"[cloud-api] Fix specs now that Jasmine files are in isomorphic-core

Summary: Depends on D4056

Test Plan: run the suite

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D4058",False
cfe29db3b96295553c057bb09d4a821035a93626,2017-03-02 00:38:37,Halla Moore,"[*] Move Jasmine setup into isomorphic-core

Summary:
Move the base Jasmine spec runner into isomorphic-core to prevent
code duplication. Jasmine will look for the config file relative to
the directory it's being run in though, so we need to symlink the
config file into each package that will need it.

Test Plan: Run tests once the suites are integrated

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D4056",False
cf56bfc2245c7369d76d1e08719e239679238f2e,2017-03-02 00:37:48,Halla Moore,"[*] Run the isomorphic-core specs as part of the client test suite

Summary:
Convert the isomorphic-core specs to Jasmine 1 and symlink them into
client-app/internal_packages so they are run as part of the client
test suite.

Test Plan: Ran the suite with fdescribes in iso-core to ensure they were being called properly

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D4055",False
51b32f974b07b694443877ed66d6faddaa19232b,2017-03-01 21:41:00,Christine Spang,"[client-sync] Enable logging in prod builds

Summary:
Disabling verbose logging in production builds just makes it harder to help our
users help us fix their problems.

Test Plan: run app without --dev

Reviewers: mark, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4070",False
d23b4ff37908a791d6ec9301a65ec4ec66c7663d,2017-03-01 05:12:23,Christine Spang,[none] Make deploy-it support -h/--help,False
a4ca416d9e8f2bd7a77f5a840f85fc8e538eaf58,2017-03-01 03:37:52,Juan Tejada,"[client-app] Fix measurement of thread-list action metrics

Summary:
We detect when a thread is removed from the thread-list by listening to
`Actions.threadListDidUpdate`. However, we were not firing the action at
the correct moment.

Before this commit, we fired the action on the root `ThreadList`'s
`componentDidUpdate`, however did this not actually fire when the
child list actually updated/removed threads from the list.

This sort of used to work because before 1067dc3125b58c0470aab4e5f31a1e20772b2e16
the root ThreadList component re-rendered all the time, so it fired the
action, but after initial sync, we would never actually report any
thread-list action metrics at all

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4051",False
3b52f92b1d7b17e56ec0678a5b4c0063a65e3733,2017-03-01 03:02:29,Karim Hamidou,"[deployment] Add a `deploy-it` script for our EB services

Summary: This is a simple wrapper around `eb-deploy`. It checks that you're using the `production` branch when deploying to a production service. It also creates a tag whenever you make a new deploy so that we can track them.

Test Plan: Tested manually.

Reviewers: spang, juan, jerm

Reviewed By: jerm

Maniphest Tasks: T7870

Differential Revision: https://phab.nylas.com/D4045",False
86bb043eca57501ae0adad82f41901f351c1d712,2017-03-01 02:49:34,Juan Tejada,[client-app] Update changelog,False
acc4172a3b1ae519cbdc285d5c847383db4008a9,2017-03-01 02:08:14,Christine Spang,"[client-app] Actually fix send+archive

The previous fix only worked by coincidence. It turns out that we don't have
the right data to associate draftClientId with ChangeMailTask on task
creation, so we have to either look up this data inside the dependency
function or make the dependency check looser.

This check gets run all the time, so we chose to make the check looser
rather than putting a db call in here and changing the interface to support
an async version of isDependentOnTask().

This patch also makes it so that the fix works properly when Undo Send
is enabled.

Fixes T7889",False
a7afc1d1c7877d3007cb6e8dd4c30c6cabefa744,2017-03-01 01:42:39,Christine Spang,"[client-app] Fix ChangeMailTask dependency on SendDraftTask

Because ChangeMailTask only depended on EnsureMessageInSentFolder task,
if a user sent a message & then archived it before the send completed,
the ChangeMailTask could run in between the SendDraftTask and
EnsureMessageInSentFolderTask and fail because it's
EnsureMessageInSentFolderTask that detects the new UID for the message.

Fixes T7889",False
b295afeb580c2714021db83ac55b9f7522bf22fd,2017-03-01 01:42:39,Christine Spang,[client-sync] Fix wording in comment,False
26ae0ad3ee8d9546d0970dc15788e9fd1e40a531,2017-03-01 01:42:39,Christine Spang,[client-sync] Add check for syncWorker to SyncbackTaskRunner,False
ca5bf6d237b5813107eb98e37c5aebe00b45be4b,2017-03-01 01:42:10,Juan Tejada,[client-app] Update changelog,False
3611ac5e4710a086e90b2924a653e166569c12b0,2017-03-01 01:18:28,Juan Tejada,bump(version) 1.0.30,False
d9e05b4315dc166dac0de936329bcb0c70f57fc6,2017-03-01 00:56:58,Juan Tejada,[client-app] Fix EnsureMessageInFolderTask - no need to get acct from imap connection,False
4f0d1623d9fe64646e9df37c942c5f1c99869209,2017-03-01 00:51:42,Halla Moore,"[cloud-api] Fix spec with expirationDate -> expiration

Summary: The codebase uses `expiration` instead of `expirationDate`

Test Plan: ran the tests

Reviewers: evan, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4028",False
3511e7407e0025ef9c56fc5532325b70f66883ba,2017-03-01 00:46:37,Juan Tejada,[iso-core] Fix typo in IMAPBox,False
4cc4756e0fca5dc349f4bf979f4429de1933467e,2017-03-01 00:39:17,Evan Morikawa,[client-sync] add assertion about Reference not cleaned up properly,False
8541c3db1c656300a8659d03e23418e53ca922e2,2017-03-01 00:37:44,Juan Tejada,"Revert ""[client-app] Limit search to focused perspective""

Temporarily reverting this commit for 1.0.30 release.
See https://phab.nylas.com/T7910 for details
This reverts commit 7ad65558907219d685a3ff0a1a9a9f53c6ffb62b.",False
42a94dc35664f9f04d51c97fba9e2c44a2662708,2017-03-01 00:27:29,Evan Morikawa,[iso-core] imap-connection properly resolves `this`,False
b5133576ebbef647ef0bcc7a0e597fe7fabf2603,2017-03-01 00:13:49,Evan Morikawa,[iso-core] imap-box.js -> imap-box.es6,False
59b6a24158be8938c2602181bf15bce93634340b,2017-03-01 00:05:58,Juan Tejada,"Revert ""[client-app] Properly re-index threads when their data has changed""

Temporarily reverting this commit for 1.0.30 release because it is causing
performance issues: https://phab.nylas.com/T7910

This reverts commit 51191b76721bc1dbcc7d81d8753f7cdffb28dce3.",False
7a25b1c4123c4e6eed154087198352575b0c68f9,2017-02-28 23:57:58,Juan Tejada,"[client-app] Remove contact support btn from red box

Summary: See title

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4049",False
1067dc3125b58c0470aab4e5f31a1e20772b2e16,2017-02-28 23:34:31,Juan Tejada,"[client-app] Prevent unnecessary re-rendering of thread-list

Summary:
This commit adds a `shouldComponentUpdate` to thread-list.cjsx so that
the thread list doesn't unnecessarily /try/ to re-render when state or
props haven't actually changed.

I noticed this because the thread list was constantly calling `render`
even though it didn't render any changes to the DOM. This was caused
because it listens to `NylasSyncStatusStore` which constantly triggers,
even though the piece of state the list is interested in rarely changes,
causing unnecessary calls to the `render` loop.

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4047",False
904b622c1d1ec06b2374658f492dcd51a1c4922e,2017-02-28 23:30:12,Juan Tejada,"[iso-core] Loosen checks for detecting retryable errors + add new one

Summary: see title

Test Plan: manual

Reviewers: evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D4046",False
cc85d350b54856649688576fb83d38b2cbd96690,2017-02-28 23:28:10,Juan Tejada,"[iso-core] (imap-P3) Fixup IMAPConnection and IMAPBox

Summary:
This commit is an attempt to cleanup duplicated code and crufty code
inside IMAPConnection and IMAPBox

Specifically:
- It replaces `_createConnectionPromise` with a more aptly named (imo) `_withPreparedConnection` helper, which provides the user a node-imap connection that will correctly time out and handle `error` and `end` events. Most of these changes are just changing existing code to use the new interface.
- Adds a subtle change to how we handle `end` and `error` events on the connections. Previously, we manually called `this.end()` on `error`, but not on `end`. From what I could gather from the old comment documenting `_createConnectionPromise`, we should /also/ call `this.end()` on `end` because node-imap doesn't clean up correctly and can leave the connection hanging (taking care not to introduce a recursion loop by `end`ing on `end`). Additionally, it no longer listens to the events via `once` but via `on`, which should be okay given that the listeners get cleared at the end.

This /might/ fix some instances of sync freezing up (T7837).

Depends on D4035

Test Plan: manual -- this really needs some unit tests :cry:

Reviewers: spang, halla, mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4036",False
604717ba38f0e3007a60865cc49cce5c8027de3c,2017-02-28 23:11:21,Juan Tejada,"[iso-core] (imap-P2) Actually fix constant socket timeout errors :cry:

Summary:
Remember how we made it so imap socket timeouts would increment up to 10m if
we constantly got timeout errors? Remember how we told everyone in
https://github.com/nylas/nylas-mail/issues/3232 that we'd fixed their problems, but they weren't actually fixed?

Well, we weren't /actually/ applying the correct timeout value. :cry:

Depends on D4033

Test Plan: manual

Reviewers: spang, halla, mark, evan

Reviewed By: mark, evan

Differential Revision: https://phab.nylas.com/D4035",False
3a4d5bbb867deda3cac12ba6ab84f71163213215,2017-02-28 22:51:09,Juan Tejada,"[iso-core] (imap-P1) :art: Fixup settings resolution in IMAPConnection

Summary:
The way it was set up was a little smelly.
- `this._settings` were /not/ the actual settings. Now, internally we have access to `this._resolvedSettings`
- `this.resolvedSettings` was being set kind of out of nowhere (gmail-oauth-helpers needs it, hence adding a getter instead)

Test Plan: manual

Reviewers: spang, mark, evan, halla

Reviewed By: mark, evan, halla

Subscribers: khamidou

Differential Revision: https://phab.nylas.com/D4033",False
50320ab3d513a4d4f7b214029adb9cd40146f722,2017-02-28 22:44:28,Juan Tejada,"[client-app] Fix selecting and creating signatures in preferences

Summary:
This commit fixes 2 issues with signatures in the preferences:
- Creating a signature (via any of the create buttons) would create 2 signatures
- Trying to select accounts to associate with a signature in the preferences would not work (the account would not be selected)

This was a regression introduced in https://github.com/nylas/nylas-mail-all/commit/3111c166b8c949cf2a5ef60392d83a53e782ebed#diff-4f38fd25aa24b48a309354be643165d3R26

3111c16 made it so we attempt to `activate` any Stores that are registered with
the StoreRegistry. When adding stores to `nylas-exports`, they are
automatically registered in the StoreRegistry. Given that the
`SignatureStore` is in `nylas-exports`, and consequently is registered in
the StoreRegistry, it would be `activate`d upon window boot.

However, we were also manually activating it inside `internal_packages/composer-signatures/lib/main.es6`.
This caused it to register listeners for every action **twice**. For
this reason, 2 signatures would be created when trying to create 1, and
an account would be immediately unselected after being selected int he
signatures dropdown in preferences.

(Other changes in this are just stylistic)

Test Plan: manual

Reviewers: spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4043",False
522a5927bd367263619717c4e8ac468cd90bb261,2017-02-27 00:06:31,Juan Tejada,[client-sync] Fix missing pass in of syncWorker in EnsureMessageInSentFolder,False
db5da93f053c83a0c90bdeada7f729c31149bfe7,2017-02-25 02:39:32,Mark Hahnenberg,"[client-sync] Use IMAPConnectionPool in client sync worker

Summary: See title

Test Plan: Run locally, make sure sync still works

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D3998",False
6526cb9378c9b3a29a96e97a4666cf6bd1c74284,2017-02-25 02:19:37,Christine Spang,[client-sync] Fix missing pass in of syncWorker to FetchNewMessagesInFolder,False
b3dca236c8b5f5ad3cefb4f9f5a185b4e54ae17c,2017-02-25 00:34:18,Evan Morikawa,"[client-sync] limit attributes returned for messages

Summary:
I did a grep for `Message.find.*` to see if there were any other places
we could limit the attributes returned

There were.

This used to be INSANELY wasteful to return all bodies when we only needed
the ids.

Test Plan: Manually bootup app and ensure search still works

Reviewers: mark, juan, spang

Reviewed By: mark, juan, spang

Differential Revision: https://phab.nylas.com/D4042",False
fc1f3d20723ff416cd72a99b215624839c30c525,2017-02-25 00:28:21,Evan Morikawa,"[client-sync] fix unbouded query

Summary:
Fixes T7783

This unbounded query, plus a yet-to-be-diagnosed bug causing large numbers
of messages with no folderIds, led to frequent crashes of the worker
window at the end of every sync loop.

This took a fair amount to diagnose. Notes on that are here:
https://paper.dropbox.com/doc/Diagnosing-Crash-X329VTxevrqtIMESBtHNV

Huge thanks to @mark.

Test Plan: Reboot app with patch, no more crashes!

Reviewers: spang, halla, mark, juan

Reviewed By: mark, juan

Subscribers: mark

Maniphest Tasks: T7783

Differential Revision: https://phab.nylas.com/D4039",False
87e80482327b65e0d3b9b2d3566346be526cd7c7,2017-02-24 08:28:13,Christine Spang,"[client-sync] Parse comma-separated References properly

This goes against the spec, but we've seen emails which use comma-separated
References instead of space-separated references. This could cause threading
to break if the message with comma-separated references was a reply and
we hadn't yet synced the message directly in the In-Reply-To header.",False
51191b76721bc1dbcc7d81d8753f7cdffb28dce3,2017-02-24 07:22:09,Juan Tejada,"[client-app] Properly re-index threads when their data has changed

Summary:
When we detect that threads in the database have changed, if they've already
been indexed, mark them as unindexed so that the indexer picks them up and
re-indexes them with the updated data

Test Plan: manual

Reviewers: evan, spang, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4023",False
625d4c8d77dbdf188107417f1ba2eae2d34c8fa8,2017-02-24 07:16:15,Juan Tejada,"[iso-core] Fix imap error detection/coercion (again)

Summary:
If for whatever reason we passed an error with a `source` property
we weren't accounting for in `convertIMAPError`, we would return an
`undefined` error. Bad!

Instead, just return the original error

Test Plan: manual

Reviewers: spang, halla, evan, mark

Reviewed By: evan, mark

Differential Revision: https://phab.nylas.com/D4037",False
d4ec7f491af0ca5c6c74a3fe014cb18c3782c385,2017-02-24 07:12:27,Juan Tejada,"[client-app] When reporting search metrics, clip all times to a range

Summary:
When reporting different times to mixpanel other than `actionTimeMs` via
recordPerfMetric, we also want to clip those times to a range to have
good data in mixpanel

This commit adds an extra option to recordPerfMetrics to be able to clip
data other than the default `actionTimeMs`, and uses the new option to
report search metrics

Test Plan: manual

Reviewers: spang, evan, halla, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4038",False
ee9cc39fdc7c2bbb07d81952db73d82388ac8cc5,2017-02-24 07:11:14,Juan Tejada,"[client-app] Fixup analytics store

Summary:
Given that we no longer report analytics or metrics in dev mode, it
doesn't make sense to include that property when reporting to mixpanel.

Otherwise, it might cause confusion to future readers of this code as to
why we are sending `inDevMode` data if we never reach that code path when we
are in dev mode.

If we want to restore this in the future, we can just revert this
commit.

Test Plan: manual

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4027",False
cefb8e98cd766244b9d32a0b02cfb62acecb6ec6,2017-02-24 07:10:22,Juan Tejada,"[client-app] Sample metrics reporting of actions we're keeping track of

Summary:
I'm making these up based on gut feeling, so feel free to completely change
these.

Test Plan: manual

Reviewers: spang, mark, evan

Reviewed By: mark, evan

Differential Revision: https://phab.nylas.com/D4026",False
5e950967cbf9ccfeec4709f788dd18ecab21f982,2017-02-24 06:29:46,Juan Tejada,"[client-app] Add sampling to `recordPerfMetric`

Summary:
recordPerfMetrics now takes a new arg, `sample`, which represents the
sample size of metrics to actually report, as a percentage

Test Plan: manual

Reviewers: mark, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4024",False
e849dc54b0ae0a6661e3e33ecee560ea2bce7c27,2017-02-24 06:05:33,Juan Tejada,"[client-app] Fix passing in nylasId and accountId to report metrics

Summary: This was really broken

Test Plan: manual

Reviewers: halla, mark, evan

Reviewed By: mark, evan

Differential Revision: https://phab.nylas.com/D4021",False
cb6008a1496515a7798137527e3baa1af742f20a,2017-02-24 05:47:50,Juan Tejada,"[client-app] Report `source` when reporting open times for accts window

Summary: See title

Test Plan: manual

Reviewers: mark, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4020",False
5c28fe358afcbb1b77dc6f8d4dfef9106a896355,2017-02-24 05:32:22,Juan Tejada,"[client-app] Measure and report search perf metrics

Summary: See title

Test Plan: manual

Reviewers: evan, spang, halla, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4019",False
5aeef7861a9f7b7fe74acf76ec3551f4e72e8ffb,2017-02-24 05:31:07,Juan Tejada,"[client-app] Measure and report app boot time

Summary: See title

Test Plan: manual

Reviewers: spang, mark, evan, halla

Reviewed By: mark, evan, halla

Differential Revision: https://phab.nylas.com/D4018",False
9318de14a6292cc1f167a18d1b58e3085e2af7c0,2017-02-24 05:06:35,Christine Spang,[client-sync] Update comment about Gmail inbox prioritization,False
d9f3720c402571a4af023baf310fdcd8eee2bf68,2017-02-24 04:53:28,Christine Spang,"[client-sync] Deduplicate UID downloads across sync loop interruptions

Summary:
Since we only persist updates to fetchedmin/fetchedmax at the end of a
batch, and a batch can contain many messages, if the sync loop is
getting interrupted often we will download the same messages over and
over again and not make much progress in downloading the message
backlog. This patch keeps a set of already downloaded messages in memory
for each batch and skips downloading UIDs we've processed in interrupted
sync loops.

Messages may still be redownloaded across app restarts.

Fixes T7798

Test Plan: manual

Reviewers: juan, mark

Reviewed By: juan, mark

Maniphest Tasks: T7798

Differential Revision: https://phab.nylas.com/D4040",False
7ad65558907219d685a3ff0a1a9a9f53c6ffb62b,2017-02-24 03:06:45,Mark Hahnenberg,"[client-app] Limit search to focused perspective

Summary:
Previously we would always search all mail. Now, if the user has focused
a particular folder we will limit our search to that folder. The inbox
is an exception--it will always search all mail unless the user
explicitly uses an ""in:"" clause.

Test Plan: Run locally, verify that searching folders returns the correct results.

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4032",False
ecfb2d222e8e91b87bc29920de87427540e8ce94,2017-02-24 01:42:13,Juan Tejada,[*] Update gitignore,False
296d69ad0228b4f55b135fee5678f195294fb817,2017-02-24 01:26:31,Juan Tejada,"[cloud-api] DONT Timeout streaming API connections every 15 minutes anymore

This is a temporary commit to prevent connections from being closed
while we release logic to re-establish delta connections after they are closed.

Our infrastructure should be able to support current usage of delta
connections after our fixes to offline notification and infrastructure

This reverts commit 068de72051af899b2b5f7661d57378498f2e733f.",False
e5eb88540613dfa4c2a95376123cdf4f652d27e3,2017-02-24 00:22:14,Juan Tejada,[client-app] Update changelog,False
1a520eb5794bfec27f1b3d568ddd9d9246b4d6b2,2017-02-23 08:00:34,Juan Tejada,"[client-sync] :art: Remove unecessary use of PromiseUtils

Given that this packages lives inside the NylasMail app, it has access
to Bluebird Promises, which already define a .each method.

Using PromiseUtils here is unecessary",False
bf7a2ff1211095c8ceaefd6b391d1724d18a0a67,2017-02-23 07:21:56,Juan Tejada,"[iso-core] Fix imap error detection!

Summary:
We were only detecting and classifying IMAP errors as retryable and non
retryable in a few places, but errors thrown in any of our imap
operations were not being properly passed through our `convertImapErrors` :(

This was broken, oh so broken

Also loosen condition to detect System Errors

Test Plan: manual

Reviewers: spang, mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D4022",False
96643c1665cafa5ca05499f852d99fab0832c807,2017-02-23 06:39:42,Juan Tejada,"[client-app] Measure and record times for opening account windows

Summary: See title

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4017",False
be1a9e16551a820756ef816dc047901531ae9b25,2017-02-23 06:38:31,Juan Tejada,"[client-app] Measure and report composer window open times

Summary: To Mixpanel and Honeycomb.

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4016",False
0e61c9e6dfd218cf5878e578ff0fe71971889d8f,2017-02-23 06:17:15,Juan Tejada,"[client-app] Measure and report task performLocal times

Summary: See title

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D4015",False
3bbd4ba77f385c46b0318cbacffb3183bbbaec98,2017-02-23 06:15:08,Juan Tejada,"[client-app] Measure and report sending times

Summary: See title

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4014",False
d1508ad23d05c4b909fcc0faecfa97e533fc74c8,2017-02-23 06:09:34,Juan Tejada,"[client-app] Measure and report time to select and load a thread

Summary: See title

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4013",False
5f95da2d274f95e76e6d774ff323be6ab1d74476,2017-02-23 06:07:30,Juan Tejada,"[client-app] Report thread-list action perf metrics to Mixpanel

Summary: See title

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4011",False
492d10c492ca47f5651e8d387e136a606d4a503c,2017-02-23 06:06:29,Juan Tejada,"[*] Fixup MetricsReporter

Summary:
Fix errors and inconsistencies in MetricsReporter code like:

- We were modifying the passed in data object in place
- We were accessing NylasEnv without knowing we were in client env to
get the version
- We were creating an incorrect logger instance

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4010",False
c62a5f8e3fb1214c92e943d5082827839ca4b3ce,2017-02-23 06:05:38,Juan Tejada,"[client-app] Add Actions.recordPerfMetric

Summary:
This action will report perf metrics to honeycomb /and/ mixpanel. This
commit also fixes up Analytics Store a little bit

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Subscribers: jerm

Differential Revision: https://phab.nylas.com/D4012",False
b538343a32cb778075739827aebc8109fea18ffe,2017-02-23 06:00:12,Juan Tejada,"[client-app] Don't report to Mixpanel when running in dev mode

Summary: See title

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D4009",False
dafbb9dc962d60bfa91af1bdd4436cc67c221f75,2017-02-23 02:49:45,Evan Morikawa,"[client-app] update Travis

Summary:
Also see:
https://github.com/nylas/nylas-mail-all/commit/1b2464846659eb75d29f86f35c0bfb97c1803ee3
which was hot-pushed to master in order to get Travis building.

We now have two travis files:

1. /.travis.yml
2. /packages/client-app/travis.yml

The first one is alwas in the private repo and runs `npm install && npm
run build-client`. This decrypts our keys and signs, builds, and uploads
to S3.

The second one is designed to live in our yet-to-be public mirror. It will
basically just run `npm install && npm test`.

That way the public one should just about ALWAYS pass (YAY!) except of
course when you break the tests or something in the installer!

Test Plan: Run on new https://travis-ci.com/nylas/nylas-mail-all

Reviewers: jerm, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D3999",False
34030462990db0a3d7c976746afe3e47e5260f5d,2017-02-23 01:39:14,Halla Moore,"[*] Make sure cloud deploy can access .babelrc

Summary:
Now that .babelrc is in client-app, we need to make it an exception in the
.dockerignore file. Additionally, this means that the client-app directory will
exist during the postinstall script in the cloud environment, so we need a
stricter check to figure out if the client-app needs to be built or not.

Test Plan: deployed to staging

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4008",False
8cc90103c7bb5f540b0a630002b2997485b9068f,2017-02-23 00:27:42,Mark Hahnenberg,"[client-sync] Use IMAPConnectionPool for IMAP search client

Summary: See title

Test Plan: Run locally, verify IMAP search still works

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4006",False
eeb3e0e8b02905ee9996db4a6637e45f1c955b3a,2017-02-23 00:25:08,Mark Hahnenberg,"[client-sync] Use IMAPConnectionPool for downloading raw messages

Summary: See title

Test Plan: Run locally, verify we can download raw messages

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4005",False
3927667e8760c78072c408eec92f31dfae936ec5,2017-02-23 00:18:26,Mark Hahnenberg,"[client-sync] Use IMAPConnectionPool for downloading files

Summary: See title

Test Plan: Run locally, verify downloading files works

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4004",False
f6c9d51df75416f211e66b570cf68f18b2cdee2f,2017-02-22 07:35:12,Halla Moore,"[isomorphic-core] Require .default

Add missing `.default` to LibHoney require",False
eff5986af559435712f747f441ac85cb26dc364b,2017-02-22 07:14:23,Juan Tejada,[client-app] Update changelog,False
0a85fa4c8c12b4f31c7dd73381dca680dc5b4c18,2017-02-22 06:09:51,Mark Hahnenberg,"[client-app] Don't compute thread search index size on startup

Summary:
We did this to see if we should clear the index, which no longer makes
sense because the index never exceeds our threshold. Additionally, none
of the other search indexes do this. This was causing us to spend a ton
of time scanning the ThreadSearch table at startup.

Test Plan: Run locally, make sure things are fine

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D4007",False
77cd76e6a9f713586b78830d727e4ef714ee8a0d,2017-02-22 06:06:38,Juan Tejada,[*] Remove bad symlinks,False
32c105bcb2350d959da1f0737224f0ed6a985b7f,2017-02-22 05:54:24,Christine Spang,"[client-sync] Refresh SMTP client when auth credentials change

Summary:
Previously, we would create a nodemailer SMTP transport object when the
sync worker booted up. The transport object would be passed the account
SMTP credentials at the time of object creation. If the Google auth
token later expired, we would continue to try to send mail using the
expired token, resulting in ""Invalid login"" failures.

This patch makes it so we refresh the transport object if the auth token
changes, and also turns on SMTP connection pooling to limit simultaneous
SMTP connections (& maybe make sending multiple messages faster).

Fixes T7891

Test Plan: manual

Reviewers: juan, halla

Reviewed By: juan, halla

Subscribers: mark

Maniphest Tasks: T7891

Differential Revision: https://phab.nylas.com/D3997",False
8d48f5b335c27b7b6f8155a762f931489c9f4606,2017-02-22 05:29:12,Christine Spang,"[iso-core] Fix Office365 sending from the mail app

Summary:
This fixes a regression introduced in D3980 that prevented sending from working
on Office365 and generic IMAP accounts.

Fixes T7892

Test Plan: manual - we could use unit tests for this but need to set up tests for iso-core first

Reviewers: juan, halla, evan

Reviewed By: halla, evan

Maniphest Tasks: T7892

Differential Revision: https://phab.nylas.com/D4003",False
b829f0c882b6d577456c8a4c807e2279ac3f8067,2017-02-22 05:27:38,Juan Tejada,"[client-app] Fix build

Partially revert 32c85ac566c4c97f7c3a79fbfb5785b1833444c6

Symlinking instead of copying the error-logger-extensions prevents the
app from finding the appropriate dependencies required in the error
logger extensions in the main process and in the renderer processes
because globalPaths are only set in renderer processes and /after/
error-logger-extensions are loaded.

We should fix this properly in a separate diff, and move the error
logger to isomorphic-core instead of copying it or symlinking it",False
95cb20293a420381ae3d9a4f441d055a15aea3fc,2017-02-22 05:25:08,Halla Moore,"[*] Rename postinstall.js -> postinstall.es6

The n1Cloud machines try to compile this script, even though they
never run it, and they didn't recognize it was supposed to be es6",False
3a0c3573f3899e90e2f87d5b9846f630d9b3b560,2017-02-22 04:54:21,Juan Tejada,"[client-sync] Fix sending per recipient

Summary: This was broken, oh so broken

Test Plan: manual

Reviewers: halla, spang, evan, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D4001",False
f71a9a8df52274b8e06221736add70b400666f8e,2017-02-22 04:47:54,Halla Moore,"[cloud-core] Detect redis disconnections in the PubsubConnector

Summary:
I'm debugging an issue with send-reminders where the metadata deltas
aren't published after the reminder is processed. The cloud-worker
logs show `AbortError: PUBLISH can't be processed. The connection
is already closed`. This error appears on staging, but not locally.
This diff 1) adds a log statement so I can see when the connection
is actually closed and better determine whether this is bug in the
send-reminders code and 2) resets the cached client to null so that
the PubsubConnector will attempt to reconnect for the next delta

Test Plan: staging

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3995",False
1a5d4d46ad8b4f5aaa96d526104283e51b1955e4,2017-02-22 04:28:31,Juan Tejada,"[*] Catch more invalid login errors when sending

Summary: See title

Test Plan: manual

Reviewers: evan, halla, spang

Reviewed By: halla, spang

Differential Revision: https://phab.nylas.com/D3994",False
1b2464846659eb75d29f86f35c0bfb97c1803ee3,2017-02-22 04:02:22,Evan Morikawa,[client-app] update build system,False
5f8644361247546f56316ff074c1933074cf1151,2017-02-22 03:30:08,Mark Hahnenberg,"[client-sync] Add per-Account IMAP connection pooling

Summary:
Prior to this diff it was easy for us to create too many IMAP connections (e.g.
by requesting many attachments at once), causing random failures when the
server would reject our connection attempts. This diff adds a per-Account IMAP
pooling mechanism so that we avoid these failures.

Test Plan:
Run locally with sync worker and several other clients using the
pool, verify correct behavior. Also added a few unit tests.

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3965",False
98554bd044fac2fab21eeb0e054619831c1a939f,2017-02-22 02:42:09,Juan Tejada,bump(version) 1.0.29,False
32c85ac566c4c97f7c3a79fbfb5785b1833444c6,2017-02-22 02:38:59,Evan Morikawa,"[client-app] symlink in babelrc and resolve links

Summary:
The prod build was failing because it couldn't find the .babelrc.

I decided to put the babelrc in the main nylas-mail repo with the
expectation that it'll need to be in the open source version too. To DRY
up this for us building, we sylink the root one to the client-app babelrc

Also since we now dereference symlinks we don't need to do the full copy
of nylas-private-resources so we don't have two error reporters floating
around

Test Plan: npm run build-client

Reviewers: juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D3993",False
eaac872ec83004155cf07732eef2a27528aef190,2017-02-22 02:08:36,Christine Spang,"[client-app] Convert nylas-env.coffee to ES6 :sweat:

Test Plan: unit tests + run the app

Reviewers: juan, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3979",False
955402061884d636ba73752257dafa1ff9f70cf4,2017-02-22 02:01:07,Juan Tejada,"[client-app] For consistency, proxy marking unread thru ThreadListActionStore

Summary: Depends on D3990

Test Plan: manual

Reviewers: spang, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3992",False
2a6a68fff187922e1b88e5fc0a81442568f6ca45,2017-02-22 01:59:52,Juan Tejada,"[client-app] For consistency, proxy starring thru ThreadListActionStore

Summary: See title

Test Plan: Depends on D3990

Reviewers: spang, halla, mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3991",False
094a50eb36e684dd607a05bd963bb466350e8823,2017-02-22 01:56:58,Juan Tejada,"[client-app] Measure and report times for trashing and marking as spam

Summary:
See title

Depends on D3989

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: spang, halla

Differential Revision: https://phab.nylas.com/D3990",False
09a6729923bc0eee45a2700f7a0331a3cbb0f077,2017-02-22 01:43:17,Juan Tejada,"[client-app] Measure and report times for removing labels from threads

Summary:
This commit adds new actions, `applyCategoryToThreads` and `removeCategoryFromThreads`
to be proxied and measured through the ThreadListActionsStore. These are called when
labels are added or removed via the category picker or by removing using
the label icon.

For now, we are only interested in timing actions that remove threads
from the inbox.

Test Plan: manual + reenabled unit tests for category-picker

Reviewers: spang, evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3989",False
d50c0408cb52b534873c5253244ac31b5171756a,2017-02-22 01:40:52,Juan Tejada,"[client-app]: Measure and report time when dragging threads to sidebar

Summary:
This commit adds a new action, `moveThreadsToPerspective` to be proxied and
measured through the ThreadListActionsStore. This action is called when
a thread or group of threads is dragged and dropped into an item in the
sidebar.

For now, we are only interested in timing actions that remove threads
from the inbox

Depends on D3984

Test Plan: manual

Reviewers: halla, evan, spang

Reviewed By: evan, spang

Differential Revision: https://phab.nylas.com/D3985",False
41067869b82153667ddd8fe269f0070bfa56c422,2017-02-22 01:23:38,Juan Tejada,"[client-app] Measure and report times for removing from inbox

Summary:
This commit adds a new action, `removeThreadsFromView` to be proxied and
measured through the ThreadListActionsStore

This action can encompass many different actions, e.g.:
- unstarring in starred view
- changing unread in unread view
- Moving to inbox from trash
- archiving a search result (which won't actually remove it from the thread-list)

However, for now, we are only interested in timing actions that remove threads
from the inbox

Depends on D3983

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: spang, evan

Differential Revision: https://phab.nylas.com/D3984",False
376561af265c76d8d78112157a4ebeab2ccb2b4e,2017-02-22 01:20:55,Juan Tejada,"[client-app] Measure and report archiving times

Summary:
This commit makes so it we report perf metrics for archive actions.
To achieve this, I added a new `ThreadListActionsStore` which serves as
a proxy for thread actions, which allow us to time them.

The new store is in charge of listening to thread list actions, creating and
queueing  the appropriate tasks for any given action, and timing and
reporting action times to our MetricsReporter.

This commit only times archiving actions, and subsequent diffs will time
other relevant thread list actions.

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: spang, evan

Differential Revision: https://phab.nylas.com/D3983",False
322aa62dd473513d40cb7f2f1f42b79fc8ca4272,2017-02-22 01:18:45,Juan Tejada,"[*] metrics(Part 6) MetricsReporter.reportEvent now requires a nylasId

Summary:
This will help us aggregate metrics by user. This also makes it so we
don't report events in dev mode

Test Plan: manual

Reviewers: spang, evan

Reviewed By: spang, evan

Differential Revision: https://phab.nylas.com/D3981",False
c31e6122fd87fac77218e4a44cc8bd06efb55647,2017-02-22 01:17:33,Juan Tejada,"[client-sync] metrics(Part 5) Rename PerformanceMonitor to GlobalTimer

Summary:
This global module wasn't really related to performance, but rather with
timing things across different processes in the app. I believe this name
is more appropriate.

Test Plan: I can still use NylasEnv.timer (instead of NylasEnv.perf)

Reviewers: spang, evan

Reviewed By: spang, evan

Differential Revision: https://phab.nylas.com/D3972",False
5a297d36e91c6534b26d161bde38b494996b844c,2017-02-22 01:16:15,Juan Tejada,"[*] metrics(Part 4): Make /ingest-metrics use MetricsReporter

Summary:
This ensures that the Libhoney instance is a singleton in cloud
processes.

Test Plan: manual

Reviewers: mark, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3969",False
3bdecd734afce70f3c27641c733586b85de92cb0,2017-02-22 01:15:29,Juan Tejada,"[*] metrics(Part 3) Don't report CPU usage on every reportEvent

Summary: See title

Test Plan: Manual

Reviewers: spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3968",False
794cd9cc49fa5dfd5e2c1b950f61ba12130376b2,2017-02-22 01:14:21,Juan Tejada,"[local-sync] metrics(Part 2) Move MetricsReporter to isomorphic-core

Summary:
Renamed it from SyncMetricsReporter to MetricsReporter and moved it to
iso-core.

The new metrics reporter can now be called from any environment and will
correctly report the metrics.

Test Plan: manual

Reviewers: mark, spang, evan

Reviewed By: spang, evan

Differential Revision: https://phab.nylas.com/D3967",False
c27815a42ac9cf5e3f3738c985f2d8319e961493,2017-02-22 01:06:18,Evan Morikawa,"[client-app] resolve symlinks before copying files

Summary:
In client-app/node_modules Lerna symlinks isomorphic-core to '../../'.
When we copy everything over to our tmp directory when building, we copy
over the relative symlink! Damn you lerna.

We get around this by resolving the symlinks BEFORE copying and caching
them in the installer task. Then the file copy always works.

Also, for some reason the glob {absolute} param doesn't seem to work in
the latest version. I'm manually creating an absolute path for the compile
target since it's a bit more transparent what's happening anyway.

Test Plan: `npm run build-client`

Reviewers: spang, jerm, juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D3988",False
d9099b42ceb5683670b6f46e18193202005235ef,2017-02-22 01:05:51,Evan Morikawa,"[client-app] build tasks now use absolute paths

Summary:
Grunt is hardcoded to use paths relative to wherever the Gruntfile is
located. Unfortunately it also expects the grunt packages to be siblings
of that gruntfile. We can get around this by changing the relative base
path, but then the cwd is different for each tasks. This is okay as long
as we use absolute paths for various files in each of our tasks. This
updates our grunt tasks to use absolute paths

Test Plan: `npm run build-client`

Reviewers: spang, halla, jerm, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3987",False
de78536ae3b6071df75709f69a1c398642ca049c,2017-02-22 01:04:30,Evan Morikawa,"[client-app] actually npm install inside the /apm dir with env vars

Summary:
We weren't actually running npm install inside of apm. This meant that
/apm/node_modules was empty causing the build to fail. This will install
with the proper env required for old apm

Wow we need to get rid of this thing soon…

Test Plan: Run `npm install`

Reviewers: jerm, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3986",False
7266b00af8e05fbf9b36f60abba8abb25e0d6ec3,2017-02-22 01:03:00,Evan Morikawa,"[dev, cloud-*] make Docker run plain npm install and conslidate deps

Summary:
It doesn't really make sense to have the root package.json have any
dependencies since it's never ""packaged"" or built itself. Everything
really should be a dev dependency. This was only separated before because
the Dockerfile unnecessarily added the --production flag.

This will make the docker build take a smidge longer, but I think it's
worth the extra minute to keep the dependencies orderly and sematically
correct

Test Plan: re-run docker build

Reviewers: jerm, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3978",False
e799455fce8386bdc2c04f119ac558400ba40c2e,2017-02-22 00:38:47,Juan Tejada,"[client-sync] Make imap ended error retryable

Summary: This error should really be retryable, and will prevent more red boxes

Test Plan: manual

Reviewers: evan, spang

Reviewed By: evan, spang

Differential Revision: https://phab.nylas.com/D3982",False
ea79f4e0430221b61d19e97272c36ad5eac1b439,2017-02-22 00:36:07,Halla Moore,"[isomorphic-core] Ensure smtp config exists

Summary:
We previously weren't saving the smtp settings for cloud gmail accounts,
and even though we fixed that, we still need to be able to handle the accounts
that were authed before that fix went out. This diff changes `smtpConfig()` to
always call `credentialsForProvider` instead of depending on what was saved
in the database.

Test Plan: manual

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3980",False
13b87b3796b3877141b19fab69943c605de980e1,2017-02-21 22:26:47,Juan Tejada,[client-app] Fix delta-processor tests,False
b468f842b05703dc7ea71b0469ef89d7b8ec8b26,2017-02-18 08:38:20,Halla Moore,"[cloud-workers, isomorphic-core] Implement the SendRemindersWorker

Summary:
Process reminders metadata and send the reminder email if there
haven't been any replies. Checking for replies involves checking
each of the folders in `folderImapNames` for messages that are in
reply to the messages in `messageIdHeaders`.

Test Plan: manual

Reviewers: khamidou, juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3958",False
ba8c9380755f8db3ba702f8d09d68ab639062f9a,2017-02-18 08:37:25,Halla Moore,"[cloud-workers] Refactor cloud-workers for multiple workers

Summary: Make adding new workers an easy and DRY process

Test Plan: manual

Reviewers: khamidou, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3957",False
9741677160f5ece83e8c1996d137b4c79507b0df,2017-02-18 08:36:41,Halla Moore,"[cloud-workers] Don't delete metadata after processing it

Summary:
The client-app can't properly process delete deltas for metadata,
because the transaction doesn't store the objectId or pluginId of
the metadata object. Without this information, the client doesn't
know which metadata to delete. Instead, we just nullify the value.

Test Plan: manual

Reviewers: khamidou, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3956",False
21d680b52be6531dcbd0bce0e93fbcf6a639c517,2017-02-18 08:36:14,Halla Moore,"[cloud-workers] Move logic for getting an IMAP connection into a helper method

Summary:
This logic will be used by send-reminders, as well as probably other workers
down the line.

Test Plan: manual

Reviewers: khamidou, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3955",False
e7fc48f88f7dab98229462b600c2f3e6e53532b4,2017-02-18 08:35:36,Halla Moore,"[cloud-core, cloud-workers, isomorphic-core] Fix sending from cloud-workers

Summary:
The SendmailClient is in isomorphic-core, but wasn't working properly when
called from cloud-workers. This diff includes a variety of fixes to get it
working:

  - Add smtp config to connection settings in cloud-core
  - Don't use `PromiseUtils.promisify` for a function that needs `this` to
    be bound properly
  - Don't reference `NylasEnv` (That error gets caught and reported
    elsewhere anyway, we don't need to report it here)
  - Default `message.uploads` to `[]` to keep iterator happy
  - Add Gmail environment variables to cloud-worker app

Test Plan: manual

Reviewers: juan, khamidou, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3954",False
c1d794d8848a03bf98a7a93d2dc278cf88792943,2017-02-18 08:35:00,Halla Moore,"[client-private-plugins] Update send-reminder metadata once draft is sent

Summary:
Send-reminders involves some data that aren't finalized until after the
draft is sent (e.g. message id, subject). Update these values after send.

Test Plan: manual

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3953",False
1c9263d73047e63d05f4a5e3c123a957e4175f58,2017-02-18 08:33:07,Halla Moore,"[client-app, client-private-plugins] Update the reminders metadata structure

Summary:
The new send-reminders cloud-worker needs different information to check for
replies now that the sync engine is local. Make sure we save all of the
required information to the metadata. The current values are:

  - expiration: the time the reminder should be sent, if no new replies
  - folderImapNames: the folders to check for replies
  - messageIdHeaders: the Message-Id headers of messages in the thread
    (we search for In-Reply-To headers that match these values, and also
     use them to decide whether a message is a new reply or an old reply)
  - replyTo: the message to reply to when sending the reminder email
  - subject: the subject to use when sending the reminder email

Test Plan: manual

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3952",False
c4e18fc3ae85ddf1b543145d636a7a23cb7db4c8,2017-02-18 07:03:18,Evan Morikawa,"[client-app] only show cloud deltas in the developer bar

Summary:
This removes client-sync deltas from the developerbar delta list.

We ONLY show cloud deltas now.

The connection between client-sync is no longer a network delta stream,
it's a direct function call. It makes no sense to show its status.

This now shows a single dot representing the state of the cloud delta
stream.

Test Plan: Manually connect and disconnect local cloud API and see icon change

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3977",False
27253e1161f4f158f385af6719e54131a6ea721e,2017-02-18 07:02:45,Evan Morikawa,"[client-app] allow returning of message from DOM

Summary:
SFDC's task to upload an email to salesforce needs the stripped DOM of a
Message object to call `innerText`. The API was changed to return a string
instead of the DOM. This adds a flag to request the DOM instead of a
string.

Test Plan:
Manually assert `EnsureMessageOnSalesforceTask` properly can add the plain
text to the Salesforce Task object

Reviewers: halla, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3976",False
0a8a4c078ecbb665e57f6ec343c67fac394f35ce,2017-02-18 07:01:36,Evan Morikawa,"[iso-core] fix error toJSON in node environments

Summary:
Node's native `Error` object does NOT implement toJSON. We attempt to call
toJSON when reporting errors. This wasn't noticed until now because
bunyan's pretty logger (which only run in dev mode) started JSONifying
errors

Test Plan:
Try and API auth with a bad username with local setup. See that it throws
toJSON error. After patch, error properly serializes

Reviewers: spang, halla, jerm, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3975",False
fe824dcab73219189c48af59ae2f6151ce95993b,2017-02-18 07:00:00,Evan Morikawa,"[cloud-core] move redis to correct location

Summary:
This was supposed to be in cloud-core/scripts, but was in cloud-core root.
pm2 couldn't find it properly

Test Plan: Manually boot up and see redis is available at localhost url

Reviewers: spang, jerm, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3974",False
620925cb1445f1875052f5e77d8fa41155fbe484,2017-02-18 06:59:33,Evan Morikawa,"[client-app] fix errors with no message

Summary:
Some API Errors, like ECONNREFUSED, have no \.message.
Catch this in the error reporter

Test Plan: Manually create a non-message error and see better error message

Reviewers: spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3973",False
b97b69d89a05945d4ebd2e08267b51f707e4a9f1,2017-02-18 06:58:09,Evan Morikawa,"[*] update and add READMEs to each package

Summary:
Adding READMEs for easy and helpful browsing on GitHub.
Also add missing script and `--interpreter` flag

Test Plan: Run new launch commands

Reviewers: mark, spang, juan, halla

Reviewed By: spang, juan, halla

Differential Revision: https://phab.nylas.com/D3971",False
23cf3bd44e0a5f8b5c3e983171d6cf28b18b06e0,2017-02-18 05:51:47,Juan Tejada,"[*] Temporary fix for coffee linter in arc lint

For now, just update the arclint config to point to the correct grunt script",False
0c1adf50eae404aeb84e7458c98d84c6e559ac3e,2017-02-18 04:38:26,Evan Morikawa,[client-app] remove rouge-committed packages folder,False
9d3a3c552cb66e52a9324e88c1e11a8abd2fdc5c,2017-02-18 04:17:10,Halla Moore,"[client-app, client-sync] Save imap folder names in the client-app

Summary:
Client-sync has the full imap folder names, but used to only pass the display
name to the application. The application needs the full imap names so that it
can pass them via metadata to cloud-workers that need to open imap boxes.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3951",False
dde49c82be9104be27620d97ebc295d6a5cc9303,2017-02-18 04:16:07,Halla Moore,"[isomorphic-core] Allow use of atob() in cloud environments

Summary: atob() is a global in browser environments, but needs to be imported otherwise.

Test Plan: manual

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3950",False
289d353c431d81c9c26bfb53dfd9917e5ff154bb,2017-02-18 04:05:07,Halla Moore,"[client-private-plugins] Change reminderDate -> expiration

Summary:
The cloud packages expect an expiration field. Update the send reminders
metadata to use expiration instead of reminderDate

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3949",False
a011aa1abf806a7bc3f67d58de2ce4e6744658d4,2017-02-18 04:02:19,Halla Moore,"[cloud-api] Change expirationDate -> expiration

Summary:
Seems like I accidently overwrote some things to be expirationDate while
implementing thread metadata. The cloud workers expect expiration instead.

Test Plan: manual

Reviewers: khamidou, evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3948",False
dbd911f703fea7723bce71a35961e30a9c6f461f,2017-02-18 03:47:30,Evan Morikawa,[client-app] convert FocusedContactStore to es6,False
695c76bcdd6f9b52c42e3c90033883e43aba2aa8,2017-02-18 03:44:17,Mark Hahnenberg,"[client-app] Fix stale import

Summary: Moved a file and forgot to update this import :-/

Test Plan: Run locally

Reviewers: juan, evan, spang

Differential Revision: https://phab.nylas.com/D3970",False
c9e80622b7f7b5a3d5673a64918f92abc85b473a,2017-02-18 03:33:24,Christine Spang,"[local-sync] Differentiate sync loop & other errors by additional fingerprint info

Summary:
If an exception has the same stack trace, by default Sentry will always group
it together in the same event. We don't want to do that for sync loop
errors---e.g. 'Invalid credentials' errors should not be grouped together with
stuff like 'Too many simultaneous connections'. Creating more unique groups
will allow us to better evaluate the effect of sync & other bugfixes.

Test Plan: writing unit test right now

Reviewers: juan, mark

Subscribers:

Differential Revision: https://phab.nylas.com/D3915",False
4c988452f47dc1161617445710f282dd56e4ae49,2017-02-18 03:31:07,Mark Hahnenberg,"[message-list] Add support for double-clicking inline images to open

Summary: See title

Test Plan: Run locally, verify that double clicking inline images opens them

Reviewers: evan, juan, spang

Reviewed By: juan, spang

Differential Revision: https://phab.nylas.com/D3963",False
05b11a877abb9d902ec335a2d882f041acd213ec,2017-02-18 03:21:27,Christine Spang,"[*] Clean up some cruft

Summary: This stuff doesn't seem to be used for anything anymore and it's cluttering up the client-app dir.

Test Plan: ran the app, also did `npm start` with no ~/.nylas-dev

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3961",False
ca3d35698bbc6e75f0d8363b2feaf03f9e0a4cce,2017-02-18 03:04:07,Juan Tejada,"[*] metrics(Part 1) Add env-helpers to iso core

Summary:
This is a set of functions which will allow isomorphic-core to detect
which environment it is running on.

This will be useful for moving the metrics reporter to iso-core

Test Plan: manual

Reviewers: mark, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3966",False
fd635ca42d8f5b6478e66e0f81be6bd134a52c2f,2017-02-18 02:33:20,Mark Hahnenberg,"[*] Fix electron launch args

Summary:
We were doing some incorrect processing of args passed to the main
function which was causing us to think we were launching NM by passing a
file (which creates a new draft and tries to attach that file). Since
were trying to attach 'packages/client-app', this was causing an error
dialogue to appear indicating that it wasn't possible to attach a
directory.

Test Plan: Run locally, verify no dialogue

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3962",False
6c082380c0e6399404095f2397722ba0e7c7d785,2017-02-18 01:45:23,Evan Morikawa,[*] convert everyting to rx-lite,False
37313eaf157a6988b162ea104684b79c39170718,2017-02-18 01:45:23,Evan Morikawa,[cloud-*] fix Dockerfile to correctly use postinstall script,False
74086571c5b40109724873f7f22aa388ab6c019f,2017-02-18 01:42:56,Juan Tejada,"[*] Correctly copy error logger extensions in postinstall script

Summary: Also fix linter errors

Test Plan: manual

Reviewers: evan, mark, halla

Reviewed By: halla

Subscribers: halla

Differential Revision: https://phab.nylas.com/D3960",False
e8730cfbf5a262f60513c69e5111608ca2ec3444,2017-02-18 01:17:45,Evan Morikawa,"[cloud-*] Get cloud-api and cloud-workers running on new repo

[dev] remove .tern-project

[cloud-*] move into cloud-core/build

[cloud-core] convert to launch properly via Docker",False
26ab7c6ad48e25334840ba9c0a332bca4e91a6c8,2017-02-18 00:33:26,Mark Hahnenberg,"[iso-core] Add BackoffScheduler to exports

Summary: See title

Test Plan: Make sure NM loads

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3959",False
072524c8b42b24c71f6562c97fa6423fb498367f,2017-02-17 23:41:35,Juan Tejada,[*] Move BackoffSchedulers into isomorphic-core,False
45adb2ef412fca85c50b718dc4afeec59c4f4216,2017-02-17 23:41:35,Juan Tejada,[client-app] Update changelog,False
08813b93167cb3bbec37b101342eacf7d3b22552,2017-02-17 23:30:43,Evan Morikawa,"[client-app] fix module spec

This changed because we now globally require node_modules",False
5f29032092d71e01575e161824497af3d1588b61,2017-02-17 08:16:26,Evan Morikawa,"[*] move to monorepo

[*] update babel

[client-app] remove flow-typed

[client-app] Move build/package.json to main package.json

[client-app] remove spec_integration

[client-app] fix babel support

Add client-private-plugins package.json

[client-app] add node_modules to global path for private-plugins

Move client-sync dependencies to client-app root

fix electron rebuild

[*] moved to monorepo

Summary: App now runs in monorepo

Test Plan: npm test

Reviewers: juan, mark, khamidou, halla, spang

Differential Revision: https://phab.nylas.com/D3947",False
f970c8f3e3ac90b26c3d4ed6a2eb48b2ff601d0d,2017-02-17 06:59:59,Jeremy Price,"[n1cloud][docker][logs] added pm2 wrapper for logs

Launching pm2 via a wrapper that launches pm2 as a daemon in the background
and then runs pm2 logs --raw in the foreground. This gets us the logs that
we want without the additional cruft that pm2 outputs by default",False
fc2f25306c72ff8cbd9722441f64f6e09cf2c5d2,2017-02-17 06:28:27,Christine Spang,fix(linux-build): Update rpm spec to use new package name,False
0434b04921cbab9d641f6f0a4e1541683edfe495,2017-02-17 05:37:36,Christine Spang,"fix(linux-build): Change package name to Nylas Mail

Need this in order to allow parallel installation of Nylas Pro and Nylas
Mail.",False
341652a2d57e75223ef6da13930ad79fbf606bb7,2017-02-17 05:32:08,Christine Spang,fix(cli): s/n1/nylas-mail/,False
1089d62f2d35aff87e16a27c5a90ff171946dbb1,2017-02-17 03:45:19,Juan Tejada,"Update .arcconfig to point to new repo

Summary: see title

Test Plan: manual

Reviewers: spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3945",False
08eb33af0f9cbdc67e76a6eed08f5c552d9d634b,2017-02-17 03:01:37,Evan Morikawa,[client-*] Rename packages folders and update readme,False
afd941e778f018b430419fd03e09cd052aea2161,2017-02-17 02:50:20,Evan Morikawa,Merge remote-tracking branch 'k2/master',True
95b68f13686791a5350eb41e32858f05e9f274f2,2017-02-17 02:45:10,Evan Morikawa,[nylas-mail] move nylas-mail into /packages,False
57b4f5796a7b2ba1f86aee242b85ee6d05c0a697,2017-02-17 02:06:06,Evan Morikawa,"fix(SFDC): fix React error in tokenizing text field

Summary:
Get ready for some SFDC diffs! Hooray getting more eyeballs on SFDC. At
this stage it's a lot of FYI to hopefully start showing more people parts
of the SFDC plugin.

This is related to the form you use to create new Salesforce Objects with.

The form window basically looks like:
```
<SalesforceObjectFormWithWindowProps>
  <SalesforceObjectForm>
    <GeneratedForm>
      <GeneratedFieldset>
        <FormItem type=""input"" />
        <FormItem type=""email"" />
        ... (lots of FormItems)
        <SalesforceObjectPicker>
          <TokenizingTextField>
            <Menu>
              some placeholder that had an error fixed by this diff!!!
            </Menu>
          </TokenizingTextField>
        </SalesforceObjectPicker>
        <FormItem type=""checkbox"" />
      </GeneratedFieldset>
    </GeneratedForm>
  </SalesforceObjectForm>
</SalesforceObjectFormWithWindowProps>
```

The whole GeneratedForm is controlled by an obejct called `formData`. This
is documented in `GeneratedForm`.

This bug prevented me from properly using SalesforceObjectPickers inside
my form.

Test Plan: manual

Reviewers: mark, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3935",False
f27ac0d6c0d7acf625dce5547e2d23f6c455a81a,2017-02-17 02:03:52,Evan Morikawa,"[local-sync] fix related threads

Summary:
When saving a thread, we weren't properly setting the `participants`
object. Since Sequelize has object properties under getters and setters,
doing `this.participants.push()` did nothing.

Since threads had no `participants`, the related threads widget, which
queries through there, did nothing.

Test Plan: Manually inspect DB and use the related threads widget

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3938",False
3549625bd83efee61366d1824bdceb812adc7dc8,2017-02-17 02:02:07,Evan Morikawa,"[*] update package.json to lerna specs

Summary:
This is the result of auto package.json fixing by lerna. Would be nice to
commit this so you can run script/bootstrap without it making local
changes.

I didn't manually bump any versions.

Test Plan: manual

Reviewers: mark, halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3934",False
427b8f70997adca27c6b233dfe6226ff3f27cd6b,2017-02-17 01:47:17,Christine Spang,fix(watchman): There's some stuff in build/ we don't want to ignore,False
47cc0dc684aeacf6a98d8f6877897aa56207297c,2017-02-17 01:45:51,Evan Morikawa,"fix(spec): re-enable NylasEnv specs and fix duplicate rejection log

Summary:
This re-enables NylasEnv spec and fixes a particularly tricky test
involving the Node event loop.

See the comments I left on process.unhandledRejection and the new spec

Test Plan: Manually run test in isolation and whole suite. All green!

Reviewers: juan, mark, halla, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3942",False
cd7e64b3e8373db4324e33fbf7e47edbafa1e2b8,2017-02-17 01:45:17,Juan Tejada,:art:(backoff-scheduler) Add getters,False
6a654a6409b59a76b9ca79bf657c3d5a3591d44e,2017-02-17 00:05:24,Mark Hahnenberg,"[local-sync] Use new BatteryStatusManager to compute sync loop delay

Summary:
We don't need to check folders that often while on battery. Check every
5 minutes rather than every 10 seconds.

Test Plan: Run locally, verify the timeout is longer while on battery

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D3940",False
4041e59f465fda276826a134bf65a11c1eea7bcd,2017-02-16 13:48:52,Juan Tejada,bump(version): 1.0.28,False
89f5a544a0102ba2453bc774c4f112411ff7a130,2017-02-16 12:52:32,Juan Tejada,update(changelog),False
1c5d392925bb639302e8dee72704d851e872989a,2017-02-16 11:40:46,Juan Tejada,bump(k2),False
726c6d9c273007a41c55ec10139c0328319b6237,2017-02-16 09:03:27,Mark Hahnenberg,"[battery] Add BatteryStatusManager

Summary:
This adds a simple service to monitor whether the computer is plugged in
or not.

Test Plan: Run locally, verify that we correctly detect battery charging state

Reviewers: evan, spang, juan

Reviewed By: evan, spang, juan

Differential Revision: https://phab.nylas.com/D3937",False
c0bdeb53dcdca446746178640047de4a2443bf27,2017-02-16 08:16:41,Juan Tejada,"[local-sync] :art: sync loop error handler

Summary: See title

Test Plan: manual

Reviewers: evan, mark, spang

Reviewed By: spang

Subscribers: mark

Differential Revision: https://phab.nylas.com/D3932",False
bf5c5f82b55b05ddd146b569c729a9b85e980371,2017-02-16 08:08:55,Mark Hahnenberg,"[sentry] Don't use breadcrumbs in dev mode

Summary: They obscure the location of our logs in the dev tools.

Test Plan: Run locally, verify that logs link to proper place

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Differential Revision: https://phab.nylas.com/D3939",False
f29bbe514e62a8d2d669e80584002c2620a1a8ca,2017-02-16 04:39:45,Evan Morikawa,bump(K2),False
3c62727f0ecc6b434db547a9bd39c5c8013f5828,2017-02-16 04:18:15,Evan Morikawa,"[cloud-api] remove latest_cursor endpoint

We no longer use this in favor of storing the last known delta id and incrementing by id",False
e02aa0f01ce1d583544da5ac37f26fe1a69c0e52,2017-02-16 04:10:24,Christine Spang,"[cloud-api] Log error info on 5xx errors

Summary:
This is consistent with how we do things in the Python API---makes
debugging 500s easier if the stack trace is directly on the logged
request event.

Test Plan: call /ping/500 locally w/prod log stream enabled, also put a throw /ping (async handler)

Reviewers: khamidou, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3921",False
baafb596f479080f99b2c845fdb2fc8df8ecb5f6,2017-02-16 04:07:31,Christine Spang,"[local-sync] Refresh Google OAuth2 tokens when Invalid Credentials occurs in sync loop

Summary:
Previously, we would only refresh Google OAuth2 access tokens at the
beginning of the sync loop, and _only_ if the access token had already
expired. This meant that if an access token expired in the middle of a
sync loop iteration, the user would get prompted with the reauth red box
for their account and would have to either go through the oauth flow
again or restart the app for sync to continue.

This diff makes two changes:

1. Adds 5min of padding to the refresh window, so if a token will expire
in <5min, we'll go ahead and refresh the token. This will reduce the
possibility that an access token can expire during a sync loop
iteration.

2. Catches Invalid Credentials IMAPAuthenticationErrors for Gmail
accounts and forces a token refresh on the next sync loop.

These should prevent a user from _ever_ having to reauth their Gmail
account unless the refresh token is revoked, or we encounter some other
permanent error trying to refresh the token.

Fixes T7775 (at least some cases)

Test Plan: manual

Reviewers: khamidou, evan, juan

Reviewed By: juan

Maniphest Tasks: T7775, T7755

Differential Revision: https://phab.nylas.com/D3908",False
5c2c7481ebc131a0c208d3e0d7e1883f3965a0ee,2017-02-16 03:53:38,Christine Spang,Add TODOs about retries in sending,False
c559c21448b72c6f5c138b1992865531e93e5204,2017-02-16 02:51:27,Juan Tejada,fix(exports) Add backoff schedulers,False
01a54525809f2552b5b922b9059f4a89e260df4f,2017-02-16 02:03:32,Juan Tejada,bump(k2),False
cb2c9d32f22859d64fb6174cfe2d0a7b0c353f56,2017-02-16 02:01:43,Juan Tejada,"[local-sync] Add exponential backoff when retrying syncback tasks

Summary:
Instead of re-implementing exponential backoff, throw the retryable
error so the sync loop handles it and backs-off

Test Plan: manual

Reviewers: spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3914",False
7e255911715151caf554ff256a164488ef9e7fef,2017-02-16 02:00:28,Juan Tejada,"feat(offline) Re add offline status notification

Summary:
This commit rewrites the offline status notification from scratch, using
the `is-online` module (https://github.com/sindresorhus/is-online). The
react component no longer manages all of the state internally, but
rather depends on a separate OnlineStatusStore that manages the online state
for that component.

The new online status system will:

- Check online status every 30 seconds
- If status switches to offline:
  - Show notification
  - Recheck online status using exponential backoff
  - Notification will show remaining seconds until next online status
  check (like slack) (upon initial inspection this seemed to have no cpu problems.)
- If status switches to online
  - Hide notification
  - Revert to checking online status every 30 seconds

Depends on D3919

Test Plan: manual

Reviewers: spang, mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3920",False
5dd7e5d51f220e6399d178dc22502cfca46df9a6,2017-02-16 01:03:37,Evan Morikawa,bump(k2): SFDC,False
f1f069c9d78284a8b67af73b61a7edf88d3669c6,2017-02-16 01:03:28,Evan Morikawa,"[SFDC] Update SalesforceSearchIndexer for new search indexing

Summary:
Update Salesforce to use the new search indexer

Depends on D3911

Test Plan: Manually bootup SFDC and ensure it launches and indexes models properly

Reviewers: mark, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3913",False
0c66c539e7ff3e973c26f9d9835f8b1372d59a80,2017-02-16 01:02:45,Evan Morikawa,"reafctor(scheduler): Move SearchIndexer -> SearchIndexScheduler

Summary:
This renames `SearchIndexer` to `SearchIndexScheduler`

It also moves it out of internal_packages and into src/ since this is now
used across packages (like in Salesforce).

It also makes the class a Singleton and exports that instead so we don't
need to pass it via `activate`. The `activate` method of many stores and
packages are designed to be argumentless.

Test Plan:
Boot up Nylas and ensure it's still indexing threads properly.
Also allows Salesforce to bootup with the SalesforceSearchIndexer

Reviewers: juan, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3911",False
8842aa9f28d9abfea672d53a09ccc97091905bba,2017-02-16 00:46:28,Juan Tejada,"feat(backoff-scheduler): Add a backoff scheduler service

Summary:
This will help us dry up exponential backoffs we have scattered in
several places

Test Plan: unit tests

Reviewers: mark, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3919",False
55a83ebc0343d8271ab0cbd067e876dc8d4aa321,2017-02-15 22:05:08,Christine Spang,bump K2,False
4465fab4502fa27feecf215973e293898973a9e6,2017-02-15 21:25:48,Christine Spang,"[cloud-api,cloud-workers,local-sync] Bump hapi version

We were two major versions behind. I upgraded and everything is working fine
in dev.",False
e22431cf7eab95a3a75d9b8b821acdd0a2b19b4c,2017-02-15 21:24:55,Christine Spang,"[cloud-api] Reduce request timing precision

Hoek.Bench() reports ms times with 15 decimal points, which is ridiculous
and makes the logs harder to read. We only need ms precision for request
times, which Hoek.Timer() gives us.",False
81ad5f8210c97f9ab92859a5ea26c500a6ecc44e,2017-02-15 21:24:55,Christine Spang,"Bump pm2 version to 2.4.0

See https://github.com/Unitech/pm2/blob/master/CHANGELOG.md
for new features and fixes",False
b87422a868f7430622796ca2ef23aadb456490a2,2017-02-15 07:58:53,Juan Tejada,bump(k2) latest master,False
068de72051af899b2b5f7661d57378498f2e733f,2017-02-15 07:58:07,Juan Tejada,"[cloud-api] KEEP Timeout streaming API connections every 15 minutes

This reverts commit 91376c587cfd066c2db08de15be71a3b5e179c8a.
This is actually working correctly to reduce REDIS connections",False
2267c8986ff456c2709c5b2731cafaae37b3ad31,2017-02-15 07:55:38,Juan Tejada,fix(offline): Really remove offline notification,False
91376c587cfd066c2db08de15be71a3b5e179c8a,2017-02-15 07:25:08,Evan Morikawa,"Revert ""[cloud-api] Timeout streaming API connections every 15 minutes""

This reverts commit 50391bc7700cfee6b629a613e8140aa19624fa19.",False
22248e6b226876cd2cdbb18e1aa232c1e21baa8b,2017-02-15 06:32:31,Juan Tejada,"[cloud-*] Properly listen to stream disconnect events to close redis connections

See the following for why we need to set up the listeners on the raw
stream.
http://stackoverflow.com/questions/26221000/detecting-when-a-long-request-has-ended-in-nodejs-express
https://github.com/hapijs/discuss/issues/322#issuecomment-235999544

Hapi's disconnect event only fires on error or unexpected aborts: https://hapijs.com/api#response-events",False
062e9872475662106e1878aff79bdfcb4039f9a0,2017-02-15 06:06:30,Evan Morikawa,bump(version): 1.0.27,False
e2d3553c47dca12f519b911ed9af711818b6c272,2017-02-15 06:03:14,Juan Tejada,"fix(offline-status): Temporarily remove offline status notification

Summary:
This component was running into a hard loop trying to constantly, unnecessarily,
re-establish the delta connection to our n1cloud servers.

Test Plan: manual

Reviewers: mark, evan, spang

Reviewed By: evan, spang

Differential Revision: https://phab.nylas.com/D3918",False
4d510f787c892885f712adde1376b709227bfabc,2017-02-15 05:39:27,Evan Morikawa,"fix(delta): add backoff to delta error handling

Summary: Report delta errors and exponential backoff when errors arise

Test Plan: Manually throw Errors in various parts of the delta stream

Reviewers: spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3917",False
225d747166baccd26eca886b15e2e48b91908ebf,2017-02-15 04:13:48,Evan Morikawa,"[cloud-core, cloud-api] add logging to delta connection",False
50391bc7700cfee6b629a613e8140aa19624fa19,2017-02-15 04:13:23,Karim Hamidou,"[cloud-api] Timeout streaming API connections every 15 minutes

Summary: Should help a fair bit with our redis connection pileup.

Test Plan: Tested manually.

Reviewers: mark, spang, juan, evan

Reviewed By: mark, spang, evan

Differential Revision: https://phab.nylas.com/D3916",False
0095054eda621a44d84fe10d4d7f94a25a26e242,2017-02-15 00:49:17,Mark Hahnenberg,"[contact] Fixup Contact prefix/suffix removal for names

Summary:
We were doing a lazy job of removing prefixes and suffixes by filtering
any and all prefixes or suffixes from any part of a Contact's name which
was leading to some odd truncations.

Test Plan:
Run locally, verify that 'Nylas Mail General' contact has proper name
when participant text field is collapsed.

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3904",False
00ac88b39a23d4d9849644000c93ff5a3ac3e7a1,2017-02-15 00:19:18,Evan Morikawa,bump(k2): adding accountId index,False
15800d991389b4373b5b051fa9cb9b4511338674,2017-02-15 00:18:12,Evan Morikawa,[isomorphic-core] add accountId index definition to Transaction table,False
ba3fce23427b98093a5ddfd6ca75aecd9dbb4395,2017-02-15 00:16:53,Evan Morikawa,fix(delta): report error when delta gets invalid cursor,False
eab4ed7fb3e86b1de8b97d40af3a0155b4cee690,2017-02-15 00:10:32,Evan Morikawa,[cloud-api] recover from bad error from /n1/user,False
d9107e2a15505b8fedaee426ec2ad1a5fc323dbd,2017-02-14 22:37:40,Evan Morikawa,"fix(spec): re-enable DatabaseStore specs

Summary:
Re-enable DatabaseStore specs and use new async model that awaits for the
promises to resolve

Test Plan: new tests

Reviewers: spang, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3909",False
c78d0cd2f67a49fc33d1dafe7d545818b3af269f,2017-02-14 22:33:57,Evan Morikawa,"fix(db): wait for models to be setup before activating packages

Summary:
Some plugins (like the Salesforce Plugin) register Models with the
database store. Upon plugin load, we check to see if there are newly
registered models, if there are, we try and refresh the database.

Unfortunately the database refresh was not being `await`ed for. This means
the `activate` method of the plugin was called before the models were
created creating DB errors.

Making `refreshDatabaseSchema` something you can `await` for requied
adding an async ready hook on the DatabaseStore itself that will work in
all windows, even though setup is only happening in one window.

Test Plan:
Turn DatabaseStore.DEBUG_TO_LOG = true and run before and after the patch
with SFDC enabled. See that after the patch the DB setup happens before
activate gets called

Reviewers: halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3906",False
cb0fc3bb12862e8acddbf522ef0e3bd392de0be9,2017-02-14 11:23:57,Boris Kaiser,Fix broken link (#3284),False
fb8cf21198343e9524e5eb88050a3f094e4951e2,2017-02-14 11:22:21,Juan Tejada,[local-sync] :art: comment,False
094e5ba589796696a0ec3d0bffd4850bf8119966,2017-02-14 11:20:02,Juan Tejada,"[local-sync] syncback(Part 5): Always keep retrying tasks if error is retryable

Summary:
This commit makes it so we always continue retrying syncback tasks as long as they
error with a retryable error. There's really no reason to not continue retrying syncback
tasks after an arbitrary number of retries (especially such a low one) if we
encounter a retryable error. Before this commit, if for example we got 2 random
network errors in a row, we would just mark the task as failed even
though it would eventually succeed in subsequent attempts.

Previously, when N1 synced against the cloud api, we would indefinitely
retry a Task if we continued getting retryable errors. This ensures that
the app can work correctly offline and prevents displaying unecessary errors to
the user, and having actions bouncing back or sending messages without putting them
in the sent folder.

Additionally, this commit ensures that when cleaning up messages without a
folderImapUID we don't delete messages that are currently being added to the sent
folder. This is relevant to this commit because given that we could retry the
EnsureMessageInSentFolder task indefinitely, we might end up deleting that
message because it wont have a uid until the task succeeds.

Depends on D3898

Test Plan: manual

Reviewers: mark, spang, evan, halla

Reviewed By: spang, evan, halla

Differential Revision: https://phab.nylas.com/D3900",False
5a56f21dbe3ed994b402481d53f0695db0fac0f5,2017-02-14 11:10:18,Juan Tejada,"fix(account) Properly keep tokens in sync between acct stores in different windows

Summary:
When loading accounts, if we detect any removed accounts, we should get
rid of the tokens for that account as well.

Test Plan: manually removed accounts, everything seems a-ok

Reviewers: mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3907",False
50e02f88e9fdfe50d0bdf11445d9673fed106ed1,2017-02-14 07:57:18,Christine Spang,"[local-sync] :fire: Message syncback tasks

Summary:
Since all Nylas Mail actions are thread-based except for sending,
we never use any of these. Make `git grep` less confusing by getting rid
of them.

Test Plan: use the app

Reviewers: evan, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3910",False
a2a518f4375fd4752c9306f02575610b850cca32,2017-02-14 04:43:26,Juan Tejada,"fix(accounts) Don't report error when removing accounts

Summary:
The current error condition check is to make sure that accounts are exclusively
removed via `Actions.removeAccount`. However, when removing accounts,
the in-memory `AccoutStore`s in each window are kept in sync via listening
to the config, as opposed to dispatching Actions globally between windows
(Actions.removeAccount is scoped to a single window, see actions.es6).
So, when we remove an account in one window, config.json will change, and the
other windows will always encounter `removedIds.length > 0` to be true
when their `_loadAccounts` runs. This will only generate unecessary noise in Sentry.

Test Plan: manual

Reviewers: mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3902",False
6319ce90328b02845efa8c50a9317ef3ac818360,2017-02-14 03:39:33,Halla Moore,"[cloud-api] Change an extension from .js to .es6

Necessary to run properly on production",False
a28b4e881b1269b978adbd452f17450493ef5c33,2017-02-14 03:18:29,Juan Tejada,"[local-sync] syncback(Part 4): Don't always mark INPROGRESS tasks as failed at beginning of sync

Summary:
Previously, if you were to close the app while you had any tasks queued,
these would be marked as failed the next time you open the app, showing
an annoying error message and reverting any optimisitic actions.

However, we don't need to be so defensive about retrying tasks because
the only tasks we can't retry are the Sending tasks. All of the other
tasks like moving or changing labels are fine to retry (trying  move the same
set of uids twice wont cause an error)

This commit adds an extra status to syncback requests, ""NOTRETRYABLE"".
Only NOTRETRYABLE requests will be marked as failed at the beginning of
the sync loop, and any INPROGRESS tasks will be marked as NEW so they
can be retried

Depends on D3896

Test Plan: manual

Reviewers: mark, evan, spang, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D3898",False
6c69ea437c262aec5a434d6e801af929a0e809db,2017-02-14 02:41:10,Halla Moore,"fix(tests): Fix some tests and add tests for thread metadata

Summary: Depends on D3875

Test Plan: run the tests

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3876",False
83bea7c4b6a34ddc099394fdcb74d9d5ee0f8052,2017-02-14 02:40:38,Halla Moore,"fix(metadata): Fix some issues with processing metadata deltas

Summary:
- Create ghost models if we receive metadata for an object we
    haven't synced yet
- Fix logic for finding equivalent threads
- Send `messageIds` when syncing thread metadata

See D3876 for unit tests

K2 pairing: D3880

Test Plan: unit tests, local testing soon

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3875",False
7e937c8c289c2035cf0964306d7ee50084b866a6,2017-02-14 02:38:34,Juan Tejada,bump k2,False
b55d117216ffc0902266fba8f12aa4b20f467400,2017-02-14 02:37:20,Juan Tejada,"[local-sync] syncback(Part 3): Fixup `runSyncbackTasks`

Summary:
Now that we don't run Send tasks outside the sync loop, we don't need
that awful hack wich required passing a `runTask` callback to
`runSyncbackTask` in order to customize how to run the task.

Instead, runSyncbackTask now knows 2 ways to run a task, either via imap, or
via smtp, depending on the resource declared by task to run. So now
SyncbackTasks declare a resource type they need to run, and that will be
passed as their second argument when running.

Depends D3894

Test Plan: manual

Reviewers: mark, halla, spang, evan

Reviewed By: halla, spang, evan

Differential Revision: https://phab.nylas.com/D3896",False
1718d53becddb72b49c9214b72b52c14928e596b,2017-02-14 02:35:11,Juan Tejada,"[local-sync] syncback(Part 2): Reinstate send tasks back into the sync loop

Summary:
We had previously ripped send tasks outside the sync loop to make them run faster,
but they run fast enough inside the loop.

This commit will also fix the scenario where if you closed the app in the
middle of a send task, the task would just hang forever and never succeed or
fail (T7818); given that it was excluded from the loop, we also had to exclude it
from the cleanup step to mark any INPROGRESS tasks as failed at the beginning
of each loop, which caused send tasks in progress to never get cleaned.

Putting them back inside the loop allows us to  fix this without adding more messy
logic, and it cleans up ugly duplicated code. Additionally, it will prevent more
duplicated code for upcoming diffs that will improve syncback task reliability
when the app is closed or window is restarted in the middle of a task.

Depends on D3893

Test Plan:
manually test sending, it still works, it's still fast. Restarted
window in the middle of send task, task fails.

Reviewers: mark, spang, halla, evan

Reviewed By: spang, halla, evan

Differential Revision: https://phab.nylas.com/D3894",False
d5bc8c5155c2d9bf24229b238447dc41471712e1,2017-02-14 02:32:59,Halla Moore,"[cloud-api] Add metadata tests

Summary: Mostly geared towards thread metadata cases

Test Plan:
Ran the tests

Depends on D3879 and D3880

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3884",False
063b485d19505573a8efcb2936cfc835e575d66b,2017-02-14 02:32:40,Halla Moore,"[local-sync, cloud-api] Add logic to handle thread metadata

Summary:
[cloud-api]
Based on the passed in `messageIds`, it finds any existing thread
metadata that might be under a different thread id. If it realizes
there are actually multiple threads that should be the same thread,
(due to getting a missing message link), it reconciles all of them.

[local-sync]
Return `message_ids` in `Thread.toJSON()`

See D3879 for tests

N1 Pairing: D3875

Test Plan: unit tests, local testing soon

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3880",False
432f1f4659bf05774924b20e7d0a6947861cb2f5,2017-02-14 02:31:28,Juan Tejada,"[local-sync] syncback(Part 1): Refactor syncback-task-helpers

Summary:
Instead of exposing helper functions, make this a class to hold the
shared state of the db, account, and logger required to run any syncback
inside an account sync loop.

Test Plan: manual

Reviewers: mark, spang, halla, evan

Reviewed By: spang, halla, evan

Differential Revision: https://phab.nylas.com/D3893",False
85236c5eed7b489d9e63334e17ef2b1fbc2b3fc9,2017-02-14 02:06:53,Juan Tejada,"fix(send) Add better error checking when sending message

Summary:
See title.
I believe this might fix T7559, or at least provide a better error message.

Depends on D3895

Test Plan: manual

Reviewers: spang, mark, halla, evan

Reviewed By: mark, halla, evan

Maniphest Tasks: T7559

Differential Revision: https://phab.nylas.com/D3897",False
3e4f008d03c0249c9ee3097df9fbcf8d5009fe34,2017-02-14 02:01:40,Juan Tejada,"fix(send): Correctly wait for send task to complete before succeeding!

Summary:
If the worker window were to restart or the app were to close in the
middle of a send task, sending to a single recipient, we would not
properly await the task and always mark as success.

This diff, along with (D3897) should fix T7559.

Test Plan: manual

Reviewers: spang, mark, evan, halla

Reviewed By: mark, evan, halla

Maniphest Tasks: T7559

Differential Revision: https://phab.nylas.com/D3895",False
ff5e0be588f31ed0d8cc5d71ed661c81f227f316,2017-02-14 01:53:31,Juan Tejada,"fix(offline-notif) Try to connect immediately upon window focus

Summary: see title

Test Plan: manual

Reviewers: mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3901",False
46c0fa86ca46cedadf1a3df8e961481f9fa07ccd,2017-02-14 01:51:16,Juan Tejada,bump k2,False
76ff5752f8a21fb47b1889b8e0fe7f890b027b3b,2017-02-14 01:48:45,Juan Tejada,"[iso-core] Detect more offline errors when sending

Summary:
See title.
I really wish we could clean up this error handling a bit better, but I don't
think its super important right now.

Test Plan: manual

Reviewers: spang, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D3903",False
68339ad2154211e8cf2451a1c09b00350743a99e,2017-02-14 01:35:52,Christine Spang,"feat(specs): Add support for generating JUnit XML by passing --junit-xml=<path>

Summary:
A prerequesite to integrating with `arc unit` or CI for each patchset is
being able to generate JUnit XML output for spec runs. This commit adds
this feature using the JUnitXMLReporter from jasmine-reporters. Invoke it like
this:

    npm run test-junit

(We output to the terminal as well when this is run, so in the case that
you're doing `arc diff` you have some idea of what is going on.)

Test Plan: run it

Reviewers: halla, juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3891",False
df9b0121a0d37d16b7ae8ebcb107b55bf00ede5d,2017-02-14 01:30:13,Juan Tejada,"[local-sync] Add a better reason when waking sync for syncback

Summary: see title

Test Plan: nil

Reviewers: mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3892",False
3a339314acfd61c4b016c0a4d4649f7f98bb443a,2017-02-14 00:44:41,Christine Spang,:art: s/N1/Nylas Mail/ in window-event-handler.coffee,False
1b4fa6abfedb15c562e8cdfbb5b090f4f6d5fcbb,2017-02-12 05:00:43,Juan Tejada,bump k2,False
ca78872942a1979aa0d922c4f2ddaf9077d953e5,2017-02-12 02:33:56,Juan Tejada,fix(syncback-category) Return error when task fails,False
f741581156531ba94eb80250d6b81383e78dc54d,2017-02-12 02:26:35,Juan Tejada,"[local-sync] More retryable IMAP errors

Summary:
I've encountered random imap errors that we mark as permanent, but that
contain try again in the error message. We should check for that

Test Plan: manual

Reviewers: spang, evan, mark

Differential Revision: https://phab.nylas.com/D3899",False
87fd478c4d39340de12471b7d21fa98ee5a36e7b,2017-02-11 08:46:53,Juan Tejada,"fix(specs) Correctly set `configDirPath` when running tests

Before this commit, running the running the tests would clear all of
your config inside `.nylas-dev` and thus your accounts, forcing you to re-add
them everytime after you ran the tests

This was happening because we weren't correctly setting the
`configDirPath` to `.nylas-spec` when running with the --test flag. When
we run with --test, both options, `specMode` and `devMode` are true, so
the logic to set the path would fall into both conditions and ultimately
set the path to `.nylas-dev`. Now it's fixed!",False
bad9a06778fea4f4527b44b4f8dc6f51dc96b74c,2017-02-11 08:31:17,Juan Tejada,fix(specs) :hocho: more side-effect flakiness,False
4035fa025bfef3a5f19056b66564f56c4719e400,2017-02-11 06:18:06,Juan Tejada,fix(specs) Fix FeatureUsageStore spec flakiness,False
7ad07cf23412a9bf37a0885c9d248eef30b74762,2017-02-11 05:13:51,Evan Morikawa,bump(changelog): 1.0.26,False
167cb1adfd14cc3e36db883eb200b72b33f1c938,2017-02-11 05:11:20,Evan Morikawa,bump(version): 1.0.26,False
2dd8a53574cc545afde6a5399b593288bd2ae7fe,2017-02-11 05:11:20,Evan Morikawa,bump(changelog): 1.0.26,False
995aafdc43c6e7742f068fb940462c40f5cd377f,2017-02-11 05:11:07,Halla Moore,"fix(n1-spec-runner): Make `fit` async too

Summary: Running async tests with `fit` can fail otherwise

Test Plan: unit tests

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3874",False
0858ca2f2ee4561a0ea4ae930ad6a79a55f79c11,2017-02-11 05:08:55,Halla Moore,"fix(tests): Allow the masterBefore/AfterEach functions to be async

Summary:
The global `before/afterEach` functions were made async, but the
`masterBefore/AfterEach` functions were applied to the references
in `jasmineExports` instead of the global references. Fix that,
and await for `destroyTestDatabase()`. Also fix a random test
failure about not receiving any json.

This diff is necessary for D3878 to work properly.

Test Plan: ran the tests

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3890",False
fb6c52d0087d04ae22c0adbf97e9c53175d72249,2017-02-11 05:07:58,Halla Moore,"[local-sync] Properly clean-up in-memory test database

Summary: There's no file to unlink, we just need to drop the tables.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3878",False
71de2386c7892fce7bf77f229f39f3611138b17e,2017-02-11 05:01:38,Halla Moore,"[cloud-api] Add a spec runner for cloud-api

Summary:
Implements the `npm test` script and extends Jasmine to handle
await in a more automatic way. Also mocks out the database
each test.

Test Plan: ran unit tests with it

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3879",False
afa1ae4ed757b8d190a79adf70c89b50370ec5e5,2017-02-11 04:51:06,Evan Morikawa,bump(k2),False
dcacd97cf65678ea31c3165ed8d146983c7a3262,2017-02-11 04:50:53,Evan Morikawa,"[local-sync] fix sync when no messages in inbox in gmail

Summary:
If you have no messages in your Gmail Inbox (Yay Inbox Zero!) and you
connect your account and do first sync, then we get an error where we try
and fetch a range from null to -1.

This was due to a logical error in the first sync fetch code.

This diff fixes this bug and renames some variables to make it clearer
what's going on

Fixes T7842

{F11176}

Test Plan:
1. Bring Gmail to Inbox Zero
2. Connect account
3. Verify first sync works

Reviewers: spang, halla, juan

Reviewed By: juan

Maniphest Tasks: T7842

Differential Revision: https://phab.nylas.com/D3889",False
0ca1ed6033649ecc55922567238e1d281b1e2dd5,2017-02-11 04:46:07,Juan Tejada,Actually fix travis,False
0e9635cff6b8533e500609e1d683cc4be6a594ae,2017-02-11 04:41:43,Juan Tejada,fix(build) Fix travis build script,False
8bd108e3e5800c5fab959312833c4a81f4e25659,2017-02-11 04:31:50,Juan Tejada,fix(build/travis) Only run tests on mac,False
f614a24d6cb1e31f1c92231c3f6d039b29a6de52,2017-02-11 03:19:40,Evan Morikawa,"fix(specs): fix FeatureUsage spec

Summary: Damn async TaskQueue

Test Plan: fixed

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3888",False
b125186126f42868c6c9e8f167225a936fa93525,2017-02-11 03:17:21,Mark Hahnenberg,"[files] Add retry with exponential backoff for file downloads in NM

Summary: See diff title

Test Plan: Run locally, verify that we backoff on failure

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3887",False
9f8aa0f42f031edc155a6e55d28edc6e008dc50c,2017-02-11 02:59:12,Mark Hahnenberg,"[files] Add retry with exp backoff to IMAP connections for file download requests

Summary: See diff title

Test Plan: Run locally, make sure we backoff

Reviewers: juan, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3886",False
b999d5038a61056a4ba3b09484c0f9127be1141a,2017-02-11 02:22:57,Evan Morikawa,"fix(identity): remove the savePromise and optimistically update

Summary:
Fixes T7832

The _savePromise mechanism of the IdentityStore was really cumbersome and
was throwing errors on the console for people. In hindsight, this is an
unnecessary complication to a very sensitive system and a source of very
hairy async bugs.

Test Plan:
I also updated the specs to ensure that when you call saveIdentity the
promise resolves after the local cache has been updated

Reviewers: spang, halla, juan

Reviewed By: juan

Maniphest Tasks: T7832

Differential Revision: https://phab.nylas.com/D3882",False
ba77219b584921f6fb137987468f041f3d3f394b,2017-02-11 02:22:40,Evan Morikawa,"fix(load): fix window load timing

Summary:
The app regressed to launching a blank white page for a while before
showing the UI. This was because I forgot to await for the now async
package loading

Test Plan: Manually boot app with compile cache disabled

Reviewers: mark, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3883",False
4045481aa97498c12c672b972f52f3890997f867,2017-02-11 02:06:07,Juan Tejada,"fix(specs) Fix Spellchecker tests

Summary:
Previously, these tests were mostly testing the library itself, instead
of our code. The library performed expensive operations and caused the
test to time out more often than not

This commit makes it so we test our code, mock out any calls to side
effects, and removes a line that was overriding our jasmine timeout

Test Plan: unit

Reviewers: spang, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D3885",False
7685e9cb166d698cdd8034e1ba77b3a89a006b86,2017-02-11 01:49:38,Juan Tejada,"fix(specs) Use shallow rendering

Now that we have 15.4.2, we don't have to worry about:
https://github.com/facebook/react/pull/8097",False
e08ad9e39d7fca8d26ab2f9052ad6548a76ca683,2017-02-11 01:49:18,Juan Tejada,fix(specs) Synchronously render test reporting gui for better stack traces,False
2522bb6525fd4ebd37a0c48d4aa0d610d1f19067,2017-02-11 01:47:34,Juan Tejada,bump(react) 15.4.2,False
fef0fac1ddee9f868b11e6d85f29dbab9cda8e45,2017-02-10 23:47:15,Mark Hahnenberg,"[cleanup] Remove random option that's no longer used

Summary: See diff title

Test Plan: yolo

Reviewers: juan, evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3873",False
cd23f32e51d7b02dacd89887164412e808da7272,2017-02-10 23:45:52,Mark Hahnenberg,"[notifications] Fixup ""Nylas is Offline"" notification

Summary:
This notification was randomly appearing and not going away on its own.
This was due to some weird logic in the react component. This diff
refactors things to make them a little more consistent.

Test Plan:
Run locally, disconnecting and reconnecting to make sure we properly
show and hide the notification.

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3881",False
08b68c8ff36b5d7f44771afacb729785a27f436d,2017-02-10 22:58:04,Juan Tejada,fix(api-error) Fix APIError constructor,False
d838576ff1982dd7af33c3d4ef43f2c76ba4228b,2017-02-10 13:24:20,Juan Tejada,bump(version) 1.0.25,False
1d8c15026e6c68d5d12cc814c0e393e178da5c54,2017-02-10 06:26:29,Juan Tejada,fix(specs) Fix react warning,False
000e364327062a7fc82f3f59a7cf3549a1e6138e,2017-02-10 06:05:52,Juan Tejada,fix(specs) Fix spellchecker tests,False
e0859cdf302bbf34ee218755f519b8c3208dba7c,2017-02-10 05:37:00,Evan Morikawa,fix(build): re-add specs back into build process,False
cfa84ceab0158083104becaba62add4d49790b55,2017-02-10 05:35:19,Evan Morikawa,fix(specs): fix util specs,False
3390bc0783d7f17906a6884e4d757876a337506f,2017-02-10 05:35:04,Evan Morikawa,[local-sync] rename spec fixture folder to be correct,False
b97037bef550fd015a2df232314969982a82b8a7,2017-02-10 05:15:22,Juan Tejada,fix(specs) lock enzyme version,False
20826181929a65fd9a8d42aa74ded817ece37632,2017-02-10 05:02:32,Juan Tejada,fix(specs) Fix tokenizingfield specs,False
5437e77d6c80bada13cc607738a0349145ff1f64,2017-02-10 04:59:30,Evan Morikawa,fix(specs): fix more tests,False
91f501bac137e2b1638954e906f2553adf13f731,2017-02-10 04:47:11,Evan Morikawa,fix(specs): fix more broken specs,False
590a4499fea6bece4ef5da40ca8f1b4d74ba72f5,2017-02-10 04:34:12,Juan Tejada,"[local-sync] When replying to a thread, properly add it to Sent folder

Summary:
Previously, when processing messages during folder sync, if the message already existed, and it belonged to a thread, we would update the message, but forget to update its thread with any changes that new
message would produce on the thread (e.g. updating the threads folders or labels).

One obvious manifestation of this was when replying to a thread: the EnsureMessageInSentFolderTask would create the new message, and then attempt to sync the sent folder to fetch the newly created message. When processing this message during sync, we would update the message but not update its thread, so the thread would not be associated to the sent folder, and it wouldn't show up in your sent items list in the UI.

Test Plan: manually verify that it works

Reviewers: evan, mark, spang

Reviewed By: mark, spang

Differential Revision: https://phab.nylas.com/D3872",False
074f581977bf3a73b5b58cb05b6a619a700e222f,2017-02-10 04:21:43,Evan Morikawa,fix(specs) fix specs logging erroneous error messages,False
f23ca7b8ba3f7714117c0177960d53afe6d142ba,2017-02-10 04:20:32,Mark Hahnenberg,"[keytar] Report errors when keytar fails to load passwords

Summary: See title

Test Plan: yolo

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3871",False
528e092785e209d974641f3211f649e3345068f0,2017-02-10 03:27:27,Juan Tejada,fix(specs) Fix ClipboardService specs,False
ed05e188787174d29e1e3d18f7544bfc7c4f60bd,2017-02-10 02:59:50,Juan Tejada,fix(specs) Fix AutoUpdateManager specs,False
d5d009c4eda4de34b3814c3fbb01f7e38f152800,2017-02-10 02:41:10,Juan Tejada,fix(spec) Never report errors in spec mode,False
a0b314d25130c51c677bfe3ee094e2b87391e007,2017-02-10 01:47:58,Evan Morikawa,fix(spec): fix package manager spec,False
a28a7dab47a6621fc694d1e6918c7aec35f6eddc,2017-02-10 01:39:49,Evan Morikawa,fix(error): fix error reporter crashing with extra errors,False
677b1bf9893103cdac7a00ffd78b72e945e3b826,2017-02-10 00:22:37,Christine Spang,:art: s/N1/Nylas Mail/ in window hang/crash dialogs,False
19160dcc16b772ecaf95f3c04629aea1304b9302,2017-02-10 00:10:03,Juan Tejada,update changelog,False
d89ef389e6beee49caae9e11112319bb6da0dca8,2017-02-10 00:00:17,Juan Tejada,bump(version) 1.0.24,False
aec6ca9b2ea35acd27a03f962868c72166ab5ef1,2017-02-09 23:55:08,Juan Tejada,"[local-sync] Fix logger for local requests

Also log send task correctly",False
78e2a0ff8e998747092a8ec1784a10966c37e2fa,2017-02-09 22:57:51,Juan Tejada,bump k2,False
f463ae3f0a1a2a166942cfe3e25c2813593cb19f,2017-02-09 22:57:36,Juan Tejada,"[local-sync] Don't crash app when reporting error and id not available

Summary:
Our sentry reporter tries to fetch the nylas identity from the database,
and access properties on it. However, if you are in a state where there
is no identity available (like having logged out, or just starting the
app), and encoutnered an error that would be reported to sentry, we
would throw an error while reporting and that would crash the app

Also, fix lint errors and some really janky code

This fixes T7810

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: spang, evan

Maniphest Tasks: T7810

Differential Revision: https://phab.nylas.com/D3867",False
551975587ae8446f491fddc11da27e53159c1e76,2017-02-09 22:49:55,Juan Tejada,":art: Fix unhandled api rejections/Prefer promises over `success` option for api requests

Summary:
This commit modifies the api of NylasAPIRequest to /not/ take `success`
or `error` callback options at all, and only returns a Promise which you
can `then` and `catch` to handle the api response.

The fact that it returned a promise, and /also/ took `success` and
`error` callback options made it really confusing to use.

Additionaly, when using the callbacks intead of a promise, any errors
would be unhandled and reported to Sentry because even though the `error`
callback was being passed, the promise returned by `run()` still rejected and
no one was handling that reject, so it reached the `unhandledRejection` event
listener. This is undesirable because if you passed an `error` callback, it
means that you intended to handle it.

An example of this is calling the clearbit API, which will more often than
not return a 404, and even though we had an error handler which ignored the 404,
it still unecessarilly reported to Sentry, flooding it with events

Test Plan: manually check all updated codepaths still work

Reviewers: halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3869",False
87c7f8595cd075a2f2cfc35f263f6b9ffc609d58,2017-02-09 22:49:19,Juan Tejada,"[local-sync] Prefer promises over `success` option for api requests

Summary: Companion D3869

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3868",False
b70183a0fc24d4a8d6df7c60cf3d093501ea173b,2017-02-09 13:58:24,Juan Tejada,bump(changelog),False
7f2ca94cf05a3769789e705ee581914811033335,2017-02-09 10:06:12,Juan Tejada,update gitignore,False
e44aebc0ac2ceded5a63b6a0634907600790d0ae,2017-02-09 09:36:55,Juan Tejada,"fix(metrics) Report task perf metrics to mixpanel

Summary: see title

Test Plan: manual

Reviewers: spang, evan, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3866",False
1d219bb24a3bfd98e12fb578eec76b5908af0701,2017-02-09 08:13:53,Juan Tejada,bump(version) 1.0.23,False
52cd011c09e19e6c665552dcf26d4f3d5263e2a7,2017-02-09 07:57:25,Juan Tejada,bump k2,False
77628a0d5c2ae38a68f8ceb62e79f1652365131f,2017-02-09 07:57:09,Juan Tejada,"[local-sync] :art: logger

If the first argument to our local-sync logger is an object
(this is bunyan's api, and it's how we log from isomorphic-core and cloud-* packages
in order to have structured json logs for logstash), make sure we log
the object last and the string that comes as the second argument first.",False
bbe0150c701f6469980a07e2a5f24c2c11d78efc,2017-02-09 07:22:01,Juan Tejada,bump k2,False
987c38eb7562461f532dd5d9f6c7e00f5005b6eb,2017-02-09 07:15:55,Mark Hahnenberg,"[composer] Fix draft truncation due to error during _onDOMMutated

Summary:
During the _onDOMMutated callback, we disconnect the mutation observer,
call some other callbacks, and then reconnect the mutation observer. If
we threw an error during the callbacks before reconnect the mutation
observer we would never get any more callbacks when the user changed
things in the composer, causing us to stop saving updates to drafts
(among other things). The fix is to just make sure that we always
reconnect the mutation observer using a finally clause.

Test Plan:
Run locally, make sure drafts are no longer truncated after spelling
correction (which was triggering an error to be thrown)

Reviewers: juan, evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3864",False
a971ab5e6847a5727504e16e997a8a8320585bd2,2017-02-09 07:07:59,Christine Spang,"[local-sync] Fix threading bug with open and link tracking enabled

Summary: Fixes T7649

Test Plan: FML writing unit tests now

Reviewers: evan, mark, juan

Reviewed By: mark, juan

Maniphest Tasks: T7649

Differential Revision: https://phab.nylas.com/D3863",False
bf0b4e3f96d76dd2dea1358cf406e03b4fab7b46,2017-02-09 06:53:17,Juan Tejada,"[local-sync] Fix Mailbox does not exist error during sync

Summary:
This error ocurred, to the best of our knowledge, on iCloud accounts
that had been linked to other clients like Airmail.

On such accounts, node-imap would incorrectly parse the mailbox list
from imap, and return an `Airmail` folder which did not exist, causing
us to try to sync that nonexistent folder and error in the sync loop.

This error is amongst the most frequent we've seen in Sentry and
Support: https://sentry.io/nylas/nylas-mail/issues/213158962/events/4897450600/

The fix es detailed in the PR to node-imap: https://github.com/mscdex/node-imap/pull/594/files
This commit only points the node-imap dependency to our fork for now

Test Plan: manual and unit tests in node-imap

Reviewers: mark, khamidou, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3860",False
c1fdeb01e1a1e40de7b160532dc1562e3bbcdaf8,2017-02-09 04:56:50,Evan Morikawa,"feat(config): dev version now used ~/.nylas-dev instead of ~/.nylas-mail

Summary:
This diff (and the K2 counterpart diff) allow us to run dev-mode Nylas
Mail side-by-side with prod Nylas Mail.

There were 4 things that needed to change:

1. Use different config dir
2. Use different keychain name
3. Use different localhost port
4. Prevent Electron's app.makeSingleInstance from killing our app

All of these are activated through NylasEnv.inDevMode()

Depends on D3861

Test Plan:
Download latest prod build from nylas.com
Remove both ~/.nylas-mail and ~/.nylas-dev
Start up downloaded Nylas Mail, connect accounts.
Run `npm start` (which enables --dev)
Connect account to dev mode
Ensure both clients are syncing and can send/receive mail

Reviewers: khamidou, halla, mark, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3862",False
7b0fb08fc2416e79c06e9aad3a806ef39e5a75fa,2017-02-09 04:46:32,Evan Morikawa,"[local-sync] use different port in dev mode

Summary:
This diff (and the K2 counterpart diff) allow us to run dev-mode Nylas
Mail side-by-side with prod Nylas Mail.

There were 4 things that needed to change:

1. Use different config dir
2. Use different keychain name
3. Use different localhost port
4. Prevent Electron's `app.makeSingleInstance` from killing our app

All of these are activated through `NylasEnv.inDevMode()`.

Test Plan: Manual

Reviewers: halla, mark, spang, khamidou, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3861",False
45d1613981454b5bcade378d9c910646258d9247,2017-02-09 03:51:27,Evan Morikawa,feat(config): dev version now used ~/.nylas-dev instead of ~/.nylas-mail,False
a7c67eaa7cada77fe06df2493e2ed2e4fb371dbc,2017-02-09 03:43:01,Evan Morikawa,fix(snooze): put feature usage before waiting for task move,False
e91bd61a24efee4ff5ad64ab61734edec79afe0e,2017-02-09 02:40:41,Christine Spang,"[cloud-api] Fix forAccount() child logger

Summary:
The global logger was keeping in memory a map of loggers for each account,
probably a holdover from the days when K2 was intended to sync mail in the
cloud. For n1cloud, we already have to create new child loggers for every
request, so keeping a map in memory results in the confusing behaviour
of wiping out any subsequent customizations of the logger, such as what
we do using a route decorator to add the endpoint, etc. to each log
line. This patch gets rid of the internal map and fixes the request
child logger for authenticated requests.

I have included unit tests more as an exercise to get in the habit of
writing tests more than these particular unit tests being super amazingly
useful. Critique on my stream-to-string implementation welcome, I have no
idea what I'm doing. It also feels weird to me to run cloud-core tests under
electron since they run under vanilla node in production, but I'm not sure how
to invoke jasmine specs properly without our N1 spec runner.

Test Plan: unit tests included + manual

Reviewers: mark, juan

Reviewed By: juan

Subscribers: halla

Differential Revision: https://phab.nylas.com/D3849",False
c3d2cb0245de63495ed7f4748957ec653efda906,2017-02-09 01:03:55,Karim Hamidou,"Hide snooze popover if the plugin is disabled

Summary:
Snooze is back in the mainline but not yet ready for primetime. We need to not show the popover if it's not enabled, which is what this diff does. It should be pretty simple to revert it once snooze has officially shipped.

Fixes T7791.

Test Plan: Tested manually.

Reviewers: juan, evan

Reviewed By: evan

Maniphest Tasks: T7791

Differential Revision: https://phab.nylas.com/D3855",False
24ea3bf860418a16856da3c454b083c27e7ecde2,2017-02-08 07:12:08,Juan Tejada,fix(onboarding) Actually trim email field value in form,False
d61b8a0715f15f9d3586c6c7e39bf1a9adc13a26,2017-02-08 04:29:38,Juan Tejada,fix(onboarding) Properly trim field values,False
95639477cc9727d77297a6030174fa58fff723ac,2017-02-08 04:22:40,Juan Tejada,Point to latest release in update notif,False
878a2fe4defd9bb4dc66fb83036939ed16716c14,2017-02-08 02:16:57,Evan Morikawa,"feat(usage): add new feature usage modal

Summary:
This adds the ""You've reached max features"" modal in N1.

http://g.recordit.co/9O7R0mLlXE.gif

Test Plan:
1. Pull latest nylas/cloud-core and start Billing site:
```
  cd cloud-core
  vagrant up
  vagrant ssh
  cd /vagrant
  bin/setup-up-feature-usage
  bin/launch
```
2. Blow away ~/.nylas-mail (err backup your old one first)
3. Restart N1
4. Before logging in, edit `~/.nylas-mail/config.json`
   - set env to ""local""
   - remove `thread-snooze` from the list of `disabledPlugins`
5. `cd /nylas-mail/src/k2` and run `npm start`
6. Restart N1 and create accounts & log in

Reviewers: khamidou, juan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3846",False
7e793a48e696a4367075ea7b94464026a3a709e6,2017-02-08 01:49:44,Mark Hahnenberg,"[search-index] Fix slow UPDATE and DELETE FTS queries

Summary:
FTS tables don't support indices, so doing UPDATEs and DELETEs based on
the `content_id` was very slow on large FTS tables. Fortunately, it seems
that `UPDATE`s and `DELETE`s based on the `rowid` are much faster, so now we
store that info hanging off the searchable models. Also fixes a random bug
where after reaching the `MAX_INDEX_SIZE` we would clear the Thread search
index on startup.

Test Plan: Run locally, time how long it takes to delete when receiving new mail

Reviewers: spang, evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3847",False
bd9678368d0496da774fb5959b88a9901b20c9c6,2017-02-08 01:31:16,Juan Tejada,"[local-sync] Fix local-sync logs relayed to main (browser) process

Summary:
In electron, the --enable-logging flag makes it so the main browser
process logs to stdout all of the logs generated from within the renderer
processes.

Unfortunately, the main process will only log out the first argument passed to
`console.log` from within a renderer process (see https://github.com/electron/electron/issues/7061)

This commit makes it so that the local sync logger logs most of the log line in the first
argument passed to `console.log`

Test Plan: manual

Reviewers: evan, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3852",False
f203f52e0a76452acfd77affade1144ef173617f,2017-02-08 00:49:31,Juan Tejada,[local-sync] Fix SyncMetricsCollector logger,False
32c820d2e50607f9381392bf825b5076f5accd8f,2017-02-08 00:34:10,Juan Tejada,"[local-sync] Log account info in all logs during local sync + color code

Summary:
When multiple accounts are syncing, it's very hard to scan the local
sync logs because it is unclear to which account the logs belong to,
and it makes debugging hard.

This commit makes it so that all logs from local-sync include the
account info, with the account email prefixed at the beginning of each
log line (this allows filtering), and color coded by account.

Test Plan: manual

Reviewers: mark, spang, khamidou, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D3851",False
7ae236b29f9918349ba6565e435b5234ab977991,2017-02-08 00:28:39,Mark Hahnenberg,"[account-store] Don't `getPassword` if we don't have to

Summary:
It's slow, so only do it if we've never seen the Account before. This
fixes jank that would happen somewhat randomly. It was especially noticeable
if the user had a lot of Accounts (and therefore a lot of passwords to
load).

Test Plan: Run locally, verify that we only load new Accounts

Reviewers: spang, evan, juan

Reviewed By: evan, juan

Maniphest Tasks: T7766

Differential Revision: https://phab.nylas.com/D3848",False
9a0cf2955d687add3f92d6107d72ecf17828ce4e,2017-02-07 23:12:34,Christine Spang,Update CHANGELOG.md,False
fbb97a36d3420c8f47963762b820844b024313d6,2017-02-07 22:31:06,Juan Tejada,bump(version) 1.0.22,False
d82113aeb683e914bd5d4fa71c302eec95a3dc9d,2017-02-07 06:52:07,Karim Hamidou,[snooze] s/expirationDate/expiration/g.,False
5df03fac5a46166adc9a9f2876c727c1a8ec74d2,2017-02-07 06:43:25,Mark Hahnenberg,"[notification] Debounce new mail notification sound

Summary:
We don't want to overwhelm a user with a bunch of bings and bongs when
they open their laptop after a long weekend. This diff takes a
relatively simple approach by debouncing the notification sounds every 5
seconds.

Test Plan: Run locally, make sure we still get notified but not too much.

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3841",False
6a068cab31f5977577bb652e05a35d83da37d91c,2017-02-07 06:23:42,Juan Tejada,bump k2,False
13750c7ba3f5abb4f083ab4a8eaf0f5ab14fffce,2017-02-07 06:11:59,Christine Spang,[cloud-api] fix typo,False
c7bdbaa66b005be41179da856a5f7df81deed116,2017-02-07 06:11:35,Christine Spang,":art: better name for nylas-k2-api

'k2 api' is ambiguous now that we embed K2 into N1.

We tag these logs using the rsyslog configuration and never use bunyan's
'name' field, so this only affects local development and won't break
anything in production.",False
dd5d02f069b42fe9c5a3caef1b41e9d5d64fd719,2017-02-07 04:56:22,Evan Morikawa,[cloud-api] fix development variable to use local billing for auth,False
6bab9bc271fd888aacac9fe9b1912157258e691a,2017-02-07 04:30:41,Karim Hamidou,[cloud-workers] Forgot more packages.,False
6d9591916c53f08038eed60eeda3bbb65963ce8d,2017-02-07 03:53:30,Karim Hamidou,Add hapi to package.json,False
d83297247c741c732e1281846665d00fdb21d6a0,2017-02-07 03:39:34,Juan Tejada,"[local-sync] Continously increment timeout for imap connection if we see timeout errors

Summary:
On each sync loop, we increment the socketTimeout based on how many times we've
seen socket timeouts in a row. The max socket timeout is 10m

Test Plan: manual

Reviewers: evan, spang, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3843",False
3dc5eafc12fb7f04129f43f0bc8317b1ad62f3a3,2017-02-07 03:08:59,Karim Hamidou,"[cloud-api] Add support for database migrations

Summary:
This diff adds support for database migration to our cloud API. It's partially inspired by Halla's local-sync migration diff (D3809). You can run a migration by calling ""node-babel scripts/migrate-db up|down"" or by calling ""npm script upgrade-db|downgrade-db"".

Note that for simplicity reasons we assume that we're only writing migrations for our MySQL database – people developing locally may have to blow up there dbs whenever there's a schema change, though in practice `ALTER TABLE ADD COLUMN`statements work the same on both dbs.

Test Plan: Tested locally. Will run the metadata migration on staging.

Reviewers: evan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3840",False
63e76cb3437f540a4599e402e2c35aeac7f37cc0,2017-02-07 02:51:34,Christine Spang,"[cloud-api] Force account selection during Google OAuth

Summary:
Previously, we would bounce directly to the Allow/Deny permissions grant screen
if only a single Google account was already logged in inside your browser. This
could be confusing in that if someone's friend used their computer and left
their Google account logged in, or if you were logged into an account other
than the one you wanted to connect to Nylas Mail, you could end up with a
different account connected than the one you clicked ""Gmail / G Suite""
intending to connect.

The only reason we bounce to the web is to allow users to skip entering their
password, and adding a couple more clicks for this case in order to be more
explicit will yield a better user experience.

Test Plan: manual

Reviewers: evan, juan, mike

Reviewed By: mike

Differential Revision: https://phab.nylas.com/D3842",False
308601fab4da90515708d71495c41446b8518e36,2017-02-07 02:43:22,Christine Spang,run-redis.sh must be run under bash,False
b91131de6cc7413c9b48b2f3ac3cc6637c100ec2,2017-02-07 02:27:48,Juan Tejada,"[thread-list] Convert list-tabular to JS, correctly use shouldCompUpdate

Summary:
This commit converts list-tabular to JS, and in the process re-adds shouldComponentUpdate which had been previously removed (D3837).

This time, shouldComponentUpdate will correctly check if actual data to render has changed, as opposed to checking if `itemPropsGenerator` had changed.

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3839",False
082435585a9655525107ad898f90a45d0ccf75a6,2017-02-07 00:46:36,Karim Hamidou,"[cloud-workers] Add a monitoring endpoint and sentry integration

Summary:
This diff changes the following thing:
1. we now have a `/ping` endpoint which throws a 500 error if something is wrong. To check that everything is alright, we query the database, and check that we've gone through a sync loop iteration recently.
2. we now log all exceptions to sentry
3. all the `console.log` statements have been replaced by proper logging calls.

Test Plan: Tested manually. Will check everything's alright on staging.

Reviewers: halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D3836",False
d6b1119ffc743a77ce283eb94e6f570166b40df8,2017-02-07 00:00:02,Christine Spang,"[local-sync] Download message batches newest first

Summary:
In most cases (and especially so on Gmail and in the inbox on generic
IMAP), messages with higher UIDs are newer---and even if they aren't the
newest possible messages in other generic IMAP folders, they are the
most recent messages that have been moved to that folder.

Our previous batching strategy unfortunately resulted in us downloading
the lowest UID in each batch first, which was especially confusing when
connecting a new account and having the first message pop up on the
screen be a message from hours or days ago.

This patch changes the batching strategy in three ways:

1. Within a batch, we process downloaded messages from highest UID to
lowest UID.

2. We download batches in order of the ones containing the highest UIDs
first.

3. We group together more UIDs within a single batch by ignoring charset
and transfer-encoding on parts and grouping only by MIME part IDs (which
is the only thing you have to pass to the IMAP FETCH command---no idea
why we included this extraneous part data before, probably just
convenience.)

Example old grouping:

  batch key: '[{""id"":""2"",""transferEncoding"":""QUOTED-PRINTABLE"",""charset"":""UTF-8"",""mimeType"":""text/html""}]'
  batch UIDs: [356416,356418,356420,356423,356432,356433,356435,356436,356437,356442,356444]

  batch key: '[{""id"":""2"",""transferEncoding"":""QUOTED-PRINTABLE"",""charset"":""Windows-1252"",""mimeType"":""text/html""}]'
  batch UIDs: [353777]

In the new strategy, all of these messages will be downloaded with the
same FETCH command, reducing IMAP round trips before message processing
begins.

Fixes T7770

Test Plan: manual - connect a new account and see that most recent message downloads first

Reviewers: mark, evan, juan

Reviewed By: juan

Maniphest Tasks: T7770

Differential Revision: https://phab.nylas.com/D3838",False
1b042f85c2972ebb6af0820b09f6147ff0f33e02,2017-02-06 22:41:22,Juan Tejada,Fix local-sync logger,False
f14e363f314d0ff5c92de1e837ebea64ec5d7153,2017-02-06 22:10:29,Juan Tejada,"Fix thread selection with `cmd` and `shift` keys in the thread list

Summary:
We recently added a `shouldComponentUpdate` method to ListTabular to
improve scrolling performance. However, this was preventing ListTabular
from updating the selected state of its items when we selected new
threads via cmd or shift keys.

This occurred because instead of passing data as props for each of ListTabular's
items, we are passing a function that calculates the props for each
item, so when we diffed old props and new props in shouldComponentUpdate,
given that the function reference never changes, we thought that the props
hadn't changed and prevented a re render, when in fact the props for each item
generated by that function might actually change.

Unfortunately, we can't use shouldComponentUpdate in this component
given how it is structured

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3837",False
03d69f5a059867016ea11dac3cd28aabd4864250,2017-02-04 08:58:09,Evan Morikawa,fix(identity): properly post to identity endpoint,False
7dbdd771b0764b1a6e1509a67876694501678889,2017-02-04 08:57:16,Evan Morikawa,[cloud-api] add local billing route for dev,False
a5730ab656b7b1f82f52db039bd8b849e125aef4,2017-02-04 05:22:37,Juan Tejada,bump k2,False
a400ce3ce9c19db1fc941fb9f3ebdd3892796630,2017-02-04 05:10:36,Christine Spang,[cloud-api] More logging fixes,False
f625825c4771b524984ed452b7b3b7fb95e733f4,2017-02-04 05:03:48,Evan Morikawa,bump(k2),False
6b306606c95424e5809eec0da04c888c78faf807,2017-02-04 05:03:31,Evan Morikawa,[local-private] Use databaseReader in error reporter,False
3111c166b8c949cf2a5ef60392d83a53e782ebed,2017-02-04 05:01:31,Evan Morikawa,"feat(usage): Add a FeatureUsageStore and move Identity to the DB

Summary:
This is a WIP

Depends on D3799 on billing.nylas.com

This adds a `FeatureUsageStore` which determines whether a feature can be
used or not. It also allows us to record ""using"" a feature.

Feature Usage is ultimately backed by the Nylas Identity and cached
locally in the Identity object. Since feature usage is attached to the
Nylas Identity, we move the whole Identity object (except for the ID) to
the database.

This includes a migration (with tests!) to move the Nylas Identity from
the config into the Database. We still, however, need the Nylas ID to stay
in the config so it can be synchronously accessed by the /browser process
on bootup when determining what windows to show. It's also convenient to
know what the Nylas ID is by looking at the config. There's logic (with
tests!) to make sure these stay in sync. If you delete the Nylas ID from
the config, it'll be the same as logging you out.

The schema for the feature usage can be found in more detail on D3799. By
the time it reaches Nylas Mail, the Nylas ID object has a `feature_usage`
attribute that has each feature (keyed by the feature name) and
information about the plans attached to it. The schema Nylas Mail sees
looks like:

```
""feature_usage"": {
   ""snooze"": {
     quota: 10,
     peroid: 'monthly',
     used_in_period: 8,
     feature_limit_name: 'Snooze Group A',
   },
}
```

See D3799 for more info about how these are generated.

One final change that's in here is how Stores are loaded. Most of our
core stores are loaded at require time, but now things like the
IdentityStore need to do asynchronous things on activation. In reality
most of our stores do this and it's a miracle it hasn't caused more
problems! Now when stores activate we optionally look for an `activate`
method and `await` for it. This was necessary so downstream classes (like
the Onboarding Store), see a fully initialized IdentityStore by the time
it's time to use them

Test Plan: New tests!

Reviewers: khamidou, juan, halla

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3808",False
68f75a56347c53af1ad80dd62d972ee694d64d04,2017-02-04 03:51:32,Halla Moore,"[local-sync] Remove `isSending` bit

Summary:
`isSending` was an artifact from the cloud sync engine that was used to
double check that the sending process for a multi-send draft had been
initiated. I don't believe the intermediate steps are API calls anymore,
and we've had the relevant code commented out for awhile. Time to kill it!

I've revived the double-sending tests in N1 to ensure we still have sufficient
checks against sending the draft again while the first call is still sending.
See D3834

Test Plan: N1 unit tests

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3835",False
5a38305d7608abc34c971353daaf3139a6064d49,2017-02-04 03:45:39,Halla Moore,"fix(specs): Revive the ComposerView specs

Summary:
We need to wait for the `DraftEditingSession` to set it's draft before we can
pass it to the composer. I've modified these tests to properly wait for the
draft promise. Additionally, I removed the `DraftStore.isSendingDraft()` stub
so we run the actual logic for determing if a draft can be sent. We had some
tests with this stub, but then we had other tests that made sure it worked
without the stub, and I don't see why we don't just run the tests without the
stub to begin with. I added a stub to `@session.ensureCorrectAccount()`
to get around issues with committing the draft's change set.

Test Plan: Ran the suite!

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3834",False
2237223b0b1a2624ea48d6a50d73a06e9acdc2af,2017-02-04 03:39:43,Christine Spang,[cloud-api] Fix updating per-account logger after auth,False
b355a8a40f90b63d134240e89391920a2dbb1fe0,2017-02-04 02:06:14,Christine Spang,"[cloud-api] Add googleapis dep back

This is breaking app launch when the app is deployed.",False
6d715e9bd34586e086462aa2c33838eb2f04b439,2017-02-04 01:51:48,Christine Spang,[cloud-core] Rename database-connector.js to database-connector.es6 for async keyword support,False
d837becb55cbcb497d481a3e7baf4aa1133a1bc5,2017-02-04 01:15:35,Christine Spang,"[cloud-api] Improve logging

Summary:
This commit makes it so we log every request we serve with the path requested,
response code, and the time it takes to serve the request, using the same key
names as we use in the Python API for consistency. It also adds the public ID
of the billing identity to all logs for authorized accounts and turns down the
level of some debug logging that isn't useful in production.

Future diffs coming which consolidate error logging on the request log which
we've found super useful, and also improving local development logging (I'm
gonna fork bunyan-prettystream as it hardcodes which JSON elements it prints).

Test Plan:
need to test on staging - verified basic logging locally but hard
           to test authenticated requests locally (b/c billing)

Reviewers: evan, khamidou, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3832",False
788a5500c10ed0c49288971eadbc2ed695e1c095,2017-02-04 01:00:15,Juan Tejada,:art: rm bad comment,False
0dfe588213c5dc21bae377cb59bb770162018001,2017-02-04 00:12:22,Christine Spang,"[local-api] :art: Remove unused message and file GET routes

Summary:
This code is dead and has confused me grepping around the codebase before.

If for some unexpected reason we need these routes back in the future, we
can always extract them from version control. For now the routes we aren't
using are a distraction.

Test Plan: been using Nylas Mail with this local patch all week

Reviewers: evan, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3833",False
c1ab037cc9273a2ed9d863071c1b0a2790c4d46e,2017-02-03 23:59:25,Juan Tejada,update(changelog),False
00cfad928376273943649da563adcbb81248b24f,2017-02-03 23:50:21,Tomasz Finc,Update CHANGELOG.md,False
5dcf3610e642b4ecb1f5c6312e6a4edd7d341287,2017-02-03 23:49:15,Evan Morikawa,bump(appveyor): build stable branches,False
3c41ee90e416df739ac16ef7cc58c7f3fadba2f1,2017-02-03 10:54:43,Avinash Kuduvalli,Update README.md (#3255),False
00a5f57ef885a9d0a6edf076ad9c2c1393e02892,2017-02-03 07:18:40,Juan Tejada,Fix travis config,False
483aca9bbf9c7d1ce75a2028b610418807772818,2017-02-03 07:16:19,Juan Tejada,bump(changelog),False
9d69c9a7e512c46c08a269f2589660aaca5f760f,2017-02-03 07:12:54,Juan Tejada,Update travis config,False
0146d52da0d05adc8186494e3e0638a8661d7913,2017-02-03 07:03:45,Juan Tejada,bump(version) 1.0.21,False
29e9eacd74b6efa00b715030bd34313752500898,2017-02-03 06:52:58,Juan Tejada,"fix(sync) Make sure we can correctly archive/delete/mark as spam

Summary:
Previously, when moving to trash or spam, we were not correctly removing
the inbox category. This produced slightly different results because the
generated task was slightly different.

Also, in ChangeMailTask we were removing the locks on the models before
the tasks had actually succeeded-- these locks allowed us to ignore
deltas on those models while the task was in progress, so removing them
before it completed caused threads to flicker when performing actions

This depends on D3829 which also properly addresses
archiving/deleting/moving to spam threads that contain sent messages

Addresses T7757 and #2706

Test Plan: unit

Reviewers: evan, halla, spang

Reviewed By: evan, halla, spang

Differential Revision: https://phab.nylas.com/D3830",False
29eeda15be6abfce3b37f06c3e2158846689a31f,2017-02-03 06:52:04,Evan Morikawa,"bump(package): upgrade Raven

fix(log): use new raven",False
d85ca0a9387a1f2ca059e60fd3bf59b7d381cb85,2017-02-03 06:51:32,Evan Morikawa,[local-private] update to use hosted Sentry,False
6c556fe0b2096adf7bdb110ae0e7238c87657195,2017-02-03 06:50:38,Juan Tejada,"[local-sync] Properly set the sent label for Gmail accounts

Summary:
We can't try to set or remove the sent label on gmail accounts because
the operation will silently fail and cause the threads to later bounce
back.

This occurred when trying to delete or archive a thread that contained a
sent message, and we incorrectly tried to overwrite or remove all of the
labels on messages, without regard for sent.

This was causing https://github.com/nylas/nylas-mail/issues/2706 and
sending and archiving to immediately bounce back.

Addresses T7757

Test Plan: unit tests

Reviewers: halla, evan, spang

Reviewed By: halla, evan, spang

Differential Revision: https://phab.nylas.com/D3829",False
b8cd33fdb1f066be871780241eda7bb9cb57a25a,2017-02-03 06:49:13,Juan Tejada,"[local-sync] Correctly retry syncback tasks

Summary:
Previously, we attempted to immeditely retry syncback tasks when a
RetryableError was encountered. However, if the error was an
IMAPConnection error, we would keep retrying with a broken connection,
which would keep failing.

The correct way to retry is to wait for the next sync loop, since at the
beginning of each loop we ensure that we are correctly connected to
imap.

To achieve this this commit simply marks a failed task as NEW if it
encoutners a RetryableError and we haven't retried too many times. To
keep track of the number of retries, we save a new field in the `props`
field of the request.

Test Plan: manual

Reviewers: evan, halla, mark, spang

Reviewed By: spang

Subscribers: khamidou

Differential Revision: https://phab.nylas.com/D3831",False
0e6301f94dc8225a1294eb5a64764636269967c9,2017-02-03 06:35:32,Karim Hamidou,"[N1] Changes required for implementing snooze

Summary: This is a pretty small diff – it changes the snooze-store to save metadata for the individual messages affected instead of for the whole thread. We need this to have snoozing work without running an actual sync of the whole mailbox.

Test Plan: WIP.

Reviewers: evan, halla

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3815",False
fb7836f280a535361adfd7b2867eab678d2112f3,2017-02-03 05:44:59,Karim Hamidou,"[cloud-api] Base infrastructure for running cloud workers

Summary:
I've decided to break my snooze patches in multiple parts to make it easier to review. This diff contains all the code related to running workers in the cloud. Cloud workers all inherit from the `Worker` class which defines a bunch of useful things like error handling.

What's left to do:
- spawn workers based on the plugin type
- add monitoring (I'm going to add a simple HTTP endpoint for that)
- writing a migration for the local sync db and the prod metadata db.

Test Plan: Tested manually.

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3814",False
a89358ec88012e0fcc8494d97ebdccb0f1e403a7,2017-02-03 05:41:52,Mark Hahnenberg,"[config] Refactor config to fail faster

Summary:
We're having some strange issues regarding corruption of the config
settings at runtime. This diff refactors the code to be more
straightforward and to be louder when things don't go as expected.

Test Plan: Run locally

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3828",False
f195118049cc3bd1cd1a4e8dcda4d38473adf6f1,2017-02-03 05:27:13,Evan Morikawa,feat(db): extract db setup and don't send sync errors to config,False
71046c837f76692f71c442fba3f5d917c743f5bd,2017-02-03 05:11:41,Evan Morikawa,bump(k2),False
13b2488d64ed034a29aadb550b83fe4719d6c4ff,2017-02-03 04:22:22,Juan Tejada,"feat(specs) Clean up local-sync database after each spec

Summary: Clean up k2's test database after each spec. Depends on D3826

Test Plan: unit

Reviewers: evan, halla, spang

Reviewed By: halla, spang

Differential Revision: https://phab.nylas.com/D3827",False
141a03effa294ca3b15f3f489072d57ec952445b,2017-02-03 04:18:26,Juan Tejada,"[local-sync] Small restructuring of local-sync specs

Summary: Make them map the same directory structure of `src`

Test Plan: unit

Reviewers: evan, halla, spang

Reviewed By: halla, spang

Differential Revision: https://phab.nylas.com/D3826",False
189745dde46ede2246f92ede419552391bdb0a20,2017-02-03 03:58:44,Tomasz Finc,Update README.md,False
9c7d559cd5874238aae7bb79a905a97c946b1aff,2017-02-02 07:34:58,Evan Morikawa,"Revert ""feat(config): move config to database""

This reverts commit a60816c9037293e7c32c29b15701336d7ec87d24.",False
2f2cd925d050beec38eb7057d1b5c3a6b7e13b19,2017-02-02 03:36:33,Halla Moore,"fix(SyncActivity): Add keys to ellipsis components

Summary: Just a quick fix to remove the warning in the console

Test Plan: manual

Reviewers: mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3823",False
a60816c9037293e7c32c29b15701336d7ec87d24,2017-02-02 03:06:30,Evan Morikawa,"feat(config): move config to database

Summary: Move config to the database

Test Plan:
Launch app before commit.
Launch on commit.
Confirm all settings and accounts stay the same.
Console.logged progress

Reviewers: mark, halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3820",False
ee3a655ebe0c4bd2793793b46716efcba6311cab,2017-02-01 20:46:35,Christine Spang,"fix(sync-status): Use sync progress from K2

Summary:
Sister diff to D3817

syncState on folders may contain arbitrarily long arrays of UIDs
(particularly, failedUIDs). If we serialize this JSON column to
edgehill.db, we can end up serializing very large objects when
persisting the local task queue. When the queue contains many tasks,
this can balloon the JSON blob to megabytes, causing the main window and
the worker window to become unresponsive.

The UI doesn't need to know about IMAP bookkeeping internals, so
serialize the sync progress instead of the sync state. This has the
advantages that (1) we don't need to worry about future keys added
to the syncState being large and (2) when we add Exchange support
we already have an abstraction for sync progress.

Test Plan: manual

Reviewers: juan, mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3819",False
5b659382d61f2774040be1e310f380bd7e0bea78,2017-02-01 20:45:33,Christine Spang,"[local-sync] Serialize category sync progress to edgehill rather than syncState

Summary:
syncState on folders may contain arbitrarily long arrays of UIDs
(particularly, failedUIDs). If we serialize this JSON column to
edgehill.db, we can end up serializing very large objects when
persisting the local task queue. When the queue contains many tasks,
this can balloon the JSON blob to megabytes, causing the main window and
the worker window to become unresponsive.

The UI doesn't need to know about IMAP bookkeeping internals, so
serialize the sync progress instead of the sync state. This has the
advantages that (1) we don't need to worry about future keys added
to the syncState being large and (2) when we add Exchange support
we already have an abstraction for sync progress.

Test Plan: manual

Reviewers: juan, mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3817",False
271dcb044d38fd42e338104f99b55b1bfea6de0b,2017-02-01 20:28:37,Evan Morikawa,bump(version): 1.0.20,False
2531f16067dba21e7821c3000651b57f58a3fe64,2017-02-01 20:27:41,Evan Morikawa,bump(k2),False
c993ec3b8749e73d4eb1ab8f457debfa21a05858,2017-02-01 20:27:30,Evan Morikawa,[local-sync] properly cleanup broken messages,False
6dad8e7ec80e70bfb54fbe34baacea404e22dc0d,2017-02-01 19:54:17,Evan Morikawa,bump(k2),False
1c73d83b78faa2b2726c992965011cfca9a79254,2017-02-01 19:54:03,Evan Morikawa,[local-sync] fix cleanup of sent messages,False
e8c1f35365c25f64fcf68509db658c015eec174d,2017-02-01 07:34:30,Evan Morikawa,bump(changelog),False
f2e11bcefc60947e70c56be8f0f41bcec9a5c99e,2017-02-01 07:31:30,Evan Morikawa,bump(version): 1.0.19,False
7d594d26a0482605e28f2e607a74772d2d79af26,2017-02-01 07:31:09,Evan Morikawa,bump(k2),False
f83d0aeec7d12753cb3915f9e48a8605b1f06b02,2017-02-01 07:30:42,Evan Morikawa,[local-sync] fixed issue where single digit date would create dupes,False
60ca623fc1d534451db5d04e1b81a038a89e89e2,2017-02-01 06:08:51,Mark Hahnenberg,"[composer] s/console.warning/console.warn/

Summary: See title

Test Plan: yolo

Reviewers: juan

Differential Revision: https://phab.nylas.com/D3818",False
e09ada7f43244f98fbe603b9ca3ba591c9cda8a7,2017-02-01 06:05:51,Evan Morikawa,bump(k2),False
735fb468f8b86ad245c7026bfa58bb8b6ba22fed,2017-02-01 05:29:56,Juan Tejada,[local-sync] Save error when clearing tasks INPROGRESS,False
f44ff52f118b115c2854c7849cad3230df971594,2017-02-01 02:15:57,Juan Tejada,Properly handle non-api errors in account delta conn,False
6d43680b59adb3d0ad1449d12fc9764d35b9ac0c,2017-02-01 01:37:27,Juan Tejada,"[local-sync] Imrpove error handling in delta connections

Summary:
We were mostly ignoring errors in our delta streaming connections. This
commit makes it so that if we get an authentication error from n1Cloud we mark the
account as invalid so users know to re authenticate, and can properly receive metadata deltas

If the error is not an authentication error, it automatically retries
the delta connection.

Addresses T7744

Test Plan: manual

Reviewers: evan, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3813",False
64dd427acafb9f8cc1f0669d1bbcb175d1305a0d,2017-02-01 00:27:24,Evan Morikawa,Add redis back into pm2,False
a88923f001677c16ca6b02d1bb5307f28e8d152e,2017-02-01 00:24:18,Juan Tejada,"[local-sync] Retry syncback tasks that throw retryable errors

Summary:
This will prevent us from showing error messages to the user when we
can automatically recover from the error

Test Plan: manual-- throw error from syncback task, check expected results

Reviewers: evan, mark, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3812",False
ee50a1cbdff50db77eb62eef5db0df904dd9cd95,2017-02-01 00:23:43,Juan Tejada,"[local-sync] Account for additional IMAP retryable errors

Summary:
There are 2 types of IMAP errors that need to be treated as retryable. See code
comments as to why.

Test Plan: manual

Reviewers: khamidou, evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3811",False
eacb5eeb0f41a1494e5a7ba3406f70a8709fdaba,2017-01-31 11:58:38,Juan Tejada,:art: remove outdated comments,False
6114e7b05d253a7c62525ff5cef9516b5553f825,2017-01-31 11:30:17,Juan Tejada,bump(k2),False
439ba5737fa9a991caf8aa6be802d908b20f8cae,2017-01-31 11:29:03,Juan Tejada,[local-sync] Report permanent sync errors to sentry,False
2170926dc7faea8d524c3139a11c3d33625cb418,2017-01-31 05:44:48,Halla Moore,update(docs): Add note about Linux dependencies,False
f10e388338b39a4d83893a42e5f4af8285f637d4,2017-01-31 05:25:13,Evan Morikawa,bump(electron): bump electron to 1.4.15,False
7b3c4a2c5b2343854243c44adaa25df3d3c7b414,2017-01-31 05:10:52,Evan Morikawa,"fix(ci): add linux dependencies for keyboard-layout plugin build

https://github.com/atom/keyboard-layout/issues/27",False
c97e016c72c444361e109d1966af5ab7c6eeca27,2017-01-31 04:53:57,Evan Morikawa,bump(version): 1.0.18,False
854a44737eb4c6d8f45c8e50e1ba2c9c022409bf,2017-01-31 04:53:41,Evan Morikawa,bump(changelog): 1.0.18,False
6af27996d4e4846820951c7e21f1743b1aaaff65,2017-01-31 04:12:41,Mark Hahnenberg,"[composer] Fix weird refocusing when plugins load

Summary:
We weren't properly keeping track of the focus state in the ComposerView which
would cause us to lose track of what was focused when plugins were eventually
loaded.

Test Plan: Run locally, verify that we don't lose focus

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3801",False
b0788908dc12417158545d1eb0aa2d996a0c038b,2017-01-31 03:14:27,Mark Hahnenberg,"[composer] Fix autoclearing of participants field in composer

Summary:
Occasionally, if the composer plugins took too long to load, the user would
start typing only to have their text blown away when the plugins finally came in.
This was caused by carelessly overwriting the TokenizingTextField's stored
inputValue state in componentWillReceiveProps. Now we don't do that!

Test Plan: Run locally, make sure things don't get blown away

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3806",False
065f54b62e4ebf666fb1ee809615e293f1c0fa1a,2017-01-31 03:13:12,Mark Hahnenberg,"[perf] Fix CSS animation for ellipses in ""Syncing your mailbox""

Summary:
This animation was changing the width of the after pseudoelement, which was
causing a lot of repainting and layout to occur in the very bottom corner of
the screen. This in turn caused an idle window to use 50-70% CPU all the
time during initial sync. The fix is to change the after element to three
spans and modify the animation to alter their opacity which avoids having to
do style and layout reflows due to width changes. It also looks slightly cooler
IMHO :-) An idle main window now sits around 8% CPU on my laptop.

Test Plan: Run locally, verify that CPU is lower.

Reviewers: evan, juan

Reviewed By: juan

Subscribers: halla

Differential Revision: https://phab.nylas.com/D3810",False
dc8c1c85fa6a851950680b7ced23870b9094fcf2,2017-01-31 02:35:36,Michael Grinich,"Update docs config

- Don't ignore built class docs
- pin requirement versions for docs
- update docs build instructions
- update repo URL",False
28bffac41a9129702110b85f713c2984072ac2ae,2017-01-31 01:20:39,Evan Morikawa,fix(rename): update nylas/N1 to nylas/nylas-mail Github references,False
78edc7078c8f379bb470bf6001e6e2003bf7952b,2017-01-31 01:20:15,Evan Morikawa,[*] update nylas/N1 to nylas/nylas-mail GitHub link,False
e6cc740a71640ad5d3f89e5dfd6990eaeabcecdf,2017-01-31 01:10:03,Evan Morikawa,fix(rename): remove n1-next references & update changelog link,False
c56b9dec12897d9316ba040b8eab45eed7262b5e,2017-01-31 01:09:18,Juan Tejada,bump(k2),False
176cfcd59dccbac89a39d6250e561c33cae16be2,2017-01-30 16:48:52,Michael Grinich,Update README.md,False
90b89a26fdac6e173f0c1266ec9c32d21c95ca77,2017-01-30 16:19:48,Michael Grinich,Add built docs,False
02f83e97aff010999f752f50006e22d80b7579c0,2017-01-30 16:17:35,Forbes Lindesay,Add the GitHub community plugin (#3197),False
ab28a66d6aef721e38058b0554894daf81b17222,2017-01-30 16:17:28,Richard Lai,Fix typo (#3173),False
610751ba7c3d0e44ce03ba94bdaa3a24c02559d9,2017-01-30 16:17:15,Paul Xu,"Normalized size of buttons in preferences (fixes #2753) (#3112)

Normalized size of buttons across signature, accounts and mail rules preferences. Also make signature pane same size as other preference panels",False
819e10ed775327e45adae97c8853ed7c84ec7f41,2017-01-30 16:16:58,John Oksasoglu,"Fix link to Flux diagram in Architecture.md (#3147)

It looks like the location of the Flux architecture diagrams got moved around on the Flux docs; this change updates the link here to the new location of the diagram.",False
4984ba58d47400bc998acf73e8519f1b9514c7de,2017-01-30 16:15:57,Michael Grinich,Merge branch 'master' into n1-next,True
6ef4a6fd9869f7220ec9ae48fef224b5f7245f48,2017-01-30 16:08:37,Michael Grinich,Update documentation with GitBook,False
da1a358cc34ad20fc7425382be773994c856dc55,2017-01-28 15:53:03,Juan Tejada,"[cloud-*] Move babel devDependencies to dependencies in pkg.json

Our Dockerfile only install production dependencies `--production`, so
lerna and babel dependencies need to be listed under `dependencies`",False
73d8cc50ff9dd66f8bffb307d2eb7c33ff5b636e,2017-01-28 15:30:16,Juan Tejada,"[cloud-*] Fix n1-cloud build

We added new presets and plugins to the k2 .babelrc but didn't add the
respective dependencies in our package.json, so the build was failing.

Add the required dependencies, and make sure that `build-n1-cloud.js`
uses the correct babel presets and plugins",False
87d1683c00b230c12b6907374453a2dce8607a2f,2017-01-28 15:10:18,Juan Tejada,bump(k2),False
1e0d953f6105405c8d8534362701100071cdb82a,2017-01-28 04:45:48,Evan Morikawa,[cloud-api] properly log and report authentication errors,False
c0ce77b60ccbfa4b6208a6a8cb7651cd6aaaa9b1,2017-01-28 04:19:38,Evan Morikawa,bump(k2),False
05ba9e2e879a73588624cb1a1e5b223fe06c3f24,2017-01-28 04:19:26,Evan Morikawa,[cloud-workers] remove babel,False
c90c62a3192a3a20560ec6ccb5e93cec1ce091a9,2017-01-28 04:16:39,Evan Morikawa,bump(k2),False
34a880e797fef3b47f2c88c6c833377e0441c595,2017-01-28 03:52:40,Juan Tejada,[cloud-*] Fix request.logger,False
c87a66ad613b3638f1645736b9e2296fc34af6e3,2017-01-28 03:32:50,Juan Tejada,"fix(tasks) ChangeMailTask should depend on EnsureMessagesInSentFolder

Summary:
See title
Add specs

Test Plan: unit

Reviewers: halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D3805",False
76664cb67df7d17d9ddeb79f899195b4bf808976,2017-01-28 03:27:19,Juan Tejada,"[local-sync] Fix compilation of FetchNewMessagesInFolder operation

Summary: This was broken because babel could not compile the `super` keyword

Test Plan: manual

Reviewers: evan, mark, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3804",False
c3b9c75219b9541ede42e5028baceda784f40a06,2017-01-28 03:04:16,Evan Morikawa,Use babel-cli in devDependencies instead,False
77da6d07da4a8bdf157155c2cbd07db966fd4f71,2017-01-28 03:01:02,Evan Morikawa,Make K2 babelrc match Nylas Mail babelrc,False
ed2adb463d751ab912145456b7066074e6897191,2017-01-28 02:56:35,Evan Morikawa,Add babel-node as a dev dependency,False
0aa3668899f158a1e8982f188b659b9d357f71a8,2017-01-28 02:24:57,Juan Tejada,bump(changelog),False
fc0593875e541c8571a041577f5a4467ddd8e135,2017-01-28 02:21:49,Juan Tejada,bump(version) 1.0.17,False
dfe4b0f809818d7a54d3c8c528c5f2838e187478,2017-01-28 02:20:35,Juan Tejada,bump(k2),False
a3a962c55814823336f3b744d0fc7d2e34b9bea3,2017-01-28 02:20:19,Juan Tejada,"[local-sync] Sync new uid in sent folder when moving to msg to sent

Summary:
EnsureMessageInSentFolder also needs to sync the sent folder to fetch
the uid of the newly moved message (like `MoveThreadToFolder` does)

Test Plan: manual

Reviewers: halla, mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3803",False
1eb75adf5557801d5c52e88d1a7d5bac73538419,2017-01-28 02:19:18,Juan Tejada,"[local-sync] When fetching /new/ messages, make sure we have fetchedmax

Summary:
In `FetchNewMessagesInFolder`, sometimes we haven't synced anything in the folder
we are trying to fetch new messages in. Previously this would just throw
an error, now we properly check if we have a fetchedmax, and if not just
run a normal fetch.

Also, when the target folder box was already open, we were not fetching the /latest/ box status to check the latest uidnext value, so we would skip fetching new messages when in fact there were new messages to fetch

(This can happen for example when moving a sent message to the Sent
folder before we've started syncing the Sent folder)

Test Plan: manual

Reviewers: halla, mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3802",False
ff9d089e860b0674c9b1fa961eaa9eb0ef97c442,2017-01-28 02:09:49,Evan Morikawa,[cloud-core] fix scope of STORAGE_DIR for local K2 running,False
c74d0feab397489b4b5367834b8aeeded85445fc,2017-01-28 01:18:06,Juan Tejada,"[cloud-*] Add more detailed logs to auth endpoints

Summary: see title

Test Plan: manual, deploy to staging, check that it works

Reviewers: evan, spang, tomasz, khamidou

Reviewed By: tomasz

Differential Revision: https://phab.nylas.com/D3800",False
4b35d3276c8a625ff6f2465443a5c7afc3e8d6d5,2017-01-28 00:49:48,Evan Morikawa,bump(k2),False
7114eac49f897f889ef21a70f541588b272cf388,2017-01-28 00:06:46,Juan Tejada,[cloud-*] Add more logging,False
faf5e77fefa386e06edec724adefe37d57a93129,2017-01-28 00:00:45,Mark Hahnenberg,"[search-index] Embiggen Thread and Contact indexes

Summary: See diff title

Test Plan: Run it

Reviewers: juan, mg, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3794",False
96115c3a7ef0c601b0dce334f1857fdd526e2b79,2017-01-27 22:39:18,Juan Tejada,bump(changelog),False
50485496c1d9e36656c627d57bb5afbb868a6d21,2017-01-27 21:59:27,Juan Tejada,bump(k2),False
33000b88305c18dcd2d50ee1bf56f89db0a68317,2017-01-27 21:58:33,Juan Tejada,"[local-sync] Ensure messages always have a uid after syncback tasks

Summary:
Syncback tasks that move messages to a different folder used to leave
those messages without a uid because it was unknown at the moment, and
it would only be discovered later on in the sync loop.
This had the unwanted effect of not allowing you to perform more than 1
syncback action on the same thread back to back (e.g. undoing an archive, or
sending and archiving immediately)

This commit makes it so that `SetThreadFolderAndLabels` and
`MoveThreadToFolder` runs a new sync task to fetch the new uids for the
moved messages.

We do this via a new sync task, `FetchNewMessagesInFolder` which /only/
fetches new messages in a folder (no fetching old messages or attribute
updates). This is a first step to cleaning up the gigantic
`FetchMessagesInFolder` task into smaller parts-- but that will come in
a separate diff. For now we want to fix the immediate problem.

See D3788 and D3789 for more details

Test Plan:
manually move threads around, undo moving threads, reply on a thread
and immediately archive

Reviewers: khamidou, mark, spang, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3798",False
36f9dd9ad28a7b7a46af78409268ba334a049773,2017-01-27 20:41:27,Evan Morikawa,bump(version): 1.0.16,False
83a28ae5abbef0a016f941343ce0ed1d6529d2b7,2017-01-27 20:41:09,Evan Morikawa,bump(changelog): 1.0.16,False
0963e116a732738ba4a4f74e77b564357b1bf681,2017-01-27 13:46:28,Juan Tejada,[cloud-*] Prevent runtime errors while logging in auth routes,False
5d870f54af6e0d6211ed4bae31ee3d859f94697e,2017-01-27 13:38:16,Juan Tejada,[cloud-*] Add more logging to auth endpoints,False
c371fa4ff6e1b852ae1f6b7dc819f47cc847ac60,2017-01-27 05:38:17,Juan Tejada,"[local-sync] Correctly check presence of messages when updating thread

Summary:
updateMessagesFromThread requires `messages` to be an array only when
recompute is falsy

Test Plan: manual

Reviewers: halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3797",False
90481e877c4a09fdad4e20fc032448a225701580,2017-01-27 05:35:18,Juan Tejada,"[local-sync] Correctly check uidvalitity when syncing and save when updated

Summary:
If there were any uidvalidity changes after we've completely synced a folder, we
would completely ignore them and not attempt to sync the folder.

Also, we weren't saving the latest uidvalidity from the box to the folder
syncState as soon as we recovered, we only saved it until after fetching
messages. This meant that if the operation was interrupted before updating
syncState.uidvalidity, we would always think that we were in a state of uid invalidity

Recovering from uidvalidity was also broken because we weren't resetting the
fetched ranges, and unnecessarily setting the folderId to null, which meant that
we would never restore the uids of messages we had already fetched.

Test Plan: manual

Reviewers: evan, khamidou, mark, halla

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3796",False
6aa7e3ffab0bdaecc233909ab0ab39e964a83e36,2017-01-27 04:57:56,Juan Tejada,"[local-sync] Correctly close imap connections when downloading files

Summary: Addresses T7708

Test Plan: manual

Reviewers: evan, khamidou, mark, halla

Reviewed By: khamidou, mark, halla

Subscribers: halla

Differential Revision: https://phab.nylas.com/D3795",False
d62657d70a15dcebc2a996328cef8aae6dc3b76b,2017-01-27 03:10:45,Mark Hahnenberg,"[spellcheck] Fix spellcheck debouncing

Summary:
Previously we were only debouncing one function in onContentChanged. This would
cause us to do very expensive things on every keypress in the things that
weren't debounced. This diff changes things so that we debounce the entire
process of running the spellchecker.

Test Plan:
Run locally, make sure spellchecker doesn't run on every keypress.
Misspell lots of things, type really quickly, paste large chunks of text
into the composer.

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3791",False
b3e0aa2c2024018dc1dc63e21abe667b9bfc6dd9,2017-01-27 03:08:40,Juan Tejada,bump(k2),False
7ce412288de568802cc089ea7db9bbdde41253c1,2017-01-27 03:02:39,Juan Tejada,"[local-sync] Make invalid imap box errors retryable

Summary:
If we attempt to operate on a box that is no longer open, we should make
the error retryable so that we re-open the correct box and continue
syncing instead of showing the scary red box to users

Addresses T7680

Test Plan: manual

Reviewers: evan, spang, halla, mark

Reviewed By: halla, mark

Subscribers: mark

Differential Revision: https://phab.nylas.com/D3792",False
048c240229aeac9f78689d4137ba71fbd82dcae9,2017-01-27 03:01:53,Juan Tejada,"[local-sync] Ensure syncback actions have uids available before running

Summary:
Given that we perform syncback actions optimistically, i.e. we save the changes to the database before they are synced, some messages might not have an IMAP UID if they haven't been synced in the loop.

When we encounter messages without uid, we could just skip them, but this would mean that we end up moving only a subset of the messages we intended to move, or not move any at all, while thinking that we /did/ move everything, which might cause the thread to bounceback later on when we sync the messages that were missing.

The permanent fix is for syncback actions to not succeed until their changes have been synced, which is coming up in a separate diff

Test Plan: manual

Reviewers: evan, spang, khamidou, mark

Reviewed By: mark

Subscribers: mark

Differential Revision: https://phab.nylas.com/D3789",False
86e4bbd0f9d09e8f5e6734cdc8f4dfad0dfdb96b,2017-01-27 03:00:40,Juan Tejada,"fix(tasks) Notify when actions on threads fail

Summary: It is better to notify that a task failed rather than having a thread or group of threads randomly bounce back.

Test Plan: manual

Reviewers: evan, spang, mark, halla

Reviewed By: mark, halla

Subscribers: mark

Differential Revision: https://phab.nylas.com/D3790",False
fe940941a5c1eee34d336b00e46284be0995d514,2017-01-26 22:49:42,Juan Tejada,bump(k2),False
009673dc5e32bfb20e63759cb27d57e8312647f3,2017-01-26 22:49:17,Juan Tejada,[local-sync] Fix transaction syntax,False
62ec7504f4a0a33f912826c2ba65d062dace8bb7,2017-01-26 22:41:01,Juan Tejada,bump(k2),False
aedc1bb3e5ff60a1b446484a00bcbf4505ef9d45,2017-01-26 13:36:20,Juan Tejada,Add comment,False
9fd9b5c7ff22e6d9c3e93381264b2175b1384b6e,2017-01-26 13:36:20,Juan Tejada,[local-sync] Make sure folder move syncback actions clear folderImapUID,False
bbc54ab26d98708cfe7f3f8192a14a99496fe417,2017-01-26 12:11:54,Juan Tejada,"fix(plugins) Unbreak plugins support in Nylas Mail

Properly use plugins specified in babelrc.json when using the babel
compiler. #3187",False
5d0cf5c8f1c03ad4191269122421e48d686908df,2017-01-26 06:27:56,Karim Hamidou,Snooze and send-later worker is running on a single worker right now.,False
26c935fe750d48c103377eb66d4ed0aa63dfe315,2017-01-26 06:17:04,Juan Tejada,bump(version) 1.0.15,False
0f101ea03b93d27f649473e5122defc372ddf3ce,2017-01-26 06:07:54,Juan Tejada,bump(k2),False
dc0e0f753412f9da4044fd7608f19c2ca0096776,2017-01-26 06:01:20,Christine Spang,"[local-sync] Avoid skipping All Mail updates if no new messages during Gmail inbox sync

Summary:
In JavaScript, null <= null is truthy. So if you set fetchedmax but not
fetchedmin and minUID, and then highestmodseq doesn't increment, we will
incorrectly skip updates on All Mail after the first batch of Gmail
inbox UID downloads, only making further progress on sync if the user
receives a new mail.

This patch tightens isSyncComplete() to require that all variables used
in the math comparisons are set.

Test Plan: manual :cry:

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3787",False
36a3cac13173512a44e9053f20cc49fb77b5be7f,2017-01-26 05:56:40,Karim Hamidou,"Changes to get the cloud workers to run in our staging environment

Summary:
Summary of the changes:
- renamed some files to es6 to be able to use babel
- only try to create a db folder when we're using sqlite
- drop use of redis
- create a skeleton folder for workers.

Test Plan: Works on staging.

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3784",False
23903178a4c41a8a351b239f05bcc3e1be7dd3ed,2017-01-26 04:36:58,Juan Tejada,"fix(onboarding) Allow users who only have custom imap to auth

Summary:
Users who only had a custom imap account could not open the window to
add a custom imap account the first time the auth was opened, rendering
the app useless for them.

Github issue #3185 and T7691

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3783",False
a79c5de0d35a1104245ed5fc5faf2da85cc59c55,2017-01-26 04:24:38,Mark Hahnenberg,"Don't register to receive IPC for hot windows

Summary:
These windows don't need to receive IPC until they're being used for something
(i.e. after transitioning from hot window to composer, popout, etc)

Test Plan:
Run locally w/ hot windows shown, make sure that hot window doesn't
receive IPC

Reviewers: evan, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3780",False
721f6dabe73b7350f3bfdf579bdd47c59f4e8464,2017-01-26 04:24:13,Mark Hahnenberg,"Use meaningful names for helper processes

Summary: See diff title

Test Plan: Run locally, check in htop for new titles

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3778",False
4cefe70e29df8acd9cd484dbf149bb5328b640f1,2017-01-26 04:13:11,Evan Morikawa,"fix(specs): change spec scheduler back to setTimeout

Summary:
Adds a new `npm run test-window` that will launch specs in a window so you
can use the debugger

The spec window wouldn't close because `onbeforeunload` was unnecessarily
preventing close. This circumvents this in spec mode.

Most significantly I discovered we can't use the synchronous timer for the
promise scheduler anymore. Suppose you do:

```
it('should error', async () => {
  try {
    await doSomething()
    throw new Error(""doSomething should have thrown!"")
  } catch (err) {
    expect(err.message).toMatch(/my message/)
  }
})
```

The way async/await is transpiled, when `doSomething` throws, the error
will propagate all the way back up to the uncaughtPromiseException handler
before the `catch` gets called and registered. The transpilation method
assumes that when the function gets executed it can synchrously advance
beyond the call before the `then` or `catch` resolve. When the promise
scheduler is synchronous this doesn't happen.

I chose to use `setTimeout` instead of `process.nextTick` or
`setImmediate` as the promise scheduler. `setTimeout` seems to work better
with Chrome's async function call stacks. `nextTick` and `setImmediate`,
being Node methods, skip Chrome's async watchers.

Test Plan:
I talked with Juan about these changes, in an upcoming diff he will be
testing these in the context of our broader test suite.

Reviewers: mark, khamidou, halla, spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3779",False
1f51d80a745eff1ab494ebc5d8675634792c714c,2017-01-26 03:41:45,Evan Morikawa,bump(k2),False
e0bde37e72977d4ee5f2a9d7540955fd344169e0,2017-01-26 03:33:29,Mark Hahnenberg,"[local-sync] Set isBatteryCharging on startup

Summary:
Previously we just assumed that we were in the ""charging"" state and wouldn't
update that until the state changed. This would cause us to throttle even if
the app was opened while plugged in. Now we don't do that.

Test Plan: Run locally, verify that we no longer throttle

Reviewers: spang, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3782",False
95e840cf827ae8e7a936c42295bbb5cafd63d1e0,2017-01-26 03:23:17,Juan Tejada,bump(k2),False
f63d5b60d230727e08b3ce02ca63ef4efcdd7419,2017-01-26 03:23:03,Juan Tejada,"[local-sync] Fix isDraft check (check array exists)

Summary: see title

Test Plan: manual

Reviewers: spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3781",False
e1c0e248d1f07c3369bec8d48105213e452b123c,2017-01-26 01:58:47,Juan Tejada,bump(version) 1.0.14,False
a621392c34b8a8f49a6eb1b0c6dc91077b8498a8,2017-01-26 01:58:09,Evan Morikawa,bump(k2),False
57cf9178b269021d390f127eb0b0f5745cc2d781,2017-01-26 01:56:38,Evan Morikawa,"bump(spellcheck) upgrade to 1.0.0

Summary: This bumps the spellcheck and restores the specs

Test Plan:
Manually open a composer, type some text and ensure it underlines them as
misspelled. Also restore test coverage

Reviewers: mark, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3776",False
f6029c99362bf19e138ad41caad9b0cb347c5210,2017-01-26 01:55:34,Juan Tejada,"[local-sync] Fix attribute updates

Summary:
Previously, when updating message attributes during folder sync, we
would fetch local db messages only by folderImapUID. This was incorrect,
because messages in different folders could have the same uid, so our
query would return messages from other folders, causing us to
incorrectly update their attributes.

This commit ensures we fetch local messages in the current folder

Test Plan: manual

Reviewers: evan, halla, mark, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3777",False
21cb8d2997427764ca15cb701bfa4868ed558980,2017-01-26 00:42:27,Juan Tejada,[cloud-*] Catch and log errors when creating storage dir,False
93c229861690f8fa04f8cc1853c384715a400854,2017-01-26 00:38:08,Juan Tejada,[cloud-*] Disable cloudwatch logs,False
2b6ed6937a085fcd1e2af46248dd15f957356f1d,2017-01-26 00:34:58,Juan Tejada,bump(changelog),False
0a7a708d3905f49200067f20b70fb7f2d9a70268,2017-01-26 00:27:16,Juan Tejada,bump(k2),False
526964b61964cc84b89644b6c81633237f2f65fe,2017-01-26 00:20:10,Juan Tejada,"[local-sync] Make sure thread is saved before updating folders/labels

We now correctly `await` for the `setFolders` and `setLabels`
operations, and make sure that the thread is always saved.

Apparently the `thread.id` check wasn't working as expected and we were skipping a
thread save, which only became apparent when we awaited for `setFolders`
and `setLabels`. Now, we always save the thread (like we did before this
method got updated)",False
363a81b49ea93f42adf72deaf537d9927640452e,2017-01-26 00:06:46,Christine Spang,"[local-sync] Sync isDraft correctly on Gmail

Summary:
When I tested if we could use labels in place of the flag, I had the
Drafts folder selected, not All Mail, and the label did not show up.
Turns out that if you have All Mail selected, all draft messages will be
correctly tagged with the Draft label.

With this patch, we should correctly sync isDraft on all supported
providers and suppress these messages from the app until if or when we
decide to implement draft sync.

Thanks Brandon Long from the Gmail team for the help in getting this right.

Test Plan: manual

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3775",False
15ce4983a919841fa7bebc96060cf8574fe0e50d,2017-01-25 23:29:36,Juan Tejada,"[local-sync] Outbox shouldn't be included in localized names for `sent`

Summary:
Otherwise accounts with `Sent` and an `Outbox` will both get the `sent`
role, causing inconsistencies in sync

Addresses T7682

Test Plan: manual

Reviewers: khamidou, spang

Reviewed By: khamidou, spang

Differential Revision: https://phab.nylas.com/D3773",False
af2139f6fb60119842b7f6949e3ea46f597522bd,2017-01-25 23:26:46,Mark Hahnenberg,"Add option to silence query plan debug output for individual queries

Summary:
Sometimes you have to perform a query that needs to do a table scan. For those
times you don't want to silence entire classes of queries (e.g. by table name),
you can now silence individual queries.

Test Plan: Run locally, verify that noisy stuff disappears from logs

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3763",False
59c1fcb121cfe24e27a1eea3a65015baf45259d0,2017-01-25 23:23:48,Christine Spang,"[local-sync] Remove duplicate db calls for looking up existing messages

Summary:
Now that message processing is serialized, this is unnecessary. I
was debugging something else and watched the code step through the
exact same db query twice in a row.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3764",False
9d4acc9110994ab8edcc5961cead5bdd59dbb73d,2017-01-25 23:19:16,Christine Spang,"[local-sync] Still sync new mail during Gmail inbox UID prioritization

Summary: Fixes T7620

Test Plan: manual

Reviewers: mark, juan

Reviewed By: juan

Maniphest Tasks: T7620

Differential Revision: https://phab.nylas.com/D3765",False
9a39415f113dc58a62d4ca1c3c9facf739fc15e7,2017-01-25 23:15:20,Christine Spang,"[iso-core] Split cert validation error handling off socket error handling

Summary:
Now that we don't do strict validation of certificates for non-major IMAP
providers this shouldn't come up as much, but when it does we're gonna
want a better error message to help support out.

I am not 100% sure there aren't other socket errors that should be fatal,
but this was the one I could figure out by test authing against a server
with a self-signed cert and grepping around the node socket source code.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3774",False
55fc90f54349d9ae829ceba8249c75492aefec81,2017-01-25 20:50:52,Evan Morikawa,bump(version): 1.0.13,False
3b372caa1f38118f5de4a0bed787fb19bf6db54c,2017-01-25 20:50:35,Evan Morikawa,bump(changelog): 1.0.13,False
2e59c86b5dccc93df04b58ac70499009ea918db3,2017-01-25 20:43:05,Evan Morikawa,bump(k2),False
d7ed7ffecf1c10574c4ab847dd5cc91da7a3a865,2017-01-25 20:42:09,Evan Morikawa,"refactor(account): remove unused accont refresh methods

Summary:
This removes `refreshHealthOfAccounts`, which I originally found because I
was trying to refactor it out of the IdentityStore. We need it gone from
the IdentityStore so that store can trigger frequently as things like the
usageLimits constantly update on it.

This also fixes T7520 where we'd get `ECONNREFUSED 127.0.0.1:2578` on
launch unnecessarily.

The concept of refreshing the health of accounts by occassionally polling
the /accounts endpoint is obsolete. This depends on
D3769 which entirely removes the /accounts endpoint
from K2.

Account health is pushed to us by `Actions.updateAccount` which is fired
directly from the main local-sync sync loop.

This also removes `refreshAccounts` and `Actions.refreshAllDeltaConnections`. These were fired by the Identity Store whenever it updated. We no longer need the Identity Store to tell us to reset the delta connections with our local-sync accounts. The delta connections will either be reset by our offline notification button, or when adding or removing an account. The Identity Store was a redundant mechanisms

Test Plan:
Manually verify things work with an existing account. Add a new account
and ensure sync starts. Remove an account and ensure it gets cleaned up.

Reviewers: halla, khamidou, mark, juan

Reviewed By: juan

Maniphest Tasks: T7520

Differential Revision: https://phab.nylas.com/D3770",False
869e6aa11f0422417cfacdba69ae7d99f9dd8255,2017-01-25 20:40:10,Evan Morikawa,"[local-sync] remove /account API endpoint

Summary:
It turns out we don't ever use the /account API endpoint.

The GET /accounts endpoint was designed to query all accounts connected to
a system for old K2, but we don't use that anymore. The environment
variable protecting the endpoint isn't set anywhere.

We used to `GET /account` from the N1 AccountStore to attempt to refresh
the health of the accounts. The accompianing diff to this one makes that
obsolete. We never need to query for the account health since the sync
loop pushes it to us through `Actions.updateAccount`.

We also never `DELETE /account` because our local-sync runs a function
called `ensureK2Consistency` that compares its DB against the Nylas Mail
`AccountStore`.

This file has always been a huge source of confusion to me and a massive
red herring for anyone trying to understand how the account system work.
The accompyaning diff has more comments explaining the existing system

Depends on https://phab.nylas.com/D3770

Test Plan:
Manually boot N1. Ensure existing account works. Add a new account. Remove
an account. Open the developer tools and check that all the tabs still
work.

Lots of grepping through the code base.

Reviewers: halla, mark, juan, khamidou

Reviewed By: juan, khamidou

Differential Revision: https://phab.nylas.com/D3769",False
b56d2b64dd42c31178fa5e8b694d3ee39f30410d,2017-01-25 20:38:23,Evan Morikawa,"refactor(name): rename worker-sync package to deltas

Summary:
This diff is a rename. No logical changes.

We used to have a set of files called `nylas-sync-worker`. In Old N1 these
used to have a lot of logic to slowly sync mail from our API. Since we
exclusively use local-sync via a soon-to-be-obsolesced delta stream, these
files really just manage the delta streaming connection.

It's incredibly confusing to have a set of files called worker-sync when
there's a sync-worker already in the codebase. This renames everything to
refer to them as account sync workers.

The reason I wanted this rename is because the IdentityStore on initial
launch triggers and fires a fairly scary-sounding
`Actions.refreshAllSyncWorkers()`. In reality all it does is
`Actions.refreshAllDeltaConnections()`. I'm also tired of staring at files
for a full minute before realizing that this is not the sync worker I was
  looking for.

Test Plan:
After rename, booted the app and ensured that deltas were coming through
for new mail and no errors were being thrown

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3767",False
dea987f44e4fb0fd075a4df63edec4ee77ab8f9a,2017-01-25 13:59:30,Juan Tejada,"[local-sync] Make EnsureMessageInSentFolder save db changes after imap success

Summary:
This will solve T7579 when saving messages to the sent folder. I
attempted to clean up the references code but decided it was better left for a
new diff, so added a bunch of TODO's in this diff

Test Plan: manual

Reviewers: halla, spang, evan

Reviewed By: spang, evan

Differential Revision: https://phab.nylas.com/D3766",False
b884f2d847253ff411427673fd47f46d8d472f10,2017-01-25 08:52:14,Christine Spang,[iso-core] :art: Use a more descriptive variable name in _resolveIMAPSettings(),False
859530aa4cb6494fb3806f44eebd9f80441f461f,2017-01-25 08:22:30,Christine Spang,"[iso-core] Allow self-signed certificates in IMAP connections to non-major providers

Summary:
Unfortunately, many IMAP hosts outside the major ones do not have
certificates issued by a certificate authority, and it is very confusing
to folks to have their account auth not work. This patch relaxes our
certificate requirements for IMAP hosts outside the major providers.

It's cool that node 6 has secure TLS settings by default!

Fixes: T7673

Test Plan: manual

Reviewers: mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3771",False
9a8567cf1b459c6ae5f6db804d09cdbca28ffd5c,2017-01-25 07:13:34,Juan Tejada,bump(k2),False
72cd27ff1c4c4b80444f659a3e625a8312df21dc,2017-01-25 07:13:34,Juan Tejada,fix(auth) Dont allow invalid form submission with Enter key,False
6701f117bf7097571948584909dc11be0b979b9e,2017-01-25 06:49:45,Juan Tejada,[cloud-api] Disable hapi logging to fix logs format,False
cdf09bfff04fcae619e9466147201d73e2ae9a5c,2017-01-25 06:15:49,Halla Moore,"fix(unpersistModel) Add default value for `opts` param

Just an empty object, so looking up a property on it doesn't error.
(Also some whitespace changes that automatically changed on save.)",False
107faab0f1a7f78ae5c02af352fad87b4338e06f,2017-01-25 05:55:03,Juan Tejada,":art: Fix to using imap-provider-settings package

Summary: see title

Test Plan: manual

Reviewers: spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3772",False
81a48d1fbb410608583b4556f95b569c0c5b889b,2017-01-25 05:49:34,Juan Tejada,[cloud-api] :art: logs,False
d8941b59da1d62090b194c273100b31c9b819c47,2017-01-25 04:39:36,Juan Tejada,"[cloud-api] When token refresh fails, correctly stop execution",False
dd3c1542e44929e2c05f310cb0f75c427c8ce1bd,2017-01-25 03:28:09,Christine Spang,fix typo,False
b5f48003b932925b62ec7eff5222ac49e1da57cc,2017-01-25 02:43:05,Juan Tejada,[*] report sending errors to sentry,False
1aa83cdb7db363facf27b55234798e078ec7fdc2,2017-01-25 01:36:56,Juan Tejada,fix(auth) fix timeouts,False
24abdafbc79b7eeb65cefd66cd9537f7771157ca,2017-01-25 01:32:58,Juan Tejada,"fix(auth) Increment IMAP auth timeout

Given that imap connections can take up to 90 seconds (see `auth-helpers` in k2),
we don't want to hang up our local connection too soon",False
53a6df35fd274c81e5a73dcce2543a808ac378c3,2017-01-25 01:27:08,Christine Spang,fix(updater): s/N1/Nylas Mail/,False
d46ee217bede0f1d8e0a81f119f56431f4de4b0e,2017-01-25 01:21:51,Evan Morikawa,bump(changelog),False
f8311a0b7cc53cb4128d67b98d1e39c46ee6165f,2017-01-25 01:16:53,Juan Tejada,bump(k2),False
84ec152c85e45c665371dc39e9cffb4ab69b5720,2017-01-25 01:16:46,Juan Tejada,bump(changelog),False
6f7f161dc7a7bb938d9f2f513f0e307c73152f42,2017-01-25 01:05:46,Juan Tejada,"[*] Increment IMAP auth timeout

- More than 50% of auth errors we're seeing still seem to be geniune
timeouts. Increment the timeout to account for this.",False
59d86d7c5a5e5b186f6013f6c630e7d3739b2634,2017-01-25 00:57:32,Evan Morikawa,fix(build): add output log interval to prevent travis from dying,False
d2e461fa4b46efaeef8dec61677e0b4414b88a0e,2017-01-25 00:39:17,Evan Morikawa,feat(build) add `npm run local-ci`,False
fe5546d3c31dd64bac0180e849418d542043227c,2017-01-24 23:06:08,Tomasz Finc,bump(changelog),False
43c0dc68400bf8d54d575dd9b69c07f6ad1a0854,2017-01-24 22:53:25,Evan Morikawa,bump(version): 1.0.12,False
81ddbe9f563b907f2e35adad1c170f5cd708e81a,2017-01-24 22:52:33,Evan Morikawa,"feat(analytics): add analytics for change mail tasks

Summary:
Adds the following new events:

- Threads Moved to Folder
  - isArchive
  - source
  - folderType
  - folderDisplayName
  - numThreads
  - numMessages
  - description
  - isUndo

- Threads Changed Labels
  - isArchive
  - source
  - labelTypesToAdd
  - labelTypesToRemove
  - labelDisplayNamesToAdd
  - labelDisplayNamesToRemove
  - numThreads
  - numMessages
  - description
  - isUndo

- Threads Starred
  - source
  - numThreads
  - description
  - isUndo

- Threads Unstarred
  - source
  - numThreads
  - description
  - isUndo

- Threads Marked as Read
  - source
  - numThreads
  - description
  - isUndo

- Threads Marked as Unread
  - source
  - numThreads
  - description
  - isUndo

Each new action has a ""source"" property that's one of the following:
- Category Picker: New Category
- Category Picker: Existing Category
- Toolbar Button: Message List
- Toolbar Button: Thread List
- Send and Archive
- Context Menu: Thread List
- Thread List Icon
- Quick Actions: Thread List
- Swipe
- Keyboard Shortcut
- Dragged Out of List
- Snooze Move
- Important Icon
- Label Remove Icon
- Thread Selected
- Mail Rules
- Dragged Into List

Test Plan: manual

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3760",False
11c15abd2eb9605a0b00e4d0a144c5ade38cac89,2017-01-24 21:04:18,Juan Tejada,"fix(auth): Properly wait for acct to be inited before adding to sidebar

Summary:
Previously, when adding an account, we waited for it to be completely loaded (which meant having fetched the folder list) before focusing it on the sidebar. This could take several seconds, so it made the app feel unresponsive or slow when adding an account.

Then, we changed the logic to wait an arbitrary amount of time to focus the newly added account in the sidebar, with the hope that it would be enough time to focus it correctly but that it wouldn't seem too long. This still caused the unwanted effect of focusing it before it had been fully loaded.

This commit changes the auth flow so that the onboarding shows a Success page until the newly added account is fully loaded, and only /then/ closes itself, focuses the main window, and allows the account to be correctly focused in the sidebar.

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3751",False
b305f44645252e1870d13a089d0383c93fcab59f,2017-01-24 21:01:37,Juan Tejada,"fix(sync) Make category syncback tasks save changes after imap success

Summary:
This will solve T7579 for actions involving categories (folders/labels)
Depends on D3753

Test Plan: manual

Reviewers: halla, mark, khamidou, evan, spang

Reviewed By: evan, spang

Differential Revision: https://phab.nylas.com/D3754",False
3210ff20b6b2f16f59f3b563fa4a8baca0ff992f,2017-01-24 21:00:43,Juan Tejada,"[local-sync] Make category syncback tasks save changes after imap success

Summary: This will solve T7579 for actions involving categories (folders/labels)

Test Plan: manual

Reviewers: khamidou, halla, mark, evan, spang

Reviewed By: evan, spang

Differential Revision: https://phab.nylas.com/D3753",False
476d60f2956205b2338acf2ed5b6a49727ff57ac,2017-01-24 20:59:25,Juan Tejada,"[local-sync] Make thread syncback tasks save changes after imap success

Summary: This will solve T7579 for thread operations

Test Plan: manual

Reviewers: evan, mark, khamidou, halla, spang

Reviewed By: halla, spang

Differential Revision: https://phab.nylas.com/D3755",False
35b64a66c51bcab3d3da3c895356454d7d19dcf9,2017-01-24 10:28:32,Christine Spang,"[local-sync] Sync draft flag from provider to K2 & exclude drafts from Edgehill

Summary:
We've been syncing drafts messages but not the drafts flag in K2, making
them appear in Edgehill as regular old messages.

This commit makes K2 sync the drafts flag, and also correctly label
folders called ""Drafts"" with the 'drafts' role.

Because 2-way syncing of drafts is very complex and error-prone since
you need to add new drafts and delete the old ones on every update, and
we reaally don't want to do things like create multiplying draft copies
or accidentally lose a draft someone started composing elsewhere, we
simply exclude messages marked as drafts from being serialized to
Edgehill through the delta stream for now. This removes the confusing
behaviour and also sets a better stage for completing drafts sync later.

Eventually we will also want to add functionality to allow users to
select their drafts folder, but for now this code does the right thing
in many more cases.

While investigating this behaviour, I also discovered a bug we've never
seen before where Gmail isn't applying the \Draft flag to draft
messages, no matter which folder we fetch them from. :-/ This is very
unfortunate and there's no way for us to work around it other than to
fetch messages in the Drafts folder and manually apply the flag locally,
since ""drafts"" is not a label in Gmail, only another IMAP folder. Brandon
Long from the Gmail team says that this is because they've had
problems with clients which sync drafts, so the Gmail web client and
mobile apps do not set the \Draft flag on drafts. (I don't get how this
solves their problem, but okay.) Let's solve the issue on Gmail if it
comes up by user demand—should be relatively straightforward to
implement, but it adds sync work & complexity.

Fixes T7593

Test Plan: manual

Reviewers: halla, juan

Reviewed By: juan

Maniphest Tasks: T7593

Differential Revision: https://phab.nylas.com/D3749",False
daac91c459e27d8b92841d696529b02a4f938e9e,2017-01-24 10:24:01,Christine Spang,"[local-sync] Don't be so strict about updating threads from messages

This is how we _add_ messages to a thread in the first place, so we cannot
place the constraint that the thread must contain the message already.",False
4728f60fa7d63098d6490172263df04609897a9a,2017-01-24 08:01:35,Mark Hahnenberg,"[local-sync] Throttle message processing when on battery

Summary:
We don't want to run message processing full tilt when a user isn't plugged in.
This diff adds some detection logic that causes message processing to be
throttled/unthrottled when a user unplugs/plugs in their computer.

Test Plan: Run locally unplugged and plugged in, verify that CPU use goes up/down

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3759",False
9d5441530f62404f0261220307a723a69dbb7d95,2017-01-24 06:34:39,Halla Moore,"[local-sync]: Update threads when they have messages removed

Summary:
See title

Depends on D3744

Test Plan: tested locally

Reviewers: spang, evan, juan

Reviewed By: spang, evan, juan

Differential Revision: https://phab.nylas.com/D3745",False
1b722e506437d601aa22d22fa833b4d627f94d2a,2017-01-24 03:00:27,Juan Tejada,build(notif) Remove appveyor notifs for now,False
0197ea74170b7d2e6cff0bdbda82602036cb48af,2017-01-24 01:49:34,Mark Hahnenberg,"[search-index] Limit search index size

Summary:
This diff modifies the SearchIndexer class to handle limiting the search
index size. It does this by periodically re-evaluating the window of
the n most recent items in a particular index where n is the max size of
the index. It then unindexes the items which are marked as indexed but
are no longer in the window and indexes the things that are in the window
but aren't marked as indexed.

Test Plan:
Run locally with a reduced thread index size, verify that the index
includes the most recent items and that it is the correct size. Also verify that
the queries used properly use fast sqlite indices.

Reviewers: evan, juan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3741",False
d92eeabf47ad7e942a63a6d8d90fd65cfff702a3,2017-01-24 01:48:54,Karim Hamidou,"Add Sentry support to cloud-api

Summary: This diff adds sentry support to the cloud API. It's mostly based on Ben Drucker's hapi-sentry plugin.

Test Plan: Deployed to staging and checked that things weren't broken, however no events were making it to sentry (even though they were being sent correctly). I think that Sentry is somehow discarding them because they're not frequent enough.

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3758",False
3b202a19524ebe8bcbd181df884a0aff7c070fba,2017-01-24 01:32:17,Evan Morikawa,bump(k2),False
afb2b9250a63710dcd404f3ccbb6c148e960c897,2017-01-24 01:20:27,Mark Hahnenberg,"[thread-search] Background on-keypress search queries

Summary:
When the search index got very big the queries we were running during
after keypress would cause jank in the UI which was very noticeable on
subsequent keypresses. This diff backgrounds these queries and adds a
LIMIT to the fts MATCH clauses to avoid having to send too much stuff
across the IPC bridge.

Test Plan: Run locally, make sure that typing is smooth while searching

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3757",False
18572836de58769456886457c2c262eb07ef51bf,2017-01-24 01:02:46,Halla Moore,"fix(unindexModel): Don't re-persist unpersisted models

Summary: See title

Test Plan: tested locally

Reviewers: juan, mark, evan

Reviewed By: juan, mark

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3744",False
7682bd937cc88660cd4ec34f5de79929648d2bb2,2017-01-22 05:22:39,Forbes Lindesay,Add the GitHub community plugin (#3197),False
18c5a332572f4ac3628d50dcbeb7dab90976c8f5,2017-01-22 05:22:13,Richard Lai,Fix typo (#3173),False
ed2235ce8602660f66fef167868d76abed3a8b33,2017-01-22 05:21:49,Paul Xu,"Normalized size of buttons in preferences (fixes #2753) (#3112)

Normalized size of buttons across signature, accounts and mail rules preferences. Also make signature pane same size as other preference panels",False
eaa3059dc07c776351709b0e2f94b5bf5583b2f3,2017-01-22 05:18:41,Sachin Agarwal,"Update CHANGELOG.md (#3194)

N1 > Nylas Mail",False
b2836e7f44631f4f8a6dbf3d418e25320adfc652,2017-01-21 07:23:57,Christine Spang,"[local-sync] Keep only one HTML part in multipart/alternative structures

Summary:
I thought it was gonna be OK that we kept all HTML parts in a multipart/alternative
MIME structure because the world is a sane place and nobody would ever put more
than one HTML part in a multipart/alternative structure.

I was wrong.

We have found extraterrestrial life^W^WI mean emails which contain duplicate,
exactly the same MIME parts within a multipart/alternative MIME structure: two
text/plain parts and two text/html parts. This is likely due to a broken MIME
implementation, or perhaps a bug in someone's email script. So, we should
only keep one text/html MIME part if there are multiple.

Test Plan:
manual for now---added this to my mail parsing regression test list
for implementation once we unify the DBs and have a roughly stable code
structure

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3750",False
d1249b731bb470e8a21f951367c6f9828ec4ef32,2017-01-21 03:25:57,Evan Morikawa,bump(version): 1.0.11,False
5640f266aac1b5c29fc3942768deb8af2f3844b7,2017-01-21 03:25:46,Evan Morikawa,bump(changelog),False
30d69a09cd5e8273b5ae74b391419bc4d44d2d0e,2017-01-21 03:24:53,Halla Moore,"[local-sync] Be more permissive with content transfer encodings (CTEs)

Summary:
Rather than having a strict model where we don't decode the message if we
don't specifically recognize the CTE, treat any CTEs we don't recognize as
having no encoding. There are several CTE strings that could mean this (e.g.
7bit, 7BITS, 8-bit, binary, NONE, utf8), and we don't want to check for them
all. Additionally, if there is a CTE we don't support, the user will likely
see rendering issues and contact support. This will allow us to obtain more
concrete information about these messages.

Test Plan: manual

Reviewers: spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3748",False
3e85aa4056adf5622d5f524ba4c35865ed940607,2017-01-21 03:16:57,Juan Tejada,"fix(crash): Fix error reporting for unhandled promise rejections

When handling unhandled promise rejections, our error reporter would
completely freeze the worker window when trying to send a Promise
through the ipc bridge, rendering the app unusuable

This fixes T7621",False
88f882898d43dc9e6085425af02a2e8326b80711,2017-01-21 01:31:07,Evan Morikawa,"feat(build): build DMG

Summary:
We need people to manually drag into their /Applications folders due to
OSX gatekeeper protections.

Test Plan: manual

Reviewers: juan, khamidou

Reviewed By: khamidou

Differential Revision: https://phab.nylas.com/D3756",False
30412ce763799cdbdaf4db4f1ebc02c185ff1676,2017-01-20 23:55:15,Evan Morikawa,bump(k2),False
8aeed8e813da392573f80817dc9067b600653c3f,2017-01-20 23:46:28,Juan Tejada,"[local-sync] Never show red box on retryable errors

Summary:
Given that we were marking the account as errored if we've encountered
enough RetryableErrors, we would show the red box to the user when in
fact the problem was the user was offline, causing confusion

If the user is offline, we will constantly get RetryableErrors in the
sync loop, and we can't mark the account as errored in that case.

Test Plan: manual

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3752",False
dcf0281438841a57a65bef79402b9107e454f304,2017-01-20 13:03:22,Juan Tejada,:art: Error message,False
f8d57a5d6a47b737a798b2b06ab2c23a0d882660,2017-01-20 08:57:50,Christine Spang,[local-sync] typo fix,False
3d0310c2251ca7a816d320c05bd6b2853b2a86b6,2017-01-20 06:29:27,Karim Hamidou,"[mini-feat] Display the IMAP commands we're sending when NYLAS_DEBUG is set.

Makes debugging a bit easier.",False
a2750de369d98cec313574fd0b16699c29287695,2017-01-20 06:17:06,Christine Spang,"[cloud-api] Make Gmail auth CTA stronger

Test Plan: ship it

Reviewers: mike, halla

Reviewed By: mike, halla

Differential Revision: https://phab.nylas.com/D3747",False
61314fb1910513b432e1310942cb8596470f0e20,2017-01-20 06:14:42,Juan Tejada,fix(auth) Don't show error message when auth is successful,False
c268936cdfbf66596199fcf819ae2bfeb6706ed1,2017-01-20 05:36:37,Juan Tejada,fix(auth) Increment timeout for requests that initiate imap connections,False
3ce7fab79da0c4a0a8854273aba49acc08ca0cc9,2017-01-20 05:07:01,Juan Tejada,:art:,False
e6ed90678938603354f5e3770f5ad62c3b180f2f,2017-01-20 05:00:06,Juan Tejada,update(changelog),False
5e144cf01e62e1bef72f499c7fc949bbb5239a9b,2017-01-20 01:09:50,Halla Moore,bump(version),False
73fe63808bb5f620d68e090c0ff0f5fdde659d46,2017-01-20 01:09:50,Halla Moore,bump(changelog),False
07286f26130eb4af76cbd5f4042f7570e3142a4a,2017-01-20 00:58:50,Evan Morikawa,fix(changelog): link to correct changelog,False
6072bc7869135dd89320f6c4b5a98050dd440632,2017-01-20 00:55:43,Juan Tejada,bump k2,False
2c88e8b0f40a116ed796f62c00b9288ec884ccce,2017-01-20 00:55:31,Juan Tejada,[local-sync]: Token error handler fix,False
772444cbfa0089ed49440433a1a21158e8a8ebfc,2017-01-20 00:46:27,Juan Tejada,"[local-sync] Properly handle errors when refreshing tokens

Summary:
This commit ensures that we handle transient errors correctly when refreshing
tokens

Test Plan: manual

Reviewers: khamidou, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3740",False
105dc2af059ce4f54d6c9154ce62260c62c7e0e7,2017-01-20 00:23:04,Juan Tejada,"fix(error-mgmt): Add a few improvements to error management

Summary:
- Add a new button to the sync error notification to ""Debug"" sync. This will open the activity window and dev tools in that window. Depends on D3736
- Update the ""Contact Support"" link in error notifications to prepopulate the support ticket with the sync error in the account
- Make the ""Check Again"" button react when clicking it

Test Plan: manual

Reviewers: evan, khamidou

Reviewed By: evan, khamidou

Differential Revision: https://phab.nylas.com/D3737",False
48389d5d8cb4b40b67dbec7dfe279f97dc7ba80b,2017-01-20 00:22:21,Juan Tejada,"[local-sync] Add a few improvements to error management

Summary:
In the sync worker:
- Move the backoff logic inside `scheduleNextSync`, where all logic to schedule the next sync loop now lives
- If we've retried a RetryableError a bunch of times, show the error to the user, otherwise the user might think the app is not working for no reason
- Clean up logging

In the message processor:
- Report message processing errors to sentry!

Sync Process Manager:
- Listen to new `Actions.debugSync` to show the Activity Window and open dev tools

Test Plan: manual

Reviewers: khamidou, evan

Reviewed By: khamidou, evan

Differential Revision: https://phab.nylas.com/D3736",False
1740cef27f80be663c884f3a33a48ab37ae28ddf,2017-01-20 00:16:33,Evan Morikawa,bump(k2),False
dee7ae7ad60516a9891ee88e413a09fd9159e1fd,2017-01-19 23:52:32,Mark Hahnenberg,"[thread-search] Add loadFromColumn option to Attribute

Summary:
The isSearchIndexed attribute gets bulk reset when we drop the search
index, however, the JSON values were not updated to reflect the new
column values. We don't care about notifications to this field, so in
order to make bulk clearing ok this diff adds a new loadFromColumn option to
Attributes which causes the value to be loaded from the SQL table column
rather than the JSON blob.

Test Plan:
Run locally, drop the search index, make sure we load from the
column rather than the JSON when re-indexing

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3739",False
167f3551d290fb8b8fdf0c131e24e185f0ab216e,2017-01-19 23:23:34,Juan Tejada,"[local-sync] Batch imap operations in syncback tasks for faster performance

Summary:
This commit makes it so our syncback tasks send as few imap commands as possible by passing a set of UIDs whenever possible. Previously, we would send 1 command per message, with a single UID, which was very wasteful given that we can pass a set of UIDs. This is especially helpful for operating on threads with a large number of messages.

Syncback actions will now group all messages in a thread by the folder they belong to, and issue a single operation on the folder box. When removing all labels from a thread (setting labels to []), we need to issue a command of the form `box.delLabels(uids, labels)`, so we also group messages by set their set of labels to issue as few commands as possible.

This commit only batches imap commands, but we can still batch syncback actions themselves, which can be implemented in a separate patch.

Test Plan: manual

Reviewers: evan, mark, spang

Reviewed By: spang

Subscribers: halla, mg

Differential Revision: https://phab.nylas.com/D3719",False
214558cafe1ed9db35c3e70c74a83169fdd13930,2017-01-19 11:39:43,Juan Tejada,"fix(offline-notif): Add some offline notification improvements

Summary:
- Make the try again button react when clicked
- Don't mark as offline until after we've tried again at least 3 times

Test Plan: manual

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3738",False
5b5405c9bba43d6b2fc0771c9b1a557f7dbf1fba,2017-01-19 07:14:22,Evan Morikawa,"fix(auth): Gmail auth screen now shows error states

Summary:
- Refactor Gmail auth functions
- Add Analytics in
- Show error states

Depends on D3735

Test Plan: manual

Reviewers: khamidou, juan

Reviewed By: khamidou, juan

Differential Revision: https://phab.nylas.com/D3732",False
bfed1312b2c8b90380670226aad04802a8687c95,2017-01-19 07:01:23,Evan Morikawa,"fix(db): reset db if we encounter malformed error

Summary:
Very occasionally the db can become malformed for some reason. If this
happens all DB requests will fail and flood sentry with errors. This will
attempt to reset the db if we encounter this error

Depends on D3730

Test Plan: manual

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3731",False
08541e6bf76cf602c2670dccb24331b59a57a76b,2017-01-19 07:00:30,Evan Morikawa,"[local-sync] protection from reset action being double-fired

Summary: Double-firing protection since the DatabaseStore can now fire this

Test Plan: manual

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3730",False
215ea71feab84c518bfe1132481df45a2ec41cb7,2017-01-19 06:59:58,Evan Morikawa,"[isomorphic-core] have IMAP auth retry

Summary: IMAP auth retries

Test Plan: manual

Reviewers: khamidou, juan

Reviewed By: khamidou, juan

Differential Revision: https://phab.nylas.com/D3735",False
87423ab08140ecf64ad6c7774ffa080c28b5e76c,2017-01-19 04:19:26,Karim Hamidou,"[cloud-api] Log N1 id too

Summary: This is going to make looking at the logs a lot easier.

Test Plan: Will ship to staging.

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3734",False
88bc142d5c7d4c873614d77a696d0bf40cb3fb1c,2017-01-19 03:35:27,Juan Tejada,"[*] Increment default timeout connection

Summary:
We are getting to many imap timeout connection errors because the
authTimeout was just 5 secs

Test Plan: manual

Reviewers: khamidou, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3733",False
c47b8a89d17fae9324a8bbb885ca4e6e09e15724,2017-01-19 03:06:50,Juan Tejada,[cloud-api] Improve auth error logging,False
557124e7f8fff33a51da182345dd0174a5ea2651,2017-01-19 01:37:58,Evan Morikawa,fix(err) re-add Draft Sending Errored event into Nylas Mail,False
8c7c6ef65f132d8ecd752494249b779701f9ffd6,2017-01-19 01:01:31,Mark Hahnenberg,"[thread-search] Update Thread search index version

Summary:
We changed the index format (splitting participants into to and from) so
we need to update the index version so that it gets rebuilt.

Test Plan: Run locally, make sure index gets rebuilt

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3728",False
39d4b519c52727dfe872f0413dfb414225e2980a,2017-01-19 00:30:46,Juan Tejada,bump k2,False
f2f84a9603af3cc679fa1ea69dc608b382afddbd,2017-01-19 00:30:46,Juan Tejada,fix(add-account) Increment delay before expanding sidebar,False
bbf3af486133a944521352341f80d2de62d5d76c,2017-01-19 00:11:20,Mark Hahnenberg,"[thread-search] Split 'participants' index into 'to' and 'from'

Summary:
Previously we indexed all participants together for a single thread.
This lead to confusing search results when people would search for
'from' and get back lots of results that were only 'to'. This diff
splits the participants index into separate to and from indices and
updates the query generator appropriately.

Fixes T7580

Test Plan: Run locally, verify from doesn't return to and vice versa.

Reviewers: evan, juan

Reviewed By: juan

Maniphest Tasks: T7580

Differential Revision: https://phab.nylas.com/D3724",False
1b55ed406988d98d88be3fa8b8346614226f0063,2017-01-19 00:05:25,Juan Tejada,:art:,False
746ec201da2e3bd8fa0cf287bb4943314a93b940,2017-01-18 23:54:26,Juan Tejada,"[local-sync] Ensure all imap operations are wrapped with timeout

Summary:
Specifically, these imap connections have been known to hang when you close your laptop or go offline/online, even though we are passing a `socketTimeout` to node-imap. When they hang, everything freezes because the promise waiting for the result never resolves.

`_createConnectionPromise` wraps the operations with a timeout we implemented ourselves, and correctly rejects on timeout.

This commit wraps other imap operations that were missing. (I notices because I encountered the hanging on one of these operations)

Test Plan: manual

Reviewers: evan, mark, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3720",False
673fd83df6eb8331bcbdbe13777ce0ea84bcaea2,2017-01-18 06:03:16,Evan Morikawa,bump(version): 1.0.9,False
6203ad9c3a46a49d8355223b474b3a0a1b81794e,2017-01-18 06:03:02,Evan Morikawa,bump(changelog),False
ba9d68be30b49b42f6f44aa7bae510a60a0e2563,2017-01-18 06:02:01,Juan Tejada,"fix(offline-notif) Make it less aggressive

Summary: Add a timeout before displaying the offline notif

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3727",False
aaa0b405e400a3751d339f22f83738f893cf1a86,2017-01-18 06:01:07,Juan Tejada,add comment,False
663f5961774f1d5f94ec79054d5d57e740d3d8b1,2017-01-18 05:48:27,Evan Morikawa,bump(changelog),False
b2b4eac1443bc933f3ac142580ed7d3fbc96fc3e,2017-01-18 05:35:02,Evan Morikawa,fix(db): don't assert transaction anymore,False
3e52a434cfcf6aafd9e51d630ff0d549243101e2,2017-01-18 04:41:44,Evan Morikawa,"[cloud-api] add a /ping-db endpoint

Summary: basic db ping endpoint

Test Plan: manual

Reviewers: khamidou, jerm

Reviewed By: jerm

Differential Revision: https://phab.nylas.com/D3726",False
b8be30b181e2e0aa52ac62294083d8d60b24bc98,2017-01-18 02:46:45,Juan Tejada,fix(logging) Don't log error out unecessarily,False
09fc56b93258fb0a124b34156548276d838ebc4b,2017-01-18 02:12:40,Evan Morikawa,fix(clearbit): catch API errors,False
cc43302e00c23b07c80c0a4be3e28082e582ecc6,2017-01-18 01:57:45,Evan Morikawa,fix(pref): remove default send preferences for now in basic,False
93db8075a40e1acb1cc5141c6e96b30b1670f4b7,2017-01-18 00:44:10,Michael Pfister,[cloud-api] Add github star to gmail auth success,False
4d690d46ab03297be84307e416fda641cf13d1d4,2017-01-17 22:19:21,Halla Moore,"rm(provider-setting): Remove duplicate ""fastmail.com""",False
66f8416cea4d5622f14288ab3d0726b55e67b0cb,2017-01-17 22:17:35,Halla Moore,"fix(onboarding): Change how we determine default IMAP settings

Summary:
If we don't have IMAP settings for a particular email domain,
try to choose based on which provider was selected instead.

Fixes #3168

Test Plan: tested locally

Reviewers: spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3721",False
a638f3ef3281308b663e619ab475ffedfa582421,2017-01-17 09:51:39,Evan Morikawa,bump(version): 1.0.8,False
27d354e685364313b388837ecc890bb065bdcbfd,2017-01-17 09:51:28,Evan Morikawa,bump(k2),False
6d5dd59d1a8d95921c9f89afc27da6739a95cd16,2017-01-17 09:48:48,Juan Tejada,fix(accounts) Make account adding look fast,False
e6d6b2fd9961b733cb8d214e6ed73487347bd406,2017-01-17 09:47:44,Christine Spang,"[local-sync] Set threading headers when uploading message to Sent folder

Summary:
We weren't, which meant that us sending with multi-send or generic IMAP
broke threading. :(

Test Plan: manual

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3718",False
9ff46b1b3667d83361a0593450a5777a49d5cd46,2017-01-17 09:07:37,Juan Tejada,"fix(deltas) Prevent app from crashing when processing deltas

Summary:
Some strange scenario is causing us to attempt to redefine the object property `_delta` on our `delta.attributes` object inside `DeltaProcessor._decorateDeltas`, which throws an error, and consequently throws the app into an error loop. I haven't been able to track down how to reproduce this, but when it happens it completely takes the app down.

From testing with tomasz's copy of N1, this seemed to have originated from the lack of Account tokens, which was hard to discover because the `_deltas` object completely floods the console with errors.

From what I gather, `_decorateDeltas` is only called from a single place, `DeltaProcessor.process`, which is also only called from a single place, and its unclear how it would be called multiple times with the same delta object references.

In order to prevent this error from completely destroying the app, I've added the `configurable` option when defining the property, so that redifining it doesn't throw an error. It should be safe to redefine this property with the latest delta reference, and will also allow us to discover other errors more easily in the console like the lack of account tokens which might be the original cause of this problem.

Test Plan: manual

Reviewers: mark, spang, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D3717",False
b95645bf146d895e5c747b796a251cff9910dcc2,2017-01-17 09:02:18,Halla Moore,rm(calendar): Comment out more calendar things,False
0c4ee478aba77d9166ad8e9799ca45e8dfd124d6,2017-01-17 08:50:09,Juan Tejada,bump(k2),False
3d58cb8e43d1045d9168d343709b33e44b88a65c,2017-01-17 08:47:27,Evan Morikawa,"fix(send): temporarily disable ensureOnce protection

Since we catch any post-send errors now in K2 and if there is a temporary
error, this protection won't let you send a message again",False
41317f1b1ee4d8946ff53e133232dc6df098767d,2017-01-17 08:39:18,Juan Tejada,"[local-sync] Fix attribute sync for non Gmail accounts

Summary:
Before this commit, if folder sync was complete, and the account didn't support CONDSTORE (e.g. Office365, Yahoo), we would only check for attribute updates every 10 minutes.

This commit makes it so we always check for attribute updates if the server doesn't support CONDSTORE

So for example, when marking a thread as read, we would perform the optimistic update in N1, queue the syncback task which would succeed, but the thread in k2s db would never get updated and become stale, with an unreadCount > 0. If we emitted a delta for that thread during the window of time where we ignored attribute updates, it would be set as unread again in N1, even though all of its messages were read.

This still doesn't guarantee that it wont happen (we could still get a delta for the thread before we actually fetch the attribute updates from IMAP), but before this commit it was sure to happen. This should be properly fixed with the sync scheduler refactor

Test Plan: manual

Reviewers: evan, mark, spang

Reviewed By: mark, spang

Differential Revision: https://phab.nylas.com/D3714",False
6a4df85201cf57d8c9b978b27c4555b659e0c6d7,2017-01-17 08:06:16,Evan Morikawa,bump(version): 1.0.7,False
196fa97594b5966c301595dd23c497e5dd40b800,2017-01-17 08:06:01,Evan Morikawa,bump(k2),False
0e1208df8fdff8ca939f71fa32f94684834c3b81,2017-01-17 07:29:13,Evan Morikawa,"Changelog version bump to 1.5.0

Changelog to 1.5.0",False
200761d9735af8330056ab99715788a2bf17800c,2017-01-17 07:19:55,Halla Moore,"fix(sync-messaging): Have ""Looking for messages..."" update properly

Summary:
Makes these messages update even if the user doesn't force a
re-render by switching perspectives.

Test Plan: tested manually

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3715",False
9b6e801ab53737c0154ff7314f2bb705babfb30c,2017-01-17 07:16:24,Juan Tejada,"[local-sync] Prioritize syncing archive for non Gmail accounts!

Summary:
Previously, we were not pripritizing archive sync when getting folders to sync, causing it to be synced almost last. I believe this was causing the issues regarding archived items coming back, because we would optimistically archive in N1, but the changes wouldn't be reflected in K2's database until we synced the archive, causing the data to become out of sync. If for whatever reason we got a delta for any of those messages before the archive was synced, they would pop back in the inbox because in k2, they were still in the inbox. This was exacerbated by the fact that all syncback tasks would interrupt the loop, so we would reach the archive until very late, making this scenario way more likely.

This still wont guarantee that it wont happen, because we dont do /any/ optimistic updates in K2, so we could still get deltas before we actually sync the folder, but makes the scenario way less likely. This should be properly fixed with the sync scheduler refactor

Test Plan: manual

Reviewers: spang, evan, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3716",False
808cf1e0614eb96bec8ca3395e241a85d4c084bc,2017-01-17 07:03:08,Juan Tejada,[local-sync] Correctly interrup! (don't wait for interruption),False
0231c3f56da59082386d8711cac63893951c650b,2017-01-17 06:27:24,Mark Hahnenberg,"[search-index] Add index for isSearchIndexed (for real)

Summary:
We had to add the id to the index as well (along with is_search_indexed)
so that the query worked correctly since it sorts by id. Also added a
default value of 0 for boolean attributes so that we don't have to query
for two different values (0 and null), which was causing sqlite to have to
do a final b-tree sort which is slow.

Test Plan: Run locally, verify query plan with EXPLAIN QUERY PLAN

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3712",False
384932e70eabdaea3887956eddfd0c373a30f0cb,2017-01-17 06:16:52,Karim Hamidou,"Remove UpdateChannelSection

Use staging autoupdater for staging.

fixed failing test

Fix autoupdater – we were using the wrong command.

Revert ""Bump version to 1.5.0""

Temporarily reverting this because I need to test the upgrade path from
0.4.2 => 1.5.0

Revert ""Revert ""Bump version to 1.5.0""""

Had to do this to test the autoupdater.

[fix] [channel drop-down list] Show the stable channel in all cases.

Conflicts:
	internal_packages/preferences/lib/tabs/update-channel-section.jsx

Fix broken autoupdater, for reals.

[master] Replace ""Nylas N1"" by ""Nylas Mail"" in build scripts

Summary: As discussed --- we need to make those changes to make the autoupdater work across versions.

Test Plan: Will run a build.

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3701

Revert ""Revert ""Revert ""Bump version to 1.5.0""""""

Need to set the version to 0.4.402 for testing purposes.

Set preferredChannel in the autoupdater instead of in the ChannelStore

It turns out that Squirrel checks for update at program launch. In some
cases, it would put Pro users on the ""nylas-mail"" channel because that's
the default channel if you don't pass a preferredChannel.

Conflicts:
	src/flux/stores/update-channel-store.es6

Set the autoupdater preferredChannel to stable.

Don't try to move the app file to the Application folder ourselves

Because of MacOS Gatekeeper path randomization issues
(https://github.com/Squirrel/Squirrel.Mac/issues/182) we need the user
to move the app themselves. Changed the dialog to ask them to do this
politely.

Conflicts:
	internal_packages/verify-install-location/lib/main.es6",False
7d116e2d7859f200829280cd3eb5935634d79296,2017-01-17 05:49:45,Halla Moore,"fix(category): Update `isSyncComplete()`

Summary:
When we've optimistically created a category and haven't seen
it come back through the remote yet, `.object` does not
exist. Just look up the sync state for the entire account in
this case.

Fixes T7556

Test Plan: tested manually

Reviewers: spang, evan, juan

Reviewed By: juan

Maniphest Tasks: T7556

Differential Revision: https://phab.nylas.com/D3711",False
914ef12701a51c39d49a5de900b35da129655ffa,2017-01-17 05:24:10,Evan Morikawa,fix(migrator): fix bug for people simply upgrading existing pro,False
9891790eb668de0635a3b09810a520def4c5045b,2017-01-17 04:06:21,Halla Moore,rename(N1): one more N1 -> Nylas Mail change,False
443a611dc355f90d50b7c7d2865e09d3cf7a7083,2017-01-17 03:59:30,Mark Hahnenberg,"[search-index] Add DB index for is_search_indexed fields

Summary:
We query based on these fields which would cause us to scan the entire
table if we don't have these indexes.

Test Plan: Run locally

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3710",False
ea2db19764848931a1bdf373a690234c7522f86b,2017-01-17 03:44:52,Evan Morikawa,fix(package): bump debug to 2.4.5,False
444910703230c4fb0595e5cfd4704578dacaa119,2017-01-17 02:26:52,Evan Morikawa,fix(lint): fix linter error,False
36cfccb16927e342ac133031f4473b4f0f641bda,2017-01-17 02:11:05,Karim Hamidou,"Remove UpdateChannelSection

Use staging autoupdater for staging.

fixed failing test

Fix autoupdater – we were using the wrong command.

Revert ""Bump version to 1.5.0""

Temporarily reverting this because I need to test the upgrade path from
0.4.2 => 1.5.0

Revert ""Revert ""Bump version to 1.5.0""""

Had to do this to test the autoupdater.

[fix] [channel drop-down list] Show the stable channel in all cases.

Conflicts:
	internal_packages/preferences/lib/tabs/update-channel-section.jsx

Fix broken autoupdater, for reals.

[master] Replace ""Nylas N1"" by ""Nylas Mail"" in build scripts

Summary: As discussed --- we need to make those changes to make the autoupdater work across versions.

Test Plan: Will run a build.

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3701

Revert ""Revert ""Revert ""Bump version to 1.5.0""""""

Need to set the version to 0.4.402 for testing purposes.

Set preferredChannel in the autoupdater instead of in the ChannelStore

It turns out that Squirrel checks for update at program launch. In some
cases, it would put Pro users on the ""nylas-mail"" channel because that's
the default channel if you don't pass a preferredChannel.

Conflicts:
	src/flux/stores/update-channel-store.es6

Set the autoupdater preferredChannel to stable.

Don't try to move the app file to the Application folder ourselves

Because of MacOS Gatekeeper path randomization issues
(https://github.com/Squirrel/Squirrel.Mac/issues/182) we need the user
to move the app themselves. Changed the dialog to ask them to do this
politely.

Conflicts:
	internal_packages/verify-install-location/lib/main.es6",False
47296e9c772f54845cbf3ca44bfdbc2c657bb4c4,2017-01-17 02:04:15,Karim Hamidou,"Don't try to move the app file to the Application folder ourselves

Because of MacOS Gatekeeper path randomization issues
(https://github.com/Squirrel/Squirrel.Mac/issues/182) we need the user
to move the app themselves. Changed the dialog to ask them to do this
politely.

Conflicts:
	internal_packages/verify-install-location/lib/main.es6",False
1aa14ce31ff9c4715420f06b617ed3c46f9025a8,2017-01-17 02:03:30,Evan Morikawa,bump(changelog),False
48683e0c6450666f87dc283906d61f0a417f9275,2017-01-17 02:01:32,Juan Tejada,"fix(send-errors): Properly surface net and auth errors from send

Summary: See title. Depends on D3708

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3709",False
45a094e80df0c3d3913c28d29c301f5da3c9173f,2017-01-17 02:01:15,Karim Hamidou,"Don't try to move the app file to the Application folder ourselves

Because of MacOS Gatekeeper path randomization issues
(https://github.com/Squirrel/Squirrel.Mac/issues/182) we need the user
to move the app themselves. Changed the dialog to ask them to do this
politely.",False
110f33173940f8fb78739a601dc6973d64773bb4,2017-01-17 02:00:56,Juan Tejada,"[local-sync] Surface send network errors

Summary: see title

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3708",False
b23cad780b8a1227d09253a1cc39eee34e999b66,2017-01-17 01:47:41,Juan Tejada,fix(offline-notif) Properly check and clear offline notification,False
985b3b5408315a7e23fce63de51a086f043ff165,2017-01-17 00:57:09,Evan Morikawa,bump(k2),False
d456f4b8bc35f83ec0a7d01520c3cd7debe3bad8,2017-01-17 00:26:46,Evan Morikawa,"[cloud-core] make DB_NAME an environment variable

Default to nylasmailclouddb",False
d48fc27a3592c306cfd1a6bca68c3111277aa83d,2017-01-17 00:18:05,Evan Morikawa,bump(version): 1.0.6,False
03272b1b16849442d2a59005655a6e5c7d065277,2017-01-17 00:17:40,Evan Morikawa,bump(k2),False
a2f30b40dd1568f6a1c8b194780d49ab8efa84ae,2017-01-17 00:17:14,Christine Spang,"[local-sync] On Gmail initial sync, prioritize up to 1k inbox UIDs

Summary:
All we do is use the SEARCH X-GM-RAW IMAP extension to find the UIDs
to prioritize at the beginning of initial sync, and download these UIDs
until there are none left. Then we continue downloading All Mail as
usual.

Because of the way we batch via ranges, the most expedient way to
implement this means that all prioritized emails will end up being
downloaded twice (the second time we'll detect that the message exists
and do nothing).

This seems like a worthwhile tradeoff for quick appearance of the
messages in a user's inbox.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3706",False
aa920a5e13127af6225ddafecf93a661cb77ff10,2017-01-17 00:13:19,Evan Morikawa,fix(db): don't exclude message bodies in deltas for drafts,False
a383202b459aeeaa9f7f7c5f19215940bd8348f8,2017-01-17 00:02:45,Mark Hahnenberg,"[search-index] Throttle search indexing

Summary:
This diff adds a new SearchIndexer class that each of the concrete
indexer implementations register with. This new class uses the
`isSearchIndexed` field in searchable classes to split indexing work
into chunks. It then times how long it takes to index each chunk and
schedules more work based on a target CPU percent. For example, if it
takes 150 ms to index the last chunk of work and the target CPU fraction
is 0.05 (i.e. 5% CPU use) then it will schedule the next increment of
indexing 3 seconds in the future.

Test Plan: Run locally, verify that indexing occurs in increments

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3707",False
5a3a6124615827a34024d7a107858e1c71fedfd1,2017-01-17 00:01:37,Halla Moore,"fix(sync-state): Make sure folder progress goes between 0 and 1

Summary:
Also fix a related rendering issue and remove unused code.

Fixes T7538

Test Plan: tested locally

Reviewers: evan, spang, juan

Reviewed By: spang, juan

Maniphest Tasks: T7538

Differential Revision: https://phab.nylas.com/D3704",False
ac6e36440c7881c9504238b61d967a87b5ea9caf,2017-01-17 00:01:03,Evan Morikawa,bump(k2),False
24b2632b0771714de6c0cd295663be42418bb831,2017-01-17 00:00:41,Evan Morikawa,[local-private] use new action name,False
c6f221d95bb5d5ee6c3514ef375b5c25e44c5395,2017-01-16 23:58:49,Evan Morikawa,"perf(sync): don't send message bodies across IPC & limit global IPC

Summary: don't send unnecessary crap over IPC

Test Plan: manual

Reviewers: spang, mark, juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D3705",False
f0a6b50d149f05124fc713f5d691c07a2a260f47,2017-01-16 23:55:07,Karim Hamidou,Reset the preferredChannel to stable.,False
f234a5aa3c72aac25abdba01e09121e5139a37ff,2017-01-16 23:54:42,Karim Hamidou,"Set preferredChannel in the autoupdater instead of in the ChannelStore

It turns out that Squirrel checks for update at program launch. In some
cases, it would put Pro users on the ""nylas-mail"" channel because that's
the default channel if you don't pass a preferredChannel.",False
42fa1ce081acd4f69dc6b2bc545ac582cb2ee108,2017-01-16 22:45:32,Karim Hamidou,"Set preferredChannel in the autoupdater instead of in the ChannelStore

It turns out that Squirrel checks for update at program launch. In some
cases, it would put Pro users on the ""nylas-mail"" channel because that's
the default channel if you don't pass a preferredChannel.",False
949690f1921abf0adbc64ece969ac6374c3cfe0a,2017-01-16 19:59:55,Christine Spang,[local-sync] throw proper error if invalid range passed to FETCH,False
21983499284fb1cc16a59631dbb857a20308bbf1,2017-01-16 07:23:47,Evan Morikawa,bump(version): 1.0.5,False
92e10a668a3ae67b65b05e13dc24cfce17c47303,2017-01-16 07:23:34,Karim Hamidou,"[master] Replace ""Nylas N1"" by ""Nylas Mail"" in build scripts

Summary: As discussed --- we need to make those changes to make the autoupdater work across versions.

Test Plan: Will run a build.

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3701",False
dc7db122f9b1528f6e3fdba94826f2e434701485,2017-01-16 07:14:25,Juan Tejada,":art:(send): Don't try to multi-send when only sending to 1 recipient

Summary:
This will make send for a single recipient faster, and open/link
tracking will continue to work as expected

Test Plan: manual

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3702",False
c2138a36f65bec707c834fea8281abae6059dddb,2017-01-16 06:59:00,Juan Tejada,"[local-sync] Fix yahoo sending

Summary: Was missing from in envelope when sending custom message

Test Plan: manual, tested sending from Gmail, Office365, Yahoo, all work

Reviewers: evan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3700",False
de50ac0935ed6a48539593a506060b3d5bb2f22d,2017-01-16 06:45:18,Karim Hamidou,"Fix broken autoupdater, for reals.

Conflicts:
	spec/auto-update-manager-spec.coffee
	src/browser/auto-update-manager.es6",False
f8c023aa6ede38e7e80100e0cd4f7e3d06a5a8e8,2017-01-16 06:44:01,Karim Hamidou,"[fix] [channel drop-down list] Show the stable channel in all cases.

Conflicts:
	internal_packages/preferences/lib/tabs/update-channel-section.jsx",False
52defbb828baf3db836f7945b2a217e1e6be80ce,2017-01-16 06:39:59,Halla Moore,"fix(icloud-sending): Add custom smtp settings

Summary: iCloud needs TLS

Test Plan: tested locally

Reviewers: tomasz

Reviewed By: tomasz

Differential Revision: https://phab.nylas.com/D3699",False
c1859049c6eea03826623b8eeb83b914f2eca5ee,2017-01-16 06:38:16,Halla Moore,"[local-sync, iso-core] Don't treat inline images as attachments

Summary:
Don't show the attachment icon on threads that only have inline
images. We do this by assuming that inline images have a contentID,
and regular attachments do not. Also updates the way we send
attachments in order to adhere to this standard.

Test Plan: tested manually

Reviewers: spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3696",False
bdcdd4a1e94d95345e62d4d403fb485ca09ebafb,2017-01-16 06:36:23,Karim Hamidou,"Fix broken autoupdater, for reals.",False
eba7bffc65215c388443758364702238804353e8,2017-01-16 06:34:01,Juan Tejada,[local-sync] :art: renaming,False
c865934b1bb3182e412d661d18a1862d9d05c9dc,2017-01-16 06:15:16,Juan Tejada,"[local-sync] Fix imap box status check

Summary:
When syncing folders, we check if the folder needs syncing by checking if it has any new messages via the STATUS command (STATUS returns uidnext, highestmodseq among others, and is cheaper than SELECT)

However, we can't issue a STATUS on a box that is already selected. Previously, if the box was already selected, we would just return it, but this was incorrect because we wouldn't get the latest box values (e.g. uidnext), causing us to think that there were no updates available, and skip syncing folders that actually needed to be synced.

Now, if the box is already selected when getting the status, we have to re select it to refresh the latest values

Test Plan: manual

Reviewers: evan, khamidou, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3697",False
f77eacafaf24c16db962dcd7edcc1614bed38648,2017-01-16 05:52:08,Karim Hamidou,[fix] [channel drop-down list] Show the stable channel in all cases.,False
b52ce6f30519a5ea0dfd9a030dbf0e337b5a3ccf,2017-01-16 05:23:43,Halla Moore,"[local-sync] Don't run interrupts within the sync-worker serially

Run them at the same time instead, using Promise.all()",False
aaf06179bf76d15acdfbff348463301191505ff2,2017-01-16 05:11:21,Evan Morikawa,bump(k2),False
8402a7b4728a77b0ba5b2dacbb104363bb728282,2017-01-16 05:05:58,Evan Morikawa,[local-sync] fix lowerbound error where uid set could be zero,False
795cdcbe77ff30c5f0dc01883b8aeada8f0ce531,2017-01-16 04:53:27,Evan Morikawa,bump(version): 1.0.4,False
15cf7024b9d2783defa9a191ea1bc93d82090ac9,2017-01-16 04:53:06,Evan Morikawa,bump(k2),False
4c00b5d99f8bf89a9f82e635bc52f9659dd3eb40,2017-01-16 04:51:51,Halla Moore,"feat(sync-status): Hide syncback tasks inside the expanded details

Summary:
Except for send tasks, place notifications of syncback tasks inside
the expanded sync details.

Addresses T7458

Test Plan: tested locally

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3693",False
ee85700ee9465040324689c08cdac22e5740cd53,2017-01-16 04:48:45,Mark Hahnenberg,"[search-index] Add isSearchIndexed field to searchable models

Summary:
The isModelIndexed function was extremely slow because it was scanning
the unindexed 'content_id' field in the search index table. This diff
adds a field to the searchable models (currently Thread, Contact, and
Event) that stores whether that particular model has been indexed or
not, allowing us to avoid doing the O(n) scan of the search index table.

Test Plan: Run locally, verify that isModelIndexed is no longer a bottleneck

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3695",False
cb204bf0fbf0c9914dec55b6c46937d143e26241,2017-01-16 04:42:54,Evan Morikawa,"perf(scroll): improve thread list scroll perf

Summary:
Lots of components were rendering when they didn't have to on the very
frequent account sidebar updates

Test Plan: manual

Reviewers: mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3691",False
6357ef4ff9eaabb705398dad394f54e3b8c071fd,2017-01-16 04:42:18,Evan Morikawa,"[local-sync] decode quoted-printable encoded attachments

Summary:
Needed to stream process quoted-printable attachments
Fixes T7530

Test Plan: manual

Reviewers: juan, spang

Reviewed By: spang

Maniphest Tasks: T7530

Differential Revision: https://phab.nylas.com/D3690",False
a217fb27fa1116340031652bf5a2125897aa1035,2017-01-16 04:40:14,Juan Tejada,bump k2,False
ae9d6f75defbab23fe5859d313132125844f5266,2017-01-16 04:37:49,Juan Tejada,"[local-sync] Make all syncback tasks interrupt sync so they run fast

Summary:
This commit also lowers the batch size of messages to fetch on folder sync down to 30. This is in order to prevent sync from getting stuck if we queue too many syncback tasks-- given that we only update the range of fetched uids after we've actually fetched and processed messages, if the batch size is too big and we interrupt too often, we might end up never advancing the range and re fetching the same messages over and over.
This also makes the sync loop run faster through all folders in general.

Depends on D3689 to make sure that the batch size actually reflects a message count, i.e. to ensure that we are making /visible/ progress.

Test Plan: manual

Reviewers: spang, khamidou, evan

Reviewed By: evan

Maniphest Tasks: T7477

Differential Revision: https://phab.nylas.com/D3692",False
96f6d8380ba84013befe617732ac50ee7fdc3399,2017-01-16 04:07:38,Halla Moore,"[iso-core] Use `SUPPORTED_PROVIDERS` in `Account.smtpConfig()`

Summary:
Consolidating provider checks to use the same source of truth.
Fixes send issues with some provider types.

Test Plan: tested locally

Reviewers: tomasz

Reviewed By: tomasz

Differential Revision: https://phab.nylas.com/D3694",False
3034d8b7ce068e9cd4dce37e33c1c850c8bb4d4f,2017-01-16 03:58:24,Christine Spang,"[local-sync] Fetch at least the batch size of messages on each sync iteration

Summary:
Because we optimistically fetch UIDs by expanding a range without looking
at the actual UIDs in the inbox and the actual space of UIDs with messages
attached may be sparse due to message moves, we need to track how many
messages we actually download during a range expansion and continue
expanding the range if we haven't downloaded enough messages.

If we reach a large gap where we download no messages at all during a batch, we
pause and check the actual UID list for the folder for the next UID to
download, as otherwise we may spin indefinitely fetching UIDs that don't exist.
(Example: my ""Deleted Items"" folder had about 300k worth of empty UIDs between
a very small UID and a very large UID. With the new system, this registers as a
completed sync within a single iteration as soon as sync hits the gap.)

Test Plan: manual

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3689",False
98970fce0ea624e86a6dd4a89293636de6f05f29,2017-01-16 03:40:26,Karim Hamidou,Bump K2 version.,False
e2ed1f45c0fce9255134a592b6a5fc7a82b1c3e1,2017-01-16 03:40:16,Karim Hamidou,Fix autoupdater – we were using the wrong command.,False
009219b76e97ef1b0166952d860827c80306e217,2017-01-16 03:39:05,Karim Hamidou,Fix unit test path.,False
dc0ab04971224cdccd213e44c981ffa94ec5dbf2,2017-01-16 01:39:41,Karim Hamidou,"HACK HACK HACK Allow querying account tokens by email address too.

We've got a plethora of ""unique"" ids for the same account and ot looks
like a recent regression is preventing us from fetching an API token for
an account from the keychain. This diff changes the AccountStore to be
able to fetch data using an account's email address. Will figure how to
do things better after launch.

Test plan: Checked that it worked for a broken account.",False
d7c61a3032226933fa4bb82f7a29f8f495e50773,2017-01-16 01:38:40,Evan Morikawa,feat(onboarding): add client_edition=pro to onboarding flow,False
64a7d8fa0c6222a10edeb882b806cc77c3b7007c,2017-01-16 01:37:45,Evan Morikawa,feat(onboarding): add client_edition=basic to onboarding flow,False
884529e7b4365623903455d3098dfe43ee653376,2017-01-16 01:36:05,Evan Morikawa,bump(k2),False
32c1caa6c6f38e60e15d1919e71559aec9c19ffc,2017-01-16 01:27:47,Karim Hamidou,"[local-sync] Back off exponentially when getting a sync error

Summary:
This patch changes the sync worker to back off exponentially when there is an issue syncing an account. This has two goals:
- first, it's a bit dangerous to retry immediately. We don't want hundreds of thousands of machines trying to refresh tokens unsuccessfully because our service is struggling.
- second, it's nicer on the CPU to wait a bit between retries.

Currently, we sleep for at most 2 minutes, with some random jitter added.

Test Plan: Tested manually, stared at the code a long time.

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3684",False
89e48b19f6939f3678d5eb8a0b45b1b4eb5ba05f,2017-01-16 00:03:12,Halla Moore,"[local-sync] Stop sync worker before deleting account database

Summary:
Various errors are thrown when the sync worker tries accessing
a database that we've already deleted, so make sure the sync
worker has been stopped before we remove the database. This diff
involves modifying `Interruptible` so that `interrupt()` returns
a promise that resolves once the interrupt has been completed.

Addresses T7472

Test Plan: manual

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3679",False
766c1b95b067fcfdfed6d44232ae2f617fa9e153,2017-01-15 23:36:52,Christine Spang,[local-sync] Update comment on _processExistingMessage,False
b6f725a780feb8b5fd780006aab3f363bca59171,2017-01-15 23:34:29,Christine Spang,[local-sync] Correctly add references when processing existing messages,False
b4bea7abd1e6b98c6ef68006119f53d2d7a402f2,2017-01-15 08:07:12,Evan Morikawa,bump(k2),False
bf0fa55c1ab4cf47b46c3b8bd2750110a8ef49d3,2017-01-15 08:06:51,Evan Morikawa,[local-sync] fix fetch unsynced messages logic looking for min,False
e54b5713942525e8b82a8bbd80e8a33d87082623,2017-01-15 07:21:39,Evan Morikawa,bump(version): 1.0.3,False
0de4179bed84da87d9b2eed7f69ba733dac4b6e1,2017-01-15 07:21:18,Evan Morikawa,bump(k2),False
2efe44cfca28b94d9bd569db2b10f5cb5fb63895,2017-01-15 07:21:02,Evan Morikawa,"fix(auth): fix unnecessarly loud api errors

Summary:
Fixes T7520
Gets rid of the Gmail auth error too

Test Plan: manual

Reviewers: juan

Reviewed By: juan

Maniphest Tasks: T7520

Differential Revision: https://phab.nylas.com/D3688",False
a112dc67c737e028d5f9ac80459080960c3a2594,2017-01-15 07:13:42,Juan Tejada,[local-sync] Fix order of execution in fetch-messages-in-folder,False
f9ff87b97ac71c0a83ac9a8a7b39462e3d334188,2017-01-15 07:10:54,Evan Morikawa,"fix(subscription): show Nylas Basic subscription with CTA to upgrade

Summary:
Removes references to the N1 ID expring.

Luckily, local-sync Nylas Mail Basic doesn't need the nylas ID to do
pretty much anything, which means we don't need to worry about the ""trial""
status of the Nylas ID. The existing trial infrastructure will only kick
into place when someone connects an email account with the Nylas Cloud
Sync servers for the first time.

The one place we do check for the Nylas ID is in the
cloud-api/src/authentication route. Here we hit
https://billing.nylas.com/n1/user and simply expect to get back a Nylas
ID. As long as we return the existence of a Nylas ID (which should ignore
whether or not the old subscription system is ""valid""), the API calls will
succeed.

This makes the ""Upgrade Now"" button go to
billing.nylas.com/dashboard?upgrade_to_pro=true with the auto-sign in
features enabled. This will automatically log the user into the Nylas
billing site with the upgrade_to_pro=true flag set.

There is also a new ""Learn More"" button which goes to
https://nylas.com/nylas-pro.

@mike, will these urls work?

Test Plan: manual

Reviewers: khamidou, mike, juan

Reviewed By: juan

Subscribers: mike

Differential Revision: https://phab.nylas.com/D3680",False
410b0e0becaffe75f7f693662cea2976e1c752ee,2017-01-15 07:06:00,Halla Moore,"feat(fastmail): Add fastmail as a supported provider

Summary:
Also fixes an issue where we would show all any accounts
that aren't gmail or office365 as a generic imap account.

Depends on D3686

Test Plan: manual

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3687",False
0360a58e4f69c6ec590665601c91f18487247715,2017-01-15 07:05:09,Halla Moore,"[iso-core] Let auth methods accept all supported providers

Summary: Treat any that aren't gmail or office365 as standard imap

Test Plan: manual

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3686",False
197a3a4a11e1b3d5e408f5b9fb8b05ed3ebdfae6,2017-01-15 06:58:08,Evan Morikawa,"fix(cal): remove calendar from protcols

Test Plan: manual

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3685",False
8812ff63b080c20a59e01b171b04ea823b36d129,2017-01-15 06:57:15,Evan Morikawa,"[local-sync] fix performance of attribute changes

Summary:
On MG's machine this function is EXTREMELY non performant and causes
things like archive to lock up when the console is running here for some
reason. Not entirely sure exactly what's causing it, but there were some
simple DB cleanups that will make it faster for large queries.

There's likely other things involved since the sequelize DB being locked
up shouldn't affect the peformLocal of the edgehill db for things like
archive. Still looking into that

Test Plan: manual

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3683",False
b1df17e1576d584955780812b095b3d63c7dfbc9,2017-01-15 06:53:43,Juan Tejada,[local-sync] :art:,False
0ea75493ac9c660e859bd5051fed9d375ed58b76,2017-01-15 06:40:38,Mark Hahnenberg,"[search-index] Don't removeQuotedHTML when indexing threads

Summary:
This is a very expensive operation and there seemed to be few downsides
to including quoted portions in the index. We can revisit this to
improve how we index when we have a proper scheduler.

Test Plan: Run locally

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3682",False
8ebe6b92e2eb2bf4f5caf6b1004b5008402f7986,2017-01-15 06:26:39,Michael Grinich,"💅 new Nylas Mail icon

Test Plan: Gotta test a Travis build

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3676",False
dc51a27526c0825e45660afb9587bc48fae1a4f0,2017-01-15 06:26:14,Michael Grinich,"Revert ""💅 new Nylas Mail icon""

This reverts commit efe8fead34e561ea2603c36d10dae3c38d8c9ce7.",False
978e3462fd23e8ddaf4098539d536a6e681cf8b3,2017-01-15 06:02:14,Juan Tejada,[local-sync] Await instead of yielding when fetching the very first batch of messages in folder sync,False
9077fd2301413e3575707794194fc0ec8a983eab,2017-01-15 05:52:53,Juan Tejada,[local-sync] Minor syntax fix,False
f9f6662b0e6c6d2880d7ca54d87290a87c022a17,2017-01-15 05:48:23,Evan Morikawa,fix(spellcheck): fix right click menu on spellcheck,False
135d499451004d9eefa3fa2bbd0b404781c71b9e,2017-01-15 05:48:19,Juan Tejada,bump(submodule),False
cedec79b0136d5025b99c053bb40d899958f581e,2017-01-15 05:26:17,Juan Tejada,"[local-sync] Skip unecessary folder syncs

Summary:
Before trying to sync a folder, check if we actually need to do so. This will prevent us from doing unnecessary work that slows down the sync loop (like performing SELECT commands)

We will perform a folder sync if any of the following are true
- The folder hasn't been completely synced
- There are new messages (using imap STATUS command)
- There are attribute changes indicated via highestmodseq (using imap STATUS command)
- If server doesn't support highestmodseq, it has passed enough time since we last ran an attribute scan on the folder.

Addresses T7513

Test Plan: manual

Reviewers: evan, halla, spang

Reviewed By: halla, spang

Differential Revision: https://phab.nylas.com/D3675",False
7935b3799dba109a7d559a51d0d8c18eedbb10a8,2017-01-15 04:27:22,Christine Spang,[local-sync] grr phab lost this update,False
00336e0d812d6e4b61941266cd50cfab46c2038e,2017-01-15 04:25:39,Christine Spang,"fix(sync-status): Update how we calculate sync status

Summary: Concommitant diff to D3677

Test Plan: manual

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3678",False
387d6894159376f5aecc6216ab451f4594ee48e8,2017-01-15 04:22:35,Christine Spang,"[local-sync] Fetch min UID in each folder for use in sync state

Summary:
Currently, our mail sync strategy of expanding UID ranges from UIDNEXT
backwards until a UID of 1 implicitly assumes that every UID corresponds to an
actual message. This assumption is incorrect, and results in several
significant bugs regarding sync status.

This patch fixes issue 1:

Since UIDs are persistent and, so long as the UIDVALIDITY is valid, ascend
monotonically upward, every time you move a message to a new folder you ""lose""
UIDs lower down in the range. In my work Inbox, where I get a lot of mail,
archive all the time, and generally have only a small number of threads in the
mailbox, the smallest UID is over 100k.  This means that, after all my inbox
messages are synced, the sync loop will continue attempting to download
nonexistent old messages in this mailbox for hundreds of sync iterations, and
will not mark the mailbox as fully synced until fetchmin reaches 1, regardless
of the fact that there are no actually messages being pulled down.

This patch needs a small associated patch to N1 to update how sync status is
calculated (coming soon).

The next patch in this series will deal with gaps in the UIDspace that slow
down syncing of a folder.

Test Plan: manual

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3677",False
1d29e7d4d0ad90eaa4ca40f4c3f024ab6991f592,2017-01-15 04:17:33,Evan Morikawa,feat(yahoo): got yahoo sending fixed,False
44f8bf0627a4a3bfa1378bcc322967af6692f711,2017-01-15 04:17:15,Evan Morikawa,[isomorphic-core] allow custom smtp configs,False
efe8fead34e561ea2603c36d10dae3c38d8c9ce7,2017-01-15 04:05:43,Michael Grinich,"💅 new Nylas Mail icon

Test Plan: Gotta test a Travis build

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3676",False
ca8bdaf651544d4c96189377477381cd99e887a8,2017-01-15 04:01:51,Juan Tejada,"[local-sync] Cleanup, use Provider constants",False
519a1f163019ede7cd6c3baed3195f497dbf5b73,2017-01-15 03:01:24,Christine Spang,[local-sync] fix comment,False
f69ce97613b77e84b8587538a97681347540fa17,2017-01-15 03:01:16,Christine Spang,[local-sync] canonicalize references,False
87d963dc44ec10875efcc364ca492958f978ec11,2017-01-15 00:14:26,Halla Moore,:lipstick:(account-onboarding): Fix margins on the accounts list,False
96e07b6adfe819227df1385a9873ca1b756fec35,2017-01-14 09:01:43,Evan Morikawa,bump(version): 1.0.2,False
5bc9b5a66878c4efe5fa67087d936fbd53c9ff43,2017-01-14 09:01:31,Evan Morikawa,bump(k2),False
5dc22a4b20e1c01fb5607147f769a2122cfe3330,2017-01-14 09:01:15,Evan Morikawa,[local-sync] fix duplicate ensure in sent folder,False
1ff0b87d8f7d9069dbe8f138400c4a8c3a32bf0c,2017-01-14 08:33:22,Evan Morikawa,bump(version): 1.0.1,False
99c3ff87b541dd9b0c269513a6b590692130f271,2017-01-14 08:32:38,Juan Tejada,"fix(send): Impose stricter attachment size limits on send

Summary: See title

Test Plan: Manual

Reviewers: jackie, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D3670",False
239aa612095facabd0386762459da45b09e749c2,2017-01-14 08:31:52,Juan Tejada,"[local-sync] Separate sending tasks from the sync-loop

Summary:
We want to do this in order to prevent send tasks from blocking the sync loop given that they can take a very long time to run. This is especially true when sending emails with large attachments to multiple recipients.
There is no real way to make sending in these cases faster, but we can prevent it from blocking the sync loop at least, especially because sending is mostly I/O bound.

This is a bit messy actually, but should be fixed when we properly implement a sync scheduler

Also added a limit to the total size of attachments you can upload to try to prevent weird EPIPE errors when sending.
See: D3670.

Also moved and renamed stuff a little

Test Plan: manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3669",False
efd20d64e7e0fd24f6f95209d728958967fd8e1c,2017-01-14 08:30:01,Evan Morikawa,"fix(reset): fix the account reset button for K2

Summary: Depends on D3672

Test Plan: manual

Reviewers: mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3673",False
f141b7253a66d966c043bf0c33539ad2c1e8d308,2017-01-14 08:29:14,Evan Morikawa,"[local-sync] fix reset accounts and data button

Summary: Allows us to reset accounts in local-sync too

Test Plan: manual

Reviewers: mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3672",False
63a0f4946b42d8589a2779b79a0f131b7b1af8c8,2017-01-14 08:24:37,Evan Morikawa,"Fix references for ~/.nylas to ~/.nylas-mail

Summary: Fix references to nylas-mail

Test Plan: manual

Reviewers: jackie, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3674",False
90ae2ac596db5d38f4cfcca41b45cf7bf2ae71fd,2017-01-14 08:15:58,Karim Hamidou,fixed failing test,False
af55ad4ff7261fda10d10f6f4648cef2f029c0f7,2017-01-14 08:06:19,Halla Moore,"fix(sync-messaging): Update other messaging to check per-folder sync status

Summary:
Also fixes an issue where accounts weren't being removed from
NylasSyncStatusStore because `subscriptions` was used instead of
`_subscriptions`. Specifically, rename `_subscriptions` to
`_accountSubscriptions` so we get an explicit runtime error if
the `_` is left out.

Test Plan: tested locally

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3671",False
64db3910ff6276b09ae25963134e2d6768493c3b,2017-01-14 06:31:15,Karim Hamidou,Use staging autoupdater for staging.,False
2d728b527a69ba609e4b074f94ba842aa45c2c6e,2017-01-14 06:30:42,Karim Hamidou,Use staging autoupdater for staging.,False
b5ceb14151f8819cfecd3e6ed93fa800f5493895,2017-01-14 05:56:11,Evan Morikawa,"fix(task): tasks re-attach to ProviderSyncbackRequests

Summary:
The old task queue for message changing tasks (like mark unread and
archiving) had a system that would only do 5 at a time until the Promises
resolved. Unfortunately our new system doesn't resolve the request
promises until the full IMAP task is actually complete. When you're moving
dozens of messages this can take a very long time since they're currently
not prioritized in sync.

Furthermore if you quit the app while this is inprogress, the Tasks had no
way of saving the status of each of the syncback actions. This means when
you restarted the app, the TaskQueue would get re-inflated and try tasks
again. We now keep track of any tasks that have started and either look
for them in the database or re-listen for their changing status again.

Test Plan: manual

Reviewers: mark, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3666",False
d700fcbb8ce6fd14a6a103753fe23b093d3562e3,2017-01-14 05:47:47,Evan Morikawa,fix(error): also listen to process errors in windows for async/await,False
a865fabe488eb853f347e3062c9ea9459df12d67,2017-01-14 05:47:24,Evan Morikawa,[local-private] use new Sentry endpoint,False
125cd96c5e6621fd5ac4cd524f51e0bdc5c60141,2017-01-14 05:12:23,Halla Moore,"[local-sync] Update oldestProcessedDate logic

Summary:
I happened to be testing between Jan 2017 and Dec 2016, so I
missed this logic flaw. Boo.

Test Plan: tested locally

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3667",False
398dcf276f866565c1b86a5e411c34c93376b5ef,2017-01-14 04:33:29,Halla Moore,"[local-sync] Make sure we're saving sent messages with 'SEEN' flag

Summary: We did this for gmail, but not for other providers.

Test Plan: tested locally

Reviewers: juan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3665",False
8b24ccdecb0ae4a6b7d5ad020bac91320dceb330,2017-01-14 04:30:27,Juan Tejada,[local-sync] fix build,False
a925cd71c57dbcb121f0b220d9a433379fa4089d,2017-01-14 04:05:54,Halla Moore,fix(task-labels): Remove an extra ellipsis I missed.,False
944afbc976c51c0734c5cf314a0f48e91474a89f,2017-01-14 03:12:43,Halla Moore,"fix(task-labels): Remove ellipses from hardcoded labels and fix css class

The css class was accidentally renamed in another commit. Bring it back and
remove the hard-coded ellipses, since the ellipsis is now part of a css
psuedo element.",False
42e0854ebeb7e8795532519db40fa03764cc1d65,2017-01-14 03:09:50,Halla Moore,"[local-private] Update task label

Remove ellipsis, since it is now included as part of a css psuedo element",False
f680e6fc9dbf27d07d1446d8c5e03e3bfed58261,2017-01-14 03:04:18,Karim Hamidou,Bump version to 1.5.0,False
b6a51872649082955b5fcadc5ff65931b370b4f2,2017-01-14 02:58:39,Karim Hamidou,Bump to version 1.0,False
0e7b836b8412ba374a0406a251f84183d86aab30,2017-01-14 02:00:43,Juan Tejada,"[local-sync] Cleanup sync tasks to be more consistent with syncback tasks

Summary: While working on separating send out of the sync loop, I realized sync tasks could use some cleanup to be more consistent with how we implemented syncback tasks. I reorganized and renamed things a little bit. This will also help us move in the direction of the scheduler implementation under which everything is a task.

Test Plan: manual

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3660",False
4ac303272b5a2caf505d305deed65f822bdd3400,2017-01-14 01:50:07,Evan Morikawa,bump(version): 0.5.11,False
8d18181f77defae7bf63584a450ee8da4ce7df53,2017-01-14 01:49:42,Evan Morikawa,"fix(config): move from ~/.nylas-k2 to ~/.nylas-mail

Summary:
fix(config): move from ~/.nylas-k2 to ~/.nylas-mail

fix(auth): ignore onboarding urls that aren't Nylas

feat(sig): change default signature

bump(k2)

Test Plan: manual

Reviewers: halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3664",False
87be12387539d0c740de918b03687850ec8de20f,2017-01-14 01:43:26,Evan Morikawa,"feat(migrate): migrate data and settings from Nylas Mail Basic

Summary: fixes to migrator and Nylas Pro langauge

Test Plan: manual

Reviewers: khamidou, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3661",False
704c0b27c670ff50ecd8435115486a1112d7106c,2017-01-14 01:37:54,Halla Moore,"fix(initial-sync-status): Change how we display the sync status

Summary:
This diff takes out the progress bars, since they can appear to
not move for very large mailboxes. Instead, just show an icon that
indicates whether the sync is complete or in progress, and add a
tooltip that displays how far back the folder has been synced to.

Submodule commit is D3662

Test Plan: tested locally

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3663",False
b3a9f66a440591c63d286cd72ae2132a71b05f17,2017-01-14 01:35:45,Halla Moore,"[local-sync] Add `oldestProcessedDate` to `Folder.syncState`

Summary:
Only updated within month precision. We can use this to show how
far back a folder has been synced.

Test Plan: tested locally

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3662",False
79696237030ced3701a2a0d12fab8d337ea30155,2017-01-14 01:30:45,Evan Morikawa,"[local-sync] fix attribute scanning in sync worker

Summary:
Fixes https://phab.nylas.com/T7435

The old deepScan (now `scanForAttributeChanges`) and shallowScan (now
`fetchLatestAttributeChanges`) had some fatal flaws.

If you deep scanned it would attempt to load the message attributes of all
messages ever and cause very bad memory leaks.

Also, if you left a mailbox running for a long time, there was a query
that would eventually run `Message.findAll` and, even though it was just
returning the headers, would still run insanely expensive operations

This fixes (and renames) these issues.

Test Plan: manual

Reviewers: spang, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3657",False
a530868a496d3e6d8a5a30da3665189e7780f6e6,2017-01-14 01:23:41,Mark Hahnenberg,"[thread-search] Add support for category search (i.e. ""in:foo"")

Summary: See title

Test Plan: Run locally, search for specific labels

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3656",False
7231353dd944d61c09405bcbed9f58a7080f11bd,2017-01-14 00:45:24,Christine Spang,[local-sync] Fix parsing of existing messages derp,False
c92704ac49fbb36019288b3713b1cc84bdd2890d,2017-01-14 00:33:47,Karim Hamidou,"[feat] [autoupdater] Let N1 specify a preferred channel.

This is the companion commit to https://github.com/nylas/N1/commit/266e6edbcfe05cca2ede74824d244132899d36fd
As part of this commit, we want N1 to be able to specify a preferred
channel. For the N1-next branch this channel will be `nylas-mail`. For
the `stable` branch, it's going to be `stable` since we don't want newly
downloaded Nylas Pro copies to be on the `nylas-mail` channel.",False
266e6edbcfe05cca2ede74824d244132899d36fd,2017-01-14 00:29:12,Karim Hamidou,"[feat] [autoupdater] Introduce a new channel, ""Nylas Mail"" + let N1
specify a preferred channel.",False
61e3349613ed3a637ed8cfa3e4900ac790bd1c94,2017-01-14 00:09:54,Christine Spang,"[local-sync] For generic IMAP, Thread based on Message-Id, In-Reply-To & References

Summary:
This swaps out our generic IMAP threading mechanism to use the threading
headers on the message instead of the prior way of grouping by subject
and then differentiating based on participants, as that design was
somewhat driven by what we could accomplish easily given legacy data
schema decisions and has serious caveats, such as different threads between
the same people with the same subject being misthreaded together. With K2, we
have free reign to change the data format, so we can do it right.

The algorithm is super simple:
- Define ""references"" as the union of the Message-Id, In-Reply-To, and
References headers on a message, filtered for valid RFC2822 Message-IDs
- On message sync, if any element of the new message's references
matches any element of an existing message's references, thread them
together

In order to accomplish this, we need to store References in a way that
allows each element to be indexed for fast lookup. That meant either
using the sqlite JSON1 extension + expression-based indices, or creating
a new table. I chose the latter as a time-tested and simple solution,
since we don't need the flexibility of JSON here.

Test Plan: manual - unit tests coming

Reviewers: khamidou, evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3651",False
c513ba8e075be593a32fd5df293c25da52f45526,2017-01-13 21:16:18,Christine Spang,[local-sync] Messages generated for send should not be unread,False
6182f4d88e8b1cbea64a14c9b7994ff3af572235,2017-01-13 03:46:47,Christine Spang,"[isomorphic-core] Disable nodemailer's automatic X-Mailer header

Examined the headers on a message we sent and found this:
> X-Mailer: nodemailer (2.5.0; +http://nodemailer.com/; SMTP/2.6.0[client:2.8.0])

No need to plaster which sendmail library we're using all over every
email our users send. Turn it off!",False
80e872284ef5fffe0ce9d41a99be57c162df982f,2017-01-13 03:23:17,Juan Tejada,"[local-sync] Don't sync spam until everything else is synced

Summary: Addresses T7426

Test Plan: manual

Reviewers: evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3655",False
5f077fc5b758d3d3f0e7a2ce5465272c3388688b,2017-01-13 02:46:07,Mark Hahnenberg,"[syncback] Reuse currently open box if possible

Summary:
Previously we would unconditionally issue a SELECT when openBox was
called. Now we check if the currently open box is the one we want first and
return immediately if it is, avoiding the unnecessary SELECT (which can be
quite expensive on large folders like INBOX). We were also calling closeBox
after iterating all the messages in a thread to mark them as read/unread.
This was unnecessary and was causing extra SELECTs to be issued. Now we don't!
This diff is a 5x speedup over the old behavior when marking lots of
threads in the same folder as read all at once.

Test Plan: Run locally, measure perf with log statements

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3654",False
c5e54bad09956935b6f6e8b93e98620846c1f29e,2017-01-13 02:00:30,Juan Tejada,"fix(offline-state): Make sure we periodically update it

Summary: See title

Test Plan: manual

Reviewers: evan, jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3652",False
ea736a529ae269f0f39a13a452e968359b08c94e,2017-01-13 01:39:53,Evan Morikawa,bump(version): 0.5.10,False
99968713572dfdd2667880aeb7a1c361d58b61e7,2017-01-13 01:36:35,Evan Morikawa,bump(k2),False
202e4f43951859aba652a0257d576effdb58c781,2017-01-13 01:35:44,Jackie Luo,":art:(rename): Update Nylas N1 to Nylas Mail

Test Plan: Tested locally.

Reviewers: halla, juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3645",False
0ab92c0e8d29d9a1ca80bc2214b351893464c1e1,2017-01-13 01:27:07,Mark Hahnenberg,"[local-sync] Fix error thrown when Gmail returns no search results

Summary:
We were returning the wrong type in the case that we got no messages
back from the Gmail search API.

Test Plan: Run locally

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3646",False
69aaff86bf7f0d8f92d80e7d27b5de165b3a0edf,2017-01-13 00:55:39,Jackie Luo,"Update Nylas N1 to Nylas Mail

Test Plan: Tested locally.

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3644",False
8e275e0064e0ebf0dd4b21cc6aca41ca480e0d9a,2017-01-13 00:46:53,Juan Tejada,"[local-sync] Ensure we get new mail ASAP via dedicated imap conn

Summary:
Add a new dedicated imap connection to listen for any updates or new mail on the inbox.
Previously, we wouldn't be able to receive new mail events on the inbox during the sync loop
because other mailboxes would be open while we sync them. This would cause big
delays in receiving new mail, especially if you have a lot of folders

Test Plan: manual

Reviewers: spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3650",False
580cfb67889d6c770e5258dec201f7efdd19885b,2017-01-13 00:26:43,Halla Moore,"fix(SyncbackCategoryTask): Make category operations optimistic again

Summary:
We don't see any weird double object behavior when delete deltas are
working properly, so might as well be optimistic since it makes for
a better user experience. This diff also notifies the user if a
category operation fails because of a mail provider restriction.

Fixes T7475

Test Plan: tested locally

Reviewers: juan, evan

Reviewed By: evan

Maniphest Tasks: T7475

Differential Revision: https://phab.nylas.com/D3648",False
da89ff1bd1499d0ccaa948b0a4694aa3614f81b6,2017-01-12 23:55:33,Halla Moore,"fix(custom-imap): Hide custom imap accounts and settings from onboarding

Summary:
IMAP no longer appears on the onboarding account list, and the option to
edit connection settings does not appear for any of the visible account
types. Custom IMAP accounts can still be added via a menu option.

Fixes T7474

Test Plan: tested locally

Reviewers: juan, jackie, evan

Reviewed By: evan

Maniphest Tasks: T7474

Differential Revision: https://phab.nylas.com/D3636",False
ee8ddfcf62ef65be6f427fcd551dc5d927c48533,2017-01-12 23:51:45,Halla Moore,"[iso-core]: Make sure deltaStreamBuilder passes along delete deltas

Summary:
We don't want to inflate delete Transactions, but we do still want
to pass the delta itself along.

Test Plan: tested locally

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3647",False
6ff1eff6dc2ccae8cfd26667836f89ce0889e6eb,2017-01-12 21:13:34,Christine Spang,"[local-sync] Enable toggling ENABLE_SEQUELIZE_DEBUG_LOGGING on launch via an env var

It's much more convenient to be able to turn this on/off without
editing the code.",False
725e05f01b748f437a1bb9519e0ab9dce39e6add,2017-01-12 07:38:20,Christine Spang,"[local-sync] Still download messages when they have no body

There are plenty of valid use cases for sending subject-only emails,
and we also want to still download the headers and create message
objects if e.g. the email consists of only an event invitation or
an attachment.",False
ddebb92d2944d6c210f6d3beffda5460b069df70,2017-01-12 06:56:27,Juan Tejada,"fix(notifs) Restore offline notification

Summary: See title

Test Plan: tested locally

Reviewers: evan, halla, jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3643",False
e533b65d1ac4e0ba3aebbaf5388e48a21c9231aa,2017-01-12 06:18:38,Evan Morikawa,bump(k2),False
8bbf18373b2726cdccd8ac030af5dc23d4577b3e,2017-01-12 06:18:10,Juan Tejada,"[local-sync] Make sure IMAPConnection times out correctly

Summary:
This commit passes down the `socketTimeout` option to node-imap. However, just
passing this option doesn't seem to work reliably, so this commit manually implements
the socketTimeout option for our IMAPConnection.

How it works is that basically every operation is wrapped with a timeout by
augmenting  the `createConnectionPromise` construct that already existed.

Test Plan:
Locally, tested by sleeping computer and turning off wifi. The
connection will successfully error and be restarted. It will reconnect when the
network is available again

Reviewers: khamidou, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3642",False
6892f51146af6b9b11d15f2ca188f32eaf232bba,2017-01-12 05:57:22,Michael Pfister,"[cloud-api] Adds gmail auth error page with action items for known issues

Summary:
These errors handle the following cases:

1. User hits ""deny"" during google oauth
2. User picks an email that has Gmail disabled for the domain
3. User picks an email that has IMAP disabled for the accoutn
4. Any other underlying IMAPConnection errors from node-imap
5. An unknown error occurs

In the case of 2-4, it will show several possible solutions (rather than a specific one)

Test Plan: Tested manually

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3639",False
c1fda21bb1c9323b326383bac22e558cb272b0b9,2017-01-12 05:21:12,Christine Spang,"[local-sync] Give Nylas Mail messages a different Message-ID from API messages

Summary:
We may find it useful at some point to be able to tell which messages in
a user's mailbox were sent using N1/the REST API vs Nylas Mail.

Test Plan: manual

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3631",False
7f750bb60a0c598b6a43353b5f60d3058a6e2f6b,2017-01-12 04:54:18,Halla Moore,":lipstick:(initial-sync): Move ""hide"" to the top of the expanded progress

Summary: Fixes T7442

Test Plan: tested locally

Reviewers: evan, jackie

Reviewed By: jackie

Maniphest Tasks: T7442

Differential Revision: https://phab.nylas.com/D3640",False
37e53b14b2b76b14c2095a52da789fcf6e6175b8,2017-01-12 03:56:42,Mark Hahnenberg,"[thread-search] Improve local thread search

Summary:
Previously we waited to build the local ThreadSearch index until we were
done with the initial mail sync. This is undesirable because inboxes can
be very large, making local sync useless for a number of hours after a
user adds an account. This diff removes that restriction.

This diff also adds a new rudimentary new grammar (along with accompanying lexer
and parser) for local thread search queries. This grammar is then
translated into the appropriate SQL queries on the ThreadSearch index
table. More advanced features (e.g. in:category, date ranges, etc) can be added
easily in the future by augmenting this simple search query language.

Test Plan: Run locally, new unit tests

Reviewers: juan, evan, khamidou

Reviewed By: khamidou

Differential Revision: https://phab.nylas.com/D3614",False
24b90b8c505077239244e2f2e448150d0fd3bbf9,2017-01-12 01:34:58,Karim Hamidou,"[fix] Add a poor man's two-phase commit algorithm for syncback tasks.

Summary:
Sometimes things go very wrong when trying to syncback an action. For example, the worker window could crash, preventing us from marking the current task as failed. What's worse, another sync iteration could try to run the task which crashed, thinking it a new one. To prevent this, this diff adds a fourth syncback task state, `INPROGRESS`.

New syncback tasks are marked as `INPROGRESS` before being executed. When they complete we mark them as `SUCCEEDED/FAILED`. Stray `INPROGRESS` tasks are automatically marked as `FAILED` at the beginning of every sync iteration, to make sure we don't retry them again.

Test Plan: Tested manually.

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3635",False
b9d4e1d8899ccefd1dc2c7a232d687e95258020c,2017-01-12 00:49:38,Halla Moore,"feat(onboarding): Display a possible issue when credentials are incorrect

Summary:
When a user tries connecting an account and it 401's, show a note
that suggests what the issue may be, and link to a support article
for more information. In general, mention that they may need to use
an app password. If it's a Yahoo email address, ask if they've already
enabled the proper setting from within Yahoo.

Test Plan: tested locally

Reviewers: evan, jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3630",False
187347b3a6442e4b41554fe6cff42165c22ad72f,2017-01-12 00:49:00,Halla Moore,"fix(preference-accounts): Don't select accounts that no longer exist

Summary:
After updating an account's connection settings, there's a brief
moment where the selected account isn't null, but doesn't actually
exist in the AccountStore. This throws a bunch of undefined errors,
so this diff makes sure we discard that selection.

Fixes T7452

Test Plan: tested locally

Reviewers: evan, juan

Reviewed By: juan

Maniphest Tasks: T7452

Differential Revision: https://phab.nylas.com/D3634",False
e87c3d07fbe11d04bb4ac9423e3a7d319280342e,2017-01-11 07:55:30,Evan Morikawa,bump(version): 0.5.9,False
4002cb23ebd839bdca84afe24dbf77465ae510fd,2017-01-11 07:55:18,Evan Morikawa,bump(k2),False
feb3f44b061f3b318c119239d368ca3018cc911a,2017-01-11 07:54:38,Evan Morikawa,"[local-sync] fix multiple sync loops starting

A bug allowed multiple sync loop processes to start. This could lead to
double sending and the sync loop appearing as thouogh it couldn't be
interrupted",False
becb137aa7404d6e1476e1046857f37e7382d30c,2017-01-11 07:45:57,Jackie Luo,bump(submodule),False
f854267c1bb1d6059ef4a661b80b9657e31b9d0e,2017-01-11 07:44:56,Jackie Luo,feat(onboarding): Add Yahoo and iCloud and fix styling,False
44517bc5fc0da0cf0435b53c8c98ef739cec5c1d,2017-01-11 07:04:57,Halla Moore,"fix(onboarding): Don't store type-specific fields when switching account types

Summary:
Since we pass all of the account info to the type-specific auth routes, having
extra fields in the account info object can cause the auth request to fail its
validation. This diff ensures that switching account types will drop any fields
in the account info object that aren't accepted across all routes.

Fixes T7455

Test Plan: tested locally

Reviewers: evan, juan

Reviewed By: juan

Maniphest Tasks: T7455

Differential Revision: https://phab.nylas.com/D3633",False
a5d0abc3b5b74ba0e8b9ef2c38e5c9a3ff970c84,2017-01-11 07:04:18,Michael Pfister,Fix readme typo,False
b4f736b1f470098185f90d29eb00e1fd478b4542,2017-01-11 07:01:51,Michael Pfister,Add ability to debug with chrome dev tools in cloud-api,False
b7e99ec7747b9611a862bac0d7f501b96d8f9ee0,2017-01-11 05:53:53,Halla Moore,"fix(category-picker): Handle the case where new category creation fails

Summary:
Instead of throwing vague undefined errors in the console, recognize that
they category wasn't created and notify the user via a dialog box.

Test Plan: Tested locally

Reviewers: jackie, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3632",False
35149148e6130264dc9c48c8e633c82f4ca1ff5a,2017-01-11 05:01:05,Juan Tejada,bump(version) 0.5.8,False
a6ae96bb1bc728efd7f435887a64c65f8ac9b5a4,2017-01-11 05:00:30,Juan Tejada,Fix error reporter causing crash due to infinite recursion,False
c5655ca25dda7871f1a2e1c15419841c7d1cbef2,2017-01-11 04:37:36,Christine Spang,"[local-sync] Properly handle multiple occurrences of From/To/Cc/Bcc headers

Summary:
Well-behaved MUAs don't do this, but it is totally legal and we should
handle it.

The Python sync engine handles this properly also:
https://github.com/nylas/cloud-core/blob/7db949fec9447b73e2ba9485d8903380414e8223/sync-engine/inbox/util/addr.py#L26-L47

(Found this out while scratching my head over the output format of
mimelib.parseHeaders---turns out it's an array for a reason:

> let to = mimelib.parseHeaders(`To: Christine Spang <spang@nylas.com>
... To: Foo Bar <foo@example.com>`);
undefined
> to
{ to:
   [ 'Christine Spang <spang@nylas.com>',
     'Foo Bar <foo@example.com>' ] }

)

Test Plan: unit test included

Reviewers: halla, jackie, mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3625",False
b0fc896e7c82843c69db86e25f8520ea4ab57839,2017-01-11 04:21:09,Juan Tejada,bump(version) 0.5.7,False
4b00490cdacb5069582396613175e560a835e9ee,2017-01-11 03:46:11,Juan Tejada,bump(electron),False
bc984e4895887c9e4d9c0f51fb84011ea607b1e3,2017-01-11 03:09:54,Christine Spang,"[local-sync] Remove deprecated comment

With the latest update to N1's CSS, this is no longer true---though a theme
can easily override the font to monospace if so desired.",False
bcac70a400cacb6c12341f95b2ea7d72c3452d9c,2017-01-11 01:49:15,Juan Tejada,[local-sync] Fix check for new mail updates on inbox folder,False
6cdf61b71e049f975fc4ccc3c70227bbe668552b,2017-01-11 01:45:22,Evan Morikawa,bump(version): 0.5.6,False
a5a042256eee991529a2fc1fbe18c09ff95a5e82,2017-01-11 01:45:00,Evan Morikawa,"feat(crash): add electron crash reporter

Summary:
Adds electron's crash reporter. This is currently going to a dumb heroku
app I setup: https://github.com/emorikawa/electron-crash-report-server

It's going there for now since I want to first evaluate if this is useful
before spending the time to build it in N1-Cloud and taking the risk of
getting flooded by crash reports.

The crash reports themselves are very difficult to debug since it requires
compiling tools that can read os-specific memory dumps

Electron seems to be crashing fairly frequently for some unkonwn reason,
and this is really the only diagnostic tool we have to potentially see why

Test Plan: manual

Reviewers: spang, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3629",False
802d50dd5a59ff40aaa91c8e649cd32ac535bc41,2017-01-11 01:41:34,Juan Tejada,"[local-sync] Run send tasks before other syncback tasks

Summary: Update `_getNewSyncbackTasks` to return any send tasks first, and then others

Test Plan: locally

Reviewers: halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D3627",False
02cff5e729ccd625572b76ff10acaa4ca247883d,2017-01-11 01:35:14,Christine Spang,[local-sync] Make comment about Date/INTERNALDATE & message hashes better,False
72a20cfcfdefb9ec2374cac21ed129c21f1f59d9,2017-01-11 01:24:49,Tomasz Finc,"fix(windows-build) bruteforce transient failure per http://help.appveyor.com/discussions/problems/5822-transient-build-failures-with-node-dependency-node-gyp

Summary: Retry the build per AppVeyor forum recomendation

Test Plan: run a build

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3628",False
542c93aee1bcd6c65c1adf0140044591d6483297,2017-01-11 00:52:23,Halla Moore,"fix(connection-settings): Update connection settings for fastmail.com

Summary: The previous settings didn't support all operations. Fixes T7450 and T7451.

Test Plan: tested locally

Reviewers: juan

Reviewed By: juan

Maniphest Tasks: T7450, T7451

Differential Revision: https://phab.nylas.com/D3626",False
248e25959eda0e12a83735cbe6c65bb9bb51b8fc,2017-01-11 00:26:15,Christine Spang,fix(email-frame): Use same fonts for plaintext emails as for HTML,False
137830e65f2e97be44b5e334f5a0c35976c63ec9,2017-01-11 00:15:53,Juan Tejada,"[local-sync] Make syncback task execution interruptible

Summary:
See title. Got rid of that syncback-worker class which was kind of useless and
made things harder. My b.

Test Plan: locally

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3624",False
a68df300def38119b981675fe4747835b3d3f1be,2017-01-11 00:11:35,Christine Spang,"[local-sync] Rename extract{Snippet,Contacts} in message-factory

Summary:
We have another function called extractContacts, in its own file,
extract-contacts.js, which is used to create Contact objects. This has
confused me a number of times and also leads to grep collisions.

This patch also makes the snippet unit tests pass again after a recent
API change.

Test Plan: included unit tests, manual

Reviewers: halla, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3623",False
b5f578af2dcf56409e9a762b3310a28154ec2c59,2017-01-11 00:09:43,Christine Spang,"[local-sync] Remove unused message update hook

Summary:
Message bodies, drafts aside, are immutable, and we set the snippet on
new messages manually in parseFromImap()---meaning this hook, if
invoked, is likely to replace the snippet with a broken version computed
with this old implementation. If we need a hook in the future (e.g. for
updating drafts), it should use the snippet function from
message-factory.

Test Plan: n/a

Reviewers: juan, halla

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3622",False
d0aa4ee4a91aa6f2572673a6cec0dbf4d57e944c,2017-01-11 00:07:08,Halla Moore,"[local-sync] Don't delete messages via cascade when a folder is deleted

1. It could be expensive to delete many messages at the exact moment
   when the folder is deleted
2. The folder delete could actually just be a rename, and if we
   deleted all the messages, we would have to re-process them all
3. We already do a clean-up check for orphaned messages at the end
   of the sync loop, where we already know if the folder was
   actually deleted or just renamed",False
c18464e58c2d13dc882e72bda616beee0ac90445,2017-01-10 23:52:17,Evan Morikawa,bump(k2),False
aacfff9afa774589a7a4daaf20653518431c1cfa,2017-01-10 23:51:14,Evan Morikawa,"[isomorphic-core] don't try and inflate delete deltas

Summary:
If we inflate delete deltas, the object we're trying to find won't exist
anymore (we just deleted it!). This is likely causing the `While inflating
${sourceName} transactions, we couldn't find models for some ${modelName}
IDs` error.

Fixes T7436

Test Plan: manual

Reviewers: spang, juan, halla

Reviewed By: halla

Maniphest Tasks: T7436

Differential Revision: https://phab.nylas.com/D3621",False
615f2f036c416e83db553e623e53d7a73b128ee7,2017-01-10 21:56:44,Christine Spang,[local-sync] s/queryes/queries/,False
93af2f48356eee323c230c2dcee20cabef93bbc4,2017-01-10 21:46:16,Christine Spang,[local-sync] Fix typo in ENABLE_SEQUELIZE_DEBUG_LOGGING,False
a495ba293e28bbf8a6f3f17ac0c7d647cbc581f7,2017-01-10 14:46:12,Tomasz Finc,fix(electron-packager): rolling back to proper latest version,False
a67dd88ecdfa1d7db66cc753c3937eae90c7c35c,2017-01-10 08:35:20,Tomasz Finc,bump(electron packager version) to fix ProductName/FileDescription issue phab #D3619,False
bd4d5752fad267d6c7b531ea5138fc3410a91171,2017-01-10 07:43:09,Halla Moore,"[local-sync, iso-core]: Cascade deletes on `hasMany` associations

Summary:
Delete associated children when a parent is deleted to prevent foreign
key constraint errors. Also make sure any child hooks are run.

Test Plan: tested locally

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3620",False
9e06a6c7293a044234e5ae4776770dca106863e7,2017-01-10 06:50:55,Halla Moore,"[local-sync] Add a `hasAttachment` attribute to threads

Summary: N1 uses this to show the little attachment icon in the thread list.

Test Plan: tested locally

Reviewers: evan, juan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3617",False
6261e653575fb7bf6373eb14c563a5aa96f22177,2017-01-10 06:46:53,Halla Moore,"fix(Thread): Don't always set `categoriesType` to 'labels'

In `fromJSON()`, we were setting `categoriesType` to 'labels' if
the json had a truthy `labels` value. But an emtpy array is truthy,
and K2 always sends an array. This commit changes the conditional
to also ensure the array length is > 0.",False
dfbd5631eca1a4fc68e68f665b5a9890e1e4ed53,2017-01-10 05:16:50,Michael Pfister,Fix localhost urlroot for billing,False
57ea6208c6e620f2f8a080248100e2610c03396b,2017-01-10 04:54:55,Christine Spang,[local-sync] Update comment,False
777c204caa9d98a429d789cbcaea27257ded2577,2017-01-10 04:50:40,Evan Morikawa,bump(version): 0.5.5,False
0c05934ba23a576bcdc851dbee8954f892eee766,2017-01-10 04:48:43,Karim Hamidou,"[comment] Add a short comment explaining the difference between the
EdgehillAPI and LegacyEdgehillAPI objects.",False
21fea0c52f51d630da935e93b4a2db89c63f39fc,2017-01-10 04:48:43,Karim Hamidou,"Create a wrapper around legacy N1 APIs.

Conflicts:
	src/K2",False
9134e1bf8d3af82d94914a0bfba84dffe5da7aee,2017-01-10 04:47:34,Juan Tejada,fix(send) correctly check for presence of headers,False
c6f09d8981ba5b12dacacfd2fc25f769c43e06be,2017-01-10 04:47:19,Juan Tejada,"[local-sync] Fix send, correctly check for presence of headers",False
b58a7bafbed2c1cd371913d5820ff9bf11b1ecd9,2017-01-10 04:26:21,Juan Tejada,bump submodule,False
3af81b2ba647908fd06c4342df52ab39b71312b0,2017-01-10 04:13:15,Juan Tejada,"[local-sync] Make the sync loop interruptible

Summary:
This commit introduces interruptible sync operations. Now, the `SyncWorker`, `FetchFolderList` operation and `FetchMessagesInFolder` operation can be interrupted at several points during their execution. This improves the performance of SyncbackTasks, which now run almost immediately.

To achieve this, this commit adds an Interruptible abstraction, which is an object that can run functions and interrupt them at points marked by the function. For more info on how this works, see the docs on the Interruptible class.

This commit also splits up the SyncWorker a little bit to make it smaller, byadding a SyncbackTaskWorker.

Depends on D3613

Test Plan: Manual

Reviewers: spang, mark, jackie, khamidou, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D3612",False
4bbfd559de3aaf721c6256732af1bd32a3be8d21,2017-01-10 04:12:57,Juan Tejada,"[local-sync] Make the sync loop interruptible

Summary:
This commit introduces interruptible sync operations. Now, the `SyncWorker`, `FetchFolderList` operation and `FetchMessagesInFolder` operation can be interrupted at several p

To achieve this, this commit adds an Interruptible abstraction, which is an object that can run functions and interrupt them at points marked by the function. For more info o

This commit also splits up the SyncWorker a little bit to make it smaller, byadding a SyncbackTaskWorker.

Test Plan: manual

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3613",False
b0909c92e897693d50893ddda96d41cfeb38fe60,2017-01-10 04:02:47,Michael Pfister,"[cloud-api] Adds prettier confirm page for gmail auth success

Summary: Furthermore, sets up static file serving and templating for the cloud api.

Test Plan: tested manually. Need to add a error handling page, but will do this in a separate diff

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3615",False
8365afbf4518125306122bd664f8780e739d6c4b,2017-01-10 03:38:23,Evan Morikawa,fix(error): add comments and logging for RequestEnsureOnceError send error,False
45331f71808b223af71c04e4b4407863b327286a,2017-01-10 03:37:31,Evan Morikawa,"[local-sync] fix changedsince highestmodseq causing N1 crash

Since we weren't giving Node IMAP the proper format for the changedsince
flag, and since node IMAP never warned of improper schemas, we weren't
properly requesting the correct range. This would cause us to request the
metadata attributes of EVERY message in the mailbox and attempt to store
them in a hash. This would eventually lead to a memory leak and take down
the worker window, which caused other subtle issues like sends failing
when the worker window dropped task half way through their perform remotes
and never re-sent the deltas notifying of their success or failure.

This was only triggered when new highestmodseq numbers fired on the remote
server, which would be triggered by the underlying mailbox getting folders
or labels changed on messages",False
c1f53e825c8eee3b016a89f61a8ec9099cd5fef6,2017-01-10 03:15:18,Christine Spang,"[local-sync] Don't filter contacts w/out emails out of To/From/Cc/Bcc fields

We separately filter out contacts without email addresses before
committing to the contacts table in the database for autocomplete (in
isContactMeaningful()), and if we filter out these already we can end up
excluding legitimate elements of the headers. For example, the Clutter
feature of Office 365 sends emails with a From: header like this:

From: Microsoft Outlook

Fixes: T7413",False
98e3e29e9a76391c1525f82b91a79f4c3bce36da,2017-01-10 00:21:13,Halla Moore,"fix(showErrorDialog): Use a different modal when 'Show Details' is clicked

Summary:
When the error details are too long, the error dialog went off screen and
could not be closed. The native dialog doesn't have any scroll support and
you can only pass it plain text, so this diff moves the error details into
a non-native modal with a scrollable textarea.

Fixes T7388

Test Plan: tested locally

Reviewers: jackie, juan

Reviewed By: juan

Maniphest Tasks: T7388

Differential Revision: https://phab.nylas.com/D3601",False
59a498d1446e10e1fcaa1ef52977ddb0e9ac389a,2017-01-10 00:16:09,Halla Moore,"fix(spinner): Use a constant spinner when loading inline images

Summary:
We used to use a progress-based spinner, but we never get any progress
updates while downloading files, so the spinner was always at 0 and
never visible.

The submodule-commit is D3609, which adds support for inline images

Test Plan: tested locally

Reviewers: evan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3610",False
bd83ad1c40fde8fa288c1de17c0d84af1583a36c,2017-01-10 00:14:42,Halla Moore,"[local-sync] Add support for inline-images

Summary:
Extract files for inline attachments and store their content id

Fixes T7414

Test Plan: tested locally

Reviewers: evan, spang

Reviewed By: spang

Maniphest Tasks: T7414

Differential Revision: https://phab.nylas.com/D3609",False
2b41df9ff411461010107e905de91817813125c1,2017-01-10 00:08:48,Tomasz Finc,"Fixing most lint errors in error-logger

Summary: Cleaning up almost all the linting errors in the logger

Test Plan: ... run the build

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3605",False
13cd9c5809a45d6cc51f3ae199c12c8610f0395b,2017-01-09 23:58:14,Tomasz Finc,"Adding AppVeyor Slack notifications

Summary: So that we know the status of builds

Test Plan: Run the build. See it post to slack

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3607",False
97342300470ece218f889cf190e2088734579d85,2017-01-09 23:27:14,Evan Morikawa,fix(lint),False
956eb09708c73d4f5e93440c0bbc931f57a3ce2b,2017-01-09 23:27:06,Evan Morikawa,[local-api] linter fixes,False
39146e6ca7e880875e23b855b3acd8a2ace968c5,2017-01-09 23:16:31,Evan Morikawa,bump(version): 0.5.4,False
132171549625c06885ee27ab280726bcf45f0a26,2017-01-09 23:15:53,Evan Morikawa,bump(k2),False
dc89d8c2f4a85974686e94987258493143e50615,2017-01-09 23:15:33,Evan Morikawa,"[local-sync] audit database indices

Summary:
Fixes T7398

We were create unnecessary and duplicate indices for the IDs of all of
our objects and increasing db write overhead.

We were not creating the correct reverse index for our join tables.

The search API'd db is already in scope of the accountId, this is an
unnecessary constraint on the query

Test Plan: manual

Reviewers: spang, juan

Reviewed By: juan

Maniphest Tasks: T7398

Differential Revision: https://phab.nylas.com/D3606",False
74b3e0a1d1bf99aa62f9e0cc23765f87e9e10431,2017-01-09 02:57:10,Christine Spang,"[local-sync] Optimize header & MIME structure download

Summary:
Headers can be quite big, so we might as well download and store only
the ones that we care about. This patch also makes it so we stop
downloading MIME structures twice per message.

While it's possible that we _may_ want to make more headers accessible
later, we don't currently make the generic pile of headers accessible to
N1 or N1 plugins in any way, so doing that would end up requiring
changes to the sync code regardless. I think it's worth optimizing the
base experience rather than trying to predict what we may want in the
future. Plus, it seems more likely that we'll want to build future
extensibility using thread metadata, rather than message headers.

On inboxapptest1@fastmail.fm, this patch decreases the size of the
generated sqlite file for a fully synced mailbox by 35%.

Test Plan: manual

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3611",False
8dca53632913981dab241336f2415d6008d1399b,2017-01-08 04:04:03,Christine Spang,"[local-sync] don't play fast and loose with newlines, or a lack thereof",False
fc96972a96d939dc06fc62e152dcdea5de310df7,2017-01-08 03:41:27,Christine Spang,"[local-sync] Correctly handle messages with non-alternative multipart text bodies

Summary:
It's possible to have multiple inline HTML parts in a message, or even
a multipart/alternative part that contains text and HTML, followed by a
plaintext signature. Previously, if there was more than one text part in
an email, we would pick the _last_ text/html or text/plain part that we
found, and treat that as the entire message body. This works most of the
time, but fails to display the full message body in some edge cases.
This patch fixes that by resolving multipart/alternative subparts to a
single part in the mimepart fetch stage, and then treating each desired
mime part separately when parsing the message, concatenating them if
there are multiple.

This makes K2's handling of multipart MIME message text better,
bug-wise, than the Python sync engine's, which has been mangling some
rare messages forever. (Example from my email: every email from the MIT
EECS Jobs List has never displayed the mailing list signature in N1.)

Note that this patch also removes our tentative support for PGP
encrypted messages. I'd rather add that back in later when I've dug up
some real example messages to test on, rather than leaving it in in its
current not-really-tested and probably not-really-working state, since
it makes it harder to make sure that the rest of the logic isn't broken.

Test Plan: manual for now - added examples of this to my growing list of regression tests to add to the message parser unit tests once I fix them

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3600",False
cdc3b12a45a30b3d53e6e74ff79bdbc803faad99,2017-01-08 02:43:22,Christine Spang,"[local-sync] Bump limit on finding matching threads

I'm kind of worried that weird stuff may happen on short, common
thread subjects. The Python sync engine has _no_ limit, and it seems
to work OK.",False
1ff080a2581894006d711205d2d6c8772eaf6b9b,2017-01-08 02:41:33,Christine Spang,"[local-sync] Port generic IMAP threading logic from Python Sync Engine

Summary:
We sync messages in the same order as the Python sync engine (newest to
oldest, generally), so we should be able to just use the same threading
algorithm. While we may still want to take into account References /
In-Reply-To at some point, this is a big step up from the current
thread-matching-only.

Test Plan: manual --- could pretty easily port the unit tests from the python codebase if we wanted

Reviewers: khamidou, juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3604",False
4a4820e991d6ccef705007af857ac133fa16430b,2017-01-08 02:18:37,Halla Moore,"[local-sync] Re-add code to associate labels with new messages

This code was accidentally removed during a merge conflict. Code was
originally added in commit 333647.",False
8033cdd697514aa8df937a36d5ad4622d077ac00,2017-01-07 06:24:09,Jackie Luo,fix(archive): Designate role for archive folder,False
7da14f7cb73237951a0be8a0a2a8386db5d2557e,2017-01-07 06:23:24,Jackie Luo,[local-sync] Designate role for archive folder,False
40042be678eacb85d542d90dcf058719da302ad4,2017-01-07 05:28:04,Evan Morikawa,bump(version): 0.5.3,False
f3a1fb42d78f3765c63d0f55b2c592c66f80795e,2017-01-07 05:13:10,Evan Morikawa,fix(typo): don't list twice,False
c519288b424e6246dde8440b47efec267f926d02,2017-01-07 05:09:09,Evan Morikawa,"feat(off): disable/hide snooze, mail rules, misc minor plugins",False
0e0a7139df64bd8ec9a3575888e724af418037f6,2017-01-07 05:07:18,Evan Morikawa,"[local-private] Disable mail merge, scheduler, send later, reminders",False
7ee3b48fd19c1b755ae281d01456634fb7dc0321,2017-01-07 04:48:57,Evan Morikawa,"[local-sync] remove `verbose` sequelize flag in fork for perf

https://github.com/nylas/sequelize/compare/9cdd4d6bfaa1e7d61a700a6ac3c0e64e45a61...nylas-3.30.0

We spend a HUGE amount of CPU in the sqlite3 verbose logging since we generate stack traces for each and every query we send.

This fork removes the verbose call that causes that.",False
646353829904f661966a7e15971477a88945b3da,2017-01-07 04:32:06,John Oksasoglu,"Fix link to Flux diagram in Architecture.md (#3147)

It looks like the location of the Flux architecture diagrams got moved around on the Flux docs; this change updates the link here to the new location of the diagram.",False
02ac6d36a4d9a0bc8f36cb24915d8879dac93397,2017-01-07 04:26:54,Tomasz Finc,"Removing node module cache for now to see if stops gyp rebuild from breaking

Summary: Trying to fix https://ci.appveyor.com/project/nylas/n1/build/2442

Test Plan: ... run the build

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3603",False
ceb7984265af288cd32a1ce999804892098dc953,2017-01-07 04:03:45,Evan Morikawa,bump(k2),False
d293735b84e41e6633e92d6824bf5b5ce729233b,2017-01-07 04:00:18,Juan Tejada,"Revert ""Make K2 recover from connectivity losses.""

This reverts commit 08950591a57e28d86cfe2ff2c2b54d76fd2473dc.

Interrupting sync by closing connection causes errors downstream when
`syncNow` is called elsewhere. Instead of interrupting by closing the
connection, we will post a patch to interrupt the sync loop properly",False
8bafc2c2a726f32182a3892e0799a5dfa8768ba7,2017-01-07 03:58:33,Juan Tejada,"[local-sync] Restore global queue for message processing to improve perf

Summary:
Sync operations are mostly bound by I/O and the imap connection.
What we believe that is mostly affecting cpu and battery life is that node’s event
loop is being hosed with cpu intensive message processing operations.

To alleviate this, we do a few things:

- Restore a global message processing queue to process messages serially and meter cpu usage (message processing continues to be a fire and forget call from within sync operations)
- Move actual cpu intensive work to the message processing queue, i.e. `MessageFactory.parseFromImap`
- Keep track of message processing queue length, and skip sync operations if queue is too big to prevent massive memory consumption

This commit also renames the package from new-message-processor to
message-processor, given that now it processes both new and existing
messages, and we like to minimize confusion.

Test Plan: manual

Reviewers: spang, khamidou, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3602",False
3491f2791734f5065d9d27ddef015528fe58b291,2017-01-07 02:48:51,Jackie Luo,fix(category-picker): Hide starred label,False
781cda45bf1f85ce2707e27d833728bdbaf0ca30,2017-01-07 01:03:06,Juan Tejada,"fix(sync-status) When getting sync status, make sure account and progress data exists

Summary: See title

Test Plan: manual

Reviewers: evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D3588",False
86b434093b63e2f5481f50fe6f0a67e54ffdfa34,2017-01-06 23:28:55,Juan Tejada,fix(build) Temporarily remove tests,False
0e9807439617f789fd223a305e652381132062fe,2017-01-06 06:26:15,Tomasz Finc,"Don't need to lint arclint

Summary: More files that don't need linting

Test Plan: ... run the build

Reviewers: evan

Reviewed By: evan

Subscribers: juan, evan

Differential Revision: https://phab.nylas.com/D3599",False
7d03ce50f2153305a1bf996f227c565cae38cc0d,2017-01-06 06:17:07,Halla Moore,"fix(categories): Fix operations on categories

Summary:
- Make creating/renaming categories non-optimistic (this, along with the
    submodule commit D3593, prevents sub-categories with emtpy titles)
- Use SyncbackTaskAPIRequest in DestroyCategoryTask
- Don't get upset that renaming a category doesn't return a server id

Test Plan: local

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3594",False
21543c39995e6db6b60ca95eda2e703dd10720fb,2017-01-06 06:16:11,Halla Moore,"[local-sync, iso-core] Fix operations on Categories

Summary:
- Ensure delete deltas make it through to N1
- Don't fail if we can't find a category that needs to be deleted

Test Plan: local

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3593",False
c3a1de6d8556fda0cbb854a90c86105f68f7c99d,2017-01-06 06:04:12,Evan Morikawa,bump(k2),False
a78ac9071fa4a95c82aad287f29f44a82afa2614,2017-01-06 06:03:38,Evan Morikawa,"[local-sync] add attachments

Summary:
- Adds `File` objects onto the `Message`s so N1 sees attachments
- Ensures `File` is eagerly loaded for all messages
- Base 64 streams attachments through the local /download endpoint
- ExtractFile only uses disposition type attachment when extracting
  attachments
- Makes sure we save existing messages when processing them

Test Plan: manual :(

Reviewers: juan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3595",False
0188aeab33e985369496f13bd0df26ae33fb5b0f,2017-01-06 05:57:23,Tomasz Finc,"Removing error-logger exclude as it didn't actually work. Removing linter for now

Summary: Almost there ...

Test Plan: ... run the build

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3597",False
8373da686f6344bb1ccb9b178ed6f6b07de0d144,2017-01-06 05:48:48,Christine Spang,"[local-sync] Do not consider HTML or plaintext attachments to be body parts

Summary:
We were previously not taking into account the 'Content-Disposition'
MIME header, which differentiates between parts intended for display
('inline') and parts that are instead transferred files ('attachment').
See the RFC for more details:

https://www.ietf.org/rfc/rfc2183.txt

Fixes: T7367

Test Plan: unit test coming soon---have the test data and going to fix all message parsing test cases at once

Reviewers: juan, jackie, evan, halla

Reviewed By: evan, halla

Differential Revision: https://phab.nylas.com/D3585",False
1baa742dd7a3a2faa6d74898cb31e8d3afc39f10,2017-01-06 04:36:20,Karim Hamidou,"[N1] Only show the ""reauthenticate"" dialog box when we're getting 401s
from the local sync engine.

Previously we'd show the dialog box when we'd get an error from
Clearbit.",False
85a9cf063780fb0763daaa6e5846cf913489bfab,2017-01-06 04:09:25,Tomasz Finc,"fix(Linting errors)

Summary: Second attempt at not linting the error logger and tiny lint cleanup

Test Plan: run the build

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3591",False
210d7f6d3402f8233d8cb68f179064089f935b63,2017-01-06 02:31:23,Jackie Luo,fix(related-threads): Include from field in thread participants,False
c7b920c5c687d64b5b32c042787537514f6ddb35,2017-01-06 02:30:57,Jackie Luo,[local-sync] Include from field in thread participants,False
78e033b6d3580b34bb034473ae8239d2ba2df8f6,2017-01-06 01:17:32,Karim Hamidou,Fix typo.,False
261fb23918189fd7d5e6796106c25156cf3d3cac,2017-01-06 01:12:58,Jackie Luo,fix(destroy-category): Process syncback request deltas correctly,False
f6cbd7ed282842e8e08ef152366127a112c1ff06,2017-01-05 07:20:29,Halla Moore,"fix(Message): update fromJSON()

Summary:
- Handle `categories` if it exists, because clone() will call fromJSON()
    on the results of toJSON(), which populates `categories` instead of
    `folder` or `labels`
- Remove the else-if for `folder` and `labels`, because both can co-exist.
    Also concatenate the results from these two, rathering than overwriting.

Submodule commit is D3581, these two diffs together help make sure the
inflated messages in N1 have the right categories.

Test Plan: tested locally

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3582",False
3336479d5dd1140dc18783ea1d0bb91081a5885a,2017-01-05 07:19:22,Halla Moore,"[local-sync] Make sure labels are properly associated to new messages

Summary:
Labels don't get added via passing in a labels attribute to
create(). We need to call addLabels() instead.

Test Plan: Tested locally

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3581",False
badf6244fce5b6c595a16540263117d6104270ec,2017-01-05 05:49:24,Tomasz Finc,"Removing error logger from linting

Summary: Skipping linting for the error logger

Test Plan: Run the build

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3583",False
1ca6a5a2b0de3ec72bb2fc4962a2f74de0226b3a,2017-01-05 05:17:16,Christine Spang,"[local-sync] Trim NUL bytes from body strings

These bytes will cause SQLite to blow up with the following error
on insertion:

'SQLITE_ERROR: unrecognized token'

Fixes: T7331",False
e1b1712a07892603678f35c623e05714e10a5949,2017-01-05 05:17:16,Christine Spang,Update sequelize point version everywhere,False
63f0ba3e3246f0f44f45a564c24254c07b8e4d32,2017-01-05 05:12:19,Evan Morikawa,"feat(send)
refactor(send): split delivery from sent folder stuffing

Summary:
See explanation in https://phab.nylas.com/D3577

Depends on D3577

Test Plan: manual

Reviewers: jackie, juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D3578",False
09f19d1adfec03c99fae0b4a1610b6c51e47f491,2017-01-05 05:11:35,Evan Morikawa,"refactor(send): split delivery from sent folder stuffing

Summary:
refactor multi-send

This diff started off by fixing sending with attachments.

The issue is that our `FileUploadStore` listened for
`Actions.sendDraftSuccess` as its signal to remove the files from the
.nylas temp directory. Unfortunately, the old MultiSend tasks, after
delivery of the message, would try and put the base message in the sent
folder. Since we already deleted the file from our local temp dir,
creating the base message for the sent folder would fail.

This exposed a much bigger issue which is that we don't consistently
distinguish between ""delivery"" of a message and any post-processing we do
(like filling the sent folder). This was leading to a variety of other
subtle issues.

For example, N1 assumes that if the SendMessage task fails, then we pop
the draft back up and ask the user to try again. Unfortunately, since we
were combining ""delivery"" and ""post processing"" it was possible for the
message to actually deliver, but fail when stuffing the sent folder, or
fail due to some other random bug. This would cause the user to send the
message twice.

To help us ensure we never ""deliver"" twice and handle errors more
intuitively, I separated out the two concepts.

Now there are ""send"" set of tasks and endpoints, and a
""EnsureMessageInSentFolder"" set of tasks and endpoint (the latter used to
be ambiguously known as ReconcileMultiSend, whatever that meant)

The logic for send hasn't changed. This is mostly a renaming and moving
files around.

Test Plan: manual :(

Reviewers: jackie, juan, halla

Reviewed By: juan, halla

Differential Revision: https://phab.nylas.com/D3577",False
218e555722cd0efc696e16f8e4af9bd159e539cb,2017-01-05 04:05:07,Jackie Luo,fix(link-tracking): Attach URL and redirect URL correctly,False
11150cc2a0307894066f9b27ae8e13cb422f534a,2017-01-05 01:03:42,Tomasz Finc,"Removing unit tests for now

Test Plan: Run the build

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3579",False
b11e28e80f94541fe0fb63e11b9889792f040446,2017-01-05 00:45:45,Mark Hahnenberg,"[thread-search] Fix archiving from search perspective

Summary:
We weren't removing the inbox category in the search perspective, so
things weren't actually being archived.

Test Plan: Run locally

Reviewers: juan, evan

Reviewed By: evan

Maniphest Tasks: T7389

Differential Revision: https://phab.nylas.com/D3575",False
facc17aaf5814a87c18a0fe24490ad513e494875,2017-01-05 00:39:10,Christine Spang,bump(K2),False
c5240f5a7062135da76be94381315219dfc7b7c3,2017-01-05 00:03:37,Juan Tejada,fix(deps) Correctly fix debug version,False
ab9eeaafce307976e2639cfc089ff534a7ba2082,2017-01-04 22:28:22,Christine Spang,"[local-sync] Bump sequelize version to latest stable

Nothing major in here, just a couple little bugfixes.",False
41be7b14f0ca5f978e406f1c3838570b123c4886,2017-01-04 21:51:47,Christine Spang,[local-sync] Remove no-longer-used getLengthValidator function,False
af7693fa5e5552f73b5f25b78e4618cfc55adc15,2017-01-04 21:49:35,Christine Spang,"[local-sync] Remove incorrect length validation on From field

Contrary to what you might think, a message can have both an empty From: header
and multiple From: headers / multiple addresses in a From header. In that case,
we must save all of them and let the client decide how to display.

Fixes: T7370",False
e98504e8ac692446237efe86c453e8865d5d9c78,2017-01-04 07:06:47,Juan Tejada,fix(deps) Fix debug to v2.4.5. See #3139,False
08950591a57e28d86cfe2ff2c2b54d76fd2473dc,2017-01-04 05:33:27,Karim Hamidou,"Make K2 recover from connectivity losses.

Summary: I've found a pretty annoying bug --- N1 would stop syncing all accounts after the Internet connection dropped. It seems that deep inside node-imap or NodeJS itself, connections aren't timing out the right way. To work around this, this diff unilaterally restarts the sync every `nextSyncIn` milliseconds.

Test Plan: Tested manually by cutting internet access and checking that K2 recovered.

Reviewers: evan, juan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3573",False
daa9d56c870084f5dfec175d2aabdc59a76c6633,2017-01-04 03:30:02,Tomasz Finc,"Adding n1-next to AppVeyor builds

Test Plan: Run some builds

Reviewers: evan

Reviewed By: evan

Maniphest Tasks: T7377

Differential Revision: https://phab.nylas.com/D3574",False
7185850a3b94a90e60e0ad4ac89405b596d878a5,2017-01-04 02:57:15,Halla Moore,"feat(sync-status): Add messaging in other areas when syncing

Summary:
We want users to know that their account is still syncing if they're
looking for a message and end up at the bottom of a thread list.
This diff changes some of the wording around the messaging when
sync isn't complete and also adds a footer at the bottom of the
syncing thread lists. Additionally, we added a ""Show Progress""
link that will expand the sync details in the lower left.

Addresses T7354

Test Plan: tested locally

Reviewers: juan, evan, jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3551",False
cdffd7610b2f75be9822e502c2201d75ca225cae,2017-01-04 00:47:10,Christine Spang,"[local-sync] Add node-iconv dependency

The 'encoding' library transparently upgrades to using iconv instead of
iconv-lite, if available. This allows us to support more encodings in
emails, such as ISO-2022-JP.

Fixes: T7358",False
6b3d40b285cd3bf67308b38f8d7a4f0a1041bf7a,2017-01-03 23:07:33,Juan Tejada,[local-sync] Convert to async,False
a7aebe9e2e119895bef3bf91c905c4f913e31de0,2017-01-03 23:02:59,Evan Morikawa,bump(version): 0.5.2,False
6f50f36cdf8ece39f3b25e37560d81bbbb2f6bab,2017-01-03 23:02:39,Evan Morikawa,bump(k2),False
16c765df705947b7c66cf86411c468784e657be7,2017-01-03 23:02:08,Evan Morikawa,"Fixes to Docker and better docs/debugging

Summary:
Fixes to docker ignore and readme
Add ebextensions that allow us to more easily use docker

Test Plan: manual

Reviewers: juan, jackie, halla, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3554",False
06cf4fce6e5c58e8b947f5290c5d45ce7a55c62c,2017-01-03 23:01:34,Evan Morikawa,"[local-sync] show messages sent to self

Summary:
If you sent an email to yourself it would not show up in your inbox. This
is because sent messages would never get a lastMessageReceived timestamp.
Since we order the inbox by lastMessageReceived, setting that to null to
on sent mail would mean it never shows up in the thread list.

Also fixed an assertion bug in SFDC that requires transactions to return a
promise.

Finally added extra debug interfaces that will show more info if the delta
stream detects an inconsistency

Test Plan: manual

Reviewers: juan, halla, jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3552",False
e4c976e821e174e9f74877ce4a4fe9a728fdaaba,2016-12-31 02:41:41,Mark Hahnenberg,"[local-sync] Return IMAP UIDs for Messages via API

Summary: See title

Test Plan: Run locally

Reviewers: evan, spang, juan

Differential Revision: https://phab.nylas.com/D3569",False
2b7a4dc2935c931f8cc080c9614ecbe979c1368b,2016-12-30 05:30:30,Jackie Luo,fix(multi-send): Check that other message exists,False
a0d83b605af0cb78c5687e748a22ddb32d463919,2016-12-30 05:28:21,Jackie Luo,"[local-sync] Fix dates for message hashing

Summary: We were creating duplicate `Message` objects because the formatting for the date was different between `buildForSend` and `parseFromImap`. Now, we create the initial hash using the same format that `buildmail` uses to ensure that we generate the same IDs.

Test Plan: Tested locally.

Reviewers: evan, juan, spang

Reviewed By: spang

Differential Revision: https://phab.nylas.com/D3559",False
78e8552d5408610d2ea39b3060a48b4b37ff35ec,2016-12-30 05:18:12,Christine Spang,"[local-sync] Use mimelib to parse contacts

Summary:
Because of the way we were attempting to parse contacts from
From/To/Cc/Bcc headers by converting them to JSON with a regex, we were
erroneously breaking contacts that contained commas in quoted names into
multiple contacts. This could result in things like parsing multiple
addresses for the From: header, incorrectly!

To resolve the problem, replace our homegrown logic with mimelib's
seemingly excellent parseAddresses(), which handles this and a myriad of
other cases correctly.

Fixes: T7370

Test Plan: unit tests included

Reviewers: mark

Reviewed By: mark

Differential Revision: https://phab.nylas.com/D3565",False
a26ca6ffbae356e85a76bc51ebe629c8b09ef36d,2016-12-30 05:17:52,Christine Spang,"[local-sync] Remove TEXT param on message.body model definition

This doesn't do anything with sqlite, and just generates the following
warning in the logs:

>> WARNING: SQLite does not support TEXT with options. Plain `TEXT` will be used instead.
>> Check: https://www.sqlite.org/datatype3.html",False
e82c21083130c1e3c3a8f5adc5c4378c5c3f6b2f,2016-12-30 00:29:17,Christine Spang,[local-sync] Fix lint,False
cdd896da5f1bdd147ba7559d505d49fb756ae6c7,2016-12-30 00:29:17,Christine Spang,"[local-sync] Mark message factory tests for fixing later

Will fix these once I've finished up the current slew of bugfixes I'm
working on---kind of a pain to ensure they're passing in all
intermediate states.",False
3741adc1ab25f3c19b55fe4f24e6b981bb57ec7d,2016-12-28 03:10:39,Mark Hahnenberg,"fix(startLongConnection) Return the connection

Summary: We weren't doing this which was causing us to deref undefined later.

Test Plan: Run locally

Reviewers: juan, evan

Maniphest Tasks: T7355

Differential Revision: https://phab.nylas.com/D3561",False
ebec51a76045d1099104f6a64cff861e792761de,2016-12-28 01:36:54,Mark Hahnenberg,"[local-sync] Add search for Office365

Summary: See title

Test Plan: Run it locally

Reviewers: juan, evan

Differential Revision: https://phab.nylas.com/D3560",False
0e562a46e1053beaf13f266df417c932c8efb2cf,2016-12-24 08:05:09,Christine Spang,"[local-sync] Catch UniqueConstraintError when associating folders/labels with threads

Summary:
Similar to the fix in D3555, concurrent message processing may cause insert
races for folder and label thread associations. If the row is already present,
we can simply do nothing.

Test Plan: manual for now

Reviewers: jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3557",False
ab128eb7cf1873c99eeb223482d98a74bd8210ae,2016-12-24 08:02:29,Christine Spang,"[local-sync] Fix message parsing when no Date header present

Summary:
When the Date: header is not present, use the INTERNALDATE from the IMAP server
instead.

Test Plan: manual for now - will add a regression test for this though

Reviewers: juan, jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3556",False
cb13512ebc3061159b7690b58bb7dd15ae3c48ec,2016-12-24 08:01:51,Christine Spang,"[local-sync] Fix UniqueConstraintError inserting contacts from messages

Summary:
Because of JavaScript's asynchronous nature, it is possible that we will
be processing several downloaded messages concurrently. This can lead to
calling extractContacts() in an interleaved fashion, which it was not
designed to handle. It looks up which contacts are already in the
database and then performs inserts or updates accordingly, assuming
nothing has changed in the contacts table in between---which is not
true! If several messages have similar contacts, an insert race can
cause one of the inserts to throw an unhandled exception.

We fix this by simply catching the unique constraint error, and falling
back to an update instead. (There's not really a better way to deal
with write races other than to enforce that we process contacts from
messages serially, as transactions are of no help here.)

This commit also removes extractContacts()'s return value, which is not
currently used and I found confusing.

Test Plan: manual

Reviewers: juan, evan, mark, jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3555",False
d6c8f86ecaafd439f4b7067299c9eb0ef45425a5,2016-12-24 07:56:35,Christine Spang,"fix(snippet-parsing): Don't add extraneous spaces after text format tags

Summary:
This was leading us to put funny things like 'Nylas !' in some snippets that used
tags like <i> and <b> for text formatting. This is probs a teeny little bit slower
than the previous version since it invokes a callback on a lot more nodes, but we
can't really fix this issue without knowledge of the preceding tag name.

Test Plan: unit test included!!

Reviewers: evan, jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3553",False
1fa24bf440b95755bd74743f98b7ac502548e40e,2016-12-24 04:11:08,Christine Spang,"[models] Remove unnecessary Reply-To array length validation

Summary:
I have quite a few emails in my mailbox that have both multiple Reply-To
addresses. This is perfectly OK by the spec.

Fixes: T7369

Test Plan:
regression test coming - making a list and planning to update all the tests once I've hammered out the current crop of fixes I've identified

I also tested and made sure that N1 does the right thing in this case...
multiple Reply-To addresses are displayed correctly, and when you hit ""Reply"" a
new draft is started with both in the To: field. Makes sense given this is
something the Python sync engine supported too.

Reviewers: jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3558",False
6b30c0c30cb6664b2986210cd1c600fd73fc13e4,2016-12-23 04:28:18,Jackie Luo,[local-sync] Allow folders and labels to be null in toJSON(),False
866539a538479a384e84aa85f93ba52d0e6346d5,2016-12-23 02:13:45,Christine Spang,"fix(sync-worker): Don't call _determineWorkerPool() twice

A race condition on bootup was causing us to sometimes start
two delta sync workers for the same account.",False
83b7eeb60a5dba4bb969e1130a673645b1a0e33c,2016-12-23 00:02:04,Evan Morikawa,fix(readme): update cloud-api log readmes,False
63a816df6a8bf7f922dfbdba0c4c142242bc9e1a,2016-12-22 23:28:26,Evan Morikawa,fix(es6): rename js files to es6,False
7b025cc025a75c1d3d6e62b33464e2ee9f7b3fe5,2016-12-22 23:06:07,Evan Morikawa,bump(version): 0.5.1,False
c2203728d0ef18d3f22272d03e9494cf90e73937,2016-12-22 22:57:41,Evan Morikawa,bump(k2),False
be1d772f3204184575742048e1ccd0a2c7d75e50,2016-12-22 22:21:16,Christine Spang,"[local-sync] Use mimelib to parse headers

Using node-imap's parseHeader function to parse headers was resulting in
a huge number of message parse failures on Office365 accounts, because
the results contained unicode control character 9 and we'd then feed that
string to JSON.parse when extracting contacts, which would throw an
exception.

Using mimelib's header parsing function eliminates these errors.",False
b02c86a40ec452af47115f37bba772938bd49947,2016-12-22 08:14:17,Evan Morikawa,"perf(delta): replaces API delta stream with direct in-memory one

Summary:
This replaces the API delta stream with a direct in-memory one

Depends on D3548

Test Plan: manual

Reviewers: halla, jackie

Reviewed By: halla, jackie

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3549",False
e31995c136cf01a101a84c88d8b7903d171a043c,2016-12-22 08:12:52,Evan Morikawa,"perf(delta): replaces API delta stream with direct in-memory one

Summary:
This replaces the API delta stream with a direct in-memory one

Addresses T7300

Test Plan: manual

Reviewers: jackie, halla, juan

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3548",False
f4cc07c69dd1be882d6d2ec890c095f7ba6859ec,2016-12-22 05:00:54,Juan Tejada,"fix(sync-status):Use weighted percentage avg for sync status progress bar

Summary: Also move calculation to sync store, rename stuff a little bit

Test Plan: Manual :(

Reviewers: evan, jackie, halla

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3547",False
1e8e88e62017f71069a1b560baa28abc191bfd22,2016-12-22 01:34:50,Jackie Luo,fix(initial-sync-activity): Update correct function name,False
fc3a3d33b56ecd36c1a244201b761d4e98c1220a,2016-12-21 17:53:09,Juan Tejada,"fix(auth): Fix authentication notifications

Summary:
Depends on D3544 (K2 diff)

This commit ensures that auth notifications are showed when the
underlying sync worker fails and are cleared when an account is
successfully reconnected

To achieve this, we manually keep track and update syncStates where
appropriate via `Actions.updateAccount`, given that we have access to
N1's version of the account directly from local-sync.
Initially I was considering account delta stream to the cloud-api and the local-api, but that
just complicated things more than it helped.

This commit also fixes a bug with refreshing the gmail token in which we
we were only attempting a token refresh upon restarting the app

This addresses: T7346, T7305, T7335

Test Plan: Manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3545",False
d1404be100a5c39b4610ad55e8499338c4feef03,2016-12-21 17:52:39,Juan Tejada,"[local-sync] Fix authentication notifications

Summary:
Associated N1 Diff: D3545

This commit ensures that authh notifications are showed when the
underlying sync worker fails and are cleared when an account is
successfully reconnected

To achieve this, we manually keep track and update syncStates where
appropriate via `Actions.updateAccount`, given that we have access to
N1's version of the account directly from local-sync.
Initially I was considering account delta stream to the cloud-api and the local-api, but that
just complicated things more than it helped.

This commit also fixes a bug with refreshing the gmail token in which we
we were only attempting a token refresh upon restarting the app

This addresses: T7346, T7305, T7335

Test Plan: Manual

Reviewers: halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3544",False
9339b34592c2c0e4ed816dd836c42693ed040414,2016-12-21 06:39:17,Evan Morikawa,[local-sync] use async await in processNewMessage and fix logging,False
0235370198ba1540ec1c3bc0f10d83f0beed7f26,2016-12-21 06:17:43,Evan Morikawa,bump(k2),False
c328cd34052bdf1def45f99324d57cb1649dd48f,2016-12-21 06:17:26,Evan Morikawa,"fix(spec): fix asynchronous specs

Summary:
I believe I discovered why our tests intermittently fail, why those
failures cause a cascade of failures, and how to fix it.

The bug is subtle and it's helpful to get a quick refresher on how various
parts of our testing system work:

First a deeper dive into how Promises work:

1. Upon creating a new Promise, the ""executor"" block (the one that gets
   passed `resolve` and `reject`), gets synchronously run.
2. You eventually call `resolve()`.
3. The minute you call `resolve()`, Bluebird's `async.js` queues up
   whatever's downstream (the next `then` block)
4. The queue gets processed on every ""tick"".
5. Once the ""tick"" happens, our queue processes and downstream `then`
   blocks get run.
6. If any more Promises come in before the ""tick"", they get added to the
   queue. Nothing gets processed until the ""tick"" happens.

The important takeaway here is this ""tick"" in step 4. This ""tick"" is the
core of what makes Promises asynchronous. By default, Bluebird in our
Node-like environment uses `setImmediate` as the underlying
implementation.

Our test environment is different. We do NOT use `setImmediate` in our test
environment.

We use Bluebird's `Promise.setScheduler` API to implement our own ""tick"".  This
gives us much greater control over when Promises advance. Node's `setImmediate`
puts you at the whim of the underlying event loop.

Before today, our test ""tick"" implementation used `setTimeout` and
`advanceClock` triggered by `process.nextTick`.

Let me also quickly explain `setTimeout` in our test environment.

We globally override `setTimeout` in our test environment to not be based on
actual time at all. There are places in our code where we wait for several
hundred miliseconds, or have timeouts places. Instead of ""sleeping"" some amount
of time and hoping for the best, we gain absolute control over ""time"". ""Time""
is just an integer value that only moves forward when you manually call
`advanceClock()` and pass it a certain number of ""milliseconds"".

At the beginning of each test, we reset time back to zero, we record
setTimeouts that come in, and as advanceClock gets called, we know if we need
to run any of the setTimeout callbacks.

Back to the Promise ""tick"" implementation. Before today, our testing ""tick""
implementation relied our our stubbed `setTimeout` and our control of time.

This almost always works fine. Unfortunately tests would sometimes
intermittently fail, and furthermore cause a cascade of failures down the road.

We've been plauged with this for as long as I can remember. I think I finally
found how all of this comes together to cause these intermittent failures and
how to fix it.

The issue arises from a test like the one in query-subscription-pool-spec.  We
have tests here (and subtly in other yet unknown places) that go
something like this:

```
it(""TEST A"", () => {
  Foo.add(new Thing())
  expect(Foo._things.length).toBe(1)
})

it(""TEST B"", () => {
  expect(true).toBe(true)
})
```

At the surface this test looks straightforward. The problem is that
`Foo.add` may down the line call something like `trigger()`, which may
have listeners setup, which might try and asynchronously do all kinds of
things (like read the fs or read/write to the database).

The biggest issue with this is that the test 'finishes' immediately after
that `expect` block and immediately moves onto the next test. If `Foo.add`
is asynchronous, by the time whatever downstream effects of `Foo.add` take
place we may be in a completely different test. Furthremore if those
downstream function errors, those errors will be raised, but Jasmine will
catch them in the wrong test sending you down a rabbit hole of dispair.

It gets worse.

At the start of each test, we reset our `setTimeout` stub time back to
zero. This is problematic when combined with the last issue.

Suppose `Foo.add` ends up queuing a downstream Promsie. Before today, that
downstream Promise used `setTimeout(0)` to trigger the `then` block.

Suppose TEST A finishes before `process.nextTick` in our custom scheduler
can call `advanceClock` and run the downstream Promise.

Once Test B starts, it will reset our `setTimeout` stub time back to zero.

`process.nextTick` comes back after Test B has started and calls
`advanceClock` like it's supposed to.

Unfortunately, because our stub time has been reset, advanceClock will NOT
find the original callback function that would have resolved `Foo.add`'s
downstream Promise!!!

This means that Bluebird is now stuck waiting for a ""tick"" that will never
come anymore.

Since Bluebird thinks it's waiting for a ""tick"", all future Promises will
get queued, but never called (see Step 6 of the Promise description
above).

This is why once one test fails, downstream ones never complete and
Jasmine times out.

The failure is intermittent because `process.nextTick` is racing agianst a
test finishing, the next one starting, and how many and how far downstream
promises are setup.

Okay. So how do we fix this? First I tried to simply not reset the time back to
zero again in our stubbed time-override. This doesn't work because it simply
exposes the diasterous consequences of downstream Promises resolving after a
test has completed. When a test completes we cleanup objects, unmount React
components. Those downstream promises and timeouts come back and throw all
kinds of errors like: ""can't read property x of undefined"" and ""can't find a
match for component X"".

The fix that works the best is to simply MAKE PROMISES FULLY SYCNRHONOUS.
Now if you look at our custom Promise Test Scheduler in time-override,
you'll see that it immediately and sychronously calls the function. This
means that all downstream promises will run BEFORE the test ends.

Note that this is designed as a safeguard. The best way to make a more
robust test is to declare that your funtion body is asynchronous. If you
call a method that has downstream effects, it's your responsibility to
wait for them to finish. I would consider the test example above a very,
very subtle bug. Unfortunately it's so subtle that it's unreasonable to
expect that we'll always catch them. Making everything in our testing
environment synchronous ensures that test setup and cleanup happen when we
intuitively expect them to.

Addendum:

The full Promise call chain looks something like this:

-> `Promise::_resolveCallback`
-> `Promise::_fulfill`
-> `Promise::_async.settlePromises`
-> `AsyncSettlePromises`
-> `Async::_queueTick`
-> CHECK `Async::_isTickUsed`
-> `Async::_schedule`
-> `TimeOverride.scheduler`
-> `setTimeout`
-> `process.nextTick`
-> `advanceClock`
-> `Async::_drainQueues`
-> `Async::_drainQueue`
-> `THEN BLOCK RUNS`
-> `Maybe more things get added to queue`
-> `Async::_reset`
-> `Async::_queueTick` works again.

Test Plan: They now work

Reviewers: halla, mark, spang, juan, jackie

Reviewed By: juan, jackie

Differential Revision: https://phab.nylas.com/D3538",False
874cddba06ad97a171416776c7ad77c57a750cfb,2016-12-21 06:16:58,Evan Morikawa,[local-sync]: better sync reasons,False
ec33f0e3ceb5886a91688b592267090e9cf3d13a,2016-12-21 05:43:59,Evan Morikawa,[local-sync] add logging for syncbackTasks,False
cc94303cbb5d273c58e354ebf6e34bca2ba4306a,2016-12-21 05:34:28,Evan Morikawa,"[local-sync, isomophic-core] nicer logging",False
70f1e587fa6b451f0b5a0af26c347f90f0d48cd5,2016-12-21 05:03:27,Christine Spang,"[local-sync] Optimize snippet extraction

Summary:
We were seeing JS blocking in snippet extraction of up to 2k ms. This
is because we were walking the entire DOM of a message and extracting
all text, regardless of message size---and using our own homegrown
DOM walker function.

To remedy this, use the standard TreeWalker from the Chrome browser
APIs (which in benchmarks looks 2-4x faster) and also exit out of
the DOM walking process once we've accumulated enough text to create
a snippet. Informal eyeballing of timing metrics for this function suggests
the new implementation is something like 10-100x faster for some messages.

As a bonus, we get to delete some code and end up with a cleaner
implementation!

Test Plan: old unit tests yaay

Reviewers: juan

Reviewed By: juan

Subscribers: evan

Differential Revision: https://phab.nylas.com/D3543",False
69536e9a93f7e78a7754e67bec280a73bf640d4a,2016-12-21 02:38:50,Evan Morikawa,bump(k2),False
9162d1174565a678bcab463e3464eb017e434155,2016-12-21 02:38:30,Evan Morikawa,"[isomorphic-core] fix sending on Office 365

Summary:
Fixed sending on Office 365
nodemailer needed a special tls flag beyond the standard SSL.
See: http://stackoverflow.com/questions/29812132/error-sending-email-using-nodemailer-via-office365-smtp-meanjs-scaffold

Test Plan: manual

Reviewers: juan, jackie, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3541",False
5dff28291a1c576af2a3fb7ddec407463fc0e462,2016-12-20 21:55:20,Juan Tejada,fix(sync-status) Fix off by one error in store,False
9e86df4fbcf447738d39c13c7e52bf68e21c6634,2016-12-20 05:10:38,Jackie Luo,"fix(tracking): Save updated metadata correctly and stop sending account ID with request

Summary:
Save metadata correctly by reassigning an object to value.

Since account IDs are different between N1 and N1 Cloud, use just the message ID, which should be unique.

Test Plan: Tested locally.

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3524",False
4fa151d7a78db728ba9d13c43c0e0336ce2bfcdd,2016-12-20 05:05:50,Juan Tejada,"[local-sync] Fix date parsing and tests

Make sure that we use the header date for our date field because that's
the one we can control and depend on for message id generation",False
30b1cc95b6cdd72709acdca572aeb6d33c571eab,2016-12-20 02:10:36,Halla Moore,"re-feat(initial-sync-status): Bring the intiial sync progress bar back

Summary:
Adds a UI component to see the progress of initial sync.
(The behavior is sometimes a little strange, but I believe this is
just because of weird behavior in the NylasSyncStatusStore itself.
For instance, it sometimes never populates the `folderSyncProgress`
fields, or it never sets the progress to 1, so the bar stops at 99%)

Test Plan: tested locally

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3536",False
d16d374854982dc171321a3b3242bcfe8bba0ebf,2016-12-19 23:39:15,Juan Tejada,fix(send) Fix typo in ReconcileMultiSendTask,False
823b229bb932edcdff3ba62941cf6aec3119617e,2016-12-19 23:08:12,Evan Morikawa,[local-sync] temporarily remove validation in send,False
2ebe47a30e8950731829ad614a94b23c5545d727,2016-12-19 23:05:21,Evan Morikawa,bump(version): 0.5.0,False
b7a63345cf45f647dbca7f0e8cb342951f0c00a0,2016-12-19 22:55:13,Evan Morikawa,bump(k2),False
d0cffc054f7ac56e02d7900e02448be0806f450a,2016-12-19 22:55:07,Evan Morikawa,"[cloud-api] refactor cloud API routes to use es6 & fix Gmail Auth

Summary:
This is a refactor of the auth APIs to use async/await. Gmail Auth is
pretty confusing and I wanted to make it cleaner to read and easier to
use. This is also part of the general API upgrade to modern ES6

This also fixes the Gmail auth error we saw at showcase

Test Plan: manual

Reviewers: halla, jackie, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3535",False
053c1f83883022940718f03cdd9ca777bcd2420c,2016-12-19 21:38:59,Juan Tejada,"[local-sync] Fix issue with imap connection mail event

Summary:
See https://github.com/mscdex/node-imap/issues/585 for details.

This issue was causing us constantly run the sync loop without pauses,
i.e. every next sync loop was scheduled immediately.

Currently, when we receive a new `'mail'`event, we trigger a new sync loop. Previously, when this happened while a sync loop was already in progress we would just ignore the event. However, my recent patch keeps track of how many times we tried to start a sync loop while one was already in progress. If the number of times this happens is > 0, it will schedule the next sync loop immediately (as opposed to waiting a constant amount seconds before the next loop).

The problem is that this new logic is making the sync worker always schedule the next sync loop immediately (without pausing for a few seconds). This is due to the following chain of events (assume we are just syncing `all` and `trash` folders):

This commit is a temporary workaround to this problem.

Test Plan: manual

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3537",False
467f061552e19628290fb7d3974e93b8597b97c3,2016-12-19 10:08:34,Evan Morikawa,feat(auth): update onboarding helpers to be async,False
3b1675b79c8ae5162988fe12e2d6a6646e6543c6,2016-12-17 05:21:27,Evan Morikawa,bump(k2),False
1e638706f6e5b6dd4d41301352f1854993efc0a0,2016-12-17 05:21:11,Evan Morikawa,[isomorphic-core] add office365 in provider list,False
4b16167c76ff056a339747eb5ab11ada18f14c52,2016-12-17 05:16:52,Halla Moore,fix(sending): Check if failedRecipients exists before checking length,False
f5efb921572ad7270b5843a5da7a3858a1473ca8,2016-12-17 05:13:39,Halla Moore,"[local-sync] Fix a couple bugs that popped up while sending

- Pass in the account when creating an ImapConnection
- Wrap the return value of the SendMessage task in an object",False
d8bcbfc68d8ec4b24699b8ad9ec030533347ed99,2016-12-17 04:59:52,Evan Morikawa,[local-api] fix validation errors on send,False
026db3f6102f469a546b3abea9f29fd591dedcad,2016-12-17 04:15:20,Juan Tejada,"feat(k2): Ensure send runs fast, clean up multisend tasks

Summary:
Associated K2 diff: D3529

This commit converts multi-send from a 3 step process into a 2 step
process

The first step creates the base message and sends a message per
recipient, each with its customized message body for tracking.

The second step reconciles all sent messages, specifically removing any
sent messages created by gmail, and saving the correct message to the
sent folder

This commit also ensures that we run the send tasks immediately by
ensuring we restart the sync loop if its already running

Depends on D3529

Test Plan: Manual

Reviewers: evan, jackie, halla

Reviewed By: jackie, halla

Differential Revision: https://phab.nylas.com/D3530",False
57682a0ff596fc0e12eebeb2a91fe9e6b89fda78,2016-12-17 04:12:26,Christine Spang,"[local-sync] Fix parseFromImap specs

Lots has changed for the better! Tests work again also.",False
a0d6e9aac1a29e37dac4c230fb768192e71b2551,2016-12-17 04:12:03,Evan Morikawa,bump(k2),False
38bd1933661c82a7f56514bc41e90921097b74e4,2016-12-17 04:11:20,Juan Tejada,"[local-sync] Ensure send runs fast, clean up multisend tasks

Summary:
Associated N1 Diff: D3530

This commit converts multi-send from a 3 step process into a 2 step
process

The first step creates the base message and sends a message per
recipient, each with its customized message body for tracking.

The second step reconciles all sent messages, specifically removing any
sent messages created by gmail, and saving the correct message to the
sent folder

This commit also ensures that we run the send tasks immediately by
ensuring we restart the sync loop if its already running

Test Plan: Manual

Reviewers: evan, jackie, halla

Reviewed By: jackie, halla

Differential Revision: https://phab.nylas.com/D3529",False
7013d16cb876ce275843984042a4394f6cb1ed87,2016-12-17 03:23:46,Evan Morikawa,"feat(auth): add office 365 support

Summary: Adds a new button in auth for native Office 365 support

Test Plan: manual

Reviewers: jackie, halla, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3532",False
86ef9a98ff51ea0e050293e3b8bf127cd0fc7522,2016-12-17 03:23:05,Evan Morikawa,"[isomorphic-core] add office365 auth support

Summary:
Adds support for office 365
Depends on D3532

Test Plan: manual

Reviewers: jackie, halla, mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3533",False
da0650efe6600e76f6486cf4b9a43fc739a41086,2016-12-17 03:14:13,Evan Morikawa,fix(sync): fix sync status store,False
4ea149651fbf907d4bda04045fd86041d7d0bec7,2016-12-17 02:54:29,Halla Moore,"fix(draft-store): Don't pop up a draft before it exists in the session

Summary:
The composer wasn't popping out correctly because the session's draft
was still null. This diff switches to using sessionForClientId(),
even if the session already exists in _draftSessions, because
sessionForClientId() won't create a new session if it doesn't need
to, and will always return a promise that resolves once the session
gets its draft. This promise will resolve immediately if the session
already has a draft.

Test Plan: tested locally

Reviewers: evan, juan

Reviewed By: juan

Subscribers: juan, spang

Differential Revision: https://phab.nylas.com/D3531",False
672848dbdcad2c5bf4223897e6418bcb667a1bb3,2016-12-17 01:08:45,Karim Hamidou,"[feat] Refresh Gmail access tokens when needed

Summary:
This is a small patch but it's pretty complex, because of the numbers of moving parts. Gmail has two types of tokens, access and refresh tokens. Access tokens have a limited shelf life of one hour. After that they expire and you need to use your refresh token to get a new one.

We've decided to do the access token generation on the server, because we don't feel comfortable giving our users both our Google client id and secret. To do that, I've added an endpoint, `/gmail/auth/refresh` which returns a valid access token as well as an expiration date for the token.

The only place where we handle token expiration is in the sync workers. Before trying opening a new connection we check if our access token is expired. If yes, we get a new one from the API. If there's an issue doing this, we notify N1 using `NylasAPIHelpers.handleAuthenticationFailure`.

There's a second patch for N1 with tiny related fixes.

Test Plan: Tested manually. Will need to test more in the real world.

Reviewers: evan, jackie, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3522",False
c7416479f506f627dafa2d7beca6ee5ceb1c5f79,2016-12-17 01:08:15,Juan Tejada,"[local-sync] Fix sync worker

- Correctly await async functions
- Make sync in progress more explicit",False
3a3829daaec0af507be7d0711c4ff9009ca88fe1,2016-12-17 00:40:20,Karim Hamidou,Required changes for refreshing access tokens.,False
637f5b565fc2d8d276d42e9e0f6fa60b3c2ebfc1,2016-12-17 00:36:04,Christine Spang,[local-sync] Update comment,False
17b015eea13272e3e3506ee8c2d1fa156e69b127,2016-12-17 00:20:35,Halla Moore,"[local-sync] Fix a couple of message parsing bugs

Summary:
- Don't fail if there's no subject, just set it to `(no subject)`
- Support ""BINARY"" content-transfer-encoding. (This really means
that there is no encoding, so it's simple to add support for it)

Test Plan: tested locally

Reviewers: jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3528",False
64bd3d3badf1973c6280262d2c7d889588e0b152,2016-12-16 23:38:52,Evan Morikawa,feat(babel): bump local babel and update K2 to use babel toolchain,False
30d60c5a752906083f45060b617b6f091eff0012,2016-12-16 23:38:21,Evan Morikawa,"[*] Add basic babel toolchain

Summary:
Adds babel to K2
Creates a simple build script so it'll run on prod.

Test Plan: manual

Reviewers: jackie, halla, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3527",False
55fd84f8bec4642a124040cf9dfe7202b1f91119,2016-12-16 10:13:52,Juan Tejada,[local-sync] Fix sync worker - Restore fns removed by mistake,False
68797366043ade4ccd86543dc18607d7eb5b7184,2016-12-16 08:25:33,Christine Spang,bump(K2),False
bb0cd019db324e7e23750b488ad831f29bbc20f0,2016-12-16 08:15:24,Juan Tejada,[local-sync] Fix typo,False
c62740991dfa940161b19f3d60f70688a161cf35,2016-12-16 08:13:08,Christine Spang,"fix(quote-parser): Restore still relevant comment I actually removed

At one point I considered just removing this feature entirely,
but ended up not.",False
24ee2e22f4b4fbe8eeb824ed007e24a6cae5db64,2016-12-16 08:10:34,Christine Spang,"fix(rendering): Fix quote stripping of many plaintext emails

Summary:
Since we changed the way we mark up plaintext emails to wrap them in <pre>
tags, the quote stripper has been failing to restore bodies in the cases
where a plaintext email starts with an inline quote (and thus the whole
contents of the <pre> tag is detected as a quote string).

This diff also fixes the HTML sanitizer to not strip off our custom
""nylas-plaintext"" class, which isn't currently used for anything but
allows us to definitively know which tags we added on for marking up
plaintext. Might be useful at some point!

Test Plan: unit test included, manual inspection of message display

Reviewers: evan

Differential Revision: https://phab.nylas.com/D3519",False
35437bad092840385ea30cfd379b2ae945783e07,2016-12-16 04:47:45,Juan Tejada,"[local-sync] Allow sync-worker to be restarted

Summary:
Add internal state to the sync worker to allow for it to be interrupted
and restarted.

The concept in this commit is that if we've tried to trigger a sync enough times
while its already in progress, bail and start over.

Usually, we manually trigger sync loops when we queue a new SyncbackTasks,
so that the newly queued task gets executed. This is necessary because the only
way to run SyncbackTasks is via the sync loop, for consistency and simplicity
reasons.

For example, we might run into a case where we queue a SendMessage task,
and we want it to be executed ASAP, but if we're in the middle of a
syncing a mailbox with a ton of folders, we wont get to the SendMessage
task after some considerable time.

Specifically this commit makes it so:

- If the number of sync attempts while in progress is > 0, make sure we schedule the next sync immediately
- If we reach a threshold of sync attempts while in progress, interrupt sync and restart

Test Plan: todo :(

Reviewers: mark, spang, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3520",False
39c74bd2fac747f0b68f193f9c515a4050a33031,2016-12-16 04:11:53,Juan Tejada,"[local-sync] Fix syncback tasks execution

Summary:
We were doing all of this fancy filtering and sorting to determine which
tasks to run, but in the end, we were just running the whole unsorted
list (using the wrong variable)

Also extracted getting the list of tasks into its own function, for
easier unit tests (it should really have some)

And, also wanted to make sure other people looked at this code, since I
believe no one has before.

Test Plan: todo

Reviewers: mark, khamidou, spang, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3516",False
2032aa45dd8d3202d91588aeb0f25679d34f3140,2016-12-16 04:03:37,Evan Morikawa,"bump(bluebird): upgrade bluebird

Summary:
I upgraded bluebird because I thought there was some missing dependency
issue when I booted K2. It actually turned out that the issue was missing
`striptags` require in the K2 local-sync package json and had nothing to
do with Bluebird.

But since were here and about to QA I figured I might as well bump it
anyway. Especially since I'll need it later to better diagnose async
tests.

I carefully went through the 3.0 changelog and believe I fixed the
outstanding issues

Test Plan: manual

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3523",False
6c2c06bd4f9fa00d93a8b939a1e3c5b7da042469,2016-12-16 03:48:50,Halla Moore,"fix(mail-rules): use the right field name to get an account id

Summary:
With the fix to the delta-processor, this is all that's needed to
get mail rules working! Some places were trying to use 'accountId'
to access an account object's id, but it needs to be 'id' instead.

Test Plan: tested locally

Reviewers: jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3525",False
b2f286371265d18d76a55c372e52801553b9e3fc,2016-12-16 03:34:51,Evan Morikawa,[local-sync] fix missing dependency,False
41e1a3e45ba967df8de52f291358ca597ec4fc87,2016-12-16 02:02:47,Evan Morikawa,fix(import): require 'rx' from 'nylas-exports',False
8319ed3e010af9e3f1c6830dcc47627e68675a70,2016-12-16 02:02:29,Evan Morikawa,[local-private] require Rx from nylas-exports,False
856ed95af5ea080b79c0f66f19ce6fa022f3acb6,2016-12-16 02:00:59,Juan Tejada,"[local-sync] Fix contact parsing from T7327

Summary: See description at T7327

Test Plan: Manual, but this should have unit tests

Reviewers: mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3513",False
0a5137d0d3b8c9caaa4f0d5dcdb51c402ce45d1e,2016-12-16 01:59:56,Juan Tejada,"[local-sync]: Move sendmail-client and errors to isomorphic-core

Summary:
Move sendmail-client and errors to isomorphic-core, given that they will
probably be used by cloud-workers (plugin backends) and cloud-api

Depends on D3510

Test Plan: Manual

Reviewers: halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3512",False
d025b8d02a03b895c4722a364488ee087a14d083,2016-12-16 01:42:37,Halla Moore,"fix(delta-processor): Return created models in the expected format

Summary:
We were returning an array of arrays, when really we wanted an object
of arrays keyed by model type. This also involved removing an implementation
of mapObject that was overwriting underscore's implementation of it.

Test Plan: local, having others try it.

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3509",False
8ceb41fde1b18b0df7d30caf85d848fbd5820de0,2016-12-16 01:27:14,Juan Tejada,"fix(send/tasks): Fix deltas for SyncbackRequest SyncbackTaskAPIRequest

Summary:
This commit fixes processing deltas for `ProviderSyncbackRequests` and
resolution of the `SyncbackTaskAPIRequest`

Specifically:
- Fix and update field definitions for `ProviderSyncbackRequest`
- Correctly parse the error attached to any `ProviderSyncbackRequest`
- Correctly process deltas for `ProviderSyncbackRequests` inside the
delta-processor
- Fix any tasks that used `SyncbackTaskAPIRequest`, and update send to use those

Depends on D3510

Test Plan: Todo/Manual

Reviewers: jackie, halla, evan

Reviewed By: halla, evan

Differential Revision: https://phab.nylas.com/D3511",False
d8a25a44e4a5caf195d13e2826532b53ef61aa73,2016-12-16 01:25:40,Juan Tejada,"[local-sync] Update send endpoints to use SyncbackTasks

Summary:
Associated N1 diff: D3511
Convert send endpoints to use syncback tasks for consistency with how we
perform other imap operations, but primarily:
- So that it triggers a sync loop immediately and we pick up changes quickly
- To keep track of various send operations as a single unit (e.g. sending + saving to sent folder or deleting from sent)

This commit also fixes SyncbackRequest error handling and processing in
N1-- previously we were saving error fields to the syncbackRequests with
a format that didn't match N1's API error and which wasn't properly
serializable. (Also rename HTTPError to APIError)

Test Plan: Todo/Manual

Reviewers: jackie, halla, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3510",False
fb8ebeaacaffb2072c1a4707a5fc12602c7bdcc6,2016-12-16 00:47:20,Juan Tejada,"fix(sync-status): Change old per model status, in favor of per folder

Summary:
Addresses T7275
Previously, we kept track of the sync status of each API model, and the progress
we'd made syncing all available models (e.g. all threads, messages, events, etc)

Given K2's set up, we are now keeping track of sync status per folder, i.e. what
percent of the folder's messages we've synced. This status is now reported from K2
to N1 via folder object deltas, and this commit rewrites the
NylasSyncStatusStore (in ES6) to reflect that.

The new Store keeps the sync state per account, which is the merged state of
per folder sync state, and delta connections state.
We also got rid of `CategoryStore.whenCategoriesReady` in favor of
`whenCategoryListSynced`, which is derived from the fact hat as long as we've
started syncing one folder, we've already synced the entire list of of folders/labels.

There are a couple of TODOs to be addressed in upcoming diffs:
- T7329 Restore the sidebar component to show sync progress, which was previously removed
- T7330 Figure out how to report sync progress per label, specifically, we are interested in knowing how much of the inbox we've synced, which is a label in Gmail. (This might be a non-issue if we sync the inbox very fast, first)

Depends on D3514

Test Plan: Manual

Reviewers: mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3515",False
4be0a08ce236f269916a7cb999d94be4f27caa62,2016-12-16 00:40:44,Juan Tejada,Bump submodule,False
f80825f2c95645f680513fbcfa252e5a26643934,2016-12-16 00:38:20,Juan Tejada,"[local-sync] Report folder syncState to N1

Summary:
Associated N1 diff: D3515

Stop ignoring deltas for Folder.syncState updates

Test Plan: Manual

Reviewers: mark, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3514",False
dc0e191fa7e2c0e7e82728df952d1b795b6ec668,2016-12-16 00:15:48,Christine Spang,"[local-sync] Allow logging parsed messages to disk with NYLAS_DEBUG env var

Summary:
I've found this useful for generating test cases and am tired
of adding and removing this code!

Test Plan: inspect output of /tmp/k2-parse-output

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3518",False
3dc9f7e7620366ad9b01e9a4427e5150b69c7b56,2016-12-16 00:11:36,Christine Spang,"[local-sync] Escape HTML entities in plaintext

Summary: This was understandably causing some messages to fail to display correctly.

Test Plan: unit tests are already broken for message parsing -- will fix in follow up diff

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3517",False
041917d7574248192b583635ef6aa7f2171b07a9,2016-12-15 23:54:28,Evan Morikawa,bump(electron): to 1.4.12 from 1.4.5,False
085d69ac3faa5b01f0d55950420657aa3f5ed715,2016-12-15 23:32:00,Evan Morikawa,"fix(spec): add support for async specs and disable misbehaving ones

More spec fixes

replace process.nextTick with setTimeout(fn, 0) for specs

Also added an unspy in the afterEach

Temporarily disable specs

fix(spec): start fixing specs

Summary:
This is the WIP fix to our spec runner.

Several tests have been completely commented out that will require
substantially more work to fix. These have been added to our sprint
backlog.

Other tests have been fixed to update to new APIs or to deal with genuine
bugs that were introduced without our knowing!

The most common non-trivial change relates to observing the `NylasAPI` and
`NylasAPIRequest`. We used to observe the arguments to `makeRequest`.
Unfortunately `NylasAPIRequest.run` is argumentless. Instead you can do:
`NylasAPIRequest.prototype.run.mostRecentCall.object.options` to get the
`options` passed into the object. the `.object` property grabs the context
of the spy when it was last called.

Fixing these tests uncovered several concerning issues with our test
runner. I spent a while tracking down why our participant-text-field-spec
was failling every so often. I chose that spec because it was the first
spec to likely fail, thereby requiring looking at the least number of
preceding files. I tried binary searching, turning on and off, several
files beforehand only to realize that the failure rate was not determined
by a particular preceding test, but rather the existing and quantity of
preceding tests, AND the number of console.log statements I had. There is
some processor-dependent race condition going on that needs further
investigation.

I also discovered an issue with the file-download-spec. We were getting
errors about it accessing a file, which was very suspicious given the code
stubs out all fs access. This was caused due to a spec that called an
async function outside ot a `waitsForPromise` block or a `waitsFor` block.
The test completed, the spies were cleaned up, but the downstream async
chain was still running. By the time the async chain finished the runner
was already working on the next spec and the spies had been restored
(causing the real fs access to run).

Juan had an idea to kill the specs once one fails to prevent cascading
failures. I'll implement this in the next diff update

Test Plan: npm test

Reviewers: juan, halla, jackie

Differential Revision: https://phab.nylas.com/D3501

Disable other specs

Disable more broken specs

All specs turned off till passing state

Use async-safe versions of spec functions

Add async test spec

Remove unused package code

Remove canary spec",False
29a2f3ad8fcc41a69b33933c17242fedc26a99c1,2016-12-15 23:27:24,Evan Morikawa,"[local-private, local-sync] temporarily disable specs

[local-private] Disable more broken specs

Disable specs

Reenable local-sync tests",False
038c34ff08370a1e027efefd5202bf630fa57d55,2016-12-15 10:05:51,Christine Spang,"fix(rendering): Don't set a class on plaintext pre wrapping

Our HTML sanitizer that we run bodies through before rendering
strips off this class, so it's not currently working with the
class set. Since this CSS is specific to the email frame, should
be OK to have no class at all.",False
3b460d97cfadb724ef0000179ab497f9f1423176,2016-12-15 09:05:48,Juan Tejada,"[local-sync, cloud-api, cloud-workers] Fix msg id collision, tracking and sending issues, some refactoring

Summary:
This diff solves a few separate issues from T7313, T7316, T7282, and it refactors
the send code a little bit.

Initially, the problem that led to this diff was generating message ids that
wouldn't collide (which was causing errors in the message-processor). Collisions
in ids were being caused by messages that contained the exact same participants,
subject and date (most likely due bots or scripts sending emails in quick
succession)

To prevent collisions this commit adds the `message-id` header as part of the
database message id, and ensures that we set it correctly before sending, and
that it remains consistent through send, multi-send, and the sync loop.

During the refactor and review, I removed some code that assumed that we were
syncing drafts (which we aren't), and also fixes a few other known and
unknown issues around sending, message creation, and tracking, like assigning
the correct date header (we were previously assigning the draft creation date
from within N1), fixing the tracking regex, among other smaller bugs/typos.

Will address inline TODOs in a separate diff

Test Plan: TODO!!! I will add tests in another diff

Reviewers: evan, halla, jackie, khamidou

Reviewed By: halla, jackie

Differential Revision: https://phab.nylas.com/D3507",False
e228dbfcdded662f74cd6e5f9b229a9c90e12624,2016-12-15 06:52:12,Karim Hamidou,trying to work around eb cli bugs.,False
4f0a7fb489593cd25658870156a95d35b0fd0c59,2016-12-15 06:50:56,Mark Hahnenberg,"[local-sync] Fix Contact.toJSON

Summary:
We forgot to refactor `publicId` to just `id`, which was breaking contact
deltas in N1.

Test Plan: Run locally

Reviewers: khamidou, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3508",False
f8cbcc8ab0927cb23197c4e73c4b4fff659bb35f,2016-12-15 02:32:18,Halla Moore,"feat(showDetails): Allow a ""Show Details"" option on error dialogs

Summary:
Pass in more details on sending errors, so that they can be viewed
more easily by clicking ""Show Details"", rather than having to check
the worker window console.

Test Plan: tested locally

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3505",False
d34cfa86b0a09d90189cc1f5237c26123fd5b6ab,2016-12-15 01:20:22,Mark Hahnenberg,"[local-sync] Implement /thread/search endpoint for generic IMAP

Summary: See title

Test Plan: Run locally

Reviewers: juan, evan

Reviewed By: juan, evan

Maniphest Tasks: T7281

Differential Revision: https://phab.nylas.com/D3498",False
2ee3c04036cb776cb7dd7aa6e8e819a8d8f09ba9,2016-12-15 00:13:20,Halla Moore,"[local-sync] Fix contact validation

Summary:
Allow other fields to be passed in with participants, so that Contact
objects can be passed in as JSON. Also fix an error check.

Test Plan: tested locally

Reviewers: jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3504",False
102837d51638dd5316adf2ff7a193fef1199029a,2016-12-14 08:12:54,Michael Grinich,Update README.md,False
70cec12d2a9aff04539db3f7969ed15a3c093a78,2016-12-14 07:27:54,Juan Tejada,fix(script/bootstrap) Properly remove already present lns + error handling,False
67d1e14e60fe204faf56622de38f2124ac7ffe24,2016-12-14 06:11:12,Jackie Luo,[cloud-api] Only prepend https:// to links if not present,False
c07f0a3b417495e2f84f775691b218cc0f1a6bef,2016-12-14 06:02:22,Christine Spang,"[local-sync] Parse DOM to extract snippets

Summary:
This fixes multiple issues, including snippets telling you you
ought to look at the HTML as well as cruft like HTML entities
and CSS in snippets.

Test Plan: unit tests included o.O

Reviewers: juan

Reviewed By: juan

Subscribers: evan

Differential Revision: https://phab.nylas.com/D3500",False
bc296a85e9512a9e68a60dae3c7f629221b4d919,2016-12-14 05:56:05,Jackie Luo,[local-sync] Update URLs and regex,False
14c1ade5b501e4d9d5bbb6489b2cfa419c77ed8a,2016-12-14 03:14:00,Mark Hahnenberg,"[local-sync] Implement /threads/search endpoint for Gmail

Summary: See title

Test Plan: Ran it locally

Reviewers: khamidou, juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3496",False
c2b272087af818cfb027f2edd78ecb256e35d2ee,2016-12-14 02:24:25,Jackie Luo,fix(tracking): Update server URLs and send MESSAGE_ID,False
35e040d7d0835ba966dc7f71cdf97adca8725db6,2016-12-14 02:23:48,Jackie Luo,fix(tracking): Update server URLs and send MESSAGE_ID,False
1040039591887047f5519e81b31a801ccb89ee8a,2016-12-14 01:15:59,Halla Moore,"[local-sync] Fix a couple of multi-send bugs

Summary:
1) Send the custom body, rather than the generic body
2) Extract contacts correctly so that the saved sent message has all the
   participants, rather than just the last one

Test Plan: Tested locally

Reviewers: jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3499",False
a5ef6235b76db223a5d74d3d5e2f848838c080c9,2016-12-13 09:48:22,Evan Morikawa,bump(SFDC),False
1a656805d82cc2a3be0367b757673bf39838711f,2016-12-13 09:43:45,Evan Morikawa,bump(SFDC),False
8f85475607c5ac9e73a4475d7bff13622c2f686e,2016-12-13 05:32:16,Evan Morikawa,bump(SFDC),False
0fd751d40363ac1ce58cfc9313bdc18350faeb79,2016-12-13 04:54:59,Evan Morikawa,bump(electron): 1.4.12,False
f432d77aa0f53dcd1fa7510a6dcb988484b3b2af,2016-12-13 04:33:39,Evan Morikawa,bump(SFDC),False
659fbec82956b612a539a34f5455bb38a4342847,2016-12-13 04:33:19,Evan Morikawa,bump(SFDC),False
ae401717fd030fa19111d426848d415eceb969b5,2016-12-13 04:11:31,Evan Morikawa,Update Changelog,False
3c74f270e445a400672d15e44fe81c2119641401,2016-12-13 03:20:29,Michael Grinich,"Add another awesome plugin and theme 🙌

Thanks @jodyheavener!",False
7a245d163390aece53fe32e7a713113b56223e7a,2016-12-12 21:08:43,Evan Morikawa,"Move old edgehill src/pro into K2/packages/nylas-private

Summary:
feat(bootstrap): automatically init submodule if able

fix(bootstrap): symlink arc instead of copy

Test Plan: test

Reviewers: juan

Differential Revision: https://phab.nylas.com/D3494",False
3a6d3157d764eb1034e61ec70f97f8fb6c5b030e,2016-12-12 21:07:43,Evan Morikawa,"[cloud-api, local-sync] reordering for lerna",False
d5ce3439faab18b0e4745df0b1e0fc65ff1ff801,2016-12-12 20:52:40,Evan Morikawa,feat(bootstrap): automatically init submodule if able,False
1daf734c97445db2c0f57264fadc9979ed984eae,2016-12-12 20:40:26,Evan Morikawa,Move old edgehill src/pro into K2/packages/nylas-private,False
85de77c9645010e7a463e55b16617de50362c49c,2016-12-12 20:39:58,Evan Morikawa,"[local-private] move old edgehill src/pro into packages/local-private

Summary: This is a test

Test Plan: Testing

Reviewers: juan

Differential Revision: https://phab.nylas.com/D3493

[local-private] add old edgehill src/pro into packages/local-private",False
c2be516d88784290066550759f76e705931986e3,2016-12-10 04:52:14,Evan Morikawa,fix(SFDC): properly enable SFDC,False
03f06c1566152a5882048ebeb18d08ea3974e73e,2016-12-10 01:33:15,Evan Morikawa,bump(version): 0.4.402,False
e271ca4d8ee5413c1a8c344143e2eb8cb3836d3f,2016-12-10 01:32:39,Evan Morikawa,fix(lint),False
9d3e2857e79e0f2f00b6498d3fded133abcf4f1c,2016-12-10 00:45:38,Evan Morikawa,bump(k2),False
bc60882a13687c30e4ff620d18a0d4c827c048a4,2016-12-10 00:45:04,Mark Hahnenberg,"[local-sync] Increment streamAll offset by chunkSize (#5)

Otherwise we'll infinite loop if there are more than 2000 results.",False
f2410c9041be7af5263a30a9c8543e6ab5022bcf,2016-12-10 00:43:23,Evan Morikawa,bump(k2),False
713be08ef6b36df3fc564208e99b130c617929aa,2016-12-10 00:42:47,Mark Hahnenberg,[local-sync] Add index for Thread.id (#4),False
a7f96b74532b6d852b034220e4b04f5782a27be2,2016-12-10 00:31:04,Christine Spang,"fix(local-sync): Fix charset interpretation in message parsing

Summary:
This commit fixes the following bugs in message parsing:
- we were unilaterally decoding MIME bodies as UTF-8; instead, decode according
  to the charset data in the mimepart header
- '7bit' content-transfer-encoding means us-ascii, NOT utf-7
- only interpret valid content-transfer-encodings (previously we were trying
  to treat various charsets as transfer-encodings)
- clearer naming: s/values/parsedMessage/
- unify snippet cleanup between plaintext & stripped HTML (merging
  whitespace etc.)

Test Plan: units tests coming

Reviewers: juan

Differential Revision: https://phab.nylas.com/D3491",False
6645de138bfad9c485e287cfab32ff4bf38e35d6,2016-12-09 08:02:23,Jackie Luo,"fix(error): Treat error as object, not string",False
fc022cc7b6ca549862fc047b91710fe3c423cebc,2016-12-09 07:56:40,Evan Morikawa,bump(SFDC),False
7c403351cf1cb31edf29d58900cddae4a3541b10,2016-12-09 07:49:53,Evan Morikawa,feat(form): better form headers,False
8c980b7b53c628dfd4dca24674b9794c3d8441c2,2016-12-09 07:40:17,Jackie Luo,fix(message-factory): Unlink circular dependency,False
e07c204ecb88d8261bc0dcbea9c74ca7b3aed7a8,2016-12-09 07:25:39,Jackie Luo,fix(message-ids): Use correct hashing for headers,False
b1cf90d697b6bb436b04ad5f826b3b7c1dfabbc8,2016-12-09 07:20:48,Jackie Luo,feat(message-ids): Hash message IDs and replace in draft before sending,False
9e975a44caf5e2d2b029d759f24a105f78cce3c6,2016-12-09 07:18:34,Jackie Luo,feat(message-ids): Hash message IDs and replace in draft before sending,False
2d4d815ac00d7771e94dbfe5941615d3ef848007,2016-12-09 06:53:14,Evan Morikawa,feat(SFDC): enable SFDC on by default,False
9455a8ce30cd73763e027931b9c6039acae2e0bd,2016-12-09 06:49:21,Evan Morikawa,feat(links): forward name and message in links,False
7632d361b8c4f3440194c9a001d752a7871ab470,2016-12-09 03:48:44,Evan Morikawa,"fix(build): fix osx sign, fail on error, remove unnecessary k2",False
a98fe771c2ca62a295a348100e1145021a251d40,2016-12-09 03:47:42,Evan Morikawa,[local-sync] fix builds. Routes with trailing slash and main extension,False
49590d998532bb39d5d7ab0822941d9b41cf02e4,2016-12-09 03:12:47,Jackie Luo,feat(tracking): Add routes for open and link tracking,False
c458e70fa7e6f9119b31f4247d904731048af72b,2016-12-09 03:08:29,Jackie Luo,feat(tracking): Add routes for open and link tracking,False
aa6a00bda92bd60d1dccd81e7292f37c2ba904fc,2016-12-09 00:41:39,Evan Morikawa,fix(SFDC): fix bug where opening new file would cause attachments to fail,False
2821ef4a652b81deb68f141c6ea6e78ea4632fd0,2016-12-09 00:41:01,Evan Morikawa,fix(SFDC): fix bug where opening new file would cause attachments to fail,False
d7195c101c7564a33f654560f346269aeba69584,2016-12-08 23:58:46,Juan Tejada,bump submodule,False
2e2194a8dc1c148c03db5688dda357ecd84b4ca4,2016-12-08 23:58:29,Juan Tejada,[local-sync] Fix lint error,False
d4859e6333bab9fabe8c0b1e9bb0a7ec225e25f2,2016-12-08 07:20:09,Evan Morikawa,bump(k2),False
5217ee001f6da27109b836ed74d428d17de9ad10,2016-12-08 07:17:49,Evan Morikawa,[local-sync] fix delta sync not getting threads with updated labels,False
159cf1053ffa86f2604e5daee743b037b1077aaa,2016-12-08 06:44:14,Halla Moore,bump(submodules),False
7261b9e23c64d6951378cff5b51b4c8a59763fb8,2016-12-08 06:20:04,Halla Moore,bump(src/pro),False
0d02f6f6d39b2762d90ff8d7fc2daba12c410775,2016-12-08 06:09:01,Evan Morikawa,[local-sync] Add global dbs and cleanup orphan messages,False
fca9a085141197b63e225c1a4268cb0d4b3d99fb,2016-12-08 05:46:59,Juan Tejada,bump submodule,False
acc61a738f244dcd0a63f908587df1ce2e580215,2016-12-08 05:46:45,Juan Tejada,[local-sync] Add todos,False
2bf4a50ead360f469a74a679b910bbd1c45546dc,2016-12-08 05:43:36,Juan Tejada,"fix(tasks): Add syncback-task-api-request to keep track of K2 tasks

This commit adds a new request type: SyncbackTaskAPIRequest.
This API request is meant to be used for requests that create a
SyncbackRequest inside K2.
When the initial http request succeeds, this means that the task was created,
but we cant tell if the task actually succeeded or failed until some time in
the future when its processed inside K2's sync loop.

A SyncbackTaskAPIRequest will only resolve until the underlying K2 syncback
request has actually succeeded, or reject when it fails, by listening to
deltas for ProviderSyncbackRequests

THis commit also updates N1's tasks that create syncback requests to use
this new type of request",False
4938170198f3395dba70b6d3fe71aa5a178befe5,2016-12-08 04:18:57,Juan Tejada,"[local-sync] Fix file/contact creation

We were getting sql unique constraint violation errors for ids because
we were attempting to create objects with the same id within the same
transaction.

This commit ensures that only attempt to write a contact with the same
id once, and that we check for all exsiting contacts before hand.

For file, we ensure that we don't attempt to write 2 files with the same
id more than once",False
7f5fede8b91595b2566e2f6f51a22742ccc84b3a,2016-12-08 04:10:30,Ben Gotow,"nit(db): Be more defensive, try to find tx issue",False
85df56fe32a85cac09474bd63b766fe8608b36f3,2016-12-08 04:05:16,Karim Hamidou,"[cloud-api] Add an endpoint to get a new refresh token

Summary:
You can hit the new `/auth/gmail/refresh` endpoint with your account token and get back the following JSON:
```
{
   refresh_token: ""AAAAA"",
   expiry_date: 1481146347
}
```

This way we'll be able to get a new token when we need to.

Test Plan: Need to write the K2-specific parts of the code now.

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3486",False
ede7a6c1d3437abb87733d8fda58fcf088679077,2016-12-08 03:49:07,Halla Moore,"update(send): Pass in the upload data that local-sync expects

Since local-sync can access the same targetPaths as N1, there's
no need to create actual File instances anymore. Pass just the
upload data in the API request, and remove SyncbackDraftFilesTask
since it is no longer necessary.",False
97a3b1d71cdbd9208b17d33103a34f9cb425d5de,2016-12-08 03:46:36,Halla Moore,"[local-sync] feat(send): Add support for attachments

Also move some helper function logic onto the Message model",False
11a26eeb5dd9242b9f8dbba473e9476a796df5ae,2016-12-08 03:09:41,Juan Tejada,"[local-sync]: Fix label/folder id creation

We were using the stripped version of label/folder names for the id
hash, e.g. [Gmail]/Drafts would be Drafts.
However, we can't do this because it might collide with other names. e.g. if the
user created a Drafts label, it would end up colliding with [Gmail]/Drafts

Minor lint fix",False
d607f799e66a4d3b60f9f8037a7667e031cb3ef4,2016-12-08 01:27:44,Evan Morikawa,bump(SFDC),False
152a7488f7a791d12797b3f4539d29565f581f18,2016-12-07 23:41:22,Evan Morikawa,feat(auth): add better error state handling,False
1684bb48c54994efbd029bb546d1b4e12edc7b2d,2016-12-07 23:40:49,Evan Morikawa,[isomorphic-core] add more auth error states,False
024de5dbcc1555343b50f20b1ab4d7846917691f,2016-12-07 20:56:18,Christine Spang,bump(k2),False
c2efca39e1cffcbe72e570910cfa541f60353eb7,2016-12-07 20:55:48,Christine Spang,Enable nodejs completion with tern,False
7969db76fa73d28406927e6c5df77b674fda3bbf,2016-12-07 20:55:28,Christine Spang,"[local-sync] Add specs for message parsing

Summary:
This commit also fixes snippets for HTML-only messages to strip out HTML
tags, and makes us preserve whitespace for plaintext emails by
displaying them in <pre class=""nylas-plaintext""> tags, and makes us log
messages that fail to parse at all to a tempdir.

The only issue I found with using <pre> tags for plaintext email was
that some lines may trigger scrolling, so there is an associated commit
(D3484) that changes the CSS for <pre class=""nylas-plaintext""> to wrap
lines.

In the future, we can add regression tests to this test suite whenever
we fix parsing bugs.

Test Plan: unit tests included

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3483",False
ab92a1719b6b7a6330fafdae836c3a6681031ffa,2016-12-07 07:21:12,Ben Gotow,[local-sync] Don’t update contacts if name is the same,False
909922b97453b32f1acff9836956cee62a310259,2016-12-07 07:17:51,Christine Spang,"feat(k2): Wrap lines on preformatted text

Summary:
We now use <pre> tags to preserve whitespace in plaintext emails,
but it's annoying when there are long lines that force a scroll
bar. Wrap them instead.

Test Plan:
looked at some emails. Not sure this isn't going to break something
           weird---is <pre> used in anything else?

Reviewers: bengotow

Differential Revision: https://phab.nylas.com/D3484",False
3e9ac0c75cf32cfcfbf29778e9fc3de70fc81569,2016-12-07 06:51:37,Evan Morikawa,fix(errors): properly rethrow api error,False
f0b15bcf27f215cb1781fec75284b8d82ba64f3a,2016-12-07 06:50:43,Evan Morikawa,remove console log,False
dc0c86622c0d70df3c603abc360968142c2ad1c7,2016-12-07 06:15:32,Jackie Luo,rm(send-successful): Remove NotifyPluginsOfSendTask,False
efd504a72160e035ef79e81a68a3e2a722a0b5a2,2016-12-07 05:35:05,Jackie Luo,fix(spelling): Correct references,False
57530b5e856ff8bfbdfcc984bb05366251697f6b,2016-12-07 05:33:44,Evan Morikawa,refactor(build): update build to install with right env for k2 packages,False
b664c827c40a33e408e6d3577ecf7ec6c4f818ed,2016-12-07 05:33:42,Evan Morikawa,refactor(auth): DRY auth,False
128d8bd9121ef4cd62a8a8a99593c91fe40b538e,2016-12-07 05:33:31,Evan Morikawa,[cloud-api] fix param names,False
fbf1a7b4e0e96eaab31c28b9c2d2946cc50dbd1e,2016-12-07 05:33:31,Evan Morikawa,[*] package.json updates from lerna,False
e04c087add976ee631f074b3e69e001a813d48dc,2016-12-07 05:33:31,Evan Morikawa,[*] fix auth,False
8568083d6adc1cbaaae8b0cf541d3baab09f0342,2016-12-07 05:33:31,Evan Morikawa,[*] update lerna to 2.0.0-beta.30,False
e26ff019c76c4a5a06944e9fdf5b5e75bd6b1c94,2016-12-07 05:33:31,Evan Morikawa,[*] DRY Auth,False
5030b40e4bb9c40fa9787830086043fb8a7e3eb2,2016-12-07 05:33:31,Evan Morikawa,[isomorphic-core] extract AuthHelpers to DRY,False
11d23cfce16786877e59afad84bff71aa790dd0b,2016-12-07 05:24:58,Juan Tejada,bump submodule,False
295601d1337b067ab86c5b46939212d723de9ef7,2016-12-07 05:24:45,Juan Tejada,[local-sync] Update DeleteSentMessage task for ordering,False
ebfc0e54e381723fd84c8e9adcd1683874c88f23,2016-12-07 05:15:46,Juan Tejada,"fix(k2) Ensure order correct order when running syncback requests

When running syncback requests, if a task is meant to change the UID of
a message (e.g. move it to a new folder), that task should be run after
other tasks that don't affect the UID. Otherwise, when trying to run the
other tasks, they would reference a UID that is no longer valid.

This commit will make sure that we run any tasks that will change message uids last,
/and/ make sure that we don't run more than 1 task that will affect the uids of
the same messages in a row (i.e. without running a sync loop in between)",False
29b7c80dff3a519a8f2da672b9698ec93550659b,2016-12-07 05:15:34,Juan Tejada,"[local-sync] Ensure order correct order when running syncback requests

When running syncback requests, if a task is meant to change the UID of
a message (e.g. move it to a new folder), that task should be run after
other tasks that don't affect the UID. Otherwise, when trying to run the
other tasks, they would reference a UID that is no longer valid.

This commit will make sure that we run any tasks that will change message uids last,
/and/ make sure that we don't run more than 1 task that will affect the uids of
the same messages in a row (i.e. without running a sync loop in between)",False
8287656f80d01f3655156a69d3022e9756bd5784,2016-12-07 01:07:47,Halla Moore,"[local-sync, iso-core] feat(send): add finishing touches to gmail multi-send

Delete the sent messages that gmail automatically creates and save our
generic form of the draft as a sent message.",False
15adefdf4a121558331fd37277d1bc47a8facf95,2016-12-06 08:27:13,Juan Tejada,"[local-sync] Correctly sync folders and labels

This commit will correctly keep track of folder and label ids when
creating them from N1.

Previously, when we sent the request to create a folder or label to our api,
we would immediately get back a serverId because it was created optimistically
in the back end— given that K2 is strictly non-optimistic, we won’t have a serverId
until some undetermined time in the future, and we need to somehow reference
the object that /was/ optimistically created in N1 to update the ui when
we do get the server id.

Since we can deterministically generate ids for folders and labels,
we ""guess"" what its going to be, and include it in the props of the syncback request
returned to N1. This is the simplest solution to get thing working
correctly right now, but we’ll need to revisit this in the future for
other types of objects (drafts, contacts, events), and revisit how we
will manage optimistic updates in N1 when we merge the 2 codebases
with K2 (given that K2 was designed to be non-optimisitc).",False
80a54a44a445b1dc1f1e8ca8ac6c71dd460ea9a3,2016-12-06 08:26:36,Juan Tejada,"[local-sync] Correctly sync folders and labels

This commit will correctly keep track of folder and label ids when
creating them from N1.

Previously, when we sent the request to create a folder or label to our api,
we would immediately get back a serverId because it was created optimistically
in the back end— given that K2 is strictly non-optimistic, we won’t have a serverId
until some undetermined time in the future, and we need to somehow reference
the object that /was/ optimistically created in N1 to update the ui when
we do get the server id.

Since we can deterministically generate ids for folders and labels,
we ""guess"" what its going to be, and include it in the props of the syncback request
returned to N1. This is the simplest solution to get thing working
correctly right now, but we’ll need to revisit this in the future for
other types of objects (drafts, contacts, events), and revisit how we
will manage optimistic updates in N1 when we merge the 2 codebases
with K2 (given that K2 was designed to be non-optimisitc).",False
8b881abe77db79b0438be321fba3a7bcdaa59bc6,2016-12-06 07:00:56,Evan Morikawa,bump(k2),False
21a92e90f644b39e3ce46112c3f0c0deb0606ba6,2016-12-06 06:58:37,Evan Morikawa,fix(key): only migrate if key doesn't exist,False
1e10e74c970d597f44e7526be9b471ae88e1cca9,2016-12-06 06:49:19,Evan Morikawa,feat(key): use unified key manager,False
a9f23341f76b1f680212b8de4838e6af8aeb106a,2016-12-06 05:53:48,Christine Spang,add watchman config file for fast fuzzy find,False
0123ded3228a7c8fa1c9aff454f144578d760b61,2016-12-06 05:50:17,Ben Gotow,[local-sync] fix(folder-list): Support children when parent has no attribs,False
7e595487437a73e986444ed27210a606f91f62cf,2016-12-06 05:37:49,Ben Gotow,[local-sync] feat(specs): Add basic tests for folder sync,False
67bd860beffd877ab0eb80022d9ea6d29132b968,2016-12-06 05:07:17,Karim Hamidou,"[fix] Fix transaction creation for contacts

Summary:
Fixes T7283. We weren't creating deltas for contacts because we were inserting contacts using `UPSERT`, which requires us to add another sequelize hook.  Unfortunately, support for this hook is only available on sequelize 4.x.

I didn't want to upgrade our sequelize version right now and cause of bunch of mysterious failures, so I've simply changed the `UPSERT` to be either an `INSERT`or `UPDATE`. We didn't really need it anyway.

Test Plan: Checked that N1 was receiving contact deltas.

Reviewers: bengotow

Reviewed By: bengotow

Maniphest Tasks: T7283

Differential Revision: https://phab.nylas.com/D3481",False
81ca3190e81297bf9b8e147118d348603c234d65,2016-12-06 04:30:37,Ben Gotow,[local-sync] fix(specs): New specs for threading,False
f439eaf03fb722e722ec03b2efe5d71d0de498c5,2016-12-06 03:53:10,Evan Morikawa,bump(version): 0.4.401,False
8e524f7e9ecbcef2d98e817ee9f78cf356251c17,2016-12-06 03:51:04,Evan Morikawa,fix(iframe): return if the iframe doc hasn't loaded yet,False
5c154345a1c0609fcdbadf6b34eab3c8a103f89b,2016-12-06 03:26:29,Evan Morikawa,feat(SFDC): pull up sidebar Contacts and Leads by name too,False
d3eb7d556e00dc502905d2ea83510b1f1ae838d4,2016-12-06 02:43:02,Evan Morikawa,fix(SFDC): fix null defaultValue to tokenizing field,False
1d79783f301510f9e117275acbe34a371387513f,2016-12-06 02:25:56,Halla Moore,[local-sync] Fix(send): change some validation fields for multi-send,False
d2a2aae794055cbdcb41da6c1f15bc1ff9514a67,2016-12-06 01:46:53,Ben Gotow,[local-sync] fix(specs): run `npm test` in local-sync dir,False
ac2d4b12ace40e6038a9677256f1cd327d846a13,2016-12-06 01:07:27,Jackie Luo,fix(nylas-api): Correct some imports and remove tests for plugin auth,False
56da181c9968394b480a8bc23b71b1366f416322,2016-12-05 23:49:50,Ben Gotow,bump(submodule),False
959b632adcf0607f61dbeca68bef344281e461b4,2016-12-05 23:49:37,Ben Gotow,fix(deltas): Minor tweaks to metadata delta processing,False
ebd4a266a7c829a19778592759369845a93e16b5,2016-12-05 23:27:47,Ben Gotow,[*] Allow zero elements in the replyTo field,False
39db842895e821bc15c6c80dfa530ca109cba195,2016-12-03 05:29:05,Ben Gotow,fix(deltas): Minor adjustments for thread deltas,False
3a984b4dd668c237edd1308c8c2c979668c9328d,2016-12-03 05:21:38,Jackie Luo,refactor(nylas-api): Make requests with helpers,False
badedc9c94344f8e78dee0216ac1392026743b73,2016-12-03 05:14:52,Ben Gotow,fix linter errors,False
f9c7d481120669acc7428337c1193d7a48e2bb38,2016-12-03 05:08:54,Ben Gotow,"[cloud-api] Require metadata payload params, value instead of data",False
e5247e25e52cfefb82d4b696bde8957cde6c4999,2016-12-03 05:04:07,Ben Gotow,[cloud-api] Saving metadata requires JSON,False
85adbda5869f56d028879a06a195e671d029269e,2016-12-03 04:50:31,Halla Moore,"[local-sync, iso-core, cloud-core] feat(send): add multi-send support

Also renames JSONType() -> buildJSONColumnOptions() and
JSONARRAYType() -> buildJSONARRAYColumnOptions() to prevent passing
those return values in as just the type value instead of the entire
options object.",False
a08c9b88639be440462cd53b63617ff459607205,2016-12-03 04:32:08,Evan Morikawa,bump(k2),False
25e8a655a306aa85c8f9ce93125252da4349149c,2016-12-03 04:20:03,Ben Gotow,[cloud-api] Put object_type back on metadata,False
6153947ae0dd28cbcfc614c79ddc64f0303fca9d,2016-12-03 04:12:13,Ben Gotow,[cloud-api] add where clauses. omfg sequelize plz.,False
88f4c56e1edb30d508283ad92ab92e2ce473cc5b,2016-12-03 04:04:42,Evan Morikawa,refactor(plugins): use plugin name instead of appId,False
7814b24ac03c1cb6c7791d291df42456b7a4bae5,2016-12-03 04:04:37,Ben Gotow,fix(metadata): Remove all plugin auth,False
e0325b424d4f90da242bffc62f1cb37678e5d591,2016-12-03 04:04:28,Ben Gotow,[cloud-api] Replace metadata key with pluginId,False
0312890b64d165705022aa52cde2d77b205ac77b,2016-12-03 04:04:05,Evan Morikawa,[local-sync] only enable logging in dev mode of N1,False
b78a73cf23a7204f7a7dbf881fc753b3c53dd97a,2016-12-03 03:43:58,Christine Spang,"feat(metadata): Look up local thread IDs via message table when setting metadata

Since message IDs are now static but there's no good way to generate
static thread IDs while syncing an account from newest message first,
we give threads the ID of any message on that thread and, when setting
metadata, look up the local thread ID by first going through the
message table.",False
4e806aa3a52aa3add6da0df8562df1626957100a,2016-12-03 03:43:47,Christine Spang,"[local-sync] Set thread IDs to the ID of a message in the thread

Since message IDs are now static but there's no good way to generate
static thread IDs while syncing an account from newest message first,
we give threads the ID of any message on that thread and, when setting
metadata, look up the local thread ID by first going through the
message table.",False
0f049de19a3a045d6eed9289614aca92fcd15ff2,2016-12-03 03:14:44,Evan Morikawa,fix(account): Remove unsupported account types,False
ac04ae5d68d2247a4984cc76b57ef44246c6748d,2016-12-03 02:56:09,Evan Morikawa,fix(folder): fix returning db transaction promise,False
663400dc353ab3c18d8331e8a10d2d15f261b773,2016-12-03 02:55:42,Evan Morikawa,[isomorphic-core] ignore folder deltas due to just syncState version issues,False
aab938110fccd53068d3074f1afcbe7dfd1fe2e2,2016-12-03 02:45:17,Evan Morikawa,feat(sync): let N1 be aware of provider synback requests,False
4f2c4b950dcf190fc30218340d2267d1b51123c6,2016-12-03 02:44:42,Evan Morikawa,[local-sync] make syncbackRequest objects N1-ready,False
86a8c71cc404249c56b1d29b0143f2aafcb508f7,2016-12-03 01:44:09,Juan Tejada,[local-sync]: Don't create or sync \NonExistent or \NoSelect folders,False
4be1b87b798f0437516f2372c5636d4d6cb1a785,2016-12-03 01:42:11,Evan Morikawa,bump(k2),False
8abf9a11fec19a4daaa20b984b9ad360ea75428a,2016-12-03 01:41:48,Evan Morikawa,debug(delta): add logs,False
b9bf6ea318a2c25f7904f63ce60752e0d8f965c6,2016-12-03 01:39:35,Juan Tejada,fix observable disposable,False
10aaf293cf966a5108b1bd3cf571f5592d1f52f4,2016-12-03 01:37:21,Juan Tejada,[local-sync] Fix starred role on folders,False
471f134b1100a4d275932d0d9d620ecf7bc3afdd,2016-12-03 01:18:56,Evan Morikawa,refactor(sync): sync workers only use delta syncs now,False
f90df6bb54dc761986e6123ab2937aff21bea6bc,2016-12-03 01:11:49,Ben Gotow,"fix(deltas): Process all deltas of each class in a single pass

Also changed the DeltaProcessor so it doesn’t query for models before sending out `Actions.didPassivelyReceiveCreateDeltas`, and renames it to be more clear it’s about deltas.",False
6fbea7d4f985ba1660b56ebacb4902846a3e52d7,2016-12-03 00:31:42,Ben Gotow,fix(auth): Add a tiny bit more logging,False
f068108456b467ae2536ea7887fbe7c48aba412e,2016-12-03 00:30:32,Jackie Luo,:coffee:(account-store): Convert to ES6,False
90ed64a7704446b8cb1897b3ec0cd9b10e487e3f,2016-12-02 23:58:18,Evan Morikawa,bump(k2),False
b3742e6c72098dc9578c00c2fc8e4aee4a92a269,2016-12-02 23:58:05,Evan Morikawa,"[cloud-api] Update cloud-api readme & remove unused files

[cloud-api] move Dockerfile and pm2 files into cloud-api

[*] additions to .gitignore

[cloud-workers]: move pm2 file into cloud-workers

updates to readme

Revert ""[cloud-workers]: move pm2 file into cloud-workers""

This reverts commit 952292124b6e8dfa304c5fbd945c0b00f427e154.

Revert ""[cloud-api] move Dockerfile and pm2 files into cloud-api""

This reverts commit aa92f691bf991848a51c00a2d01a5848f20a35a2.

Update deploy readme",False
c8fe903f472455027729aae355964abdec72883a,2016-12-02 08:24:26,Ben Gotow,"[*] fix(deltas): 0 as first cursor, deltas from redis are already JSON",False
dd55b9be44ada448d5a70cf6e57818ea948677b9,2016-12-02 08:12:13,Ben Gotow,fix(deltas): Remove extra params passed to streaming endpoint,False
21ed199247f71aa9a78faaca7beeceb8691cabd1,2016-12-02 08:11:46,Ben Gotow,"[*] fix(deltas): Cloud-API not filtering deltas at all, refactor a few things

- Don’t need functions in delta.js which must be called to return promsies. Fun of promsies is that you don’t need to care when they’re built to attach a .then.

- Make boundary between route handler and delta stream builder more explicit, don’t do query parsing in helpers, always reply from handler.

- Remove pushJSON extension to outputStream which never actually received JSON.

- Remove `takeUntil` - disposing of the downstream observable should dispose of all the merged/upstream observables

- Rename inflate => stringify since the returned value is a string not an object.

- Remove support for delta streams with no cursors. Don’t think this was supposed to be a feature.

- Add accountId to Transaction models

- Make database hooks shared in isomorphic core",False
36eaccbb604be769512901983ed9dcc76a9d55b2,2016-12-02 06:19:09,Karim Hamidou,"Strip the '[Gmail]/' prefix from folder names.

Summary:
T7253 has two related parts:
1. Stripping the '[Gmail]/' prefix from any canonical Gmail folders
2. Handling nested IMAP folders.

This diff fixes 1. Changes for 2. are forthcoming.

Test Plan: Tested manually. Checked that the part was stripped from the N1 folder list.

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3475",False
eff147ec90ddf717571331e87810e153cdb892a4,2016-12-02 06:08:30,Juan Tejada,"fix(tasks): /Actually/ fix moving threads in Gmail

Moving to between gmail folders (all, spam, trash) or moving to inbox,
involves changing labels /and/ folders, simultaneously. For this I added
a task to perform both operations, and apply labels first before
attempting to move the folder

Revert ""fix(categories): Fix tasks for moving threads in Gmail""

This reverts commit c253503dc976f1ec048f7419e1878c1d855ce597.",False
371820ed2ed841dca11694c38c24dcbdaf1c5faa,2016-12-02 06:07:49,Juan Tejada,"[local-sync] Refactor tasks and /actually/ fix moving between Gmail folders

Moving to between gmail folders (all, spam, trash) or moving to inbox,
involves changing labels /and/ folders, simultaneously. For this I added
a task to perform both operations, and apply labels first before
attempting to move the folder",False
63778dcd72de83db54f0a3d95c9486521256c049,2016-12-02 05:08:16,Ben Gotow,"lint(*): Fix linter errors within K2, update eslint grunt task",False
d0838161c43f8bc4afe35f576f60fb2896c1151c,2016-12-02 05:07:48,Ben Gotow,[💄] fix eslint issues before they get overwhelming,False
e46c17344c73115cad79f69f05944f1c67eda5b1,2016-12-02 05:00:01,Karim Hamidou,Fix bug where we wouldn't create an id for file parts.,False
e6ae7d248741941c0af67f32acc7dac5c8f07a2a,2016-12-02 04:21:33,Juan Tejada,"[*] Generate persistent id for Accounts based on email+settings

This also ensures that we can use the accountId as part of the ids for
other models, like labels and folders

Before this commit, labels and folders with the same name for different
accounts would have the same id, screwing things up in n1",False
ffa6d43bd61f60522e365b27d8698f0105e9d991,2016-12-02 03:53:52,Ben Gotow,[local-sync] Ship first sync metrics to honeycomb,False
6067af3b1bd8df044491b16220cfb5d91ab0aab9,2016-12-02 03:40:05,Juan Tejada,:art:(task-factory),False
c45f85deb34d106206c9edab48cb4b1f5e50b050,2016-12-02 03:33:19,Juan Tejada,"[local-sync] Fix setlabels task

Make sure we /remove/ the labels when we get an empty set of label ids",False
37f1f7ec80e28e386bb0118b0f0fecd5da25a659,2016-12-02 03:26:02,Evan Morikawa,fix(auth): now authing IMAP through n1-cloud,False
70581995f76297209dbeeb53f92530eaa6f6b5c2,2016-12-02 03:26:02,Evan Morikawa,feat(auth): IMAP request to both n1-cloud and local sync,False
3efc53847224990af60b8039fe38cf9aa99faabb,2016-12-02 03:20:31,Ben Gotow,fix(specs): Fix AccountStore specs,False
e994c766889a9a789760e981b66767b9c72f4934,2016-12-02 03:19:27,Evan Morikawa,[cloud-api] remove validation from IMAP auth endpoint,False
0a0d8d996f071622b5fb1949f63ce1e5191055f0,2016-12-02 03:05:20,Ben Gotow,fix(accounts): Save both local and cloud tokens per account,False
0232b7bce5ff2f66f8246e682efa35779d66149c,2016-12-02 03:03:05,Evan Morikawa,[cloud-api] add npm start for pm2 launch,False
a86a0eeaf88a8f666a170ad0d3b5637335f6c7cb,2016-12-02 03:00:47,Juan Tejada,[local-sync] Give better name to thread folders task,False
1e34f8f4be80d54724ec9b3d3527d8a405642d7c,2016-12-02 02:15:51,Evan Morikawa,bump(k2),False
d730bd0181fa89788da47335f250db3d8a2cb0b4,2016-12-02 01:27:29,Juan Tejada,[local-sync]: Add distinct ids to folders and labels,False
2a1b0904497ab61e444d223eeccc765d0be6b204,2016-12-02 01:09:25,Ben Gotow,[cloud-api] Fix more broken package.jsons,False
a9cf3a004089ee53425a0f4ecb6e511400993881,2016-12-02 00:51:28,Ben Gotow,[cloud-api] New honeycomb ingestion endpoint,False
1e37ece969d880cf4b8af27817216fd47bf5e043,2016-12-02 00:45:13,Karim Hamidou,"First step to getting persistent id in K2

Summary:
This diff adds persistent unique ids for messages and contacts. For messages, we just take a hash of the headers. For contacts, we hash the contact's email address.

This diff bundles a couple of tiny fixes too, like always trying to restart an account's sync, even after an exception.

Note that since there's no reliable way to have persistent ids for threads, we'll have to change our code to use message ids instead. Alas, that's a story for another (massive) diff.

Test Plan: Tested manually.

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3468",False
79e4ff2d186eb71f5f5b13db79875396e981dc10,2016-12-02 00:30:20,Evan Morikawa,fix(spec): fixed specs for nylas-sync-worker,False
c253503dc976f1ec048f7419e1878c1d855ce597,2016-12-02 00:09:53,Juan Tejada,"fix(categories): Fix tasks for moving threads in Gmail

Since our backend now reflects the actual gmail model, a thread actually
has folder and labels. Updating our N1 data model to reflect that would
take too much time right now.

Instead, I updated the task factory to generate both ChangeLabel and
ChangeFolder tasks when moving threads for gmail, by detecting if its
moving to all, trash, or spam, or returning to inbox (if moving
something to inbox, just makes sure we move to all as well)

TODO: there are still inconsistencies because k2 doesn't generate unique
ids across the entire database, which causes 3 labels and 3 folders to
have the same ids. In our code, we expect all categories to have
distinct ids",False
0168a0795e2ad6c5dbee88040711609e110aaea6,2016-12-01 23:47:55,Evan Morikawa,fix(spec): progress on spec fixes for sync worker,False
7ec44beeab73ed4f3fee531954079fff41378950,2016-12-01 22:44:02,Juan Tejada,fix(delats): Warn when receiving unkown obejct class,False
ca010e983865525a7c594dc5393fdb66500700dc,2016-12-01 22:34:37,Evan Morikawa,fix(sync): Support N1Cloud auth errors. Fix LongConnection cleanup,False
ad749b5875c6c11cd6b9d5d840c5d2688d535bd7,2016-12-01 21:34:19,Evan Morikawa,fix(delta): JSON blob persist failed to save properly,False
7a203c7027c9e886c24f52cd06ceaef415855760,2016-12-01 21:01:14,Evan Morikawa,bump(k2),False
905f349f5779bea187fab62a77b018f37f7f9101,2016-12-01 06:56:23,Ben Gotow,"[local-sync] Run message processor for one message at a time

This avoids issues that arise when we process two messages on the same thread concurrently!",False
6802b67363a893407ed55ac6d1926d587db51c64,2016-12-01 06:30:11,Ben Gotow,fix(deltas): Fix deltaProcessor handling deletes wrong,False
4a0c255683773878921f7be38770f8054ee65ca0,2016-12-01 06:23:52,Ben Gotow,"fix(deltas): Delta.id is now a transaction id, need objectId",False
f4a052783eae2b121455f0fd03242a0f7ab7df5b,2016-12-01 06:21:51,Ben Gotow,fix(deltas): We’ve been flipping deltas by accident for a while!,False
f90551da719c3049e62118ca834abf38954fe623,2016-12-01 05:57:25,Jackie Luo,:coffee:(nylas-api): Convert to ES6,False
66df8b85f830b51b01b6c817932c3d1273825f09,2016-12-01 05:56:53,Ben Gotow,[local-sync] Fix “Add INBOX label” issue,False
1259cb8ca2c4c5e63d4db360dd8680ad06a73678,2016-12-01 05:56:53,Ben Gotow,[local-sync] Fix deletion of labels,False
fa10589c1d40d86eaf6045be74f67f294de99aea,2016-12-01 05:56:53,Ben Gotow,[local-sync] Fix ingestion of flags and labels,False
261c3ab849e0fc5f53b17dc892ec17c9cdbc0300,2016-12-01 05:55:28,Ben Gotow,[local-sync] Fix transaction log to only ignore syncState,False
3cfc536600a69f42c30e15d3d43d5f1ae6257e32,2016-12-01 05:55:28,Ben Gotow,[local-sync] Sync a bit faster for testing,False
6cfb3c7dcd4c65d16c8270cb399c05d008c9fa5f,2016-12-01 05:43:26,Juan Tejada,fix(k2) fix local sync deltas,False
807e25d4b68abb506279c5e349851a0a6e7c4fca,2016-12-01 05:42:35,Juan Tejada,"[local-sync] Fix observable for deltas

We were missing a return :'(",False
a089f59455681f0cdba4871d53275fb849242df0,2016-12-01 04:39:17,Juan Tejada,bump submoduels,False
9c1cc7fe2abe00b34a81465d951629017d50e870,2016-12-01 04:26:59,Evan Morikawa,fix(delta): default cursor to 0 if no transactions exist yet,False
fccc83a2f3fa867f28ccfcbae480f043431eec0d,2016-12-01 04:25:45,Evan Morikawa,fix(delta): fix issues with delta sync,False
581d03b9b88f12c80d49dc165088bb8d5b01dc7a,2016-12-01 03:43:46,Jackie Luo,fix(auth): Make N1 Cloud API request correctly,False
f51443b9b751396f7cfa8023d567ae4a8e7fa047,2016-12-01 03:43:06,Jackie Luo,fix(identity): Require NylasAPIRequest correctly,False
18d0dcaeade3f73b5905820baf71a1553dc28343,2016-12-01 03:25:49,Ben Gotow,fix(sync): Fix attribute updates applying to threads,False
d596c81f578c16c6858feb19694b798ef5131be0,2016-12-01 00:12:10,Evan Morikawa,"refactor(delta): add a second delta stream, convert to es6, and cleanup

This reverts commit 0c6d82153ca4cb4a3b5fb2dfac78d39375122a23.

Updates to nylas sync worker to support multiple cursors

Convert NylasSyncWorker to es6

Convert NylasSyncWorkerPool to es6

Extract into deltaProcessor

Update names to NylasSyncWorker state

Working on spec fixes

More spec fixes

Delta stream refactor fixes",False
59be001118192ee991a6db97f2610a6a5eff25d6,2016-12-01 00:11:09,Evan Morikawa,"[*] add delta endpoints and DRY deltaStreamBuilder

[cloud-core] add objectType to Metadata

[*] binding fixes to delta stream",False
9ff60ae2bd88b103fa0bb19241d14d9fc31fb7b8,2016-11-30 23:47:59,Juan Tejada,[local-sync] Remove unecessary db queries in detect-thread,False
25884d7ea44594ffea9f78b13914e663bd71e6f2,2016-11-30 07:32:25,Ben Gotow,fix(sync): Issue with CONDSTORE args not passed to fetch,False
827ddbd0160cad34edd4534d6dbd6f26575501e3,2016-11-30 06:34:01,Ben Gotow,refactor(sync-worker): Convert IMAP operations to async/await,False
ee550568daf206f87d55cef28b68a510a38be5ee,2016-11-30 06:10:53,Jackie Luo,spec(nylas-api): Update tests to use NylasAPIRequest,True
a414f60ef1727524e626b599a132d9ad9b016b36,2016-11-30 06:03:44,Jackie Luo,refactor(nylas-api): Create API requests from tasks,False
bd7da7cffb32c166bad0492b370ec10386610e86,2016-11-30 06:03:44,Jackie Luo,fix(nylas-api): Send API and options as object,False
b9b1f1b317ce7cecaf6cef0eab90cd057cc06a32,2016-11-30 06:03:44,Jackie Luo,bump(submodule): Update Salesforce API requests,False
245f6364f24de8529dd1874958ae0b2c3f96ef32,2016-11-30 06:02:23,Jackie Luo,spec(nylas-api): Update tests to use NylasAPIRequest,True
0c20c107e08089342c837ca03aa3f153cbe7640b,2016-11-30 05:50:18,Ben Gotow,refactor(sync-worker) async/await for Karim,False
d6c613c28a501ff78f20a0353df0e8e84e2e147a,2016-11-30 05:37:47,Ben Gotow,[local-sync] Synchronize K2 accounts with N1 accounts,False
86b0854860c54d0b68d99e9fcd27fe44bdea5a65,2016-11-30 05:37:33,Ben Gotow,[local-sync] Synchronize K2 accounts with N1 accounts,False
ae619357e4ed9703354478e959432049f3fa01cd,2016-11-30 05:04:21,Ben Gotow,"fix(reload): When reload is interrupted by beforeunload, continue reload afterwards",False
b96cd73236ca98b97e837aacc6a09582e5dc26d2,2016-11-30 04:43:42,Karim Hamidou,Make db reset synchronous.,False
c88d77f036986ae34b67b6827dc394a927bffe55,2016-11-30 04:42:52,Ben Gotow,rm(*): Internal packages don’t need engine version locking,False
388f17b1416360eb25883e94be5dfd697dd8a3b7,2016-11-30 04:40:50,Juan Tejada,bump submodule,False
28f4b809b2e579a89142eef81068a2245954c85e,2016-11-30 04:34:45,Juan Tejada,[local-sync] properly save folders when detecting thread,False
a6d05b0103d8e33482f6770755695ab75a2455f7,2016-11-30 04:29:37,Karim Hamidou,Add a shortcut to restart the sync for an account from scratch.,False
390099d06f38f878d7d834e0e59e5630b8ab94c5,2016-11-30 04:28:52,Ben Gotow,fix(dashboard): Remove sync policy,False
2834d2083c60709a1d18fa267303054cf1004eb7,2016-11-30 04:24:54,Jackie Luo,refactor(nylas-api): Create API requests from tasks,False
6577e4af0d0e1abfc747bc04a0d5c09dd334a027,2016-11-30 04:21:41,Jackie Luo,fix(nylas-api): Send API and options as object,False
8bf45ccfc97391c7e240d4a78b6d6c2fff3cb335,2016-11-30 04:21:13,Jackie Luo,bump(submodule): Update Salesforce API requests,False
35358b173d1330fa996e4805c32e00a691c6124e,2016-11-30 02:22:36,Juan Tejada,[local-sync] minor fix,False
896930ae82f722f62b90fe3bf5cb645720dfdd2f,2016-11-30 02:14:02,Ben Gotow,fix(sync-worker): Missing binding arrow…,False
05ee25df34f0f44ec142b5aad0ff695632a57684,2016-11-30 02:09:36,Juan Tejada,fix(deltas) Update syncworker signature,False
518aa9c05e0e2b1cdd13de045f30df9817319984,2016-11-30 02:08:49,Juan Tejada,[local-sync]: Load all db models,False
0e07007bd998471092e225377f6bb2fb7f37ed36,2016-11-30 01:44:11,Ben Gotow,fix(kill): Don’t attempt to re-open windows on killed,False
6c919ee4ad667670ed5d565d18090dd6cb56ee5b,2016-11-30 01:26:00,Juan Tejada,[iso-core] Fix dependencyin model,False
f8c48bc3243d7eb5ffe7289e89044239ce459c4c,2016-11-30 00:54:27,Juan Tejada,"[local-sync]: Refactor message ingestion to write new messages only once

This will only generate 1 delta per new message instead of 2
Adds a MessageFactory to create messages from imapmessage objects, and
unifies and cleans up that logic
Also modified the message-processor to be more suited for local sync,
made emphasis that it's only for processing new messages, and got rid of
the while ""pipeline"" concept

- TODO message-processor specs are broken",False
89794844a2025acb756e24b9091c7d1c25fa9d28,2016-11-30 00:27:19,Evan Morikawa,[isomorphic-core]: move Transaction model to isomorphic-core,False
db56c332ef43e6874dd0b8e21713a155f69e9107,2016-11-29 07:33:27,Ben Gotow,fix(sync): Put K2 dashboard into work window,False
203f3a563693f2fcd1974875953b894db6dc0c96,2016-11-29 07:32:42,Ben Gotow,[dashboard] Put dashboard into work window,False
0c6d82153ca4cb4a3b5fb2dfac78d39375122a23,2016-11-29 06:43:18,Evan Morikawa,Rename DeltaStreamingConnection -> LocalDeltaSyncConnection,False
02f2d7b6a0d4aa9a7280a251b4e9d6dd0edc1b0d,2016-11-29 06:29:04,Evan Morikawa,Update nylas-sync-worker to better fetch metadata,False
a0246d6cc8e598acd5a5d2b907412759400f342a,2016-11-29 06:26:14,Evan Morikawa,[cloud-core] update Metadata model to better match N1,False
1a7c07e2db1ca9749a43619ff6c5d2cce94c05af,2016-11-29 05:41:10,Evan Morikawa,Fetch folders and labels at the same time,False
2d4beb37b514bde54f31b435a5fbda4340bcfd59,2016-11-29 05:14:36,Evan Morikawa,Deprecate LocalSyncRoot,False
cc6e94aa232f1051cff2dce0f10f3b14c92028e7,2016-11-29 05:08:53,Evan Morikawa,Introduce N1CloudAPI as endpoint,False
8837a65ab8bbf7e5c2178f2433dad8eab6e59654,2016-11-29 05:08:43,Evan Morikawa,[cloud-api] Readme fixes,False
2c48b98adfc806ca53198e308905bee7d34c32fd,2016-11-29 04:17:47,Halla Moore,bump(k2),False
497ea7ad62a086882b87903a15d8593b967baece,2016-11-29 04:16:31,Halla Moore,"[local-sync, iso-core] feat(send): Support basic sending for gmail accounts",False
e7e8f9ca97dc87d137e01a83a5ea7f87273467cf,2016-11-29 03:43:46,Evan Morikawa,[cloud-api] added Readme,False
9c0cc488e4dc0d388213db625550dd52539c988b,2016-11-29 03:43:23,Evan Morikawa,Readme updates,False
4dc0d34560b3b567ee50f8d9cf7725db090e3628,2016-11-29 01:35:49,Ben Gotow,fix(sync): Sync again immediately if more emails remain,False
bf5b9f422142eafcea2b0c4727a5d9244a32c589,2016-11-29 01:35:41,Ben Gotow,fix(sync): Throttle instead of debounce for better initial sync,False
80123ab4effbb4062ebc5f4c7fc290a21a0de1ed,2016-11-29 01:30:57,Ben Gotow,[sync]: Sync again immediately if more emails remain,False
5833127bfba2a7ef6ec29d788dc7966cce37135d,2016-11-29 01:11:16,Juan Tejada,[local-sync] Support parsing 8bit encoded messages,False
e51065506b7da320640e917fd5c25f66e0a054dc,2016-11-29 00:55:20,Ben Gotow,fix(sync): Remove the “SYNC” window type,False
50715495e386fa281395fda7a059d14b8e0606b5,2016-11-29 00:35:00,Ben Gotow,fix(auth): Stop sending other crap with key,False
d07adb46ef11a64d079484f4e7f8675d825b0d64,2016-11-29 00:20:12,Ben Gotow,fix(auth-response): Actually pass correct args to find,False
1f9b39da7d7fbf630f06ca70535f05f24614c22c,2016-11-29 00:09:23,Evan Morikawa,[local-sync] retry sync after error,False
ecf4e6a5adb7a170474e21079e35227fb6eb0fcf,2016-11-29 00:07:04,Evan Morikawa,[local-sync] print sync error when in error state,False
357b1d1a69051d2910854a2e3a0be36bf6f5f297,2016-11-27 02:21:18,Juan Tejada,:art:(k2) Move non shared-models to local sync / remove duplicate DatabaseTypes,False
569024ae4a39056d27540ecea939f8aabb218f0c,2016-11-27 02:18:48,Juan Tejada,Move non shared-models to local sync / remove duplicate DatabaseTypes,False
f104c28275be885eafc847df8a1106f2f5114588,2016-11-24 06:39:16,Ben Gotow,fix(storage): Move to ~/.nylas-k2,False
8670f350627b6202a582bf1e0f808639d86cc727,2016-11-24 06:38:38,Ben Gotow,fix(storage): Move to ~/.nylas-k2,False
a531a8bcc93d9e3737688b087aba447fd4cb8745,2016-11-24 06:38:38,Evan Morikawa,fix(thread): handles new API with both folders and labels,False
115b1a2495e25bcfcbf86e5f7d296a4366201514,2016-11-24 06:37:09,Ben Gotow,[n1] fix(sync): Add support for message encodings,False
81d8a457296bb1dd67543a8d84a2fd1a1ac58ace,2016-11-24 05:56:40,Ben Gotow,fix(auth): Support gmail auth against K2,False
4a6f7020101bf8be3aaa769396ef4a5e3fcd4ee4,2016-11-24 05:56:40,Ben Gotow,fix(auth): Use new endpoints for Gmail auth,False
6a8ec445f3c933db449d899401379896f660fd9f,2016-11-24 05:55:45,Ben Gotow,[n1] fix(api): Add support for messages?thread_id=1,False
42a4b10fd1f970742957325cb7788a0ea571caea,2016-11-24 05:17:49,Ben Gotow,fix(account):,False
4729d55584de167acf78bf528f3556ddc67808f5,2016-11-24 04:54:41,Ben Gotow,fix(account): Include name,False
23f6102cf5074aac2951a9f2ac3585081da68f21,2016-11-24 04:53:46,Ben Gotow,Gmail auth: resolved settings tests,False
5a99d58c58c1c1c45916243b548e7faa719f8e9c,2016-11-24 04:21:39,Ben Gotow,[cloud] Store resolved settings for returning to client,False
53fb617a211ad98548306502caa9c24e530b823f,2016-11-24 04:08:19,Ben Gotow,[cloud] Need more room for auth response,False
e8f475da6110eb824bc5795b07ce43f2b4f24677,2016-11-24 03:56:24,Juan Tejada,fix dangling paren,False
7ebb201a914a9932212884995f6cf42422826c80,2016-11-24 03:55:52,Evan Morikawa,bump(k2),False
c49a6d2d20b79a18ee6c926c660d92948bbdbcf9,2016-11-24 03:55:15,Juan Tejada,"[local-sync]: Restore message-processor

Don't use pubsub for scheduling a message for processing, just use
nextTick",False
e1162db7d4ae2ad0f222486107786cd4993ab4c4,2016-11-24 03:52:38,Evan Morikawa,[local-sync] fix promise instance of check,False
c779c064ee21ae58c38ab7dd94c54226b593d64f,2016-11-24 03:16:57,Evan Morikawa,bump(k2),False
a36284d40339ea490bc59b2ee3ad290a01173da6,2016-11-24 03:13:00,Evan Morikawa,[local-sync] fix unnecessary transaction JSON parse and binding issue,False
7c1f147fcb6ab02b8830d52be69a94d43b58c566,2016-11-24 03:00:51,Juan Tejada,[local-sync] Remove unused message-types,False
da604488b759387b8efcb89e91551ffc2661535c,2016-11-24 02:38:59,Karim Hamidou,"Make the delta stream work

Also replaces our LocalPubsubConnector by a TransactionConnector which
just uses EventEmitter.",False
e1f5d175f550d02f3bc617cf8cc92df8b5a98c92,2016-11-24 02:07:05,Evan Morikawa,Remove EdgehillAPI from auth and fix NylasRequest and perspective,False
d7ec67db1830185427c1175d941013be27cd9478,2016-11-24 02:05:48,Evan Morikawa,[local-sync] return as auth_token instead of token for N1,False
dbd31e3407bd20f6d7cef540454944a8c348332c,2016-11-24 01:50:51,Juan Tejada,bum submodule,False
05874d5d79a7ac24cdd1d5c7a607ff5e5e5d29fa,2016-11-24 01:46:58,Juan Tejada,[iso-core]: Make loadModels reusable by cloud-core,False
87bb598e41bdb7a1da46c3e92cae5a056a8a5d00,2016-11-24 01:31:47,Evan Morikawa,rearrange logging so message comes first in console,False
03e53d3a463c6f3a41c29865b180d2f6b6c28e30,2016-11-24 01:25:46,Evan Morikawa,Make NylasRequest look at APIRoot too,False
6e28ef40f80663e52497f25c37f071589ea8af55,2016-11-24 01:22:17,Evan Morikawa,bump k2,False
27ea5386c8d030ca7e055881aeb3e8964e10d901,2016-11-24 01:20:13,Karim Hamidou,"Remove redis dependency

Conflicts:
	packages/local-sync/src/local-sync-worker/sync-process-manager.js",False
3e5a080b65915bac8d229920a9714cc52c62f6d2,2016-11-24 01:19:32,Juan Tejada,[iso-core]: Update api for loadModels,False
b8f40fe98b0f9fe134c8ccc5685069bbbffef8e2,2016-11-24 01:18:58,Evan Morikawa,fix(auth): don't send unncessary IMAP params to local-sync/auth,False
97d8fc1edc3340d8c03221fae497c5479a9f2d14,2016-11-24 01:18:48,Evan Morikawa,Use 2578 as port on example,False
fc6c9a9f705cb30385e1962eb5c16e473fd0cfe9,2016-11-24 00:47:27,Evan Morikawa,Use ~/.nylas-k2 as default config dir path,False
f3f4ae8be02c19c10e2af706cab3a64697af5f60,2016-11-24 00:37:04,Evan Morikawa,[local-sync] Remove Gmail auth from local-sync,False
d03b86efbb0659c61da582c5aa67b919b9d32eb6,2016-11-24 00:31:48,Juan Tejada,[local-sync]: Properly remove all refs to global.Metrics,False
869ee926db87629b267e655ec06e64a2834ce587,2016-11-24 00:31:29,Juan Tejada,[iso-core] Use sequelize.import now that eval is enabled,False
2b730bd585ddac52f317871d4c30f3222b1c9cf2,2016-11-24 00:24:55,Juan Tejada,bump submodule,False
3191a609afbe97e5fa370eec48ba7d2aea005b7e,2016-11-24 00:23:02,Evan Morikawa,Add logger fallback,False
9a17afd28360c123a971b9682b3dc1c46f30306d,2016-11-24 00:21:27,Karim Hamidou,Turn on JS eval for lodash.,False
33fd3490549d452f4a0c1a1c5917fbae74d3d1a3,2016-11-24 00:21:03,Karim Hamidou,"Fix module loading bug

Conflicts:
	packages/isomorphic-core/src/models/index.js
	packages/local-sync/package.json",False
543f5a4fb49d7738449ccd15c2f25784846bcf44,2016-11-24 00:02:46,Juan Tejada,fix loadModels,False
937a91613fa76c73331bf279a52448aef2728225,2016-11-24 00:02:07,Evan Morikawa,Add sqlite3 since sequelize can't use better-sqlite3,False
37beaf3b488aaebc723a6878c900240df53e7572,2016-11-23 23:49:43,Ben Gotow,bump submodule,False
ff21ac46fa0f17e729428208210c44937b3ca370,2016-11-23 23:49:35,Evan Morikawa,Fix JSON parsing error,False
509cde0f6c7f168dc101bda4242cec0d90f33084,2016-11-23 23:48:47,Evan Morikawa,Add better-sqlite3,False
d90536acc7a75dd047f1cecb743339603d88579a,2016-11-23 23:48:35,Juan Tejada,"[local-sync]: Let local-sync start, add loadModels to iso-core",False
297f03a8b846616e596b8a5ac708762f89fa666a,2016-11-23 23:43:31,Evan Morikawa,bump(k2): bump k2 to latest,False
c033dd92ba735b54f88866dc3c43d61b005a493b,2016-11-23 23:42:02,Evan Morikawa,Update local port to 2578,False
6009967d727f3f4c49bfa0a723f57f6933826777,2016-11-23 23:38:45,Evan Morikawa,Local port is now 2578,False
43222a27572d553ba118766a76850ec5e55a166b,2016-11-23 23:29:14,Evan Morikawa,rename APIRoot to LocalSyncRoot,False
a626a50a7b6a28a52d66140f9831cfeecd0566f9,2016-11-23 23:11:49,Ben Gotow,fix(onboarding): Remove support for local sync engine,False
57bef82944b6262ab049ee335c9c387580de9618,2016-11-23 23:06:41,Ben Gotow,[cloud] Fix paths,False
a7ed48b7abed6916e45019c6e50806fb7e1b22dc,2016-11-23 23:04:38,Evan Morikawa,[isomorphic-core] add trailing ./,False
79d0512189dae49bb493290fef4f7b24dfd1fbbf,2016-11-23 23:03:54,Evan Morikawa,[*] package.json updates post lerna bootstrap,False
daf0903c5e8563f6dc33fc7dc980632052751431,2016-11-23 23:01:23,Evan Morikawa,bump(k2): update k2 pointer,False
cb1285b9926ed41308360dea65e7a9bafd111659,2016-11-23 22:57:41,Evan Morikawa,[local-sync] update package.json to include missing deps,False
5b2f96759998de98848df6bd4b93c13c878552f7,2016-11-23 22:52:08,Evan Morikawa,[cloud-workers] remove unused newrelic and add src/ dir,False
95b0df9cefc4022854ab73b4da067a155a7a0ead,2016-11-23 22:48:00,Evan Morikawa,[cloud-api]: move src into /src folder,False
27df142f127b4a9b4cc6a2638d1baa57afee77a9,2016-11-23 22:42:59,Evan Morikawa,[isomorphic-core] Remove packages no longer used in isomorphic-core,False
d1e86bc4429fffac5b79410b69ac9b4db881f25b,2016-11-23 22:42:54,Evan Morikawa,[isomorphic-core] Move files into src folder for isomorphic-core,False
30f7d87f571aa0407e7cf09b664ef25aba7824b8,2016-11-23 22:42:50,Evan Morikawa,[isomorphic-core] Rename nylas-core -> isomorphic-core,False
c5545af01e78bb7f284f9e287e75cfcc7a2ba298,2016-11-23 22:42:45,Evan Morikawa,[isomorphic-core] Uppdate refs nylas-core => isomorphic-core,False
ee5693fb04bc7e980980c514df1cb0fae34a0acc,2016-11-23 12:03:53,Juan Tejada,Remove unused PromiseUtils in cloud-core,False
98895342be9e2d53acdc3544694d1035d9c129cf,2016-11-23 10:06:38,Juan Tejada,"Final nylas-core and cloud-core cleanup

- Remove unused exported PromiseUtils from cloud-core, import instead
from nylas-core where needed
- Remove unused MessageTypes from cloud-core
- Move MessageTypes from nylas-core to local-sync. It's completely
isolated to local-sync",False
39ca2164e6a9041d4043810b0201624e3208db07,2016-11-23 09:55:43,Juan Tejada,[local-sync] Misc fixes from database-connector move,False
aed9cf2a397f74daf8ddc5eb2b6226a0a1568b44,2016-11-23 09:48:19,Juan Tejada,local[sync] Move missing file for local-syncs database-connector,False
a2dd0b1c6a5a76129a7a477ca7f2ca486540b5fb,2016-11-23 09:43:35,Juan Tejada,[local-sync] fix path for local pubsub-connector,False
598cb89744cefb186972625ca2352e9645b2fe34,2016-11-23 09:40:54,Juan Tejada,[local-sync] Make local logger es6 for compilation,False
4f7432a4ecb3aaac92fbdb8a23b1fd04dc27eb53,2016-11-23 09:37:11,Juan Tejada,[local-sync] Remove logger and metrics from local-sync and nylas-core,False
6fd78f7924fc9aa1b9130b41459332b0aba24000,2016-11-23 07:54:46,Evan Morikawa,Rename generic Errors to IMAPErrors,False
8a1b8c8daf55e71e632bf1c32595926ec82ebfe5,2016-11-23 07:50:34,Evan Morikawa,Move SyncPolicy out of nylas-core to DefaultSyncPolicy,False
18d49fe37b26281ed6d7fc437dbc6f1c0dd2dbed,2016-11-23 07:34:35,Ben Gotow,Update auth to hit new hosted N1-cloud,False
f18909df3145b1014d69a1e7c90231e56ae7e3e7,2016-11-23 07:21:43,Evan Morikawa,Rename DatabaseConnector to LocalDatabaseConnector and move,False
cd866ed5a2dc812ccebb8191a03ab2776c389e13,2016-11-23 07:21:43,Evan Morikawa,Move PubSubConnector to LocalPubSubConnector out of nylas-core,False
18f3cf7e5dfce4e489c600f21a2f1060399d2b54,2016-11-23 07:10:01,Ben Gotow,[cloud] Add missing rx dep,False
a07fb9b248c49b7fb4048c751a8f149bda07c7ae,2016-11-23 06:58:25,Ben Gotow,[cloud] feat(metadata): Delta stream for metadata working,False
16d3165d073be059fc8cac3e338086c329bbc375,2016-11-23 06:37:48,Evan Morikawa,Move SchedulerUtils out of nylas-core to local-sync/src/shared,False
b5562347c091a73dab64a19c31dd2c1814391c21,2016-11-23 06:25:08,Juan Tejada,fix(deps) Fix deps for local-sync and nylas-core,False
960a04387108ea4419f5214c0adf4f94f5d8b71e,2016-11-23 05:44:18,Ben Gotow,[cloud] Put bunyan back again,False
89307f49420330e3210b1ecb8f2c6de51481ac89,2016-11-23 05:38:10,Evan Morikawa,[local-sync]: moved spec into similarly named folder and updated refs,False
24827587d81973f1bd80d8472bab6fc6704bcc04,2016-11-23 05:33:38,Evan Morikawa,[local-sync]: move folders into `src` folder,False
9ced1c5b8b5aa6daab7eb31fa22f2bb8d3a2feb5,2016-11-23 05:31:49,Juan Tejada,fix(local-sync): Fix bootstrap for local-sync package,False
f556501e2f5f677b5ad1318cfa784532ba1d0f9a,2016-11-23 05:29:15,Juan Tejada,bump(k2),False
29c460f98ee636643212f7fb9957d4ffb43e5d0e,2016-11-23 05:28:26,Evan Morikawa,bump(k2),False
f35008d119c6a3b587700b2314b9034aad5d2a0c,2016-11-23 05:17:18,Jonathan Lai,Typo: mispelled > misspelled (#3085),False
6492eda572783041211f49878de7f1a64700194e,2016-11-23 05:13:59,Ben Gotow,[cloud] Put signalfx back,False
916e853e5e1868f51d4e693ad11a5199ee538ec4,2016-11-23 05:13:13,Ben Gotow,Actually update things to work without cloud-metrics…,False
9a1b7673d4f1243cf78fd40ae476234f7e817a9e,2016-11-23 05:10:18,Ben Gotow,[cloud] fix(*): More misplaced packages,False
704f3013391cdef3f4e79f0a6d6a9760406fadb6,2016-11-23 05:04:00,Evan Morikawa,Moved cloud-metrics into cloud-core,False
38eb129f477f74368eaa2b5738974ae853994527,2016-11-23 05:04:00,Evan Morikawa,[local]: rename folder nylas-api to local-api,False
7618cc543a2b73a0f83897873e66cade219a4390,2016-11-23 05:01:35,Halla Moore,"[local-sync] Check for missing Category roles by localized display names

Sometimes imap mailboxes aren't properly flagged with their roles, so we
check the display names against known variations to see if we can find any
missing roles.",False
437615a9c9029926e8763cb200065a3a76b37f78,2016-11-23 04:59:27,Karim Hamidou,Create a new sync window.,False
0eaebe19b608d9f0ec068f761b665e3da6c677e8,2016-11-23 04:46:00,Juan Tejada,Merge branch 'master' of github.com:nylas/K2,True
00fe4e3b7f01134c425d2050c39e721c4b848615,2016-11-23 04:43:48,Ben Gotow,[cloud] fix(*): remove all traces of loggly,False
18ad660bd13f043c709e026ab75f200e65896645,2016-11-23 04:43:28,Juan Tejada,fix local-sync package,False
1ffa8be06cab9aa96805b8de7638f9228b14787c,2016-11-23 04:24:40,Ben Gotow,[cloud] fix(*): add things back to package.json,False
a86bf826311d070aeb5957470de944b3c31922f8,2016-11-23 04:22:42,Evan Morikawa,Update package.json post lerna install,False
ee5a51bad92fc2c23f172660581986a03e283b33,2016-11-23 04:17:18,Evan Morikawa,Fix package.json,False
d741cb995f927ff13881b47d012d70b705be7903,2016-11-23 04:09:31,Evan Morikawa,bump(k2): bump k2,False
0cfd8e85e30ee87d72c67c4a03610f02bc47e7ff,2016-11-23 04:08:39,Evan Morikawa,bump(pro): update pro submodule pointer,False
0336c8edb3d53d280022861de683f9cc7e60a9c4,2016-11-23 03:56:48,Karim Hamidou,"More structure adapts.

Conflicts:
	packages/local-sync/package.json",True
e284c40788e954b3c8d4ccd65971fc21a491f9ee,2016-11-23 03:53:16,Karim Hamidou,Basic structure changes to run K2 in N1,False
b221f75602ed120b90a90644ad89ef586c7cc65c,2016-11-23 03:25:04,Ben Gotow,[local] Fix package json,False
aaae61f7fc266e5b9d009d764571310dbe7be642,2016-11-23 02:55:58,Ben Gotow,[cloud] fix(eb): Oops,False
c618033d882bcfaceac8980773143b1503d09984,2016-11-23 02:54:26,Ben Gotow,[cloud] fix(eb): Switch port to 80 to see if it fixes it,False
dbf988881d16e0c181823844cdd8a39c1852d8ff,2016-11-23 02:47:31,Ben Gotow,[cloud] fix(docker): Define port used by docker,False
13d7feb953d1aa9f89206b91dea960b475b7428b,2016-11-23 02:31:30,Evan Morikawa,fix(spellcheck): fix right click menu on spellcheck,False
1d42cb0443608ea4b13dc514afec5cdc10c1878f,2016-11-23 02:04:29,Ben Gotow,[cloud] fix(db): Rename to ebdb for consistency with elastic beanstalk,False
6211c7cb2dbf8b3924ea855c1ffb75c930f3301a,2016-11-23 01:55:27,Karim Hamidou,Flesh out skeleton.,False
42d4c5763a749cc3d290fce8dc73cba4a2ca5841,2016-11-23 01:54:13,Juan Tejada,fix(folders): Properly update thread folders on sync,False
657e03bb7e6e1aa1cd1f19de18d7906ec0e712cf,2016-11-23 01:53:21,Ben Gotow,Remove bunyan-loggly,False
3ebf69f1ffeeb06f82772e8b97a6ec4831c22681,2016-11-23 01:31:45,Karim Hamidou,(fix) Set up base structure for local sync.,False
c1e7e7c320e455a9191dbb17e807d90c635cf9a9,2016-11-23 01:28:34,Ben Gotow,Bump eslint,False
d6fd60e3b8aa909f614c2d31e51a22a2ee42a4bb,2016-11-23 01:06:49,Evan Morikawa,bump(changelog): 0.4.400,False
90f74bca8800fa9697218c8b237f0ba4b2c91049,2016-11-23 00:50:35,Halla Moore,"feat(calendar): Allow calendar events to be dragged and resized

Summary:
In order to allow events to be dragged across multiple days, this involved
implementing a new data source for the WeekView that modifies the event feed
based on mouse event data.

Depends on D3451

Test Plan: manual

Reviewers: evan, bengotow

Differential Revision: https://phab.nylas.com/D3452",False
7d18176aabaf0e3d3511a80903b7d23e0319dd9a,2016-11-23 00:28:27,Ben Gotow,Pull in cloud packages,False
5d6485e0dc2914a5aa265fac38f75bc91c81c103,2016-11-22 23:49:25,Ben Gotow,bump(version): 0.4.400,False
53ed9511de4f865c91788c5cda5e032e150d0af7,2016-11-22 23:49:20,Ben Gotow,fix(mailto): Restore AtomApplication breaking Mailto,False
35919d6b511e62de0bde0ae60a6cd92d0ce8c56d,2016-11-22 23:43:57,Evan Morikawa,feat(k2): nylas api only uses localhost,False
fbd415cb154903015ca541978a17c62e7e39fb2f,2016-11-22 23:28:41,Juan Tejada,"feat(labels): Add functioning endpoint for updating labels for messages & threads

- This commit also correctly sets the labels on the corresponding thread
whenever a message has its labels updated
- Fix removing labels from messages",False
fbb6ea6aa48c1c4101e8ab2e03b73b263d4f8a20,2016-11-22 07:48:28,Evan Morikawa,feat(k2): add k2 as valid env,False
5906815ff6a3e6d797182547a8f7b2b848ac9857,2016-11-22 07:48:21,Evan Morikawa,fix(readme): minor readme changes,False
7df033f82fc60782e826a33947f5c6a834162923,2016-11-22 07:11:57,Juan Tejada,feat(api): Can now set labels for messages,False
3577c34ada064b0809f355d550f9b42f6fef4a4a,2016-11-22 06:38:40,Evan Morikawa,feat(:cloud:): copied via remote push to n1-cloud at this point,False
1b1d356753b230dd67f399493c76976395e250da,2016-11-22 06:37:52,Evan Morikawa,fix(package): re-order package.json files,False
96e879607326f8189a601a75caf086b3f7e73c1d,2016-11-22 06:08:29,Ben Gotow,bump(version): 0.4.400,False
022b5aa3de75cc52a18023d8d022207646236005,2016-11-22 06:06:41,Ben Gotow,fix(mailto): Restore AtomApplication breaking Mailto,False
8afa3d4eaea0f481cefc20fffa53e1e393d5f4ea,2016-11-22 05:36:03,Ben Gotow,"fix(*): K2 inside N1, build and ship in src/K2",False
6418a9616c4ca03315fa3582ee3b25df95b6812d,2016-11-22 04:46:04,Halla Moore,"change(API) Prevent N1 from sending ""view"" parameters in some API requests

- Threads: N1 always asks for the 'expanded' view, so K2 just always returns
the expanded view. N1 no longer needs to specify this.
- Messages: N1 only needed a 'count' view to display the initial sync progress
We've removed this progress bar and the corresponding request.",False
eba33080aceccd86678e605788b46c4833697457,2016-11-22 04:06:54,Juan Tejada,fix(messages): Fix raw message api endpoint,False
11fe681af23c9deb2f4fc6837410f35e6934599a,2016-11-22 04:01:55,Evan Morikawa,fix(travis): update travis task for spawn signature,False
8efd4f79356885c446f1f59f79344241f32af212,2016-11-22 03:35:38,Ben Gotow,Fix another linter issue,False
e87e67cea35cdc8aa2d654bf850003c4fd0b2ff5,2016-11-22 03:30:35,Ben Gotow,Fix linter issues,False
c55b698132c4f4150c19cd3b7b2d68e97254e404,2016-11-22 03:27:52,Ben Gotow,fix(build): reset appveyor cache on package change,False
7906e3303dbb8b8ff81c54e9643d4928d1d51f8a,2016-11-22 03:20:34,Halla Moore,Add placeholders for various routes that N1 uses.,False
0fe6343137dfccdf4be88ea0ccea92e60b6e6e20,2016-11-22 03:20:29,Halla Moore,"Remove filtering from the collection APIs.

Affected collections were categories, contacts, files, messages, and threads.",False
a49214112099dea06c2b7b7d53e1444645451b70,2016-11-22 03:20:09,Juan Tejada,fix(cal): Disable event search for now,False
68120155971fc2c02f0cb4825e250c437b4e33e3,2016-11-22 03:20:08,Juan Tejada,fix(lint) Fix lint error on publish task,False
15880366555f39f676051bc0ba14b2335361cc43,2016-11-22 03:19:05,Ben Gotow,fix(bootstrap): Build deps for current arch,False
c9ff8df54bac86722b20e1a26ad2e717d9d4b55c,2016-11-22 02:55:08,Ben Gotow,fix(db): Use SIGTERM instead of signal 1,False
ffa8a6201aefcaf5df82e0e30f3f9a67be96a7b8,2016-11-22 02:05:41,Ben Gotow,fix(cache): Support non-inline source maps,False
3eeb9d517f6a2b11bbe50ab67593a7d85fe526b7,2016-11-22 01:37:15,Juan Tejada,"Revert ""Link K2 into N1 as a private submodule""

This reverts commit 88d874133deda02c3c81a5ad144480b6a39f7762.",False
b95f2748c780870386da21239934823f85ef279f,2016-11-22 01:35:17,Ben Gotow,Bump src/pro pointer,False
939ef1bc363360c55062995c9427d681ae1dbcd6,2016-11-22 01:33:46,Juan Tejada,fix(build) Fix publish task for linux,False
86eb3047d02f17ec5ee6a8c359c3da37606788aa,2016-11-22 01:32:51,Evan Morikawa,fix(build): add setup travis keychain task,False
88d874133deda02c3c81a5ad144480b6a39f7762,2016-11-22 01:24:27,Ben Gotow,Link K2 into N1 as a private submodule,False
a867029bfa38bd3029c0025f9c6b24eb25522758,2016-11-20 03:52:07,Juan Tejada,fix(cal) Make sure we center the current time on screen when opening cal,False
bed1a5c62f08e728c3243d850110e37351d6efd7,2016-11-20 03:51:36,Juan Tejada,fix(scheduler): Make sure composer is focused to insert event card,False
89df816f0bd6461299673c3852b1774ef9283e77,2016-11-20 03:38:01,Juan Tejada,"fix(cal): Correctly capture times when selecting proposed times for meeting

Adding a scroll region messed up selecting times for meetings. Make sure
that we select the correct container off which to base the time
calculation",False
f51e44cc3c0fe16a0be9d63d489e5a720207e1e3,2016-11-19 06:03:11,Evan Morikawa,fix(build): update the nylsa-Info.plist to use electron-builder,False
ae7a355878e61f8adf4d2c04d948e595c1039c84,2016-11-19 05:56:09,Juan Tejada,fix(lint),False
41dc94ecc4295c5a2de1ca3efad52daabe22dad0,2016-11-19 05:29:45,Jackie Luo,fix(theme-picker): Add z-index to close button,False
39c63d988ec7fc0fdd7a7023223001f3013813da,2016-11-19 05:08:26,Juan Tejada,:lipstick:(md) Fix markdown styles,False
7a08ef3d956ac44e4dc63339f66f3714f1eed355,2016-11-19 01:54:45,Juan Tejada,fix(win-build) Run deploy_script as cmd,False
e3297d1540c76f5b2684e8e77219b952aad6b086,2016-11-19 01:43:40,Evan Morikawa,fix(SFDC): fix deactivate,False
18f574281a2f21bc65d0d780fe778484f94a0c87,2016-11-19 01:40:09,Evan Morikawa,fix(SFDC): refactor lib main,False
f5d97e9039504cfd0e6a29f922e22fdf843562fb,2016-11-19 01:33:24,Juan Tejada,fix(build): Add proper error handling to publish task,False
18a2e1f5c394f9ea77a1dd140c5b332ce2aca6e8,2016-11-19 01:28:09,Juan Tejada,fix(build) Actually fix build,False
59dde10372c60f40701e22af822b033ef071f17b,2016-11-19 01:13:41,Juan Tejada,"fix(build) Fix output directory for builds

- We were including the root output dir twice in the file path",False
27246017d17e08b791d7a11994d7576b4890e869,2016-11-19 00:43:21,Evan Morikawa,fix(lint): fix linter import error,False
105be10e573133a3dc407579747df113f36be95d,2016-11-19 00:32:07,Juan Tejada,bump(version): 0.4.205,False
8dc4d40453f924316e929d5f29aa71aa2e19891a,2016-11-19 00:31:21,Juan Tejada,"fix(win-build): Change to 'cmd' for build script

This should prevent it from failing on npm install warnings",False
6b95e4d0545847354899c4ea042f571434a05807,2016-11-18 05:32:42,Evan Morikawa,fix(db): fix error with modelify not finding markNotBackgroundable,False
77050a8df7f4c69dac6d7e20083e5d186884ca88,2016-11-18 05:31:55,Evan Morikawa,fix(search): allow custom search result elements,False
a9cadef9d251166f40adb30fbf4eee5407c8933d,2016-11-18 05:07:44,Juan Tejada,fix(specs) Fix remaining tests,False
626ba3c2df10b495a3a4ddbf274a1190773d883f,2016-11-18 04:21:44,Juan Tejada,"fix(cal): Fix changing weeks on weekview

- Fix specs too",False
c67fe4ac8fa499e03b494681e03ef7298351b29c,2016-11-18 04:21:24,Juan Tejada,fix(spellchecker) Fix spellchecker specs,False
a29abcbbd8b3935e3653b0f0e0b8f9a701e38d96,2016-11-18 03:33:06,Juan Tejada,"fix(db-transaction): Make sure we mark as not bg-able query objects

When forwarding query operations to the database (e.g. find, findAll)
from the transaction,
we didn't check if those methods actually returned a ModelQuery object
(e.g. modelify returns a regular Promise), so this would break in cases
where it wasn't defined (`markNotBackgroundable` would be undefined)

This commit fixes that and fixes related specs",False
4d7c1513c501c6919c094272d6e4c4abc26a5ba5,2016-11-18 00:30:44,Evan Morikawa,fix(analytics): update analytics in SFDC,False
d237d7c4f89745b7227707bdd2b4799aff331717,2016-11-17 12:18:14,Juan Tejada,"fix(sidebar): Correctly show all accounts in sidebar during initial sync

Ref #1587",False
be6685ddaca1f082743a9c04815df679696dce77,2016-11-17 08:15:36,Evan Morikawa,fix(input): error in tokenizing text field and queue debug info,False
25bfe96e3ef3afc300d78e62ded962ec1eccf06c,2016-11-17 07:17:24,Ben Gotow,"feat(db): background flag to exec queries in a single forked node process

Summary:
This is an initial attempt to fix an issue we’ve had with long-running queries interrupting the N1 user experience. Node-sqlite3 used an async approach that ran sqlite’s synchronous query methods on a worker thread, but doing that involves copying memory more and node-sqlite3 was just generally slow.

However, moving to better-sqlite3 made /everything/ synchronous. Even with the right indexes some of our queries just suck.

This diff adds `DatabaseStore.findAll(…).background().then()` which allows you to mark a query as “unimportant”. These queries are run in a separate process which is forked from the window and can take an extra 10-50ms to complete. That said, they’re totally async and don’t jam up the app.

I’m personally a fan of the flag and less a fan of the implementation. The “agent” process can handle many queries in it’s lifetime if they keep coming and quits after 10 seconds of inactivity. (Both to save memory and to avoid scenarios where it might end up oprhaned and running forever). While running it uses about 40MB of RAM, which is a bit on the crazy side.

Test Plan: No new tests yet

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3420",False
53a981039541b1de12ebb5b4f29fd60a1bf4f0d0,2016-11-17 06:38:56,Ben Gotow,"feat(calendar): Add line showing ‘now’

Summary: Just a small line that shows during the current week to highlight the current day and time.

Test Plan: No tests atm

Reviewers: evan, juan

Reviewed By: juan

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3435",False
b8c16594dbfad4e22ed2d87b379d342de074cb13,2016-11-17 05:35:48,Evan Morikawa,feat(menu): new `hideWhenDisabled` flag for custom submenu items,False
c8c0e568c958ce6162aa3feda0baed859825fcf3,2016-11-17 05:30:56,Evan Morikawa,feat(plugin): don't show `isHiddenOnPluginsPage`,False
8f1c12466a68ca28815ba3c4fc7e3adb0457bfc3,2016-11-17 05:23:16,Evan Morikawa,feat(menu): completely remove top-level menus from optional plugins,False
220acc4a5834f6d445433a4b6bf5d2025afb5759,2016-11-17 04:48:11,Juan Tejada,"fix(spellcheck): Minor perf improvements

- When applyign spellcheck mutations to the dom, toggle display property
on the contenteditable to reduce reflows/repaints while mutating
- Debounce provideTextHint to reduce work on each keystroke
- Minor speedup checking existence of keys in spellchecker internal maps",False
ff79d81bfa8c18ad3f99d8f59cb6c52454c1ae04,2016-11-17 04:10:44,Evan Morikawa,feat(link): enable the clicking of nylas: and calendar: links in N1,False
f2216d5230960f6da49d95154c2aaa96d00a4a04,2016-11-17 03:05:12,Evan Morikawa,feat(autolinker): linkify nylas: commands,False
29f658afb94f932d6dafe746e48553f0fbc19ac9,2016-11-17 01:31:05,Evan Morikawa,feat(link): nylas:// plugin links notify when turned on or off,False
b8027380997e733aafd208520bc7ed537db2221c,2016-11-16 07:20:21,Juan Tejada,fix(cal) Fix backspace in event-search,False
06db5a95ac38414789b2631cf6bbd2e865888fa4,2016-11-16 06:57:31,Juan Tejada,"feat(event-search): Add event search to calendar

Summary:
This commit adds the ability to perform event search in the calendar window.
To achieve this, SearchBar has been moved from the thread-search package to be a part
of the nylas-component-kit, and reused by both thread-search and nylas-calendar

When an event is selected from search results, the calendar view is moved to the selected
event. Depends on D3396 to open the event popover.

Test Plan: Manual

Reviewers: halla, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3424",False
d95756ba98e899e417abf8a9c3d88cbf62a06bff,2016-11-16 06:34:43,Ben Gotow,fix(inline-attachments): Handle images with UTF16 names,False
dd7f24d343247ab006d6a917d468c586dc9e5517,2016-11-16 06:27:07,Ben Gotow,fix(tokenizing-text): inputValue === undef error,False
30a8ab613b7f086afe7369fd2819d27600e9d16e,2016-11-16 06:19:11,Jackie Luo,lint(eslint): Update to new rule names,False
97c0e7f9f8e521ef78d28131265a272bf61d505b,2016-11-16 06:02:49,Ben Gotow,fix(calendar): Move quick-add button into toolbar,False
8e1b360036e2827492aeac29a85d46328b15cc09,2016-11-16 05:32:56,Ben Gotow,fix(calendar): Use ScrollRegions so win users know you can scroll,False
fd512adb7f5976d3cd46a7846fb846f9a9da1b46,2016-11-16 03:34:07,Jackie Luo,:art:(calendar): Clean Exchange event titles,False
9fd8b38a4bc6dcbfd6da512290e4093946b9cbce,2016-11-16 01:41:21,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
151348124515fb8e877d679b5b8d7cbe32a67019,2016-11-16 01:40:35,Jackie Luo,:art:(calendar): Fix overflow for event names,False
858e3a99c2ba216a40593f1bd01c315c9d029e75,2016-11-16 01:38:44,Evan Morikawa,feat(tokenizing): allow tokenizing text fields to accept a defaultValue,False
9656025532d1c83c92daccef82d9f3fee512c476,2016-11-15 23:50:39,Evan Morikawa,fix(lint): update files to for new linter version,False
808b6b0e5b36a1ae7b27600c1873d3f9d921c86e,2016-11-15 23:26:39,Evan Morikawa,feat(lint): upgrade linter and add exceptions for dumb new rules,False
04435287f014e603cb799711cc397f4ea981db10,2016-11-15 22:52:46,Evan Morikawa,feat(lint): add eslint_d to package.json,False
073427f3b2ed0fba3dc58bdb9c5aba32e26a546a,2016-11-15 04:54:44,Halla Moore,fix(tests): Make selectedEvents default to [],False
714506635498f510a522f0c7e333998253b15dbc,2016-11-15 03:31:00,Evan Morikawa,fix(contact): only limit length if too long,False
387c157a55a237563c999e10f9072cfe4ef5a48c,2016-11-15 03:31:00,Evan Morikawa,feat(composer): render suggestion via custom component,False
211f0a65c6ad2f580058984e09f736a74819e32c,2016-11-15 03:31:00,Evan Morikawa,feat(composer): allow extensions to composer participant searching,False
177edc7f47ad53ddec816ad976a89b37648e8d09,2016-11-15 03:31:00,Evan Morikawa,"fix(search): Don't re-query search results on status change

If that method is fired immediately twice in a row, it's possible for
this._set to not re-instantiate causing the results to be blow away",False
8eb63040b33264542c11e2d6573acee028be9554,2016-11-15 03:31:00,Evan Morikawa,feat(search): support search extensions,False
e942b914e6b9947ad0ffc04bdd384b233d40f275,2016-11-15 03:31:00,Evan Morikawa,refactor(search): extract generic ModelSearchIndexer,False
f9756c2f1d0e2d792fc7d972896cadb05949c2e9,2016-11-15 03:31:00,Evan Morikawa,refactor(registry): move all registries into src/registries,False
8918778a7563297f2aa3abd5bf21a1cb319e10ec,2016-11-15 02:39:42,Halla Moore,Bump submodule,False
a0a5f6efce0602a3fa0e2da016647f198a7ceef5,2016-11-15 02:03:19,Ben Gotow,fix(build): Run the linter before build on CI machines,False
f0586181a3d2778dd4d74c7ee788a946545529ca,2016-11-15 01:51:29,Halla Moore,"feat(calendar): Add functionality to create/edit events

Summary:
Add some basic functionality for creating and editing calendar events

This is a weird work-around diff. Original review is at
https://phab.nylas.com/D3396

Test Plan: manual

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3426",False
3f51d09af11e2a65d4e21bc0d305ec4545c0b2ed,2016-11-15 01:25:45,Evan Morikawa,fix(composer): don't create bullets after text insert,False
be795e4b59ac7e7b8f8f37a171b92c8fa2c99ea4,2016-11-15 01:25:37,Evan Morikawa,fix(quote): fix more cases of unwrapped signature detection,False
7227af23fb19385942a94be8d81c3fd6f963ad0e,2016-11-15 01:25:31,Evan Morikawa,fix(quote): catch Office 365 quoted text case,False
77523d4cdb2144e61f82f87a460fcbe035bf2e10,2016-11-15 00:23:47,Joris Pelgröm,"Rename Google Apps to G Suite in onboarding (#3047)

Google renamed Google Apps (both 'normal' and education editions) to G
Suite on 2016-09-29. See
https://blog.google/products/g-suite/all-together-now-introducing-g-suite/
for the announcement. Updated text for account selection to match Google's
branding.",False
5769898abc9afbcef17d1772b6abb453f5ffebeb,2016-11-10 05:28:57,Ben Gotow,specs(spellcheck): Ignore on linux due to dict downloads,False
ac70c95eb0aef540670b922d51349b7d6b32a84a,2016-11-10 05:21:05,Ben Gotow,fix(docs): We no longer support Node 4 for building,False
eb5777ce97265cb9d8d1c8edfb8961b5d6840f16,2016-11-10 04:46:44,Ben Gotow,fix(readme): Remove readme to prevent overwriting on script/bootstrap,False
06663299cc6dcdba84c3fa2071fd18f1e90e2568,2016-11-10 04:37:44,Ben Gotow,fix(main): Print notice if exiting due to makeSingleInstance,False
4345d9810918ea491cfcb6c8f1648e81a49f3267,2016-11-10 04:37:30,Ben Gotow,"fix(spellcheck): Wait longer, electron-spellchecker actually downloads dicts",False
e3fa1d390125d58cf2b03bbcb6ab07a6522bc79e,2016-11-10 04:10:41,Ben Gotow,fix(builds): AppVeyor can cache node_modules too,False
9dc4e8f3a28687973be4bffec6a7b4abf46762b0,2016-11-10 04:10:27,Ben Gotow,"fix(builds): Stop when tests fail, use Appveyor build phases",False
7b84217c87ff3dd65fd177ae1b924ffc0395dfed,2016-11-10 03:58:42,Ben Gotow,deps(pro): Lift deps out of packages for simpler install / better deduping,False
c5d5b4e3c6a8e01506618a9ef00464340af5feb6,2016-11-10 03:54:10,Ben Gotow,deps(*): Lift deps out of packages for simpler install / better deduping,False
85d9c454fe7df0e173b7b5e31f077d7c2d54f2e1,2016-11-10 03:43:09,Ben Gotow,"ci(*): Travis and AppVeyor changes, script cleanup

Also removed 32-bit build files which have been made obsolete. You can build 32-bit builds by altering script/bootstrap to specify a different arch",False
64450fb51b91990a410e3486e87d5430eb5786e3,2016-11-10 03:22:37,Evan Morikawa,fix(contact): Have Focused contacts immediately available,False
e89fd364b4706b4a0d9972a1c4ce2fa131eaa4c6,2016-11-10 03:22:10,Ben Gotow,"build(*): electron-compile, electron-packager instead of custom tooling

Summary:
This diff removes significant cruft from N1's compilation and build tooling:

- Electron-Packager replaces most of the code in build/tasks/* used to copy things,
  bundle things, download electron, etc.

- script/bootstrap has been replaced with a much simpler script that does not use
  APM, does not download Electron (we just use electron as an NPM dep) and does
  not manully compile sqlite. It requires NPMv3, but I think that's safe.

- babel and eslint are now devDependencies of the main project. The main project
  also supports optionalDependencies now.

- npm test and npm start replace ./N1.sh

- APM is still around, and is only put into N1 so it can install plugins at runtime.
  It should be removed as soon as we notify package maintainers and have them provide zips.

- N1 no longer has it's own compile-cache or babel/typescript/coffeescript compilers.
  It delegates to electron-compile and electron-compilers. Both of these packages had
  to be forked and modified slightly, but I'm hopeful the modifications will make it back
  in to the projects and you can still consult their documentation for more info.

  + In the near future, I think we should stop shipping electron-compilers with N1. This
    would mean that all plugins would need to be compiled on pre-publish, just like NPM
    packages, and would complicate the local development story a bit, but would make the
    app smaller. electron-compile is not supposed to compile at runtime in the prod app,
    just pull from the compile cache.

- I've re-organized Grunt according to Grunt best practices, where each tasks/* file
  specifies it's own config and imports grunt tasks.

- Unfortunately, I was not able to use any open source projects for the deb and rpm builds,
  because we have things like postinst hooks and start menu items which are not supported
  by the electron installer-generators.

WIP

Turn off all LESS compilation, because themes. Doh.

Use Grunt for new build process too, just remove tasks

More changes

Add babel-eslint

Remove unused react-devtools

WIP

Add name

Ignore nonexistent

Switch to more modern approach to config for grunt

Move zipping to mac installer task

Restructure publish task so it aggregates first, can log useful info if publishing is disabled

Fix build dirs

Fix win installer

Fix linux installer

Fix linux installer

Try making linux

A few more

Updates

Upadtes

fixes

fixes

Get rid of non-meaningful variables

Resolve assets path

Insert nylas.sh

Clean up args more

Actually use description

Fix display name ugh

More tweaks

Expliclty write /usr/bin/nylas

Improve vars

Use old nylas.sh

Reinstate APM to better scope this diff

Test Plan: Test on Mac, Windows, Linux

Reviewers: evan, jackie, juan

Reviewed By: jackie, juan

Differential Revision: https://phab.nylas.com/D3411",False
79d77ab14d86e5962801ae7e3178fd58f3ba5047,2016-11-10 03:17:38,Karim Hamidou,"[fix] Don't make undo-send so ridiculously fast

Summary: I almost need at least 30s to proof-read an email.

Test Plan: Looked at the code.

Reviewers: bengotow, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3412",False
26c9fffdca89491db3a382d66d3e56baf6960d04,2016-11-10 01:06:13,Juan Tejada,"fix(send-and-archive): Don't validate defaultSendAction key in config (#3031)

Before this commit, opening a new composer window would reset the
default send action to just `send`, even if you had selected it to be
`send-and-archive` via preferences.

This happened because on window initialization we run a config schema
validation, and coerce any values that are not valid under the schema
(e.g. make sure that the value for a setting is one of possible values specified
in the enum). Given that the schema is static, but the values for the enum for
this particular setting are dynamically calculated when we render the selector,
it doesn't make sense to validate the values for this setting.

To prevent validation, we just need to remove the `enum`, and `enumLabels`
from the static config-schema.",False
83e927209179a6105bac5fbfe4d4fa099f49a1ea,2016-11-09 22:52:46,Evan Morikawa,"fix(form): say ""Create"" instead of ""Submit""",False
297072dd6e4fd6905ebfe9304a96846799827fec,2016-11-09 22:42:58,Evan Morikawa,feat(thread): add method to return unique participants by email,False
e2289fba18f765b510177ae8390d1b15944ec978,2016-11-09 03:42:28,Juan Tejada,fix(menu-icon): Make sure to only show unread state when unread counts have actually changed,False
d6ed956907eddb45db17d1e23427de3193da2975,2016-11-09 01:24:19,Ben Gotow,fix(image-editing): Fix selector for finding <img>,False
0c378f83feed7da55df775d08491039dee9163fa,2016-11-09 00:36:23,Ben Gotow,fix(notifs): Re-display notifs with the same tag on macOS,False
03cccbeab4156f2335f7081e103f351828aaff02,2016-11-08 23:10:35,Evan Morikawa,bump(SFDC): show related sub objects above thread,False
2950695ccde51dcdbbbfe2a6d9e15a78d08c88de,2016-11-08 04:05:38,Juan Tejada,fix(send-and-archive) Make sure package is registered in work window so PerformSendActionTask can find it (#3023),False
7187072b9cf66e2a6095120fb61cdffde01509e2,2016-11-08 03:46:50,Juan Tejada,bump(version): 0.4.204,False
8da1407dd0648553314bed1357f3bfa9fdb69235,2016-11-08 03:44:45,Juan Tejada,fix(attch-preview) Properly escape paths for qlmanage,False
51654eca1f499d5ab230df529bdcd2666c0a7fd6,2016-11-08 03:42:53,Ben Gotow,fix(local-sync): Display relevant error so users can debug,False
5459b283d7703e6a9f5e73139c76ce1ac583f2bc,2016-11-08 03:39:47,Ben Gotow,"fix(newsletter): Use bound functions for callbacks, always.",False
18ec8c38e8f7fd08f37c603f686dc6b978e8802b,2016-11-08 03:39:47,Ben Gotow,fix(*): Resolve Sentry #42679 with nylas-observables,False
abb9dd7c209dcdb35ea244a12e0a0267488eee58,2016-11-08 03:39:47,Ben Gotow,fix(mailto): Improve handling of invalid urls,False
ae4d766b8c85e2935a32cf25f5e7047e3eef82cd,2016-11-08 03:37:15,Juan Tejada,fix(attachments-preview): Account for pound sign,False
1a6bd847867719fdc3f9cb1263cc2ac7921866e2,2016-11-08 03:14:25,Evan Morikawa,fix(package): bump package migration version to match release version,False
3c1a072de4287ce9e95acada30f5b3d6640927a1,2016-11-08 01:45:47,Juan Tejada,fix(specs) Fix date-utils specs,False
7cd1088baa1f36a2eb9e7f104d68ff1aa0b772a0,2016-11-08 00:12:18,Juan Tejada,update(changelog),False
0e0167a5e0f944bb81bba628286ff188ddbac7b9,2016-11-08 00:10:41,Juan Tejada,"fix(build): Remove node-mac-notifier temporarily

node-mac-notifier build process is currently breaking. This will be
fixed when we revamp the build process, so for now we are punting the
node-mac-notifier feature",False
3105df07d75c7e4813139e39b96a38122361ef4e,2016-11-07 23:19:25,Jamie Wilson,"(darkside) fixing composer fields spacing (#3020)

* fixing composer fields spacing

* updating attachement selector names",False
a21e333a46ab4860257981dcbc291342fd70da53,2016-11-07 23:10:53,Ben Gotow,fix(build): Don’t dedupe when installing mac-notififer,False
1a6a62b7b7251f659927671b6e656805534bb93f,2016-11-06 00:26:23,Evan Morikawa,fix(spec): fix DST related spec failure & linter error,False
88ba82d7ff105ffdc482d1e6e18d41f0d8982759,2016-11-06 00:14:19,Evan Morikawa,fix(plugin): use config since `activatePackage` doesn't persist,False
f97905567bd5c9a559002b9c596811b99333d89e,2016-11-06 00:07:11,Evan Morikawa,fix(unload): safely unload the task queue on quit,False
c792b363583996211e928111fcea2ab90f03be1b,2016-11-05 23:53:14,Evan Morikawa,feat(plugin): activate & deactivate plugins via a nylas: url,False
274091eb36dcd85f232a74181f23d334cc56acbd,2016-11-05 09:15:25,Evan Morikawa,feat(quote): improved quoted text detection for trailing signatures,False
e00c4c802259e5f6b32018e16d12963913c6b693,2016-11-05 07:09:37,Evan Morikawa,"fix(quote): properly detect ""wrote: "" strings with trailing space",False
8836e9a1ab0e4396858eaf3780d73010f05f1e46,2016-11-05 06:58:11,Evan Morikawa,convert(es6): quoted-html-transformer to es6,False
8464cd58e743addd224c127e3adce365608d4d11,2016-11-05 05:19:20,Juan Tejada,bump(version): 0.4.203,False
3a8ca13d10df30cdc096ecfe71838a964c7df3e2,2016-11-05 05:00:28,Jackie Luo,feat(notifications): Allow notifications to be dismissable,False
90d923913bdc2e81ec368193d7d95707afd39899,2016-11-05 04:14:30,Juan Tejada,"feat(requests/send): Add mechanism to ensure that a req be sent and succeeds only once

Summary:
This commit adds a new option to NylasAPIRequest api to allow users to
specify requests that should only ever be executed once, once they
succeed. This is done via saving a hash of some of the requests
properties to the filesystem.

Specifically regarding send, this ensures that a draft never be sent
twice from N1. We ran into this case once when the final state of the TaskQueue
wasn't saved to the database before the N1 app closed. In this case, a
PerformSendActionTask that was supposed to be dequeued, was restored to
the task queue again when N1 restarted, causing the draft to be sent
twice.

Test Plan: Manual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3407",False
b9939d54ebc0ed646929abe2d31dc1530885a379,2016-11-05 04:00:49,Juan Tejada,"fix(task-queue): Save the task queue before closing the window

Summary:
Save the final state of the TaskQueue to the database before window
gets unloaded

Test Plan: Manual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3408",False
061d49d537d79f392a94ca49ec8b2001017f40bd,2016-11-05 03:37:14,Evan Morikawa,fix(lint): fix linter errors,False
8f4d046b412aa74beebf5d9af6626ec6bec4d6d5,2016-11-05 03:30:28,Evan Morikawa,bump(submodule): update UI & SFDC,False
10f05246af44a237453122342ae4f97a89e1cb1c,2016-11-05 03:15:45,Juan Tejada,:lipstick:(reminders) Add title to reminders header,False
35e98919115304f8e38d850adcc43de57e2ed464,2016-11-05 00:02:14,Ben Gotow,fix(darkside): remove notifications shadow,False
3ff556f4efb46517db9d4b4d6e20373baacaf3cf,2016-11-05 00:02:14,Ben Gotow,fix(prefs): Only scroll to top when switching tabs,False
82c267307ac1e0fd7bfd27086c5e7cc5cd029bf2,2016-11-04 23:52:51,Evan Morikawa,bump(submodule): update SFDC,False
125be77968da49e7b2a4125fd837cef50b27f2f5,2016-11-04 23:42:51,Evan Morikawa,fix(form): support cmd+enter and not optimistic submission on all enter,False
6c6e7d3f5361eac67fa896e6001c940c368d2430,2016-11-04 23:35:14,Ben Gotow,"Revert "":lipstick:(messages): Remove email-frame max-width styles""

This reverts commit c926f6144b540f4027929a3ce274da0daa594c2e.",False
daffee5bb6c4340024d48450489cd0369bb5c116,2016-11-04 23:33:22,Halla Moore,"Revert "":lipstick:(messages): Remove max-width styles""

This reverts commit d7c79f5d5c6f3a91c1392a63ac599816bc3b43e5.",False
c926f6144b540f4027929a3ce274da0daa594c2e,2016-11-04 23:31:16,Ben Gotow,:lipstick:(messages): Remove email-frame max-width styles,False
fc9c0bb08be848ee3f889990c160e1aed657262a,2016-11-04 23:28:34,Ben Gotow,fix(composer): Check for empty as well as original body,False
fa661b4f469933ab457b11e1392177921164ee65,2016-11-04 23:28:34,Ben Gotow,fix(gh-sidebar): Don’t customize <h2> styling,False
d7c79f5d5c6f3a91c1392a63ac599816bc3b43e5,2016-11-04 23:22:51,Halla Moore,":lipstick:(messages): Remove max-width styles

Although some word-wrapping may look better at 800px, it looks much worse
when we can't properly display html emails that are meant for a wider area.
It also just seems a little weird to limit our users in this way.",False
aae737e3cdedf70514fa11942a7d02a7938ffe8e,2016-11-04 23:20:10,Juan Tejada,"fix(search): Prevent duplicate results from search query

This is a temporary fix which adds defensive code to prevent duplicate results
from being returned from the thread search query which causes N1 to enter a loop
and freeze (#3001).

Duplicate results from the search query likely indicate that a thread
was indexed twice, which was not the case before. The cause for this is
still at large.",False
b612c9356427bbaf417719491207fa7f773e023f,2016-11-04 22:59:59,Ben Gotow,fix(theme-picker): Regression in design of theme picker,False
fd135377587fe9d6c6477a6f36236df4b5ff76e4,2016-11-04 22:59:59,Ben Gotow,fix(mac-notifier): Manually install on darwin (for now),False
018ee4e98de33f60f2d51cfde4b82d53be9aa64f,2016-11-04 21:58:55,Evan Morikawa,"fix(form): Have submit button say ""update"" when necessary",False
6ef08a1f316e6b267d26da32f43ef6d40955b9ac,2016-11-04 11:37:47,Juan Tejada,:lipstick(sidebar): Update reminders icon:,False
35e344d525787d8f5c57266c8f4d762f402070ac,2016-11-04 11:32:15,Juan Tejada,:lipstick:(attachments): Fix file attachment styles,False
c974e7c8d0308a7a2b3fe7dffc20fe1bb243550e,2016-11-04 06:56:11,Juan Tejada,fix(attachments) Add default value for filePreviewPaths in case they are not provided,False
2e54d01a4ebbcf8930439ca0bc244b0b7bc0d5b5,2016-11-04 06:25:40,Juan Tejada,"fix(attachments): Fix several bugs in attachment components

- Fix several styling issues
- Adjust the generated size of the thumbnail preview to fill all of the
available space",False
e3cfea3c5681f28c38df835447d415ab150c461c,2016-11-04 06:24:47,Ben Gotow,fix(decorators): Carry container config through decorators,False
3f9fa85f7b391dcfd3a11ac2501748db33c833bc,2016-11-04 06:22:10,Ben Gotow,fix(popovers): Don’t apply minimum width to all,False
a67b39e8603e2969f74ff474010d5073db5e092c,2016-11-04 06:12:20,Ben Gotow,fix(auth): Add partition back to webview,False
daecdd1fdacabb2d000a35d3f5a9bf9797202cb8,2016-11-04 00:01:58,Evan Morikawa,fix(travis): PUBLISH_BUILD only on mirror,False
ec6c8add9f85777c95c9e0e2183a7f7e4b9f7c83,2016-11-03 21:48:54,Juan Tejada,update(changelog),False
28896286d5e3f59b3f5c653258e7eb73efca1753,2016-11-03 21:27:11,Evan Morikawa,fix(spec): bump submodule spec fixes,False
aa8b91d508e17d469921256909518599478aad41,2016-11-03 12:38:55,Juan Tejada,fix(lint),False
aedd6de90234174f03ae8ebcdc22b3e7884cecbd,2016-11-03 06:33:56,Evan Morikawa,fix(plugin): remove from plugin list,False
9ccf2079b44de09efaf0eb585f503d751ffafa86,2016-11-03 06:33:31,Juan Tejada,bump(version): 0.4.202,False
a3b6723e319f68d3a4de5be7a949262183cd413b,2016-11-03 06:15:12,Halla Moore,"feat(cal) Add a mini month view to the corner of the calendar

Summary: Title says it all!

Test Plan: Manual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3373",False
e476c03f3b2f0501b27c4a2626f6c8e26492370d,2016-11-03 06:13:56,Evan Morikawa,fix(form): add currentFormValues to GeneratedForm,False
330bb55e80aed3dbfcfd6e9e15a1f760d381541c,2016-11-03 06:03:32,Juan Tejada,bump(version): 0.4.201,False
18fe94ab72fb381f662c5672b011851a6ff3abfb,2016-11-03 05:57:53,Juan Tejada,"feat(attachments): Generate and display thumbnail previews for files (mac only)

Summary: Adds option to view preview thumbnails for attachments. This commit updates the FileDownloadStore to generate file thumbnail previews for attachments via `qlmanage` and displays them in the AttachmentItem component.

Test Plan: Manual

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3393",False
e583573ad5421928bdbf8d28dcb4476dccd43066,2016-11-03 04:26:27,Jackie Luo,fix(email-frame): Refactor if/else for frame height,False
60c0e6a3221bb505b060163c74bfada71805ef84,2016-11-03 04:05:58,Jackie Luo,fix(email-frame): Revert to body scrollHeight if documentElement's is zero,False
ee6faa236ce96c02d8e09ce79c61820c628111e6,2016-11-03 04:05:58,Jackie Luo,fix(logging): Remove console.log(),False
d6a2faaf6446db3f3a5bead0368c22bc693fd14b,2016-11-03 04:05:58,Jackie Luo,fix(email-frame): Prioritize documentElement for scroll height,False
11c95871e79c078d7e15e5af3bda53425c39fc66,2016-11-03 03:24:17,Evan Morikawa,fix(travis): fix conditional check in before_install,False
47b5f744cb1ec81134549d26817db47e6a7365be,2016-11-03 02:01:30,Ben Gotow,fix(onboarding): Respect hot window dimensions,False
6f3e7fc096073ddce4d6d9d091b548204a780933,2016-11-03 01:43:16,Ben Gotow,"fix(search): Rename package, fix column naming issue",False
f55d9962eabd0c03bfe35c917dddebb007032837,2016-11-03 01:33:28,Ben Gotow,feat(search): Fix slow queries with FTS5 on Contacts,False
692cfebb1740e54757991e306d97fbfeaf19dbb7,2016-11-03 01:32:31,Evan Morikawa,"fix(travis): Fix travis build script

fix(travis): Fix travis error

add debug to travis

bump(submodule)

Silence",False
da6636de303925a691fe1417b082d444a80331b9,2016-11-03 01:10:01,Halla Moore,"fix(decaffeination) Remove second arg from some slice calls

Decaffination replaces someString[index..-1] with
someString.slice(index, -1 + 1), which is bizzare. This commit changes those
instances to someString.slice(index).",False
b4d7865121eee11012ae3022c98478a1674281bf,2016-11-03 00:56:45,Evan Morikawa,fix(travis): Fix path to encrypted files,False
32b5f684f3623b87742bbd4d7b5781919bc3cebf,2016-11-03 00:53:19,Evan Morikawa,feat(travis): allow builds on mirror,False
3de919b221fc60e5aa4e9a4661cf68a739217d9e,2016-11-03 00:45:31,Juan Tejada,"fix(selection): Add index to Contact table to improve perf when selecting threads

Thread selection triggers a query on the Contacts table by account_id,
email and name. Add an index to improve this query",False
0d4b080d6403669570ba0ae5382fe47d89b4fc9e,2016-11-03 00:28:34,Juan Tejada,bump(submodule),False
1b775cf89c3e0aa5719cd1713199f6bfdf687959,2016-11-03 00:16:28,Juan Tejada,fix(specs): Add regression test for list-selection,False
f76edb44f873056262c51ff8238d1af46b601e48,2016-11-03 00:08:26,Halla Moore,"fix(email-frame) Only use documentElement scrollHeight if it is taller than body

There are cases where the documentElement has a scrollHeight of 0, even if
the body has a larger scrollHeight. Before, we were always using the
documentElement if it was present. Now, we use the maximum scrollHeight.",False
6e05db199bfeea7904c22384c44e7af857ce9c14,2016-11-03 00:03:01,Juan Tejada,"fix(list-selection): Properly iterate over the selected indexes when expanding selection

This commit fixes a bug in which you couldn't shift select threads from
the bottom to the top (i.e. select a thread, shift-click a thread on top of it
would not select the range of threads).

This bug was introduced by a translation from coffeescript to JS.
Specifically, by converting

```
for idx in [startIdx..endIdx]
```

to
```
for (let idx = startIdx; idx <= endIdx; idx++) { ... }
```

The coffeescript range syntax for `[x..y]` automatically generates the
correct range when x > y or when x < y, generating a descending or
ascending range respectively.
However, our transaltion simply iterated ascendingly from `startIdx`
to `endIdx`, which would be a no-op when the `startIdx` was greater than
the `endIdx`, which was the case when shift-selecting threads from bottom to top.",False
c9b226a7271c1c5e22457afbff7d75c10724c25d,2016-11-02 23:49:35,Evan Morikawa,fix(forms): fix window launcher and gen form,False
48063e0013ec07a36c8866ab7b76b7c2cad6174b,2016-11-02 06:42:24,Juan Tejada,fix(es6): Convert FileDownloadStore to JS,False
474b9edadc7884fcfad0374af7c899f3d9dfc612,2016-11-02 04:43:42,Juan Tejada,"feat(attachments): Add ability to preview with quicklook (mac only)

On mac, you can now preview an attachment by clicking on the new preview
icon, or by pressing space bar when an attachment is focused.

This commit also updates the styling for attachment items and adds the
ability to focus attachment items. We don't keep any focused state, just
the browser's, which means you can focus attachments by clicking, or
tabbing/shift-tabbing",False
6e3f9aa9f1949a96ef4b564e0d85c266dbfc1095,2016-11-02 00:16:47,Halla Moore,"fix(sidebar-notifs): Set containersRequired on the notifs-wrapper

Switch from manually setting containerRequired to false on each individual
notification to setting it on the InjectedComponentSet within the
notifs-wrapper. This way, people adding new notifications don't need to
remember to manually set it themselves.",False
39a968f3998d86c77632314c79667634435bf4ff,2016-11-02 00:09:50,Juan Tejada,"fix(reminders): Add missing assets, ui cleanup, restore dead code

Summary:
This commit adds a couple of missing assets, including the icon for the
plugin list and other misc icons. It also switches to the new UI where
we use the thread timestamps to display the reminder date in the
Reminders perspective instead of using mail labels. It also adds a
header to the threads inside the reminders perspective to indicate that
a reminder will be triggered if no one replies to their email.

It also adds a header to indicate when a message has been brought back
to the inbox due to a reminder based on sdw's designs.

Finally it restores some code that magically disappeared when landing
reminders + other misc cleanup

Test Plan: Manual

Reviewers: bengotow, halla

Reviewed By: bengotow, halla

Differential Revision: https://phab.nylas.com/D3388",False
c7fbd158126ae6a78b37f872288937b53ce4ef53,2016-11-01 22:31:11,Halla Moore,"fix(menubar): Add missing not operator

Menu items could not be opened on Linux because Linux allows menu items to be
disabled, and the logic for determining if a menu item should be enabled was
accidentally negated during coffescript conversions.",False
879c74723037f34ce092ae9025aea5d095fbcdb4,2016-11-01 05:56:20,Juan Tejada,":art:(attachments): DRY and cleanup attachment components code

Summary:
The attachment components were the only React Components which used
inheritance between components, which is an anti-pattern in react. I
deleted these components in favor of new purely functional/dumb
components exposed via the component-kit: Attachment Item and
ImageAttachmentItem. These are defined in the same file to reuse some
smaller components between them, like the progress-bar, etc.

The attachments pacakage still remains, and only registers a single component to
a new are called MessageAttachments. This InjectedComponent role is
shared by the Composer and MessageItem, and is the only reason this
exists as an injected component in a separate package.
MessageAttachments renders all image and non image attachments for a
message or draft, and binds the appropriate actions for removal, downloading, etc.

The composer still used FileUpload and ImageUpload components for rendering
uploads in the Composer (i.e. when you add an attachment (these are
different from files because they aren't saved until the draft is
sent)). These 2 components were pretty much copied and pasted from the
ones in the attachments package, with subtle differences-- I got rid of
these as well in favor of the new AttachmentItem and ImageAttachmentItem

Also convert more coffee to ES6!

Test Plan: Unit tests

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3381",False
1ca7ad91f8f5f3e904f73c76c54230d2da8334b8,2016-11-01 04:57:16,Evan Morikawa,fix(DB): turn debug logging off,False
6f1518548663e719ee3626233326e94711768dd2,2016-11-01 04:54:23,Evan Morikawa,feat(DB): Revert to schema version 23,False
010706a754d0e4b18d10341a7ced0b5d4b9b7569,2016-11-01 00:22:21,Michael Pfister,fix(task): fix typo during error check,False
38d7e4f01389c810f5ce23e9b55414c07cc72b87,2016-10-31 23:12:36,Kevin Jose Martin,"Fix this line on non-POSIX systems, such as Windows (#2996)

Per: https://github.com/nylas/N1/commit/f8f0cb206f53183698ee1648a7a789bfbf2598ac",False
f8f0cb206f53183698ee1648a7a789bfbf2598ac,2016-10-29 04:03:38,Ben Gotow,fix(fd-limit): Increase FD limit to 1024,False
cccec14d0af626b5b66d064033e2794380881ad9,2016-10-29 02:26:24,Evan Morikawa,fix(linter): fix linter errors,False
078b37e4414c27f6789d26b4474cb327b2148228,2016-10-29 02:19:10,Evan Morikawa,"fix(channel): only show stable or beta

Or the salesforce channel if you've ever used it before",False
8f9aade3d0f2b49550306dba1b9e8010f41ae4a0,2016-10-29 01:57:30,Evan Morikawa,fix(build): fix codesign step,False
815e78db3c42ef78c80701d36660d67c799efa25,2016-10-28 22:53:26,Evan Morikawa,bump(SFDC): fixes to object pickers,False
335050a7eae6c1731164838b8238dbe1090b8832,2016-10-28 20:58:50,Evan Morikawa,fix(build): fix gruntfile error,False
47784fb8f9f71966f39d901d1d7b960701ee8586,2016-10-28 20:38:09,Evan Morikawa,fix(build): remove dmg task from build,False
29bfd8dc1d1263f59e582285dfed6882a67784b8,2016-10-28 20:07:59,Evan Morikawa,fix(build): bump AppVeyor to build with Node 6.9 from 4.2,False
13c69ab4998c671c4bd91c7eeccb3487c2f67914,2016-10-28 19:39:42,Evan Morikawa,"fix(travis): build with Node 6.9 to fix npm build issue

Travis on Node 4.2 can't succeed installing the build folder with npm 2
due to a peerdependency issue that doesn't happen with latest node and npm",False
e8e6099005b5a1f0270eb5efba688cf1d8a53acf,2016-10-28 19:29:41,Evan Morikawa,fix(es6): fix linter and compile error in es6 conversion,False
429ab7e95c9b98a4d486d15960a58c4c04372cea,2016-10-28 19:25:41,Evan Morikawa,bump(SFDC): Update to latest SFDC fixes,False
f05c745deea1b93f63575b09affebe964c923450,2016-10-28 07:18:33,Ben Gotow,"es6(*): Actions, ConfigSchema => ES2016",False
03d4e7525b13ac1b2003e9c13b69904d6a1e3f56,2016-10-28 06:55:30,Ben Gotow,"es6(*): Misc components, nylas-exports => ES2016",False
f9ac1624576862b1c6f3e57760a33c77369ceb1d,2016-10-28 05:58:36,Ben Gotow,es6(composer): Composer extensions => ES2016,False
89d17d55575daa6e4ab451007725cc6080c7d54f,2016-10-28 04:01:27,Ben Gotow,"fix(tooltips): comp. w/ tooltip must be conditionally rendered

Also update tooltips to support functional components.",False
31dfa2d5e4c512bdda8d62ecd30a2992c85b266f,2016-10-28 03:36:51,Ben Gotow,lint(send-action-button): Whoa nylaslint just chill 😂,False
fa069277d3391bc7ebf0c45bbfcd35dd32d954e7,2016-10-28 03:14:33,Ben Gotow,fix(mac-notifier): Make macOS-only package optional,False
6a25f7afdf571ade29d7428f83eb4b1595edef2e,2016-10-28 01:14:22,Ben Gotow,fix(spec): Apply jasmine styles to windowed specs,False
858a41db333e065f01b6c2803c8d72b0a1526216,2016-10-28 00:54:13,Evan Morikawa,fix(spec): let ./N1.sh --test=window work,False
8323b3d9af2180cdbc3963b708b450a0286e1b13,2016-10-28 00:38:59,Ben Gotow,es6(*): Misc src to ES2016,False
ceb1eb90fa92d027faad58cfa6de3f0f0eb6fcbd,2016-10-28 00:38:59,Ben Gotow,es6(*): Small components from shared library => ES2016,False
b9dbba2bf8b296f75e2d5e66cf6f73e84687c6d5,2016-10-28 00:38:59,Ben Gotow,"es6(list): ListDataSource, subclasses => ES2016",False
bd0ec9986b7d31c1b5c9be24fab62423aec3c6a9,2016-10-28 00:38:59,Ben Gotow,"es6(models): Remaining models => ES2016

# Conflicts:
#	src/flux/models/contact.coffee",False
bee782b6d6ee7489b76d5ebb708e8944a37c5afd,2016-10-28 00:35:02,Juan Tejada,fix(warnings):Fix react warning caused by decorator,False
fdde68f574ef4144f0610525690f9fe817af9688,2016-10-28 00:14:19,Juan Tejada,fix(specs): Fix remaining broken specs,False
dc4c9f42b59b3fd9543b6628c8e2f7cd6a7e8ba8,2016-10-28 00:05:37,Juan Tejada,fix(specs): Fix date input specs,False
4644077141127844e229a7b3e84522f0df12287a,2016-10-27 23:10:20,Juan Tejada,fix(specs): Fix draft-store tests,False
7002e566112b13255336a4d464d09736cbdddfe0,2016-10-27 21:32:45,Evan Morikawa,fix(token): Fix placeholder & style issues in tokenizing text field,False
d92a6a5808049508eedebee1b29e10a0fe371dbe,2016-10-27 21:31:37,Juan Tejada,fix(warning): Don't attach ref inside decorator if not a `Component`,False
29e453681a723de2e2ad2cde59f16e345dcb1199,2016-10-27 21:19:29,Juan Tejada,"feat(reminders): Add send reminders functionality

Summary: Add reminders plugin which lets you set reminder if you don't get a reply for a message within a specified time in the future

Test Plan: TODO

Reviewers: halla, bengotow, evan

Reviewed By: halla, bengotow, evan

Differential Revision: https://phab.nylas.com/D3356",False
956fbe9a68c7d4ae79e6b5f63c5214fe41e9397f,2016-10-27 19:06:10,Evan Morikawa,feat(license): add GPL-3.0 license to package.json,False
29965d9e56cdf00d2874f3fb443bf8d2d0300bb1,2016-10-27 09:10:10,Juan Tejada,"feat(undo-send): Add undo send

Summary:
Add ability to undo send. We decided to make undo send completely client side for a couple of reasons. If we rely on send-later for undo-send, we would be giving /all/ send load to our send-later backend. If this increases the send-later load too much, it might cause delays in the regular send-later functionality and potentially other plugins like snooze that run under the same service. We would also need to rely on the network to be able to cancel a send, which would make it unusable offline or hard to debug if that specific request fails for any given reason.

This commit also refactors the way `ComposerExtension.sendActionConfig` works. The method has been renamed and now must return an array of send actions. Also, all of the business logic to handle different send actions registered by extensions has been pieced apart from the SendActionButton and into a new SendActionStore. This also enables undo send to undo custom send actions registered by extensions.
Along the way, this also fixes a pending TODO to show all registered custom send actions in the preferences for choosing the preferred send action for sending.

Undo send works via a task, so in case N1 closes before send goes through, it will still be persisted to the task queue and restored when opened again. Undoing a send means dequeuing this task.

Test Plan: Manual

Reviewers: jackie, bengotow, halla, evan

Reviewed By: bengotow, halla, evan

Differential Revision: https://phab.nylas.com/D3361",False
2faf86c2a29efdb3e13da3d0446d59297d47f46b,2016-10-27 05:18:22,Evan Morikawa,"bump(version): 0.4.200

Includes SFDC and the package migration",False
e8c425ad98cecec715f998a4c23cc91f317b9cc7,2016-10-27 05:16:54,Evan Morikawa,"feat(SFDC): Initial SFDC commit

Fixes to generated form error handling

Remove console fix css

Styles with tokenizing field and generated form

Gen form fixes for required

Gen form styles

Fix datepicker in generated form

Can compute plain text for messages

Add resolvePath. Fix bug in sidebar scoring

Plaintext fixes

Use new syntax for global plugin actions

fix(styles): fix input[type='url'] syntax error in inputs.less

Remove sendToAllWindows action

Style fix to generated form

bump(SFDC): 0.4.100

Trigger AppVeyor

Trigger AppVeyor

Add ci-build to appveyor yml

Only build mac

Publish all builds that make it to AppVeyor or Travis

Bump submodule

Update submodule to init recursively for appveyor

feat(win): add getAllWindowDimensions

bump(SFDC): 0.4.101

fix(form): generated form handles disabled inputs

Make tokeizing field editable

bump(SFDC): 0.4.102

bump(SFDC): 0.4.103

bump(SFDC): 0.4.104

bump(SFDC): 0.4.105

:art:(salesforce): Highlight prefilled fields

Form fixes

Fix prefill class

Fix z-index of fieldsets

Refactor our BoldedSearchResult component

Move and split sidebar section into thread list and toolbar

Fixing referenceTo

bump(SFDC): 0.4.106

bump(SFDC): 0.4.107

bump(SFDC): 0.4.108

Fix delete object from form

Don't show tokenizing input field borders on window

Close popover after adding existing opportunity

Fix required fields

bump(SFDC): 0.4.109

Merge submodule with master

Only store raw data for full object fetches

Use Salesforce error reporter

Refactor form and smart fields

Fix form validation

Remove DOM form validation

bump(SFDC): 0.4.110

Fix mini month view

bump(SFDC): 0.4.111

Fix Record Type layouts

bump(SFDC): 0.4.113

Fix click target

bump(version): 0.4.53 and update Changelog

fix(changelog): Update changelog to reflect latest puublished release

fix(thread-sharing): Update popover style

bump(build)

fix(thread-sharing): Find-thread, incr timestamp delta to 1min in ms

:art:(thread-sharing): Prefer url and querystring modules to parse url

fix(mail-merge): Correctly handle empty column names

fix(thread-sharing): Throw error when thread is /not/ found

fix(thread-sharing): Timestamp range in seconds

fix(N1.sh): Allow path to working copy to have spaces

bump(electron): Electron 1.4, node-sqlite 3.1.4+fts

fix(keymaps): Correctly map mod+z to undo, instead of just z (#2663)

fix(tutorial): Minor tweaks, finalized styling

Add link for Darkish theme (#2854)

Fix typo: dependencesi > dependencies (#2838)

feat(channels): Choose an update channel! Limited time only!

Summary: Just a small select input.

Test Plan: Run tests

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3282

fix(logging): Fix query logging: escape '%' properly

fix(trial): Compute “days remaining” in timezone-aware way

fix(util): Utils.deepClone properly clones dates

Merge submodule with master

bump(SFDC): 0.4.114

fix(trial): Move”days left” bar to the sidebar, new design

fix(lint): import ui-variables for linter

Refactor object store and gen form updates

feat(msg-list): Don't make participants mailto links, add context menu

fix(long-connection): Throw error for reporting, instead of just logging

design tweaks, breaking css up into files, update readme (#2858)

fix(darkside): `script/grunt lint` requires explicit LESS includes

fix(specs): Display which tests are console.logging

fix(promise): Don't use deprecated Promise.longStackTraces()

fix(error): Let APIErrors have proper stack traces

Update submodule

Revert ""fix(promise): Don't use deprecated Promise.longStackTraces()""

This reverts commit db0e025fb5e56880ffea147ad5c4dcfb37b9d830.

Bump submodule

bump(SFDC): 0.4.115

fix(specs): Fix tests that were console.logging, bump coffee-react

fix(drag-drop): Restore support for thread dragging

fix(thread-sharing): Fix unloading plugin

fix(auth): Update autofill for Fastmail.fm

fix(tooltips): Position relative to custom container for composer

lint(*): Fix issue breaking the build

bump(react): 15.3.x, warning removal, thread-sharing tweaks

es6(db): Convert attribute class declarations to ES2016

es6(db): Didn’t wait for NylasLint…

hack(channel-picker): Hide Salesforce for now

fix(accounts): Restore account re-ordering

fix(specs): attribute conversion fixed bugs, broke specs

fix(task-queue): performLocal now operates serially

Revert ""fix(task-queue): performLocal now operates serially""

This reverts commit 179d3fd78a4c817115d7013f6692834b4845d1db.

Add back in `isSameDomainAsMe`

es6(db): Query-related classes moved to ES2016

fix(task-queue): task queue dependencies are only for preceding tasks

bump(SFDC): 0.4.116

Revert ""fix(task-queue): task queue dependencies are only for preceding tasks""

This reverts commit e1e8c1cd9429b5aa20e19d4e2b8eca7215aa4a2c.

Add sequentialId check to tasks

Design pass on SF icons

fix(search/long-conn): Process results buffer before ending connection (#750)

NylasLongConnection ends the connection when the 'end' event is emitted
by the `request` object. When this happens, the global connection buffer is cleared.
Also, the global buffer holds the data we've received from the connection, and
whenever we receive new data, we accumulate it in the buffer and call a processBuffer function
which is throttled to 400ms.

Given that the buffer is global state, and processing occurs
asynchronously with a delay of up to 400ms, if the 'end' event on the connection is
fired before we actually get to process the buffer, we would clear it and show no results.

This scenario currently only affected search because if we accidentally
threw away some data when streaming deltas, we will get that data again
when we reopen the delta streaming connection.

fix(tray): Flipped logic in displaying unread count

Add section to Message footer

bump(SFDC): 0.4.117

fix linter

bump(electron): Update to 1.4.1 to fix intermittent Symbol() error

es6(db): Query builder converted to ES6

fix(long-connection): `close` instead of `end` on network end event

NylasLongConnection.Status.Ended means that we can't open the
connection again. When we get a network level 'end' event, that doesn't
map to our meaning of `Ended`, so we should just close it instead

Fix db setup

bump(SFDC): 0.4.118

feat(transforms): Replace regexp body transforms with DOM approach

Summary:
We originally didn't do this because creating a DOM tree was loading images.
Using range.createContextualFragment seems to do it without the tree ever
being attached.

Accompanying changes to src/pro are here:
https://phab.nylas.com/D3300
https://github.com/nylas/edgehill/compare/bengotow/draft-dom-transformations?expand=1

Also rename applyTransformsToDraft => applyTransformsForSending. Needed
a new name because the function signature has changed. AFAIK there are no
open source plugins using the old functions.

Test Plan: All specs updated

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3299

fix(tooltips): Defer display of background, ensure dot inside window

bump(SFDC): 0.4.119

Merged in latest master from N1

fix(attribute): fix es6 conversion error

bump(SFDC): 0.4.120

Include calendar fix

fix(warnings): Fix warnings for react unkown dom prop

When using the pattern `{...extraProps}` to transfer props in the render method,
if rendering a native dom element, react will issue a new warning if we
end up passing invalid dom props:
https://facebook.github.io/react/warnings/unknown-prop.html

This adds a helper library to exclude invalid fom props instead of
manually excluding props inside each render method

fix(attribute): fix es6 conversion error

fix(mail-merge): fix `applyExtensionTransformsToDraft` rename

bump(SFDC): 0.4.121

Add welcome modal with video

Move close button to modal component and update styling

Fix linter errors

fix(help): Better help URL

fix(mail-merge): Add test coverage

Add jitter to BackoffTimer

Summary:
This should help us avoid the thundering herd problem if we have some
kind of API outage affecting a wide number of clients.

Test Plan: Tests

Reviewers: bengotow

Reviewed By: bengotow

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3297

fix(contact-sidebar): Correctly update selected contact

Sometimes, when selecting a contact (with name, email) inside a thread,
the dropdown (`<select>`) did not correctly reflect the selected
contact.

This was because when focusing a contact, the FocusedContactStore
queried that contact from the database just by email, and the contact
retured from the database became the focused one. However, sometimes the
returned contact might have the same email but different email, and
given that the `<select>` component is keyed by both name,email, it
couldn't find the appropriate <option> to render, so it could not update
to reflect the newly selected contact

Now, the FocusedContactStore queries by email and name to prevent this

Fix broken test

Summary:
Fixes a test that was broken due to my unfamiliarity with
CoffeeScript :-/

Test Plan: Tests

Reviewers: bengotow

Reviewed By: bengotow

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3302

feat(inline-images): Drag & drop or paste inline images

Summary: Initial support for inline images. Tests still forthcoming!

Test Plan: WIP

Reviewers: mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3295

Revert ""fix(task-queue): performLocal now operates serially""

This reverts commit 179d3fd78a4c817115d7013f6692834b4845d1db.

fix(lint)

es6(db): DatabaseTransaction & Query moved to ES6

fix(tasks): Add instrumentation to Task's performLocal

A slow performLocal may be one of the causes of #2725

update: Update CHANGELOG for v0.4.55

fix(whitespace)

fix(install-location): Update language and remove buggy regex

fix(tasks): Report slow performLocal only when it takes > 500ms

fix(mail-merge): Reduce max number of emails to 250

Almost always, you will get rate limited trying to send 500 emails.
Reduce to 250 to make it more reasonable

💄(sidebar): Github repos should not wrap

fix(sidebar): Command-click + href to open in background

Global window event handler should work when clicking elements /inside/ of an a tag with an href.

💄(mail-merge): Fix alignment and height of tokens

fix(composer): No need for overlaid z-index: 10, appearing over menus

fix(db): Add an index on Thread.client_id for modelify

fix(overlaid-comps): Check if supports preview only after we know exists

fix(warnings): Correctly remove all unknown props warnings

fix(thread-list): Use interaction handlers, don’t update selection directly

fix(drafts): Sanitize quoted text to avoid overlaid component issues [!!]

fix(lint): Change variable to const

fix(search): Update local search syntax to include more results

Add prefix search. Previously, if searching for a thread with a specific
subject, you had to type the entire subject. Searching for just a prefix
wouldn't return the result.
This should not affect any of the current search results, only add more results

fix(react): React refuses to add `partition` attr to webview

fix(identity): Always refresh accounts after identity

This fixes an issue where changing your Nylas ID didn’t refresh your accounts, and N1 would still think they were invalid.

fix(db): Messages with empty bodies always showing loading spinner due to ‘’ == null

Bump submodule

fix(composer): Dedupe registered key bindings to avoid double undo in composer

fix(calendar): CSS layout fix for Chromium 53

fix(mail-merge): Reduce limit to 150 messages, improve error handling

fix(composer): Add additional isMounted checks

Resolves this exception: https://gist.github.com/jstejada/a26dc6a7a2896dcef9be3cec60eaecdb

fix(perspectives): More robust validation of saved perspectives, never open to blank screen

fix(specs): Fix mail merge specs

:art:(thread-sharing): Fix icon

fix(lint): Fix coffeelint errors

fix(draft-list): Don't render html string in draft subject

fix(dev): Pretty print deltas

:art:(activity-list): punctuation

fix(window-state): Per electron#7278, save state in beforeunload

Related:
https://github.com/electron/electron/issues/7278
https://github.com/atom/atom/pull/3223/files

As of Chromium 36, unload is async and @zcbenz does not think it happens reliabily in Electron. Move saving of window state to beforeunload, following suit with Atom.

fix(composer): Wrap composer instead of allowing overflow-x

fix(spec): remove unnecessary messages & prevent extra hot window

bump(SFDC): 0.4.123

fix(linter): fix linter error

fix(linter): fix linter error

rm(ship-logs): Remove unused log shipping, prevents many-processes bug on win32

feat(bios): Linkify twitter hashtags and mentions in bios

fix(composer): When pasting links that are tracked, extract actual link

fix(self-hosting) Don't load packages that don't support self-hosting

feat(self-hosting) Add onboarding page about self-hosting plugin restrictions

bump(verison): 0.4.56, more items in changelog

fix(data-source): Wait until the next cycle to cleanup

Fixes a crash when switching to the thread list from the draft list, where there are very briefly zero observers.

:lipstick:(share-thread): Fix positioning of share thread button

fix(tutorial-tips): Don't display when component is not visible

fix(participants): When copying, include space #2871

fix(spellcheck): Do not spellcheck <code>, <a>, <pre> tags

This fixes #2877. The templates feature becomes broken when variable names contain misspellings.

fix(specs): Minor spec fixes

fix(composer): enable click regions on margins of composer

Change padding, margins, and borders to allow you to click on the left
margin of to, cc, bcc, from, subject fields as well as the composer
margins both above, left, and to the right of the composer.

Ensured attachments and other assets show up in correct spots

Ensure subject looks correct for mail merge

fix(composer): can shift-tab more places

Allow shift-tab to go back to subject from anywhere except in front of a
tab character

fix(composer): fix margin when editing contact chip

fix(composer): tokenizing text field trigger logic moved to composer

Put acess tokens and refresh tokens in keychain

fix modal spacing

bump(SFDC): 0.4.125

fix tokenizing field margins

fix(tutorial-tips): Recompute pos when theme changes

fix(share-thread): Closed when blurred when blurred or new thread selected

fix(dev-mode): Don’t save to config.json, use flag instead

Turns out even the built, packaged version of the app can be restarted into dev mode by adding `—dev` to argv and using the new relaunch API.

es6(db): Move DatabaseStore to ES6

:lipstick:(outline-view): Add title attr for tooltips

fix+:art:(notifs): Cleanup, handle nonexistent thread when opening notification

Notifications now check to see the thread they are supposed to open
exists.

Also, clean up FocusedContentStore._onFocus so that it doesn't have the side
effect of dispatching another action and messay logic.
Instead, added Actions.ensureCategoryFocused, to focus any category, and which
should be used separately from focusing content (notifications now use
this action for ""opening"" the thread)
Also, convert FocusedPerspectiveStore to ES6

fix(specs): Activity List

fix(composer): enable click regions on margins of composer

Change padding, margins, and borders to allow you to click on the left
margin of to, cc, bcc, from, subject fields as well as the composer
margins both above, left, and to the right of the composer.

Ensured attachments and other assets show up in correct spots

Ensure subject looks correct for mail merge

fix(composer): can shift-tab more places

Allow shift-tab to go back to subject from anywhere except in front of a
tab character

fix(composer): fix margin when editing contact chip

fix(composer): tokenizing text field trigger logic moved to composer

:hocho: Last remaining traces of coffeescript in submodule!

fix(tools): Make `arc lint` great again

Add proper arc config for linting ES6 files with eslint

fix(files): When download mode is “manual” prompt about inline attachments

Summary:
When you have your ""Download attachments for new mail"" setting set
to ""manually"", inline images always appear broken with no explanation.

This patch listens for the image load to fail and displays a button which
queues the fetchFile task on click. This seemed like the best approach because
it doesn't slow down the loading of the message with more fstats / lookups.
(Seeing if the file has already been downloaded is an async operation)

Test Plan: No specs atm

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3313

feat(sidebar-notifs) Create sidebar notifications to replace old bars

Summary:
Move the old bar notifications to the sidebar, and only display one notification
at a time using a priority-rating system. Remove all of the old notification
infrastructure.

Test Plan: Added specs, also reproduced notifications locally

Reviewers: bengotow

Reviewed By: bengotow

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3310

bump(submodule)

fix(lint)

fix(phising): Handle scenarios where input is malformed (Sentry 51642)

https://sentry.nylas.com/sentry/edgehill/group/51642/

fix(templates): Handle error when scanning dir (Sentry 44351)

https://sentry.nylas.com/sentry/edgehill/group/44351/

fix(perspectives): Restore when only account cannot be found (Sentry 59061)

https://sentry.nylas.com/sentry/edgehill/group/59061/

refator(notification): move base notification to nylas-component-kit

Remove all salesforce objects on logout

Add syncing of salesforce objects

Summary:
Depends on D3327
- Also remove all coffeescript
- Make it so salesforce mail label grabs opportunity from database
- Make sure metadata is kept in sync when salesforce objects are deleted
- Set up stub for Salesforce Object cache via SalesforceObjectStore
- Cleanups here and there

Test Plan: Manual

Reviewers: jackie, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3328

fix(db): Switch to better-sqlite3, resolves offline issue

Summary:
Better-SQLite3 is a fork of node-sqlite3 which includes a re-written JavaScript interface. It’s more synchronous, but better reflects what is actually sync vs. async in sqlite’s C++ API. (Not much is really async under the hood.) This diff uses a branch of better-sqlite3 I’ve edited to support Node 6.

In my tests, this branch spends 3.24x less time executing queries than `master`. (Measured time spent in calls to `this._db[run|all|get]` over the first 5000 queries of initial sync. It also increased the performance of starring a thread in the thread list by 28%.

This library also allows us to use a prepared statement cache, which is great because we often make the same queries repeatedly as query subscriptions refresh the UI and deltas are dumped into the app. The old interface didn’t expose statements (cached query plans) to JS.

better-sqlite3 advertises that it uses the JS garbage collector instead of lower level C++ memory management. I tested syncing my entire mailbox to verify that memory usage is not significantly different on this branch after a lot of queries have been made.

Finally, it looks like we can finally stop building sqlite3 from scratch in `script/bootstrap`. This library builds properly with `apm install`. 🎉

We might want to change the DatabaseStore and DatabaseTransaction classes more, now that it’s possible to execute queries synchronously. It could make things cleaner and get us out of promise-hell in a few places. In this diff I tried to change as little as possible.

Test Plan: Run tests, everything still works

Reviewers: juan, jackie

Reviewed By: juan, jackie

Differential Revision: https://phab.nylas.com/D3315

Fixing broken screenshot link (#2911)

Replacing with new screenshot

fix(onboarding): Fire event when user selects account type

bump(sqlite3): Fix issue with CI build / bindings location

fix(reporter): Handle errors cleaning log files (Sentry #6887)

Switch spellcheck libaries

Summary:
Switch to electron-spellchecker, which will allow N1 to
spellcheck more intelligently across languages. It auto-
detects languages and downloads dictionaries on the fly.

Test Plan: Specs, manual testing

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3319

Update Windows.md

fix(jquery): remove jquery

fix(spec): remove unused spec helpers

fix(specs) convert nylas-protocol-handler-spec to ES6 (#2886)

fix(win32): Still need custom sqlite3 build cmd for win32 😥

This also includes a bump of the better-sqlite3 module to support compilation on ia32.

feat(popout-threads) Add functionality to open threads in popout windows

Summary:
Threads can now be opened in separate windows. This can be done via the popout
icon next to the print icon, or by double-clicking the thread when in double-
pane mode. Note that the single-click action is still fired, which is why
double-clicking does not work in single-pane mode. The popout icon changes to a
pop-in icon while in the popout window, to allow users to collapse it back into
the main window.

Test Plan: Tested locally

Reviewers: evan, juan

Reviewed By: juan

Subscribers: sdw

Differential Revision: https://phab.nylas.com/D3332

fix(analytics): Add pgp encryption events

Email Encrypted
Email Encryption Errored
Email Decrypted
Email Decryption Errored

feat(win32): Allow N1 to become the system-wide mailto: handler

Summary: This will address the longstanding concern in #417

Test Plan: No new tests

Reviewers: juan, evan

Reviewed By: juan, evan

Maniphest Tasks: T7065

Differential Revision: https://phab.nylas.com/D3322

bump(version): 0.4.57

 (0.4.58 was accidentally in prev commit)

fix(readme): Improve Win32 build instructions

fix(readme): More Win32-specific instructions

fix(spellchecker): Use cross-platform misspellings, fix lint error

feat(calendar): can pick which calendars you want displayed

Summary:
Adds a resizable column next to the calendar that lets you pick which
calendars you want to turn on and off.

The picker sidebar styling mimics that of the main account sidebar.

Calendars are grouped by account.

We store the disabled calendars in in your config.

I added a `notIn` SQL method so it'll perform `WHERE calendarId NOT IN
['a', 'b', ...]` instead of `NOT (WHERE calendarId IN ['a', 'b', 'c'])`

I wanted it to be an exclusion (instead of inclusion) list so the default
was ""all on"" and we didn't need to always fetch the full list of
calendarIds from the database to compare against.

This also fixed a test that was failing constantly: The Query Subscription
Pool Spec was not being properly reset on each test. As a result, the test
would fail with an instance of a query subscription that Jasmine would
attempt to pretty print. Jasmine would fail to pretty print it because of
a jasmine bug that fails to properly display Objects with null prototypes.
The DatabaseStore's EventEmitter has a property with a null prototyp
causing the error

Test Plan: manual

Reviewers: bengotow, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3336

fix(linter)

Merge submodule with master

Bump submodule

Bump database version and submodule

fix(contact): add hasSameDomainAsMe method to Contact

Better email syncing with Salesforce

feat(dock): Automatically add N1 to the OS X dock upon install

Note - you need to `killall Dock` to see this after it happens

Add main window calendar package

Summary: Add tiny helper app for calendar goodness

Test Plan: No tests yet

Reviewers: juan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3346

cleanup(*): Remove dead .bowerrc, .gitignore files

es6(db): Convert the ORM specs to ES2016

bump(Electron): 1.4.3

fix(license): Swap ref to GPLv3 with the whole thing so GitHub picks it up

Clean up spec-bootstrap and jasmine-helper

Convert spec-suite to es6

Extract out jasmine reporters

Move global imports back to jasmine-helper

Extract to N1SpecRunner

Fold jasmine-helper into spec runner

Convert `spec-suite` to `n1-spec-loader`

Convert spec-helper to es6

Remove unused methods from spec-helper

Move waitsForPromise to jasmine-extensions

Move spec runner & deps into `n1-spec-runner` folder

Remove unused spec-helper-platform

Move specs into subfolders

Initial extraction of all methods out of of spec-helper

Fixes to spec-helper extraction

fix(spec):

Dramatically clean up and simply the spec bootup process.

Converting spec bootup system to es6 from coffee.

Converted old `jasmine-helper`, `spec-helper`, and `spec-suite` to a new
`n1-spec-runner` file.

Each of these old files had tons and tons of code related to various parts
of the spec bootup and running process.

Each of those parts have been extracted into individual files

Fix linter

Add icons to object types in picker

Remove opp references in popover

bump submodule

fix(spellchecker) Add a cache to improve performance

fix(notifs): Don’t render empty <img />

lint(*): Bump to ESLint 3.8

Update linter

bump submodule

bump submodule

bump submodule

bump submodule

bumpd submodule

Add sync thread toggles

Search focused contact by email

fix(mailto): Support body with \n or \r characters

Related to #2923

fix(thread-popout) Add missing packages to the 'thread-popout' window

Summary: Missed some non-composer packages that should be in the 'thread-popout' window

Test Plan: Tested locally

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3352

fix(mailto): Missing return in URL handling

fix(beta): Add notif when on beta channel

fix(db): Return; preventing ThreadSearch indexing

bump(version): 0.4.58

fix(specs): Don’t run update channel check in specs

fix(search): React warns, convert to ES2016

fix(search): Missed a .default

fix(spellcheck): Don’t include cld sources in build

fix(tooltips): Prevent tooltips from breaking wrapped components

fix(overlaid): Preview button was just invisible?

fix(auth): Hide title when long acct. err present

fix(onboarding): Don’t display “Welcome Back” screen

fix(accounts): Return correct list of email addresses

bump submodule

fix(misc) React warnings, kill cjsx

fix(accounts): Return correct list of email addresses

:lipstick:(thread-window): Update pop-out icons

lint(react): InlineImages don’t get session at send-time

fix(mail-merge): Upload files per draft to fix inline images

fix(mail-rules): Allow recipient filters to contain names #2942

bump(version): 0.4.59

:lipstick:(thread-window): Add thread-popin icon

update(changelog): 0.4.59

fix(search): Use fts search index for typeahead results

Summary: This improves performance of the search typeahead

Test Plan: Manual

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3363

fix(popover): :hocho: deprecated popover

fix(popover) Actually :hocho: deprecated popover

feat(flow): Add Flow to Nylas N1

Add flow-typed annotations

Ignore annoying submodules

Add /* @flow */ header to all js & es6 source files

Fix error about having number keys for objects

Remove @flow config from compile-support

Check es6 files

Add jasmine to flow

Revert ""Add /* @flow */ header to all js & es6 source files""

This reverts commit c5a57bc402c53633b407b557f28ad12eaa8f27fe.

Update submodule

Add nylas global interface file

Fix generated form and bump

Fixes to generated form

Use customComponent in task

fix(warning): Don't render participant picker with null value

fix(thread-popout): Display the hidden message toggle in the thread-popout

Summary:
Also, maintain the perspective that the thread was opened in, so that the
proper messages are hidden (e.g. hide deleted messages when opened from the
inbox, but not when opened from the trash folder)

Test Plan: Tested locally

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3366

rm(grim): We’re not using Grim for deprecations

feat(quick-replies): Reply from Mac notifications

use single regex exec for toEquivalentEmailForm (#2962)

Fix JSON spacing (#2958)

Match JSON style to rest of file

Fix issue #2758. Press Escape after a finished search to get back to … (#2939)

* Fix issue #2758. Press Escape after a finished search to get back to Inbox

Use a keydown event when search bar is in focus to capture escape key press

* fix(search): Convert to ES2016

:art:(notifications): Remove indent and left padding from notifications

Revert ""Fix issue #2758. Press Escape after a finished search to get back to … (#2939)""

This reverts commit 091f768e6670347136c1044fff96ff28ae12c81d.
This was already fixed in https://github.com/nylas/N1/commit/ebb8b45809911601b7b14f4201fdb46c380af1c8

fix(utils): Don’t overwrite _ in global scope

feat(tokens): Multi-select for tokenized text fields

Test Plan: Lots of tests, mostly updated to enzyme. Not many new ones.

Reviewers: evan, juan, jackie

Reviewed By: juan, jackie

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3374

fix(tokenizing-text): Re-add shouldBreakOnKeydown prop

build: bump eslint-plugin-import version

feat(field): Let TokenizingTextFields be disabled and onEditMotion",False
183c547ccf10c559935840ddf7be9d01f0a37025,2016-10-27 04:29:19,Evan Morikawa,feat(field): Let TokenizingTextFields be disabled and onEditMotion,False
bffac1b20374284455e4d2327e595cb3c14b3a37,2016-10-27 02:59:18,Juan Tejada,build: bump eslint-plugin-import version,False
3e66e8684a43189acad520653d6c693421d1498e,2016-10-27 02:55:58,Ben Gotow,fix(tokenizing-text): Re-add shouldBreakOnKeydown prop,False
01fc435a4af3d8bec9845875416cccfc3ce521af,2016-10-27 02:28:57,Ben Gotow,"feat(tokens): Multi-select for tokenized text fields

Test Plan: Lots of tests, mostly updated to enzyme. Not many new ones.

Reviewers: evan, juan, jackie

Reviewed By: juan, jackie

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3374",False
cdc5f635a343dd6682677c4464b4001b692490ac,2016-10-27 02:14:09,Ben Gotow,fix(utils): Don’t overwrite _ in global scope,False
acd0980c64ca2fd31df6d9bcb7b9048812b22f5a,2016-10-27 01:50:26,Juan Tejada,"Revert ""Fix issue #2758. Press Escape after a finished search to get back to … (#2939)""

This reverts commit 091f768e6670347136c1044fff96ff28ae12c81d.
This was already fixed in https://github.com/nylas/N1/commit/ebb8b45809911601b7b14f4201fdb46c380af1c8",False
64585aceb478c86c9a1b086046fcd8ddb03f2ef5,2016-10-27 00:49:12,Jackie Luo,:art:(notifications): Remove indent and left padding from notifications,False
091f768e6670347136c1044fff96ff28ae12c81d,2016-10-27 00:27:57,Yishu See,"Fix issue #2758. Press Escape after a finished search to get back to … (#2939)

* Fix issue #2758. Press Escape after a finished search to get back to Inbox

Use a keydown event when search bar is in focus to capture escape key press

* fix(search): Convert to ES2016",False
77d5c62f589514abe83cd068a400b245b035b646,2016-10-27 00:24:48,Niraj Pant,"Fix JSON spacing (#2958)

Match JSON style to rest of file",False
6b82a1c33d0f628fad55a02b9350a723d1886ce3,2016-10-27 00:22:52,Koen Punt,use single regex exec for toEquivalentEmailForm (#2962),False
16a715937c25bc86e8fbf4a207df077c491e07a4,2016-10-26 02:38:26,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
921c5f970a6374f002e000499bf9f50233a7093d,2016-10-26 02:38:13,Jackie Luo,fix(warning): Don't render participant picker with null value,False
ec3df7a0bc74ff6b967b8889fe7259ca83f15bd3,2016-10-26 00:06:20,Ben Gotow,feat(quick-replies): Reply from Mac notifications,False
ab4ef6de01658fa81ffa2418cc462184affbfc2a,2016-10-26 00:06:20,Ben Gotow,rm(grim): We’re not using Grim for deprecations,False
2661772d66c5fb62caf2ff435b80c728d5a22f53,2016-10-25 23:35:34,Halla Moore,"fix(thread-popout): Display the hidden message toggle in the thread-popout

Summary:
Also, maintain the perspective that the thread was opened in, so that the
proper messages are hidden (e.g. hide deleted messages when opened from the
inbox, but not when opened from the trash folder)

Test Plan: Tested locally

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3366",False
a53092b2035de6932adf4b23a6b5be985c44826d,2016-10-25 08:14:16,Evan Morikawa,"feat(flow): Add Flow to Nylas N1

Add flow-typed annotations

Ignore annoying submodules

Add /* @flow */ header to all js & es6 source files

Fix error about having number keys for objects

Remove @flow config from compile-support

Check es6 files

Add jasmine to flow

Revert ""Add /* @flow */ header to all js & es6 source files""

This reverts commit c5a57bc402c53633b407b557f28ad12eaa8f27fe.

Update submodule

Add nylas global interface file",False
79246215d8707743d1e94b6a0a72da364c7da854,2016-10-25 05:22:02,Juan Tejada,fix(popover) Actually :hocho: deprecated popover,False
53062830c9a8bde1d3c44379cf2a5008df5440a3,2016-10-25 05:03:17,Juan Tejada,fix(popover): :hocho: deprecated popover,False
ebb8b45809911601b7b14f4201fdb46c380af1c8,2016-10-25 02:48:29,Juan Tejada,"fix(search): Use fts search index for typeahead results

Summary: This improves performance of the search typeahead

Test Plan: Manual

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3363",False
07f357fc0de2f92ae5a4746c9ac89d237ca9c3d8,2016-10-25 02:43:58,Juan Tejada,update(changelog): 0.4.59,False
4ac7cea38a8947bf7b139b6a6f8709b0265f6643,2016-10-25 02:16:20,Juan Tejada,:lipstick:(thread-window): Add thread-popin icon,False
76845f421232fc5bd1cd25db599e9c2ffe4006f8,2016-10-25 01:51:08,Ben Gotow,bump(version): 0.4.59,False
c2e3262c33bb3d9141b25657753c3fa78f854ede,2016-10-25 01:47:22,Ben Gotow,fix(mail-rules): Allow recipient filters to contain names #2942,False
1ebb225ba9a9778f7309ac320bbc3f5588e3b765,2016-10-25 01:02:58,Ben Gotow,fix(mail-merge): Upload files per draft to fix inline images,False
1e72b19ed93b67259740a2157b56ff120b778532,2016-10-25 01:02:58,Ben Gotow,lint(react): InlineImages don’t get session at send-time,False
60ec6f1138c7af17f9fa16b642607030ce46d228,2016-10-25 00:33:19,Juan Tejada,:lipstick:(thread-window): Update pop-out icons,False
69cc2b895316bae3de0ecb20fe239bc63de73ef3,2016-10-24 23:56:51,Jackie Luo,fix(accounts): Return correct list of email addresses,False
a5ff3cfc6216b0c5eb9fbbdec504992bb4cbb7c7,2016-10-21 05:04:59,Ben Gotow,fix(onboarding): Don’t display “Welcome Back” screen,False
ec67dfb8bf81ab9d1b254aeb862c904d86eb79c8,2016-10-21 04:56:52,Ben Gotow,fix(auth): Hide title when long acct. err present,False
1a377608b74771644189b5616bfbd18c6da413d6,2016-10-21 04:40:09,Ben Gotow,fix(overlaid): Preview button was just invisible?,False
ef4523a8d1edf462f4c3d2131e7ff56476a58ff0,2016-10-21 04:39:37,Ben Gotow,fix(tooltips): Prevent tooltips from breaking wrapped components,False
181fa4e35889be6d228f596d0e6de35e5fd46718,2016-10-21 02:15:22,Ben Gotow,fix(spellcheck): Don’t include cld sources in build,False
7d98f88089c89c586c5930962c0c8d9ca65a9b9d,2016-10-21 00:51:15,Ben Gotow,fix(search): Missed a .default,False
ae341a20a37b8cf9895980384d9f518269460947,2016-10-21 00:39:53,Ben Gotow,"fix(search): React warns, convert to ES2016",False
04bd4ee4c16907bf4b5cbd5935aeb045d77b0c0b,2016-10-20 22:54:53,Ben Gotow,fix(specs): Don’t run update channel check in specs,False
d7d6fbc4eebee15fcc32e1a533ac093a24c3a53f,2016-10-20 22:51:04,Ben Gotow,bump(version): 0.4.58,False
e40391117f59854bb93ae9230db352f6be73ca01,2016-10-20 05:24:00,Ben Gotow,fix(db): Return; preventing ThreadSearch indexing,False
ff8d21d8c21e51082aaf430a1c20c13b7f8e6437,2016-10-19 01:09:09,Ben Gotow,fix(beta): Add notif when on beta channel,False
217c289a36aafe1cae3e2869f832d8100b1c2520,2016-10-19 01:09:09,Ben Gotow,fix(mailto): Missing return in URL handling,False
752c9ede58f28ebc023c2bb9a3a020e98c293055,2016-10-18 23:32:30,Halla Moore,"fix(thread-popout) Add missing packages to the 'thread-popout' window

Summary: Missed some non-composer packages that should be in the 'thread-popout' window

Test Plan: Tested locally

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3352",False
45964b8ae3dd85fd59fa96176a9beecfa36be0ca,2016-10-18 23:07:27,Ben Gotow,"fix(mailto): Support body with \n or \r characters

Related to #2923",False
21c0b9ecf45e36e41787075b1b4bbce088dbaead,2016-10-18 06:37:35,Ben Gotow,lint(*): Bump to ESLint 3.8,False
11247f6e8c1c7cb4cf7acb3b847a07ab21c6d4d6,2016-10-18 06:29:37,Ben Gotow,fix(notifs): Don’t render empty <img />,False
1797938fff4e07947cded1e941028da43f6a6f35,2016-10-18 02:14:22,Halla Moore,fix(spellchecker) Add a cache to improve performance,False
d5602fd418eab5580eba49b166f8252d5abaca24,2016-10-17 08:40:19,Evan Morikawa,"fix(spec):

Dramatically clean up and simply the spec bootup process.

Converting spec bootup system to es6 from coffee.

Converted old `jasmine-helper`, `spec-helper`, and `spec-suite` to a new
`n1-spec-runner` file.

Each of these old files had tons and tons of code related to various parts
of the spec bootup and running process.

Each of those parts have been extracted into individual files",False
b57b7c435daea8e3f0944ccfa7b077b78730bc08,2016-10-17 08:40:19,Evan Morikawa,Fixes to spec-helper extraction,False
15b56747477b21b836887c34191727634719cf4c,2016-10-17 08:40:19,Evan Morikawa,Initial extraction of all methods out of of spec-helper,False
2171a891164bf845357f33b1212b1978e030fd7b,2016-10-17 08:40:19,Evan Morikawa,Move specs into subfolders,False
f3ba2917a756e2c5e809640e05deb4dc561dbcd7,2016-10-17 08:40:19,Evan Morikawa,Remove unused spec-helper-platform,False
3619c04bdbc73e188b5eeb89aba3f245d81875b8,2016-10-17 08:40:19,Evan Morikawa,Move spec runner & deps into `n1-spec-runner` folder,False
0e55e774904ccf29d590a319ea1aac447c4aa5a8,2016-10-17 08:40:19,Evan Morikawa,Move waitsForPromise to jasmine-extensions,False
ac5e055bdf4b7bec736eae66e5fc23f1f0392da3,2016-10-17 08:40:19,Evan Morikawa,Remove unused methods from spec-helper,False
43d4daa657da8cb54a57946b92e0b16c4ef0bde5,2016-10-17 08:40:19,Evan Morikawa,Convert spec-helper to es6,False
2659bd0ab0c90b1cfa88573e3cc2ec3adb7a5c2f,2016-10-17 08:40:19,Evan Morikawa,Convert `spec-suite` to `n1-spec-loader`,False
9cbe97d111cd1bb3799dcb21d61944bd17d34369,2016-10-17 08:40:19,Evan Morikawa,Fold jasmine-helper into spec runner,False
f420bb1c0996c53f88ed09f2f1a50c77cf193dba,2016-10-17 08:40:19,Evan Morikawa,Extract to N1SpecRunner,False
ba56cc411aa07d3a57ef93ec926c28d878886fdc,2016-10-17 08:40:19,Evan Morikawa,Move global imports back to jasmine-helper,False
adced60ad23cd89fb0a7a4a91c16609dcc3246a6,2016-10-17 08:40:19,Evan Morikawa,Extract out jasmine reporters,False
b3243a53afa6ff0c0e58b63b87bf88a856d49c20,2016-10-17 08:40:19,Evan Morikawa,Convert spec-suite to es6,False
df9219cfe091500f21b8ceedcdf2e4602a36338c,2016-10-17 08:40:19,Evan Morikawa,Clean up spec-bootstrap and jasmine-helper,False
b3317b65d44660d1927eebac1f4684643d736c06,2016-10-15 23:18:44,Ben Gotow,fix(license): Swap ref to GPLv3 with the whole thing so GitHub picks it up,False
2902a3b264a1e4cd6c1a1e2e2c82290d16d4ec2a,2016-10-15 01:41:20,Ben Gotow,bump(Electron): 1.4.3,False
28d636b7fc6a716202816699bce83ec94f1bd8f8,2016-10-15 00:36:07,Ben Gotow,es6(db): Convert the ORM specs to ES2016,False
c388f55ccb12e265ec2f011531d9b925212c629f,2016-10-15 00:09:34,Ben Gotow,"cleanup(*): Remove dead .bowerrc, .gitignore files",False
4178e6725cf57c0e5648b7588b8b4abcff0db36e,2016-10-15 00:08:31,Ben Gotow,"Add main window calendar package

Summary: Add tiny helper app for calendar goodness

Test Plan: No tests yet

Reviewers: juan, halla

Reviewed By: halla

Differential Revision: https://phab.nylas.com/D3346",False
c0aad93c4eca056a3f7f129e4cef764b922b1b4b,2016-10-14 03:31:51,Ben Gotow,"feat(dock): Automatically add N1 to the OS X dock upon install

Note - you need to `killall Dock` to see this after it happens",False
5bb264596443be3df0fd7793a0cd758f5fb6c85a,2016-10-14 02:01:40,Evan Morikawa,fix(contact): add hasSameDomainAsMe method to Contact,False
57fbc0b9a1da1b10f7e0fac057151ab4ee745190,2016-10-13 22:11:09,Evan Morikawa,fix(linter),False
405f28152baacfdf459433db7644fd2d2ad8f5c4,2016-10-13 21:07:19,Evan Morikawa,"feat(calendar): can pick which calendars you want displayed

Summary:
Adds a resizable column next to the calendar that lets you pick which
calendars you want to turn on and off.

The picker sidebar styling mimics that of the main account sidebar.

Calendars are grouped by account.

We store the disabled calendars in in your config.

I added a `notIn` SQL method so it'll perform `WHERE calendarId NOT IN
['a', 'b', ...]` instead of `NOT (WHERE calendarId IN ['a', 'b', 'c'])`

I wanted it to be an exclusion (instead of inclusion) list so the default
was ""all on"" and we didn't need to always fetch the full list of
calendarIds from the database to compare against.

This also fixed a test that was failing constantly: The Query Subscription
Pool Spec was not being properly reset on each test. As a result, the test
would fail with an instance of a query subscription that Jasmine would
attempt to pretty print. Jasmine would fail to pretty print it because of
a jasmine bug that fails to properly display Objects with null prototypes.
The DatabaseStore's EventEmitter has a property with a null prototyp
causing the error

Test Plan: manual

Reviewers: bengotow, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3336",False
2b63e343ae50065c3f7ead303269439b45f3f466,2016-10-13 05:37:22,Halla Moore,"fix(spellchecker): Use cross-platform misspellings, fix lint error",False
dc84d9af55c78afcc05b36da5d21a8cc996593fd,2016-10-13 05:07:04,Ben Gotow,fix(readme): More Win32-specific instructions,False
180b032277385ac7bde64751a147cffc21b4b923,2016-10-13 05:00:03,Ben Gotow,fix(readme): Improve Win32 build instructions,False
e74217be3c3116b4f8b5c46ece4e96ea820eea74,2016-10-13 04:36:40,Ben Gotow,"bump(version): 0.4.57

 (0.4.58 was accidentally in prev commit)",False
0888c5cdd0432e8496ac5b33daa0506bb89deb6d,2016-10-13 04:35:36,Ben Gotow,"feat(win32): Allow N1 to become the system-wide mailto: handler

Summary: This will address the longstanding concern in #417

Test Plan: No new tests

Reviewers: juan, evan

Reviewed By: juan, evan

Maniphest Tasks: T7065

Differential Revision: https://phab.nylas.com/D3322",False
038c2bb11fcb79434081955c2c073a620fe56861,2016-10-13 02:59:58,Evan Morikawa,"fix(analytics): Add pgp encryption events

Email Encrypted
Email Encryption Errored
Email Decrypted
Email Decryption Errored",False
267555a6db6f88c7c29bd0cd91f6f0d3af7a91f5,2016-10-13 02:25:11,Halla Moore,"feat(popout-threads) Add functionality to open threads in popout windows

Summary:
Threads can now be opened in separate windows. This can be done via the popout
icon next to the print icon, or by double-clicking the thread when in double-
pane mode. Note that the single-click action is still fired, which is why
double-clicking does not work in single-pane mode. The popout icon changes to a
pop-in icon while in the popout window, to allow users to collapse it back into
the main window.

Test Plan: Tested locally

Reviewers: evan, juan

Reviewed By: juan

Subscribers: sdw

Differential Revision: https://phab.nylas.com/D3332",False
c598e31f1e7dffa51b2ba07bf27a20dedc3f07bc,2016-10-13 01:00:23,Ben Gotow,"fix(win32): Still need custom sqlite3 build cmd for win32 😥

This also includes a bump of the better-sqlite3 module to support compilation on ia32.",False
2eab187da03b9da146f0531c65e7bfb9deb680f4,2016-10-13 00:08:30,Jonathan Boiser,fix(specs) convert nylas-protocol-handler-spec to ES6 (#2886),False
78b22b1e634458f299715b47fd67241a07f5bf1d,2016-10-12 20:34:38,Evan Morikawa,fix(spec): remove unused spec helpers,False
61ac77e029c6f51098c0ddb8bb207251519dc606,2016-10-12 20:34:38,Evan Morikawa,fix(jquery): remove jquery,False
124edf25bab52ac52b45a034c96a90692bc680ac,2016-10-12 07:05:00,Ben Gotow,Update Windows.md,False
16191266880eae5dc43547de51c3459670ad2653,2016-10-12 02:30:50,Halla Moore,"Switch spellcheck libaries

Summary:
Switch to electron-spellchecker, which will allow N1 to
spellcheck more intelligently across languages. It auto-
detects languages and downloads dictionaries on the fly.

Test Plan: Specs, manual testing

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3319",False
e10e51ab5d2029cd260ed9c8c5e8e33d74a39e05,2016-10-11 13:14:10,Ben Gotow,A few changes to support linking to K2 via the new GUI,False
739ca2b053319411e8fa78777cf3ee186ba6d80b,2016-10-11 02:14:41,Ben Gotow,fix(reporter): Handle errors cleaning log files (Sentry #6887),False
3c5efaf55ec5fa180f3097c509e4915ea9724400,2016-10-08 06:29:10,Ben Gotow,bump(sqlite3): Fix issue with CI build / bindings location,False
c5ff2f640b728fc2d23bec0cdeb6ebb094aaa7be,2016-10-07 22:46:20,Ben Gotow,fix(onboarding): Fire event when user selects account type,False
a8865eb2a2a8754487990f42ed0ec7c08d83ece3,2016-10-07 07:18:12,Luke Schlangen,"Fixing broken screenshot link (#2911)

Replacing with new screenshot",False
0eef80e5d46372b36aff8e6af191b9689fc166fc,2016-10-07 05:31:22,Ben Gotow,"fix(db): Switch to better-sqlite3, resolves offline issue

Summary:
Better-SQLite3 is a fork of node-sqlite3 which includes a re-written JavaScript interface. It’s more synchronous, but better reflects what is actually sync vs. async in sqlite’s C++ API. (Not much is really async under the hood.) This diff uses a branch of better-sqlite3 I’ve edited to support Node 6.

In my tests, this branch spends 3.24x less time executing queries than `master`. (Measured time spent in calls to `this._db[run|all|get]` over the first 5000 queries of initial sync. It also increased the performance of starring a thread in the thread list by 28%.

This library also allows us to use a prepared statement cache, which is great because we often make the same queries repeatedly as query subscriptions refresh the UI and deltas are dumped into the app. The old interface didn’t expose statements (cached query plans) to JS.

better-sqlite3 advertises that it uses the JS garbage collector instead of lower level C++ memory management. I tested syncing my entire mailbox to verify that memory usage is not significantly different on this branch after a lot of queries have been made.

Finally, it looks like we can finally stop building sqlite3 from scratch in `script/bootstrap`. This library builds properly with `apm install`. 🎉

We might want to change the DatabaseStore and DatabaseTransaction classes more, now that it’s possible to execute queries synchronously. It could make things cleaner and get us out of promise-hell in a few places. In this diff I tried to change as little as possible.

Test Plan: Run tests, everything still works

Reviewers: juan, jackie

Reviewed By: juan, jackie

Differential Revision: https://phab.nylas.com/D3315",False
f2c1ac3289ee31b11bbf8ea2e65c24a61c1133a7,2016-10-06 23:23:22,Evan Morikawa,refator(notification): move base notification to nylas-component-kit,False
0bb26bce7950a6967ae8fb48f55f572b50e0b76b,2016-10-05 02:45:52,Ben Gotow,"fix(perspectives): Restore when only account cannot be found (Sentry 59061)

https://sentry.nylas.com/sentry/edgehill/group/59061/",False
a232f6fc17b6c29c7f04bd7e08c5e5276e11d894,2016-10-05 02:45:52,Ben Gotow,"fix(templates): Handle error when scanning dir (Sentry 44351)

https://sentry.nylas.com/sentry/edgehill/group/44351/",False
8a3efdd6f7e74ce16d2c3d9626b49e2408cedf81,2016-10-05 02:45:52,Ben Gotow,"fix(phising): Handle scenarios where input is malformed (Sentry 51642)

https://sentry.nylas.com/sentry/edgehill/group/51642/",False
aaca39f9c783a4f79faa886ecc1baebcd7ab85d9,2016-10-05 00:36:43,Juan Tejada,fix(lint),False
b1c6a9996fb1ccbcd597dadd37cc281788154066,2016-10-04 23:47:57,Juan Tejada,bump(submodule),False
dcb84db3e378713ceb6a312c1fa3725a70825d2e,2016-10-04 20:38:23,Halla Moore,"feat(sidebar-notifs) Create sidebar notifications to replace old bars

Summary:
Move the old bar notifications to the sidebar, and only display one notification
at a time using a priority-rating system. Remove all of the old notification
infrastructure.

Test Plan: Added specs, also reproduced notifications locally

Reviewers: bengotow

Reviewed By: bengotow

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3310",False
dda7c50adf2605b0306d573adabbaf9b7a7b2664,2016-10-03 23:52:44,Ben Gotow,"fix(files): When download mode is “manual” prompt about inline attachments

Summary:
When you have your ""Download attachments for new mail"" setting set
to ""manually"", inline images always appear broken with no explanation.

This patch listens for the image load to fail and displays a button which
queues the fetchFile task on click. This seemed like the best approach because
it doesn't slow down the loading of the message with more fstats / lookups.
(Seeing if the file has already been downloaded is an async operation)

Test Plan: No specs atm

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3313",False
b1dddd1541cccf47f488529fe43712e29649c0d2,2016-10-02 23:26:11,Juan Tejada,"fix(tools): Make `arc lint` great again

Add proper arc config for linting ES6 files with eslint",False
dafffa87d5ae21968866c4eb5993d360e1279f64,2016-10-02 23:25:41,Juan Tejada,:hocho: Last remaining traces of coffeescript in submodule!,False
8fd6fe27ca4f519767ba78d0bb43cce075fd71ce,2016-10-02 21:35:31,Evan Morikawa,fix(composer): tokenizing text field trigger logic moved to composer,False
f7c2703683163742db80fd8a189a7ed36fa22bff,2016-10-02 21:35:25,Evan Morikawa,fix(composer): fix margin when editing contact chip,False
5ea9d110cbf1df3f0dccca84b04d77c503e274e5,2016-10-02 21:35:14,Evan Morikawa,"fix(composer): can shift-tab more places

Allow shift-tab to go back to subject from anywhere except in front of a
tab character",False
376158c9b92348a9161c9edcdcad1c7d9c5a5c37,2016-10-02 21:34:55,Evan Morikawa,"fix(composer): enable click regions on margins of composer

Change padding, margins, and borders to allow you to click on the left
margin of to, cc, bcc, from, subject fields as well as the composer
margins both above, left, and to the right of the composer.

Ensured attachments and other assets show up in correct spots

Ensure subject looks correct for mail merge",False
a47eb507054a9d465693bb5441f38acc94e6c111,2016-10-01 12:55:20,Juan Tejada,fix(specs): Activity List,False
c1396c877ad63da9f2d1f1566caf38346a780bbc,2016-10-01 12:38:19,Juan Tejada,"fix+:art:(notifs): Cleanup, handle nonexistent thread when opening notification

Notifications now check to see the thread they are supposed to open
exists.

Also, clean up FocusedContentStore._onFocus so that it doesn't have the side
effect of dispatching another action and messay logic.
Instead, added Actions.ensureCategoryFocused, to focus any category, and which
should be used separately from focusing content (notifications now use
this action for ""opening"" the thread)
Also, convert FocusedPerspectiveStore to ES6",False
93281f859fe96c85d82eff5ebec1d80634255f32,2016-10-01 09:31:30,Juan Tejada,:lipstick:(outline-view): Add title attr for tooltips,False
1b8c41d057e51767b8af05e4bc38509d311dbb63,2016-10-01 03:54:34,Ben Gotow,es6(db): Move DatabaseStore to ES6,False
a2b9e221574daa5eede37d20b617214de69bf181,2016-10-01 03:07:03,Ben Gotow,"fix(dev-mode): Don’t save to config.json, use flag instead

Turns out even the built, packaged version of the app can be restarted into dev mode by adding `—dev` to argv and using the new relaunch API.",False
7d7700edb70a86ce01c87aa86205b34798e9d0b6,2016-10-01 02:18:12,Juan Tejada,fix(share-thread): Closed when blurred when blurred or new thread selected,False
7acc8dc995a292a3729b46d475544d526cf3a941,2016-10-01 02:16:17,Juan Tejada,fix(tutorial-tips): Recompute pos when theme changes,False
2e66cf9ef6d80e2aee3111ed1186bca39720d7e2,2016-10-01 00:28:57,Ben Gotow,fix(specs): Minor spec fixes,False
31bf2e2ce75213639d8b98d4b3b21ea94ed26756,2016-10-01 00:23:52,Ben Gotow,"fix(spellcheck): Do not spellcheck <code>, <a>, <pre> tags

This fixes #2877. The templates feature becomes broken when variable names contain misspellings.",False
325ce1b12eab21b4710d6eec674cf6ec3c6a64de,2016-09-30 23:18:34,Ben Gotow,"fix(participants): When copying, include space #2871",False
805e665b6eb868dc74879a3bcaf1bfc7bb93908b,2016-09-30 09:01:52,Juan Tejada,fix(tutorial-tips): Don't display when component is not visible,False
796e7e1a140041baa31ac5fa1467bc2b7d3f29cb,2016-09-30 09:00:03,Juan Tejada,:lipstick:(share-thread): Fix positioning of share thread button,False
c222fa0c390a62b862f41b873b163389d254e499,2016-09-30 02:12:52,Ben Gotow,"fix(data-source): Wait until the next cycle to cleanup

Fixes a crash when switching to the thread list from the draft list, where there are very briefly zero observers.",False
1e9d1dff0770485b236c80c63775071e90836719,2016-09-30 00:54:15,Ben Gotow,"bump(verison): 0.4.56, more items in changelog",False
02eaf34c6cd87d0fa1f3e2d072fbbf262ed4ca12,2016-09-30 00:42:05,Halla Moore,feat(self-hosting) Add onboarding page about self-hosting plugin restrictions,False
c2b9b3070a088daef81c00b61a306bf28b33e1ae,2016-09-30 00:42:05,Halla Moore,fix(self-hosting) Don't load packages that don't support self-hosting,False
4e3332386ab6b6d9fb93240878a754126eb94bc9,2016-09-30 00:00:19,Juan Tejada,"fix(composer): When pasting links that are tracked, extract actual link",False
7997e70a848803f2c006cf03ec31f069f247e416,2016-09-29 23:55:08,Ben Gotow,feat(bios): Linkify twitter hashtags and mentions in bios,False
af278e07658d5a0ad23d6720f2adbe9c5f795855,2016-09-29 23:08:29,Ben Gotow,"rm(ship-logs): Remove unused log shipping, prevents many-processes bug on win32",False
787781b3a963065766b8537b531d70daaea1a399,2016-09-29 20:35:11,Evan Morikawa,fix(linter): fix linter error,False
ec51730e2428e561c1885d6e072d2701396d395e,2016-09-29 20:22:51,Evan Morikawa,fix(spec): remove unnecessary messages & prevent extra hot window,False
6fad7a9ceb9fbbce22acccb3ae28ee5658dd71c3,2016-09-29 06:09:44,Ben Gotow,fix(composer): Wrap composer instead of allowing overflow-x,False
3940a0abbde0cdda644532c5d621b93fbfae93d6,2016-09-29 06:09:44,Ben Gotow,"fix(window-state): Per electron#7278, save state in beforeunload

Related:
https://github.com/electron/electron/issues/7278
https://github.com/atom/atom/pull/3223/files

As of Chromium 36, unload is async and @zcbenz does not think it happens reliabily in Electron. Move saving of window state to beforeunload, following suit with Atom.",False
7391dd782bf9dfa93ce9ec8839931f6041cbfd7c,2016-09-29 05:52:50,Juan Tejada,:art:(activity-list): punctuation,False
878dc293bc69d5079ffb17a1c147f34d65e03410,2016-09-29 05:21:50,Juan Tejada,fix(dev): Pretty print deltas,False
7c871a8618db7e85aad12acac4b7ad04b96a3ec1,2016-09-29 04:32:47,Juan Tejada,fix(draft-list): Don't render html string in draft subject,False
302aca5a4e394fa31c9d67f5a84bff07270d7544,2016-09-29 04:28:16,Juan Tejada,fix(lint): Fix coffeelint errors,False
a3497956ba71a057d47a778739c0198b0e50a8c2,2016-09-29 04:26:37,Juan Tejada,:art:(thread-sharing): Fix icon,False
4e1f8c9b539d0f8875fd8221062d8492bd56554f,2016-09-29 03:32:36,Juan Tejada,fix(specs): Fix mail merge specs,False
dc15c3e243d18c5a6a05433731cf950923586c68,2016-09-29 03:16:08,Ben Gotow,"fix(perspectives): More robust validation of saved perspectives, never open to blank screen",False
96ab35cb8e6ff2b0bda583e1445dfdcb10b8fe7e,2016-09-29 03:16:08,Ben Gotow,"fix(composer): Add additional isMounted checks

Resolves this exception: https://gist.github.com/jstejada/a26dc6a7a2896dcef9be3cec60eaecdb",False
0e6b4a0c96d04dd0448296c1c9255c594fbe333d,2016-09-29 01:57:59,Juan Tejada,"fix(mail-merge): Reduce limit to 150 messages, improve error handling",False
6815c36065f7e8d3feb9520c15bded9ec340ab70,2016-09-29 00:44:50,Ben Gotow,fix(calendar): CSS layout fix for Chromium 53,False
b575d1fa973d7e413f66b2cb8a7ca9c9ebcbd9fc,2016-09-29 00:33:58,Ben Gotow,fix(composer): Dedupe registered key bindings to avoid double undo in composer,False
9627ae9b0ce20fea7ab7f1c2c79ccdee873618ea,2016-09-29 00:12:18,Ben Gotow,fix(db): Messages with empty bodies always showing loading spinner due to ‘’ == null,False
6ddca404f55ab95ba1465e351ae6ed0eabb1ff7e,2016-09-28 23:59:26,Ben Gotow,"fix(identity): Always refresh accounts after identity

This fixes an issue where changing your Nylas ID didn’t refresh your accounts, and N1 would still think they were invalid.",False
306a5010fdcb7e0f7b6fd2998cda57b288ddbe13,2016-09-28 23:59:26,Ben Gotow,fix(react): React refuses to add `partition` attr to webview,False
ab954521307d93418ff289fa9b0c337e41995f0a,2016-09-28 23:36:10,Juan Tejada,"fix(search): Update local search syntax to include more results

Add prefix search. Previously, if searching for a thread with a specific
subject, you had to type the entire subject. Searching for just a prefix
wouldn't return the result.
This should not affect any of the current search results, only add more results",False
9f1b11a5de4c828ab2bd91ecac6a7dd749631640,2016-09-28 12:09:10,Jackie Luo,fix(lint): Change variable to const,False
ae306a94ab28a7ddda9ecbcf553c7fc45f577230,2016-09-28 06:15:51,Ben Gotow,fix(drafts): Sanitize quoted text to avoid overlaid component issues [!!],False
9191a1cb6a83c2ea4a611e28586874321114e4c5,2016-09-28 05:01:28,Ben Gotow,"fix(thread-list): Use interaction handlers, don’t update selection directly",False
f51111d924b9e5ab79cd846aa8e7c562abb3e01c,2016-09-28 03:36:23,Juan Tejada,fix(warnings): Correctly remove all unknown props warnings,False
1647becce552342ee868d534bd6ba53ca2c2781c,2016-09-28 03:36:13,Juan Tejada,fix(overlaid-comps): Check if supports preview only after we know exists,False
29d6b972b1ea866e92c38d2558d9096ea7acead8,2016-09-28 03:31:28,Ben Gotow,fix(db): Add an index on Thread.client_id for modelify,False
1e9b32ed0500eebddfcca463c523e17667d3d866,2016-09-28 03:10:58,Ben Gotow,"fix(composer): No need for overlaid z-index: 10, appearing over menus",False
ea47381b52aed25fd647151fdb5c28576791f965,2016-09-28 03:06:58,Ben Gotow,💄(mail-merge): Fix alignment and height of tokens,False
df499243f72050b56f8f4675b580ae4a97ce9f65,2016-09-28 03:06:58,Ben Gotow,"fix(sidebar): Command-click + href to open in background

Global window event handler should work when clicking elements /inside/ of an a tag with an href.",False
41a4e3198a3584eaf741cc29701fc6c2daffd815,2016-09-28 03:06:58,Ben Gotow,💄(sidebar): Github repos should not wrap,False
bf2f156dcbc0453f648f46e451d97cee71e32cbc,2016-09-28 02:52:50,Juan Tejada,"fix(mail-merge): Reduce max number of emails to 250

Almost always, you will get rate limited trying to send 500 emails.
Reduce to 250 to make it more reasonable",False
42aa3e01cdddaa31716d4556d82c06de033ee2d7,2016-09-28 02:52:50,Juan Tejada,fix(tasks): Report slow performLocal only when it takes > 500ms,False
8d0d38357f682d9c83ecdfec11b044e1fa59ba56,2016-09-27 23:05:50,Jackie Luo,fix(install-location): Update language and remove buggy regex,False
cb92ee3ad03b6b5f7c0433bd107b48b857bf4ca2,2016-09-27 23:02:52,Juan Tejada,fix(whitespace),False
bc76c3d9d1d6c9ff7ef139bb950a79c0e1729b24,2016-09-27 22:22:11,Juan Tejada,update: Update CHANGELOG for v0.4.55,False
2627a88dae1b45f314bcdace3eb29a342ff97bad,2016-09-27 21:18:57,Juan Tejada,bump(version): 0.4.55,False
1b4209ed377784835befe19582072239e11d19ff,2016-09-27 21:16:35,Juan Tejada,"fix(tasks): Add instrumentation to Task's performLocal

A slow performLocal may be one of the causes of #2725",False
2af6eb7be3e5b264de4464c9c428c8414e9258e1,2016-09-27 12:16:46,Ben Gotow,es6(db): DatabaseTransaction & Query moved to ES6,False
138afab00e8c245af8f1426517b727f7e3173223,2016-09-27 05:52:56,Juan Tejada,fix(specs): make sure stub resolves (bump submodule),False
42854d9ccfc5191f05a948e3cef279a2eb292f53,2016-09-27 05:52:08,Juan Tejada,fix(lint),False
fabea8a504a5f8db66c17d2092aba4562aa954ee,2016-09-27 05:34:23,Evan Morikawa,"Revert ""fix(task-queue): performLocal now operates serially""

This reverts commit 179d3fd78a4c817115d7013f6692834b4845d1db.",False
009365a155e329bda5cd979d23165525b2e37e6b,2016-09-27 05:31:19,Ben Gotow,"feat(inline-images): Drag & drop or paste inline images

Summary: Initial support for inline images. Tests still forthcoming!

Test Plan: WIP

Reviewers: mark, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3295",False
2485312a3faa5d3e9b14fda757ec80d373ed3982,2016-09-27 05:19:22,Mark Hahnenberg,"Fix broken test

Summary:
Fixes a test that was broken due to my unfamiliarity with
CoffeeScript :-/

Test Plan: Tests

Reviewers: bengotow

Reviewed By: bengotow

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3302",False
49ae0926410dee75982f3dc79dbb382a2226431b,2016-09-27 05:04:29,Juan Tejada,"fix(contact-sidebar): Correctly update selected contact

Sometimes, when selecting a contact (with name, email) inside a thread,
the dropdown (`<select>`) did not correctly reflect the selected
contact.

This was because when focusing a contact, the FocusedContactStore
queried that contact from the database just by email, and the contact
retured from the database became the focused one. However, sometimes the
returned contact might have the same email but different email, and
given that the `<select>` component is keyed by both name,email, it
couldn't find the appropriate <option> to render, so it could not update
to reflect the newly selected contact

Now, the FocusedContactStore queries by email and name to prevent this",False
f954b85ad69ad2e2cab5b4495c7f18c4aabbed6a,2016-09-27 02:06:49,Mark Hahnenberg,"Add jitter to BackoffTimer

Summary:
This should help us avoid the thundering herd problem if we have some
kind of API outage affecting a wide number of clients.

Test Plan: Tests

Reviewers: bengotow

Reviewed By: bengotow

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3297",False
80e1c5b457248385f8c64d27162ef65c61e44783,2016-09-26 23:50:10,Juan Tejada,fix(mail-merge): Add test coverage,False
e40193f5646626d724647adc589e87af9226d10a,2016-09-26 23:46:49,Ben Gotow,fix(help): Better help URL,False
6a9949ec0a322e9c1252d5252a0094721254b03b,2016-09-26 20:26:21,Evan Morikawa,fix(mail-merge): fix `applyExtensionTransformsToDraft` rename,False
eda3ba8359088dd3f9c861e7a37ecb287eaee092,2016-09-26 01:57:10,Evan Morikawa,fix(attribute): fix es6 conversion error,False
72809ca990d12655fb9e34658a819c995c82b72f,2016-09-25 01:01:25,Juan Tejada,"fix(warnings): Fix warnings for react unkown dom prop

When using the pattern `{...extraProps}` to transfer props in the render method,
if rendering a native dom element, react will issue a new warning if we
end up passing invalid dom props:
https://facebook.github.io/react/warnings/unknown-prop.html

This adds a helper library to exclude invalid fom props instead of
manually excluding props inside each render method",False
99e80a4bd84c7dfedd5f6bad7fa5c6e627c4dec1,2016-09-24 05:31:05,Ben Gotow,"fix(tooltips): Defer display of background, ensure dot inside window",False
29ac8950449a796043d658f93a626558c7917a07,2016-09-24 05:08:39,Ben Gotow,bump(submodule): Replace regexp body transforms with DOM approach,False
ee0241038f70278c5e3a9e9fdd8006210778d2df,2016-09-24 05:06:08,Ben Gotow,"feat(transforms): Replace regexp body transforms with DOM approach

Summary:
We originally didn't do this because creating a DOM tree was loading images.
Using range.createContextualFragment seems to do it without the tree ever
being attached.

Accompanying changes to src/pro are here:
https://phab.nylas.com/D3300
https://github.com/nylas/edgehill/compare/bengotow/draft-dom-transformations?expand=1

Also rename applyTransformsToDraft => applyTransformsForSending. Needed
a new name because the function signature has changed. AFAIK there are no
open source plugins using the old functions.

Test Plan: All specs updated

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D3299",False
7a647204c95e9783bbeb9053b7c8724954818e71,2016-09-24 00:05:44,Juan Tejada,"fix(long-connection): `close` instead of `end` on network end event

NylasLongConnection.Status.Ended means that we can't open the
connection again. When we get a network level 'end' event, that doesn't
map to our meaning of `Ended`, so we should just close it instead",False
ee226113e95badb8cf5629a2d1a07e4387aaaa03,2016-09-23 20:58:41,Ben Gotow,es6(db): Query builder converted to ES6,False
d82fe350ae45e8dba175da2d2c504346cf741a3c,2016-09-23 20:52:13,Ben Gotow,bump(electron): Update to 1.4.1 to fix intermittent Symbol() error,False
a3225e1b77f4f45257cc50776f2f57655b0788c5,2016-09-23 02:01:22,Ben Gotow,fix(tray): Flipped logic in displaying unread count,False
dd3cf1c50f8507b9b86adffc1e23259e53538424,2016-09-23 00:38:59,Juan Tejada,"fix(search/long-conn): Process results buffer before ending connection (#750)

NylasLongConnection ends the connection when the 'end' event is emitted
by the `request` object. When this happens, the global connection buffer is cleared.
Also, the global buffer holds the data we've received from the connection, and
whenever we receive new data, we accumulate it in the buffer and call a processBuffer function
which is throttled to 400ms.

Given that the buffer is global state, and processing occurs
asynchronously with a delay of up to 400ms, if the 'end' event on the connection is
fired before we actually get to process the buffer, we would clear it and show no results.

This scenario currently only affected search because if we accidentally
threw away some data when streaming deltas, we will get that data again
when we reopen the delta streaming connection.",False
109e1e1e1996b23c17da149946ef0843a4907189,2016-09-22 12:37:23,Ben Gotow,es6(db): Query-related classes moved to ES2016,False
179d3fd78a4c817115d7013f6692834b4845d1db,2016-09-22 02:20:41,Evan Morikawa,fix(task-queue): performLocal now operates serially,False
247d12e8de291b2502e6005afe89f44df3b3be3c,2016-09-22 00:26:54,Ben Gotow,"fix(specs): attribute conversion fixed bugs, broke specs",False
9972f2e42116237959146f64c1aaccdf8b46ff59,2016-09-21 23:53:38,Ben Gotow,fix(accounts): Restore account re-ordering,False
c19ea14da594325a8113fd54085abf7b6599d4ce,2016-09-21 23:15:04,Ben Gotow,hack(channel-picker): Hide Salesforce for now,False
57f963ebc1401f0530afc150b3f26e7cd01e8732,2016-09-21 22:15:11,Ben Gotow,es6(db): Didn’t wait for NylasLint…,False
ae45b4b898c5eec1f0912d0dcde080340b666ef6,2016-09-21 22:06:36,Ben Gotow,es6(db): Convert attribute class declarations to ES2016,False
18f7a8d463cfe243b329e98f7676c84df7b8e133,2016-09-21 05:58:50,Ben Gotow,"bump(react): 15.3.x, warning removal, thread-sharing tweaks",False
0709b33c9175283eb1937b3210e7b537cbcb765d,2016-09-21 05:04:30,Ben Gotow,lint(*): Fix issue breaking the build,False
abdae1e7954d633330d0602a2d292fe54b7e88e3,2016-09-21 04:51:31,Ben Gotow,fix(tooltips): Position relative to custom container for composer,False
c2a3dab18788312c5cedf80fe601138301eafcd1,2016-09-21 04:22:36,Ben Gotow,fix(auth): Update autofill for Fastmail.fm,False
dd8b83bcf925d768d2a499a524b7f9abf8b4570a,2016-09-21 04:18:39,Ben Gotow,fix(thread-sharing): Fix unloading plugin,False
e33c10b61ea07d1bd63b850938e98929e542ab0b,2016-09-21 04:18:15,Ben Gotow,fix(drag-drop): Restore support for thread dragging,False
4affeff58e4b4b054abeff2173eee242fe3e8a1a,2016-09-21 03:47:48,Ben Gotow,"fix(specs): Fix tests that were console.logging, bump coffee-react",False
06ead70a6a8c87144c6eb34ca104a811178591c4,2016-09-21 02:53:53,Evan Morikawa,"Revert ""fix(promise): Don't use deprecated Promise.longStackTraces()""

This reverts commit db0e025fb5e56880ffea147ad5c4dcfb37b9d830.",False
81b9eec674fe50782e3c691a2edbd1d7474d257a,2016-09-21 02:47:39,Evan Morikawa,fix(error): Let APIErrors have proper stack traces,False
db0e025fb5e56880ffea147ad5c4dcfb37b9d830,2016-09-21 02:46:59,Evan Morikawa,fix(promise): Don't use deprecated Promise.longStackTraces(),False
8368e9cba7350283ef5f9c4b041e5a0db8192ff4,2016-09-21 00:01:33,Ben Gotow,fix(specs): Display which tests are console.logging,False
9a137677421347676696a49a59f2a1d932600d31,2016-09-20 22:56:44,Ben Gotow,fix(darkside): `script/grunt lint` requires explicit LESS includes,False
cfa62e28e04ea18bb62eb42afdb37cb730ef9856,2016-09-20 22:50:15,Jamie Wilson,"design tweaks, breaking css up into files, update readme (#2858)",False
6eea9d26f1cda3712b2f6b31aa54c0d68ee27d94,2016-09-20 08:06:32,Juan Tejada,"fix(long-connection): Throw error for reporting, instead of just logging",False
5f8bb9dffdd2e5b989254ba8c9dc329909aeff90,2016-09-20 08:03:52,Juan Tejada,"feat(msg-list): Don't make participants mailto links, add context menu",False
657b8f38efd3602b964497456a9bca85025c8be0,2016-09-20 07:03:17,Ben Gotow,bump(version): 0.4.54 beta,False
779a27c5b882acc06a7e491b29358cdcf9c7702d,2016-09-20 06:37:43,Evan Morikawa,fix(lint): import ui-variables for linter,False
1734e588b61b2a1aa6b89dc7de18fc1418ee3871,2016-09-20 05:51:55,Ben Gotow,"fix(trial): Move”days left” bar to the sidebar, new design",False
ebb5584e541f64cc822afcbf11726b04138fd8ec,2016-09-20 05:44:41,Evan Morikawa,fix(util): Utils.deepClone properly clones dates,False
3d826fff41d744806e1e0c9d3bdceb395f1ce2ae,2016-09-20 04:50:34,Ben Gotow,fix(trial): Compute “days remaining” in timezone-aware way,False
0891ad855d00a780acc3471c36a71e3eab9eb9ee,2016-09-20 01:19:46,Juan Tejada,fix(logging): Fix query logging: escape '%' properly,False
35c3a66642d7f01168be95c1f130296c58d337f7,2016-09-20 01:11:16,Ben Gotow,"feat(channels): Choose an update channel! Limited time only!

Summary: Just a small select input.

Test Plan: Run tests

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3282",False
ebb8d02c3dcf9795b9ef753e8385a9ee176fdd42,2016-09-19 22:42:34,Jonathan Lai,Fix typo: dependencesi > dependencies (#2838),False
62d25ce840312a2973c128b786002c0a92cce5b7,2016-09-19 21:22:24,cem guresci,Add link for Darkish theme (#2854),False
e01a23e2c2c4fc0796b82c188306cfdadddeab1a,2016-09-17 06:04:22,Ben Gotow,"fix(tutorial): Minor tweaks, finalized styling",False
ec28214d5e93905ebbf7de6ffc89881edc7650dc,2016-09-17 01:51:52,Juan Tejada,"fix(keymaps): Correctly map mod+z to undo, instead of just z (#2663)",False
a5723dbc5a11589272a60cf73f8d3aeb2c984117,2016-09-16 21:29:36,Ben Gotow,"bump(electron): Electron 1.4, node-sqlite 3.1.4+fts",False
b07c0377d2880e6a49b7df4ab268c28ec728eabd,2016-09-16 21:08:52,Ben Gotow,fix(N1.sh): Allow path to working copy to have spaces,False
b1fb5d8b3a470afa158a8d58b6fb817d7ca40cfc,2016-09-16 12:35:48,Juan Tejada,fix(thread-sharing): Timestamp range in seconds,False
ffe7fc57c0ba3d6331612871b5838eb297399524,2016-09-16 12:30:02,Juan Tejada,fix(thread-sharing): Throw error when thread is /not/ found,False
ff7ea9da7d7c467805d8af0faa96ea03ef0563d1,2016-09-16 06:55:57,Juan Tejada,fix(mail-merge): Correctly handle empty column names,False
34996ec597e69d00ce65cea81cb1b1daae8f0808,2016-09-16 06:40:07,Juan Tejada,:art:(thread-sharing): Prefer url and querystring modules to parse url,False
bb2a69ec32077ad9c6a478860a95939b05b2c7c6,2016-09-16 05:13:30,Juan Tejada,"fix(thread-sharing): Find-thread, incr timestamp delta to 1min in ms",False
36f4801f062a88b68d98357ef82b9a8c1356fb6f,2016-09-15 07:03:50,Juan Tejada,bump(build),False
5e10cde7e3d3303765184d69ed1210eddd749f39,2016-09-15 06:43:35,Juan Tejada,fix(thread-sharing): Update popover style,False
48aeaf94eb71470401e8df9724296b2c0f30ebf1,2016-09-15 03:04:01,Juan Tejada,fix(changelog): Update changelog to reflect latest puublished release,False
0520a94dff7e1c7ca97a72f0f3c611062649b031,2016-09-15 00:55:00,Juan Tejada,bump(version): 0.4.53 and update Changelog,False
d52217a0873a2d087612583c04e56e5f8669b483,2016-09-15 00:26:36,Evan Morikawa,bump(version): 0.4.52 and add Changelog,False
cba4c4ac5195be818f5d1f78db414ade77391748,2016-09-14 23:51:48,Jackie Luo,fix(subscription): Remove hardcoded trial length,False
08ec6e534d2dd4daa22001d7a90ab11ebfad76b7,2016-09-14 23:46:19,Ben Gotow,fix(copy): Updating language for onboarding tour,False
1ab5a1327a8237b012a860b8462eddbd45d21d11,2016-09-14 22:44:50,Juan Tejada,fix(build): Fix lint errors,False
677a83b8f511db1c4a9bfefc507a73a8b815694f,2016-09-14 12:34:20,Juan Tejada,"Add thread-sharing plugin

Summary:
Add thread-sharing plugin:

- Add popover to enable sharing
- Register custom nylas:// protocol to open a thread via protocol is thread exists

Test Plan: Manual

Reviewers: jackie, bengotow

Reviewed By: jackie, bengotow

Subscribers: jackie, halla

Differential Revision: https://phab.nylas.com/D3265",False
0d67a593b4635dcb01c8b87dea069d6fa1d228bf,2016-09-13 11:59:38,Ben Gotow,"feat(tutorial): Overlay bubbles that guide you through initial features

Summary:
Add header to show how many trial days remain

More rendering out of Store, consolidate registry and store and expose via new serviceRegistry

WIP

Merge branch 'master' into hallamoore/feature-walkthrough-tutorial

Switch to using observable instead of AbortablePromise

Update submodule

WIP

WIP

Remove annotations

Remove changes

WIP

Test Plan: No tests

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3260",False
d87878bed3fe82718c7d03e03f9bf6652546d68f,2016-09-13 00:27:16,Gleb Polyakov,"Update Community Plugin Link

Changed todoist link to more polished integration at : https://github.com/alexfruehwirth/N1TodoistIntegration",False
90e7cfd2e71efb71bf5dad04524221daac521bd9,2016-09-12 10:19:44,Michael Grinich,more themes,False
241820c71e88a748dd57681700c98fac431ba12a,2016-09-12 09:55:02,Michael Grinich,Update README.md,False
14aab71cd7db0538f2ef893fcceddfcbff30dad3,2016-09-10 22:47:17,Alberto Castillo - acg,Fixed issue #2670. URL parsing '?#' (#2827),False
9ac730cccc1aa08f7e01c5672062071dcd9f4afa,2016-09-03 05:41:00,Jackie Luo,fix(identity): Log user out of app if identity token is missing,False
d47c5bf3dde5828db0e8d872bd0fbe62ec4768be,2016-09-03 04:31:26,Kyle King,"Fixes #2723 -> apm ignore plugin dev-dependencies (#2741)

`apm install --production`",False
b8b52fa5f7fe2cc434c44c4c7577c8751aff2f01,2016-09-03 04:25:30,Jonathan Lai,Fix typo: wether > whether (#2793),False
19091478a53045a5ea40ec74eb489ce4434ba289,2016-09-03 00:21:04,Jackie Luo,fix(send): Check for number of BCC participants before using multi-send,False
970f519f119e8e0b18e927b8b9991b436617b946,2016-09-02 23:45:25,Ben Gotow,Add “Ctrl-A” to the outlook shortcuts,False
a4ed2ccf7c2a83fc10420ce3dc88453e81f3258f,2016-09-02 23:45:25,Ben Gotow,Remove bad .jsx extension,False
e14961ab80b04c11e14559f5e9729490b8d77623,2016-09-02 08:58:17,Juan Tejada,bump(version),False
1685f3bd45e8ae59464682966d0803a69e766006,2016-09-02 08:51:13,Juan Tejada,fix(markdown): Update editor height,False
b14e4f6aa28b2d367e55755b496fdb4dbe564133,2016-09-02 08:13:10,Juan Tejada,"fix(markdown): Fix textarea bug (use our fork of simplemde)

- Textarea bug prevented us from typing in the markdown editor, almost
consistently. Seems to be a chrome bug
- Stop using textarea and use contenteditable instead via codemirror's
inputStyle option. Had to use our fork of simplemde to be able to pass that option
- Disable spellchecker also",False
f81c29e1cd1281564a32eda81ae9f5240bf50f51,2016-09-02 06:57:39,Juan Tejada,fix(markdown): Add setSelection method,False
eb87fe4745c54ff10262e2211dfd6a3369426e7b,2016-09-02 06:01:59,Ben Gotow,Markdown support for quoted text / signatures,False
176155275fba05a2d819f1fcc44483bb4c145046,2016-09-02 05:22:55,Juan Tejada,fix(markdown): Fix focusAbsoluteEnd,False
791a2caac35e9dde1cac04ae07bda41c44a36382,2016-09-02 05:14:53,Juan Tejada,fix(markdown): Fix tabbing into composer,False
8fea55583fdcda88713fac0161b12054e8e99735,2016-09-02 03:23:31,Juan Tejada,"fix(packages): Make sure we can migrate and correctly disable new packages

- Add a package migration manager to be able to migrate external
packages into N1, and decide if they should be enabled or disabled by
default when added.",False
10ed8a25212dc907359c267bccc1fc6b97b0de92,2016-09-02 00:02:52,Evan Morikawa,fix(size): remove unused docs & screenshots,False
21a485e23d0a124703c9e146ceb99777bf3467ea,2016-09-02 00:02:52,Evan Morikawa,fix(size): Losslessly compress package images via ImageOptim,False
b55c5bcdd96e868fc2aa077d56adb927ad60924c,2016-09-02 00:02:52,Evan Morikawa,fix(size): Losslessly compress images via ImageOptim,False
4ea242f9524635a11d443c09f8ab27f6093cc474,2016-09-02 00:02:52,Evan Morikawa,fix(size): Remove src/pro from build,False
65f9a3dd6bdb8001fdb581dbf7de586153d8f7c1,2016-09-01 23:41:25,Ben Gotow,"fix(onboarding): Fix React warnings, no back button to auth",False
2cbc1a7ddefae2c55eb27cd7b1426d140e0aa273,2016-09-01 23:33:30,Ben Gotow,"config(*): watch config across fs deletes, re-creates",False
0924404c854fcd98b1fffb794d24648971117ecf,2016-09-01 22:44:40,Ben Gotow,config(*): Fix bad template string,False
8122ed0b5a8ab4f3fd1efee2b0f3142534dc12d4,2016-09-01 03:52:53,Juan Tejada,update(*): Update changelog,False
c8006f4eb085e326686667d2a8228338e4492db7,2016-09-01 03:26:08,Juan Tejada,bump(version): 0.4.50,False
f8d2904f725b126c2a4a1f5da212ba15ed717bb0,2016-08-31 22:26:36,Juan Tejada,bump(submodule),False
7ffb156ee0c65f702e4c0665e30f4b8e7f3688ec,2016-08-31 22:26:23,Juan Tejada,plugins(*): Add identifying css classes to composer plugin buttons,False
a8b8359e0c37039b7ee0e35b1d525b99f9416460,2016-08-31 07:53:01,Jackie Luo,feat(markdown): Add Markdown composer,False
d1ba5a3e2b1cc570ffe7bbe7e3484f5d3c6c12c6,2016-08-31 07:50:51,Jackie Luo,fix(onboarding): Receive user info correctly,False
73a1fbf76b903181368b95334575ff654115ecd5,2016-08-31 06:25:19,Evan Morikawa,fix(less): tokenizing field input no box-shadow on windows,False
aac01d1088d1a1a4ca65a765d077b6e15db36060,2016-08-31 04:38:45,Juan Tejada,"fix(utils): Fix import when running in browser process

Main process doesn't know about nylas-exports",False
0ea35896b03e1693da04bf5dd2e25ba9f36d8198,2016-08-31 04:16:53,Juan Tejada,"fix(config): Write config.json atomically and handle errors (#2518)

Summary:
It seems that #2518 was being caused because `fs.writeFileSync` ocasionally failed and ended up writing an empty config.json file, effectively blowing away your N1 settings. The most common cause of failure for `writeFileSync` seems to be EBUSY error on win32, according to Sentry. The reason as to why EBUSY is happening so frequently on win32 is still unclear.

This commit:
- Adds an `atomicWriteFileSync` helper which writes to a temporary file first, and then renames the file. If writing to the temp file fails, we wont blow away our actual config.json. Also, renaming seems to be atomic across all platforms.
- Adds more robust error handling and messaging to both loading and writing the file, and report them to Sentry
- Automatically retries saving the file 3 times before telling the user.
- Fixes https://sentry.nylas.com/sentry/edgehill/group/43112/

Test Plan: Manual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3245",False
95aa6386fce644e0b91e9eb5bc65f333ff50132a,2016-08-31 03:22:19,Evan Morikawa,fix(onboarding): no longer show welcome page,False
105a0526cbca02f06d98022d1e37c2d0f1d1a887,2016-08-31 03:16:48,Michael Grinich,add theme img,False
4fa75e2c0a730bd192ad14ee021a5c0291d1b872,2016-08-30 23:23:36,Michael Grinich,theme notes,False
f5bf41a18156d96977cc400e84eb7d7cb3910a90,2016-08-30 23:11:31,Evan Morikawa,fix(onboarding): fix injected js error and pass N1 version,False
5108cded87ef489931ddcc92a0f037094e564624,2016-08-30 07:37:44,Evan Morikawa,feat(webview): can add .open-external class in webview,False
88ed82dd0d3dd4340104c5dc93c218c65b705f36,2016-08-30 06:13:24,Evan Morikawa,feat(travis): add ci-build/.* wildcard to building branches,False
ec848a4a6e555707f578c36ca67a56fd87e1ce43,2016-08-26 02:48:06,Jackie Luo,fix(lint): Remove unused variable,False
1f15026a5f914ac0b3596008123424cb18cf28d9,2016-08-25 23:14:32,Jackie Luo,"feat(oauth): Add new component for OAuth sign-in

Summary: Future services that require OAuth get a cute new component that lets them connect more easily.

Test Plan: Tested manually.

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3186",False
7406c1a94fbbb4b41dfe5d307188a9c153108fd1,2016-08-24 03:15:46,Evan Morikawa,"fix(dev): don't show tokens in developer api bar

Fixes #2756",False
629ddf78860ea929c9a3fc3bb56fa37114d7784e,2016-08-23 23:16:44,Jackie Luo,feat(onboarding): Allow HTTPS in self-hosted sync engine onboarding,False
e294415e2f0aef0df601429cc5b4c2bc67acb565,2016-08-23 04:44:51,Evan Morikawa,feat(workspace): keep track of workspace mode,False
f9a530017de40b5194d0f8e62743e53680299616,2016-08-19 06:41:52,Juan Tejada,"fix(msg-timestamp): Fix incorrect date var / convert to es6

- Typo in cjsx code broke the message timestamp
- Converted to es6 so this doesn't happen again!",False
63672a72fc14a392934368e3b4cb404d09c03b21,2016-08-19 03:46:58,Juan Tejada,Update changelog,False
2839ce2856c35566243285c90185beec13111ec3,2016-08-19 03:39:16,Juan Tejada,"fix(mail-merge): Remove extra call to `linkToDraft`

Screwed up our state!",False
c908a1633ca2c745a52d495869716b78c719e0ba,2016-08-19 01:52:56,Jackie Luo,"fix(autoupdater): Change feed URL when Nylas ID or accounts changes

Test Plan: Tested locally.

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D3178",False
afc20f255a9f1fb37a9958f18009f1098f6714a5,2016-08-19 00:57:45,Evan Morikawa,fix(lint): fix linter error,False
4a0af16abd73717609f876237f4ac5e936c8896e,2016-08-19 00:51:41,Evan Morikawa,bump(version): 0.4.49,False
dcdfa230e85febd39965e4e584c15d50c1634215,2016-08-19 00:44:53,Evan Morikawa,fix(draft): prepareDraftForSyncback double checks quotes on send later,False
e6deb83440e77484fe0c27f6b2ee69f17ca1d02a,2016-08-19 00:12:55,Evan Morikawa,feat(plugins): plugins now properly report which are active on change,False
01dee59e0430ece3e2c7cd53e9e0a67628add671,2016-08-18 23:09:13,Juan Tejada,"fix(send): Don't retry send

Summary:
- There are some cases in which constantly retrying send can cause unexpected bugs like sending multiple times, so don't retry send at all
- Make 429 a permanent error code

Test Plan: Manual

Reviewers: jackie, evan

Reviewed By: jackie, evan

Differential Revision: https://phab.nylas.com/D3177",False
0a5388d0bbfcee8fc97725b8112dc15d0e75bfc0,2016-08-18 22:28:13,Evan Morikawa,feat(app): dialog box prompting to move to Applications folder,False
9b0306d509557f7eeef1e4fe5ace26c94c7a817e,2016-08-18 21:58:09,Jackie Luo,fix(errors): Remove reporting for applyTransformsToDraft,False
4b4763dba4343a6a8e5b9740d363429345568a46,2016-08-18 06:39:26,Juan Tejada,fix(mail-merge): Update props for body tokens when state changes,False
5f0b248a2e0f578cfb84130e8dae44fa73814bf3,2016-08-17 22:44:38,Shelley Vohr,improve first name parser by adding honorific exclusions (#2732),False
07f0ed69ef3505796565fe9996f06c5296b86a4f,2016-08-17 10:20:17,Juan Tejada,Update changelog for 0.4.48,False
c7a69e1e8feaf855b5d65021befd981a6ac3f21a,2016-08-17 06:12:28,Evan Morikawa,bump(version): 0.4.48,False
74ad414bf8c8942405509ea63c85d2f0cea9a2e5,2016-08-17 06:07:02,Juan Tejada,"fix(build): Fix specs and lint errors

Summary: Fix specs and lint errors

Test Plan: Unit

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D3168",False
97084687b4bd65643532f5ff1b59f2d9a2d95889,2016-08-17 06:00:09,Jackie Luo,fix(submodule): Remove submodule commit,False
6ff7aec999ded762d449f5ea986cb5c3a7ece3a7,2016-08-17 05:52:30,Jackie Luo,fix(tracking): Check for specific plugin before transforming body,False
5231b4f556be1f31340cd07f26f037eb456a98d9,2016-08-17 05:28:13,Evan Morikawa,"feat(install): add a checker for the install location

Summary:
Adds a new notification bar for mac users only that warns you if N1 is not
in your /Applications folder. Gives you the option to move it to your
/Applications folder.

Test Plan: manual

Reviewers: juan, jackie

Reviewed By: juan, jackie

Differential Revision: https://phab.nylas.com/D3166",False
b223a38b73058fafbd3b4c19e6963ab50eefb6d3,2016-08-17 01:51:41,Juan Tejada,"fix(mail-merge/preview): Don't unmount components when toggling preview

Summary:
See edgehill revision: https://phab.nylas.com/D3160

- CustomContenteditableComponents.get now takes a single component to register as an overlaid component, and this component will be passed a prop `{isPreview: true}` when it is meant to be rendered as a preview. Update scheduler and mail-merge to use this new api.

- This prevents the mail merge state from being incorrectly updated when we toggled preview mode -- previously, it believed that the tokens had been unmounted when toggling preview, so they were incorrectly removed from the mail merge state.

- Additionally, makes sure that tokens are correctly added to the mail merge state whenever a token is rendered via componentDidMount -- previously, we only added the token to state when a token was dropped on the contenteditable, however, a token might be pasted or an anchor node might be added by any other means, in which case we want the mail merge state to reflect that. (Adds docs about this)

Test Plan: Manual

Reviewers: jackie, evan

Reviewed By: jackie, evan

Differential Revision: https://phab.nylas.com/D3161",False
3b365dd9b14594fbfa50a1501f9a79d53da5000e,2016-08-16 02:46:54,Evan Morikawa,"fix(window): window launcher now assigns new window keys if none exist

Fixed issue where new windows wouldn't refresh themselves because the keys
were stuck on the hot window",False
610aecb1842059a7104fa40809c295c6f55b89ff,2016-08-16 02:09:40,Evan Morikawa,"fix(metadata): add pluginId string check when grabbing metadata

This caused an infinitely growing set of duplicate metadata entries whose
keys were ""[object object]""",False
ff61da26d725f8d12af25b767744edc48b22abe1,2016-08-16 02:08:01,Evan Morikawa,"fix(sidebar): fix bug in sidebar scoring

Not properly getting passed the account means that yourself was not
properly downgraded in the sidebar participant score",False
43ea21e3bf1f14036944dad11d43696bdfa9c06d,2016-08-13 04:36:22,Annie,"add(composer): Turn emails into mailto for debugging purposes

Summary:
fix(subject-field): Fix subject text field focus
Before, if you clicked a mailto link, once the composer loaded, the subject field (which was focused in composer-preload) blurred. This was not ideal as users would want to type once the popout loaded and instead they would have to click first. We identified that this was coming from the composer header _renderSubject injected component. We fixed the focus within mail merge subject text field and additionally added the onComponentDidChange method to injected component. This allowed us to only update the component when the header field changed.

Test Plan: tested on my machine for mailto links

Reviewers: juan

Reviewed By: juan

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3150",False
a7602a5351c0a2524f40f73e1aefa90ee1216f18,2016-08-13 02:57:31,Annie,"fix(cursor): Make cursor focus at the top of email

Summary: When you would click outside the contenteditable in the composer, it would focus to the absolute end. Not ideal. I added a check if the click is above the top of the content editable -- if you click the top padding of it -- then focus at the beginning.

Test Plan: is this something i should test?

Reviewers: juan

Reviewed By: juan

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3139",False
492c1ad52393fcfea1c1078729f680d8e2778375,2016-08-09 07:06:21,Wattenberger,Add Snow to README (#2711),False
f482645effce413b3bae78713d02f90f1c2d3012,2016-08-08 22:31:47,Ira Praharaj,Updated readme to include BoraBora and Honeyduke theme (#2708),False
2e1bd5daae45a471e64103d8b9ce000d0113e020,2016-08-06 00:45:39,Evan Morikawa,"fix(env): add remove unload callback for stores

Also add eslint_d to linter setup.
Developer bar store supports bearer token auth",False
59b5c2d960e2e95e68f0f5bf8e659c7dc4d8bb20,2016-08-03 23:53:55,Evan Morikawa,feat(request): Add APIRoot as an option to Nylas API Request,False
011d5e90a9be1490c6fe53ae0eb59ce710a4f026,2016-08-03 06:04:56,Evan Morikawa,Add NylasLongConnection to nylas-exports,False
0de68632dfb5b14a31cf28c1c150c184795b67a3,2016-08-03 04:47:34,Evan Morikawa,"Auth keybase and clearbit

Summary:
Fix to pass N1 ID auth through to edgehill-server for remaining services
(clearbit and keybase) that request authing against the Nylas API. We need
to pass along the N1 ID.

This also requires an Edgehill Server patch here:
https://phab.nylas.com/D3149

Test Plan: Manual.

Reviewers: bengotow, juan

Differential Revision: https://phab.nylas.com/D3151",False
b46f60fc1cadab5f1a4b839c350aec0c7b59524b,2016-08-02 02:48:13,Annie,":art:(signature): Fix signature dropdown styling on different themes

Summary: Ran into issues with the selected tag having different styles associated with it in taiga and in darkside. Fixed these.

Test Plan: Tested on my machine

Reviewers: jackie

Reviewed By: jackie

Subscribers: jackie

Differential Revision: https://phab.nylas.com/D3144",False
3678c23515d64f8e83dd9cfc587cdbde2b7bc38a,2016-08-02 01:20:36,Juan Tejada,"fix(mail-merge): Fix cursor style, refactor state reducers, add test",False
9fe6717a982440fbba3ffaf0ffb8a4c0fccbdc50,2016-08-02 01:11:05,Juan Tejada,"fix(utils): Properly export DateUtils.timeZone, fix specs",False
5e2f8756e01a5ba401604b69780b48ee4ae831fc,2016-08-02 00:39:01,Juan Tejada,fix(activity-list): Properly update to DateUtils.shortTimeString,False
5254589e5ee830ff84623c43c9cf4234f2c2bbc4,2016-08-02 00:24:00,Ben Gotow,fix(signatures): Scrolling for long signatures,False
ead866fc065eafab159cb43ae831d11e76e10275,2016-07-29 06:49:07,Ben Gotow,fix(phising): Make detection lower case #1784,False
7faa9ac7bd9a36c0ae916a8d11c1f2deedca27ae,2016-07-29 06:12:14,jathpala,"Better support 24-hour time (#2622)

* Added support for 24-hour time to the thread list view (Issue #682)

* Add 24-hour time support to the thread list scroll tooltip (Issue #682)

* Fix for 24-hour time in the thread list scroll tooltip (#682)

Correctly imports the DateUtils module

* Add support for 24-hour time to the draft threads list (Issue #682)

* Add 24-hour time to the message sidebar

* Fix for 24-hour time in the message view so the rollover tooltip is 24hour also (#682)

* Removed unused date functions from utils

fullTimeString and shortTimeString from src/flux/models/utils.coffee were not
compatible with 24-hour time. These functions were modified and moved to
DateUtils in src/date-utils.

* Fix for display of 24-hour time in the message view (Issue #682)

* Removed unused import of Utils in a couple of files

Prompted by Travis build errors.

* Updates to handling of date/time display

Incorporates changes suggested by @bengotow.
Re-enables support for the isDetailed property in message-timestamp (if this is set
to true, a medium length date/time string will be used for display).
Re-enables additional display varieties based on when the email was received. Note
that this is implemented slightly different to the orinal version - time is now given
as an absolute time rather than ""... days ago"" format.
TZ guessing moved to the global scope of date-utils for performance reasons.

* Minor de-linting

* Re-enable all tests by unfocusing the test suite

A previous commit (ad04775) added an fdescribe() to one of the tests in
draft-helpers-spec. This changes that to a regular describe() so that
all tests will be run when running ./N1 --test.

* Added tests for the new DateUtils functions

Added tests for getTimeFormat, mediumTimeString and fullTimeString.
Removed no longer relevant tests from message-timestamp-spec as _formattedDate
has been removed in favour of the functions in date-utils.

To test shortTimeString, we need to be able to set a fake current time which is
possible in jasmine 2.0+ but not in 1.3 which is currently in use.

As a possible bug, when running more than 10 tests the following warning is raised:
""(node:25025) Warning: Possible EventEmitter memory leak detected.
11 on-config-reloaded listeners added. Use emitter.setMaxListeners() to increase limit"",
source: internal/process/warning.js (24)

* Minor de-linting",False
329ea706709401b8ca810b4008f0fc5940ce9bf8,2016-07-29 06:05:56,Halla Moore,fix(error msgs): Show an error when we can't store the identity token,False
8b837fb11313191d01d58907efbd371fd12a117e,2016-07-29 03:55:11,Halla Moore,"fix(icons): Prevent signature dropdown icon from appearing too large

The 1x and 2x icons for the signature dropdown were both actually the same size,
resulting in too large of an icon when N1 thought it should use 1x. Fixing this
by simply removing the 1x file.",False
b0f30f58567fc511380d2ea33b55f0ed710a81c5,2016-07-29 03:47:04,Ben Gotow,feat(changelog): 0.4.47 release notes,False
36bd794b612f637833f2207e1fc7e375446d58d6,2016-07-29 03:24:37,Ben Gotow,feat(signatures): Fix specs,False
817a78a29661edb851e9049ee5df539f8d348de8,2016-07-29 03:16:01,Ben Gotow,feat(signatures): Upgrade old signatures to new format,False
5dc0f53cea48b63d8457db9e46d1de7752636df2,2016-07-29 02:45:31,Annie,bump(submodule),False
c347a36ab5f4c4a107ee087499c610283c55e9ae,2016-07-29 02:35:51,Juan Tejada,"fix(mail-merge): Skip row in table data if its empty

- Don't show annoying error if entire row is empty
- Just show error if just the email cell is empty",False
0b82543c44b8b7467ae7ad38735230b121c67fab,2016-07-29 02:12:53,Halla Moore,"fix(spellchecker): Make sure spellchecker returns selection to its original state

This also fixes the scenario where the link editor wouldn't pop up properly with
misspelled words.",False
44d8d823a053eb5e3a8d61f7ccd9b0cc5b7d2af4,2016-07-29 02:04:46,Ben Gotow,bump(version): 0.4.47,False
0c414989776d76a061c243b0f236c11465dd9dc7,2016-07-29 02:03:59,Ben Gotow,"fix(quoted-text): Don’t add <body>, <head> accidentally to text when transforming",False
95a03692ed706a42b80b4b3515240d5109408cdc,2016-07-29 02:03:59,Ben Gotow,fix(keybase): incorrect react proptype,False
e3a58b4bde185f1d7963a1fd298adac1738151e7,2016-07-29 02:03:59,Ben Gotow,fix(thread-list): Random error when rapidly clicking row after launch,False
5f52a9a47b41de363791da4f109a131ad56ae92f,2016-07-29 01:10:31,Juan Tejada,"fix(specs): Properly spy on streaming connection

- Prevent error logs and actually trying to start delta streaming
connections",False
796af843a00a0a66007c7a57a833b2b45dfbbaf4,2016-07-29 00:42:10,Annie,"fix(mail-merge): Fix column deletion and added a spec for uneven data

Summary: After importing an uneven csv (not all rows have the same number of columns e.g. rows: [[1,2][3,4,5]]), deleting the last column would improperly delete data in rows with fewer columns. This is because we were slicing each row based on row.length - 1 which is not the same for all rows. Fixed this by creating a new variable newNumColumns which is columns.length - 1.

Test Plan: Added new test data with uneven data and added a test in table-data-source-spec for removeLastColumn on this uneven set.

Reviewers: juan

Reviewed By: juan

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3133",False
ea60c69fa657bf8a7e29eb2d6cb5d6ef50ea13bd,2016-07-29 00:40:54,Annie,"refactor(folders): Make folders disappear when deleted rather than graying out until confirmed

Summary:
When testing we thought that Deleting a folder turns it grey but keeps it in the folder list; trying again throws this error.
It turns out, that the folder was actually going to be deleted if left alone long enough, however, since it sat there grey for a while
we would attempt to delete it again which would throw an error. To get around this, we removed the isDeleted grey state and
unpersisted the folder right when delete is clicked then persisted the folder if there was an API error.

fix(folders): Add new and extend destroy category task specs

Test Plan: I tested locally, tweaked destroy category task specs and added minor new specs

Reviewers: bengotow, juan

Reviewed By: juan

Subscribers: bengotow, juan

Differential Revision: https://phab.nylas.com/D3131",False
0723457f27b80ec9c76a8aabb51719edc6b496dd,2016-07-28 23:50:02,Ben Gotow,fix(specs): Wait longer in DraftStore specs for window close,False
947646fed8732a78df19faecf96c16bb4616310a,2016-07-28 23:01:48,Juan Tejada,fix(log): Rm unecessary console.log call,False
301d10e33e0c1c0cb2a6f7725ae07d2fd418348e,2016-07-28 08:38:18,Jackie Luo,:art:(onboarding): Fix clipped gears in onboarding,False
8e1aa4b371b4c72a99d6c76ebd655c6ae9d5e25a,2016-07-28 08:22:08,Halla Moore,"Make sure draft has enough time to save before composer is closed

If the composer is closed too quickly, the DatabaseStore doesn't have enough
time to trigger the necessary ActionBridge events that will properly save the draft.
These events are triggered every 10 ms, so to be safe, we wait 15.",False
a728722f0f68fb6753b1e5c35b10e95601d0e154,2016-07-28 08:02:32,Jackie Luo,:art:(ubuntu): Unhide toolbar for popout composer,False
05b6d46002cce310ac00f5db975dbb62c4efd6bf,2016-07-28 07:05:32,Ask Brean,"Enables showing/hiding of menubar (#2648)

* Enables showing/hiding of menubar as per #1181

* Updates to new setting name",False
ef6cf545d85d4e8448a92d40dfb8660003f9c0b0,2016-07-28 03:00:12,Juan Tejada,"fix(deltas): Update latest cursor, address comments

- Add test to make sure that latest cursor is updated",False
b7408805f0a30383df77666b52500c6e42202b87,2016-07-28 00:22:55,Ben Gotow,"fix(packages): Don’t look for package in top level directory

Fixes issue with Keybase.io installing a folder at the top level of the filesystem called `keybase`",False
008aa113187e121af93d542c47ecd75b33051640,2016-07-27 15:42:55,Juan Tejada,fix(long-connection): Close connection on 'end' event,False
693bd18267af9741bce0545d8cd5743af3ef18a0,2016-07-27 15:26:55,Juan Tejada,"fix(deltas): Consolidate nylas-long-connection code

- Completely remove nylas-long-connection.coffee file and consolidate all logic into
nylas-long-connection.es6 and worker-sync/delta-streaming-connection.es6:
  - Separate it into DeltaStreamingConnection which is specific to the worker-sync
    package for handling deltas
  - NylasLongConnection is a ""reusable"" persistent connection to our API
    which is also used by the search package
  - This is a basically a fixed revision of https://phab.nylas.com/D2875,
    see difff for more info
- Makes it so delta streaming does not retry so aggressively on 403s, which
  happens whenever a user’s trial has expired",False
df4dec866f64958869353c23fc52aecf6e76a18a,2016-07-27 07:51:39,Juan Tejada,bump(submodule): Revert submodule bump revert,False
02d48ff0cee295b2bc7214b7d6872643f2d8e00b,2016-07-27 05:23:45,Annie,"build(preferences): Add two buttons to the bottom of the general preferences page that clear email and clear all .nylas

Summary:
Wanted a way to reset configuration settings. I added button in N1 general preferences to remove `.nylas` folder and reboot titled 'Reset Accounts and Settings' as well as one to exclusively remove `.nylas/edgehill.db` titled 'Reset Email Cache'.

Not sure about the wording of the button descriptions.

Test Plan: Tested with different file paths on my machine. Was going to write tests, but the two buttons just call previously tested functions onClick -- rimraf and fs.unlink. Testing might be excessive?

Reviewers: bengotow, juan

Reviewed By: juan

Subscribers: juan

Differential Revision: https://phab.nylas.com/D3127",False
77730d04bb8c7906d3832a6ce42f8c2cc7433fb6,2016-07-27 04:25:45,Annie,"build(onboarding): Add input with gmail auth url

Summary:
Added animation and input with url of gmail auth for users where the broswer redirect doesnt work.
Still need to finish up some minor styling.

style(onboarding): add input with link for gmail auth if browser redirect doesnt work

Test Plan: testing on my local install

Reviewers: juan

Reviewed By: juan

Subscribers: sdw

Differential Revision: https://phab.nylas.com/D3119",False
a8f34fa7474e07c3276ccf0d055b7b6b6210aa27,2016-07-27 04:24:23,Juan Tejada,build(tools): Add eslint_d package for faster linting in text editor,False
950126e6c85d4024b72228fa465c34a9f6f1dcb7,2016-07-27 04:16:50,Jackie Luo,fix(identity): Modify language around subscribing,False
665f2c8dd1bf00ef43c8c5d25ac59a87314d873f,2016-07-27 04:01:44,Annie,bump(submodule),False
4c452aaf4765f23a7c853b5b7a91db3d5d940726,2016-07-27 03:32:09,Annie,"fix(downloads): Add a check to see if last download directory is different, only show item in folder if true

Summary:
Each file downloaded would open finder and show the path to the file. Users were reporting that this felt excessive when downloading multiple files all to the same location #1044. I added a check to see if the path was the same as the previous file path, and only showed the item in the folder if these differed.

Also added tests for this in file download store.

test(downloads): Add tests for showing item in folder only if lastDownloadDirectory differs

Test Plan: Added tests to file-download-store-spec

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3121",False
7626bf6728b2a356c64ee80ac38270461e8f99fb,2016-07-27 02:30:36,Halla Moore,"Ignore thread labels that aren't listed in the account's labels

Summary:
An ""important"" label has been showing up for some users, rather than the usual
important markers. We generally have a list of labels that are hidden, including
the important label, but this list starts with the labels for the entire account.
In these cases, we believe gmail stopped returning the important label for the
accounts, while we still had threads marked as important. This resulted in the
important label not being properly hidden. To fix this, we added a clause that
ignores labels if they are not in the account's list of labels.

Test Plan: Tested locally

Reviewers: annie, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3123",False
02c33ea3f3914301c6874a2ced7bc5deb1f7956d,2016-07-24 01:33:38,Michael Grinich,Update ISSUE_TEMPLATE.md,False
525e6c644438350a8376687ba357d3cef631d7f4,2016-07-23 19:02:12,jathpala,"Re-enable all tests by unfocusing the test suite (#2667)

A previous commit (ad04775) added an fdescribe() to one of the tests in
draft-helpers-spec. This changes that to a regular describe() so that
all tests will be run when running ./N1 --test.",False
0ae78ebdd93d2fe1880ac7cf06acb43cacd43718,2016-07-23 02:56:28,Juan Tejada,fix(mail-merge): Bump submodule,False
7b020765e90fa96c3652138864f3169dae23831b,2016-07-23 02:55:31,Juan Tejada,"fix(mail-merge): Keep column links state properly in sync #2493

Summary:
See https://phab.nylas.com/D3112 for full description
- Update EditorAPI.insertCustomComponent to take a pre-generated
anchorId

Test Plan: Unit tests + manual

Reviewers: bengotow, halla, jackie

Reviewed By: jackie

Differential Revision: https://phab.nylas.com/D3113",False
941708d419b43d7b095612730dc961c11a484559,2016-07-22 23:55:38,Pablo Niklas,"Linux Mint 18 support. (#2659)

Allows the deb package to be installed on Linux Mint 18.",False
a471e81d4193185248c9657f148ca2f74a9eaecc,2016-07-22 23:30:11,Jackie Luo,fix(self-hosting): Check for env properly,False
d916e1d8fa2c5b1ec0a54c7f72cd41f8b8c9c955,2016-07-22 11:23:19,Jackie Luo,fix(lint): Fix linter issues,False
2b4af5b45e2b019d19fda468fdaa426296a4d4c3,2016-07-22 11:15:52,Jackie Luo,update(readme): Fix typo,False
ad047755e66e2d9529418bfbcaff0ae00b517cdd,2016-07-22 06:15:47,Jackie Luo,fix(quoted-text): Check that message is reply,False
ba323913510e9d01550f12ea2ede8c34b43487f6,2016-07-22 04:17:54,Jackie Luo,spec(quoted-text): Fix broken tests :disappointed:,False
c4f9bcdf661f51456c01a3a4e8edc5aa5bef23ce,2016-07-22 04:16:37,Jackie Luo,fix(self-hosting): Set identity correctly,False
98e351ebeb4857a77d256034fb96b5665dc45b48,2016-07-22 02:55:30,Jackie Luo,"feat(self-hosting): Add onboarding flow for self-hosted sync engine

Summary:
Adds a fun new UI for adding accounts to the sync engine. After creating your sync engine instance, all you have to do is auth your accounts on the command line and then enter the URL/port number in this flow. That pulls all of your accounts from the `/accounts` endpoint, mocks an identity token, and edits your `config.json` properly.

TODO: Update the docs in the repo and revert the PR with the temporary fix.

Test Plan: Tested locally.

Reviewers: bengotow, halla, juan

Reviewed By: halla, juan

Differential Revision: https://phab.nylas.com/D3114",False
e40239f6b9ed9a1fc5154fd466e89f59b0331368,2016-07-22 00:26:44,Ben Gotow,fix(message-body): Sanitize contenteditable attrs out of message bodies,False
7af69e3bb95c38d041d06385f4d22d37aaeed1ea,2016-07-22 00:26:44,Ben Gotow,fix(dev): Tiny script that allows you to install eslint packages into main node_modules folder (for Atom),False
7ca9f7667c5c1a58f3c04a29e76f9df9b8838293,2016-07-22 00:06:45,Halla Moore,"Implement a participant cap for multi-send, add multi-send unit tests

Summary:
Prevent hitting SMTP rate limit with multi-send
Some users were hitting the SMTP rate limit when sending messages
with multi-send to too many recipients. There is a backend patch
to help with this, but we decided it would be useful to limit it
on the client side as well.

Test Plan: Added unit tests

Reviewers: jackie, juan

Reviewed By: jackie, juan

Differential Revision: https://phab.nylas.com/D3109",False
d55616ca14db7e2050e53069b0442894ff12d7e4,2016-07-22 00:03:15,Annie,"fix(signatures): Added alias to accounts rendered in dropdown

Summary:
Extended default signatures to also be associated with aliases in the signature
preference page. Also fixed some styling with the signature dropdown button in its blurred
state on the popout composer.
fix(signatures): Fixed styling for signature compuser button on popout when blurred

test(signatures): Updated tests to support and cover extending signatures to alias

Test Plan: Modified existing tests to work with these changes

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3111",False
87dba382a8779c95c0a4e975cf5af8cc8a667661,2016-07-21 23:41:14,Jackie Luo,"fix(composer): Stop parsing quoted text on each keystroke to prevent composer lag

Summary: We used to parse the quoted text on each keystroke in the composer for a reply so that we could continue to determine what was quoted text. However, that resulted in dramatically slow typing for replies to complex HTML emails. Now, the quoted text isn't a part of the reply until `prepareDraftForSyncback`, after all of the extensions have run their transformations—we use a marker to determine whether quoted text should be appended or not. The quoted text control is now a one-way operation—you can't hide the quoted text after showing it (Gmail-style).

Test Plan: Tested locally (but didn't run unit tests because they won't run on my machine...)

Reviewers: bengotow, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3106",False
e984a0c2226be7f2cf6a5f097ea481bed15cfc10,2016-07-21 03:29:07,Ben Gotow,fix(readme): Add Kleinstein description,False
43a8a1255b94a2a342965494604e87227d0a3eb0,2016-07-21 01:03:52,Ben Gotow,fix(specs): Misc fixes,False
241d3e8d61dee7d3ff16fa4674187da0b6d19383,2016-07-20 05:18:24,Annie,"fix(image): Prepend file:// to image paths to solve #621

Summary:
refactor(test): Fix file paths in message item body tests to be prepended with file://

Some inline images were not rendering as seen on (#621). The images were being correctly added to the
downloads folder, however, their path was being prepended with an unrelated base url. I hardcoded
file:// into the image paths so that they would always point to the local downloads folder.

Test Plan: Ran the specific tests for message item body and message item. Also checked in my email.

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3105",False
cd1f39f2fa53e7aae53a8d7b9a4abf92f44cd194,2016-07-20 05:08:59,Annie,"fix(email): Fix email body height bug #1280

Summary: Some emails were having their body height set to 0 if their height was dependent upon the iframe height -- e.g. body.height equals 100% or inherit. Added a check to see if height computed to 0px and if so, set the height to auto.

Test Plan: Tested with emails on my computer

Reviewers: juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3100",False
34bf11d9c099a8b743bd6d44ab1b598b628a99b8,2016-07-19 09:01:06,David Klein,"Update README to include Kleinstein theme (#2645)

This theme hides the account list sidebar.",False
897a331e2531f287503eb400bca2086b8cd67406,2016-07-19 06:18:26,Jackie Luo,:art:(composer): Add newline for replies,False
f39ed8011cc68babfd06dce79b63a7394b033a33,2016-07-19 05:27:31,Ben Gotow,fix(menus): Adopt new `pasteandmatchstyle` menu role,False
12b9b910c47a84f136ce394da521265b7d543852,2016-07-19 05:23:25,Ben Gotow,fix(linux): Support unread counts in Unity #408,False
a85cc4d896b7647409cee804d9f08a306358b1d4,2016-07-19 05:21:49,Ben Gotow,bump(version): 0.4.46 and Electron 1.2.7,False
310af1727dd2f5619370141cfe6467ca5fc9e57a,2016-07-19 02:55:09,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/N1,True
893feb2ad85bb45dc432b67128a5203bad2840c9,2016-07-19 02:55:00,Ben Gotow,fix(contacts): Support unicode characters in domains #1920,False
1392887c831d92fbcb2c1c57d2aceade08860934,2016-07-19 01:02:46,jathpala,"Pasting into a participant field now preserves any text already there (Issue #2410) (#2635)

This modifies the behavious when pasting into the to, cc or bcc fields of a new draft.
Any text already in the input field is not automatically deleted. Rather the pasted
text is added to the already existing text. If the new contents of the email field now
matches as an email address (based on RegExpUtils.emailRegex().test()), then the address
is immediately tokenized. If the new input text doesn't match as an email, just append
the new text and wait for further input.",False
f9f78968b15896a496624e12e4609750cd2421f5,2016-07-16 07:31:50,Ben Gotow,"Use defaultValue as a template, fix critical sync issue",False
549ced612825ff681f7927db4e17812d9620e853,2016-07-16 04:58:13,Ben Gotow,"Revert change, @evan’s fix is better",False
18a8e5f09aff4b5f8a2ad62d7113fa41cc21ba85,2016-07-16 04:55:21,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
7efe5db7e941c7781bdeefd89f83b9e627037914,2016-07-16 04:55:18,Ben Gotow,USE_CONSOLE_LOG for simple console logs,False
8140076e17391271d6ae106d8ed2f64aaffa6e9d,2016-07-16 04:39:17,Halla Moore,"Remove auto-scaling for the collapsed dashboard view, at least for now.",False
5095f0626fcf842c030244660325f73608c4b8e1,2016-07-16 01:59:25,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
0dad9bf7fa19cd76c195b897ac9a269cd9dbeb92,2016-07-16 01:50:09,Halla Moore,"Auto-scale MiniAccounts in the collapsed, ungrouped dashboard view",False
dffb87bd4af7ed9ae02a58c4c6dd94e096ae8534,2016-07-16 01:45:26,Evan Morikawa,Report errors earlier,False
5e0bcc5effdb487f79f68e5656fc16e4846c0338,2016-07-16 01:37:12,Evan Morikawa,Quieter logging on dev,False
e13097045ba72782abbc82788a7d6d0b50eac736,2016-07-16 01:09:28,Ben Gotow,Log boxname and category name as well,False
0abd70c7466bbc985e5a969fb2e263694e3f59c7,2016-07-16 01:01:07,Halla Moore,Add option to group by process in collapsed dashboard view,False
579fe43fdf6738addb0c2214104de73ffd2760d5,2016-07-16 00:17:26,Ben Gotow,"Log when recovering from uidvalidity, don’t do it on first sync",False
95793877c6bd61b526c480e6a7fcb6c89f62f094,2016-07-15 23:44:35,Ben Gotow,"Do file creation in a transaction, and with fewer saves",False
e5bada04d35e0f1d5cefbc5d4b2d5c44b7d005ff,2016-07-15 22:53:01,Ben Gotow,Do contact insertion in a transaction,False
979401883d3972a7a43053319199d9a893ce5be6,2016-07-15 22:52:49,Ben Gotow,Make db connection pools smaller,False
ac3f96e2d41be66ab3eb3c403a2fd0b0bf90931c,2016-07-15 22:37:33,Ben Gotow,Fix accounts syncing in a hard loop due to redis loopback,False
13a723e6639e7e6676e4b0e3aa430c1c409e299b,2016-07-15 22:16:31,Ben Gotow,Correctly detect condstore to lower db load,False
13879db9c83dfbc0ec002bd396fcf41acae207ae,2016-07-15 08:02:13,Ben Gotow,Wait until tables are created before queueing sync,False
08c7ca8b0daa78a31ebc79d578bd62edb7ed3abf,2016-07-15 07:22:30,Ben Gotow,Use EC2 instance ID instead of hostname,False
5062f8d02b72924fef62f354aee550e77b209615,2016-07-15 07:03:46,Ben Gotow,Sort process ids,False
1996666516cd790aaf390a6e4c77695f6b7de9d1,2016-07-15 06:48:54,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
daaa67818df4fd982f22ab817f2a8d23b0dbab65,2016-07-15 06:48:48,Ben Gotow,"Add missing unique indexes, only create tables when authing account",False
6e2ae255196cdbea0b6b84d136e9d4a14b0057d0,2016-07-15 06:31:52,Halla Moore,Add a sum line to the dashboard's process load counts,False
45f132b7462ca06e5e547ecb1b78ed4595d2b3d9,2016-07-15 06:07:38,Evan Morikawa,Fix thread moving to support new Promises,False
a229ba1a90fb407969ba0b3f674fdba0e32151f4,2016-07-15 06:04:33,Ben Gotow,Sort process entries on the dashboard,False
1ce7787632703c32bdcd49771f5b3647982caa4d,2016-07-15 05:51:21,Ben Gotow,Disable sequelize logging,False
1d08faece3d4f1a251c55f2f8912ac04efa0566d,2016-07-15 05:51:02,Ben Gotow,Fixes to still support sqlite,False
2f3ca2a9062569d6d91933d80b7cd9d35fe580a5,2016-07-15 05:47:22,Ben Gotow,"Merge branch 'master' of ssh://github.com/nylas/k2

# Conflicts:
#	packages/nylas-core/hook-transaction-log.js
#	packages/nylas-core/models/account/transaction.js",True
de3151cab4d006aace60874847bec4265ac0ee16,2016-07-15 05:44:16,Ben Gotow,Move to single database with many tables for accts,False
1eef4c3428c3f3a5bbf04031efbfedacb49de5f7,2016-07-15 05:06:13,Evan Morikawa,Remove logs and rename variables,False
5b3f5c8a91060cd5452b26b5724136638acdc22c,2016-07-15 04:58:09,Annie,fixed thread syncing,False
ea497f7ea2264e1dc49d521aabcd05cff0dc0a18,2016-07-15 04:18:48,Ben Gotow,A few changes for upcoming db refactoring,False
b14d5f7e8dd2f99b7aeb82628c104284f76d4a7b,2016-07-15 03:21:54,Halla Moore,Add process load counts to the dashboard,False
099e200ec5d40e01af722c99db205298336b960a,2016-07-15 02:14:43,Juan Tejada,Only log sync errors if they are permanent errors,False
37b2323cc716b663246bf3227d8b424e6727d192,2016-07-15 00:30:05,Juan Tejada,Add metric for sync errors,False
0921df432b9af62e313f2238de23fb9702691c03,2016-07-15 00:10:46,Evan Morikawa,Uses default from address,False
6ce54c2a34de9358599f8f564a01fd71589b7ec8,2016-07-15 00:04:30,Evan Morikawa,Add send endpoint,False
b58c11605cb6223b6657ef02d3143281b42e3daf,2016-07-14 23:50:58,Juan Tejada,"Moves metrics into its own pkg to be able to instrument other services

- With the Metrics module inside nylas-core, and bc of our current lerna
setup, we required other modules like sequelize and redis before requiring
newrelic, thus preventing them from being properly instrumented",False
592b2af986c687d885bae1d54ca7ed4af65377e0,2016-07-14 23:19:40,Juan Tejada,Update metric type for `accounts_syncing_count`,False
16b91ea3941a9f7473f118002b8c802f43688e29,2016-07-14 23:09:05,Juan Tejada,Update metrics with signalfx - report # of syncing accts per host,False
eebc6c5c9b3a617f5b67a1caac8eea1d9738723d,2016-07-14 10:32:48,Evan Morikawa,fix(delta): add N1 token to delta stream connection,False
0c900b072d26911ede866a65dc3753179bb1a3bb,2016-07-14 07:38:24,Juan Tejada,"Add new relic to all pkgs + Revert to PromiseUtils methods

- PromiseUtils does not conflict with newrelics changes to Promise
- Other misc fixes",False
ec9f8581f7679af029df75e98c14d1aea4a960ab,2016-07-14 06:56:49,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
66951b4b1a675a2a8c57c40afe7a43706f40fa83,2016-07-14 06:56:46,Ben Gotow,Add more logging to process claiming,False
a07174cc4e4678d0900085ad47e1e38dacfc4623,2016-07-14 06:49:13,Annie,fixed json parsing of message,False
070670137874422b0b917655c36ed435364cf34d,2016-07-14 06:30:17,Halla Moore,"Make the grayAfter time more appropriate for production, 10 mins",False
49f475cdd1fd6c0e8be1b243e125e04e08d32429,2016-07-14 06:15:54,Halla Moore,Add collapsed dashboard view,False
5c1704ac8efe1e02fc85d36f1850cff7b3c31d23,2016-07-14 06:11:07,Juan Tejada,Fix thenReturn + misc logger fixes,False
07e3f3ab198de17a1bc3a1e277c3d5eca5faeb76,2016-07-14 06:04:42,Ben Gotow,Make dashboard boxes slightly smaller,False
2a05e69e4c43fb79fce68524a36bc691272913da,2016-07-14 05:55:39,Ben Gotow,Sort IDs as numbers not strings,False
b43b623ca66f9f3d84000aa954312c428f830b7d,2016-07-14 05:52:02,Ben Gotow,Expand promise utils,False
1eeb9128c05b95f1c143f447c16f79851414c5f8,2016-07-14 05:24:43,Juan,"Merge pull request #2 from nylas/linux-readme

Add Linux setup instructions to README.md",True
b60595f0f860132db826071b6f5bca7de5e7f3cc,2016-07-14 05:24:21,Juan,"Merge pull request #3 from nylas/remove-bluebird

Remove bluebird",True
35c32a3645a5e11e6b647b895a510e051dd0ac75,2016-07-14 05:12:13,Ben Gotow,"After authing an account, close IMAP connection",False
ab9c01a249c40ceeedb19f053003b186251c4941,2016-07-14 05:05:22,Juan Tejada,"Remove bluebird

- Implement `each` and `promisifyAll` + other bluebird fns",False
87905d0145c7f0be8379ffb960c513dbb8fca982,2016-07-14 05:01:34,Evan Morikawa,Fix transaction log to ignore syncState changes,False
fcbaac302b49dca3aea813f608133fd901a0fb97,2016-07-14 05:01:14,Halla Moore,Change dashboard error appearances,False
971b64b4c299758cc942fd55c27c89b073f15900,2016-07-14 05:01:14,Halla Moore,"Add other dashboard optimizations

Fix typo in Account's shouldComponentUpdate method
Consolidate intervals into custom window events
Manually update ElapsedTime contents",False
93942e792dcf8d54c1a4b544ddfbb0d39e98bb74,2016-07-14 04:50:43,Ben Gotow,Also conert imap errors in createConnectionPromise,False
8c33c4976f1fc4e24532912b93dbe56d6f488da4,2016-07-14 04:27:59,Evan Morikawa,Better IMAP Error handling,False
192f6a75b689af3b5823b6688e8c9fc6f0c70129,2016-07-14 04:25:45,Evan Morikawa,fix(login): fix error thrown when login fails for IMAP,False
0b9933b51469611bba0d2773748557efb2be0cf6,2016-07-14 03:23:56,Halla Moore,Re-render accounts in more scenarios and update onWebsocketConnectedFake,False
b03b8b537d7fd9b2b003451dc9a6491052727a53,2016-07-14 03:04:27,Halla Moore,"Optimize dashboard rendering

Add version to local copy of account and only re-render entire account
if the version is different. Create an ElapsedTime component that
re-renders on its own, and update SyncGraph to re-render on its
own as well.",False
a5e3ddb44596d7d5158ba61ec58adb6e299cd6ce,2016-07-14 01:09:11,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
a11ee2987bacbd0eaf14d194fbf17c3f50553144,2016-07-14 01:09:07,Ben Gotow,"Change proxy to honor null values, create helper for open box name",False
3d64affc52c495679349af96760e3b59524eae50,2016-07-14 01:07:38,Evan Morikawa,Delta stream adhere to old Nylas spec,False
f2f6dec35ac7127994824ab6184cdc553cb8814c,2016-07-14 01:05:49,Halla Moore,"Add dashboard optimizations

Make account elements absolutely positioned and opaque
Send account updates all at once, at timed intervals",False
7f72ab7f14ae08137f727fc7006e71c582d44f6d,2016-07-14 00:28:46,Juan Tejada,"Add loggly logging service to test it out

- Adds env to all logs, cleans up code a bit",False
ffc2593c4e09c4630500b7b4f082c00680eb215b,2016-07-14 00:12:34,Ben Gotow,Log all box attributes to help track down bug,False
1c0c4ee61e988d5c6e33fb72fee2796a92019096,2016-07-14 00:11:46,Evan Morikawa,Add redis-server back into pm2,False
6e19cd84f5a19392755f3dd4f62c5bfd76de9fbe,2016-07-14 00:07:35,Annie,Added view query param for contact and message routes,False
7056a4b8f487ab5de3dbe6be84662efbafb8fde8,2016-07-14 00:00:22,Ben Gotow,"Fix bug with accounts that have uidmin=0, not 1",False
ecc8bd67d3c69534a79e4650bc1128718d3c0ce5,2016-07-13 23:41:32,Ben Gotow,Clean up dashboard websocket code a bit,False
8629b5a055a4439a399b3d2b9c907219d355c66a,2016-07-13 23:27:05,Ben Gotow,New function to stub dashboard view,False
ea4d5d0054613110ce33b34a133c6e5ec8576fab,2016-07-13 07:03:33,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
17f920fb90d6100a8091e29ed3ee15a073a5b1d3,2016-07-13 07:03:19,Annie,Ordered inbox messages chronologically,False
eac4f7243165815333e9a292706c38bcb7473c46,2016-07-13 07:02:00,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
e89975456b6b28a089accecb50df30af70bb480d,2016-07-13 07:01:55,Ben Gotow,Fix scenario where sync worker is re-assigned the same account before fully releasing it,False
e658f066dd0ea90ddbb62175e1bd020e032bcb80,2016-07-13 07:01:00,Evan Morikawa,Change transaction schema to match current API,False
1ce430cd2a2c1ed723ed6b9c3b693ddb1516ab36,2016-07-13 06:57:04,Halla Moore,Add an auto refresh option to the dashboard's syncback requests modal,False
8e790a0e155507cea1009a210352882e7394c83d,2016-07-13 06:57:04,Halla Moore,"Spruce up the dashboard

Consloidate modal functionality into its own component and make
general appearance fixes, especially with the Syncback Request
Details.",False
3e8623d38332c99aa0a74d6eb2301db9f55e6b90,2016-07-13 06:33:08,Ben Gotow,Move charset definition to single location,False
a62e858389ec8e1fd9334b7ca934caadd1e53dd7,2016-07-13 06:11:16,Ben Gotow,Make charset explicit on connection and models,False
efc8d8ba12d0f11f49745ffd33b19ad1ab37c25f,2016-07-13 05:16:17,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
562cedf971707913036bc70c302bb3d0c0f998a5,2016-07-13 05:16:14,Ben Gotow,Fix sync worker stopping forever on errors,False
83a6a8008b5533e4fe6be427c406adbaffacc1e0,2016-07-13 04:57:57,Annie,Add thread id to message model,False
9d7343eb918f879f6bf86d6c8c40c0b1260943bc,2016-07-13 04:54:03,Ben Gotow,Fix UTF7 reference - prod will not use ssh,False
ae082c5b53fa0a5b9416ab4fe3475586e59d66db,2016-07-13 04:42:04,Ben Gotow,Fix support for Gmail accts with non-english folders,False
8b1e9564cf997c992c784dbe5c6bdda1518a8945,2016-07-13 04:41:29,Ben Gotow,Fix UTF7 support — module didn’t support Node6,False
7d92438d57704a22f7f86808a321499cfdfeec43,2016-07-13 03:53:55,Ben Gotow,"Change firstSyncCompletion to string, cast to int for JSON",False
dfa16fb5fc2f503570658c498517178bb9c54b8b,2016-07-13 03:34:12,Ben Gotow,Allow firstSyncCompletion to be null,False
84d89792656bdb3cf8f897dd7e6ac896e05408dd,2016-07-13 01:54:48,Ben Gotow,Add ability to auth gmail account via `/auth`,False
3e6e5e95b95c89173d53f29fbb05592e5df5cd05,2016-07-13 00:50:12,Halla Moore,Add dashboard functionality to clear sync errors,False
674da272963644254873a9301166a130d4c41d5d,2016-07-13 00:45:46,Ben Gotow,Fix flipped errored / ended handlers,False
347fcd8c2dc3ab859d101b47a90a1f4fd9122c02,2016-07-13 00:33:13,Carson Ip,"Fix incorrect port number when using https (#2600)

When APIRoot is using https, the port will forced to be 443 even when APIRoot
indicates another port. This is because of the line options.port = 443
overwriting the correct options.port extracted by url.parse. This is fixed by
removing the problematic line. The default port is still 443 if you look into
https.js. In case we want a different default port in the future, we can do
options.port = options.port || 443.",False
b0a6ec066bb1ecd63094a78e54b4742a1a544ebf,2016-07-12 22:23:04,Ben Gotow,Sync non-active accounts more infrequently,False
c4736cb4d18061a38df8553c2dd6acf0434b3001,2016-07-12 14:04:13,Ben Gotow,Copy test_accounts.py into curl format for easy testing,False
ac627f1580dd3e0849889d0993f8132902f05843,2016-07-12 14:03:56,Ben Gotow,"Remove use of Rx.toPromise(), which wasn't behaving as expected",False
b44272621d99f9bcaa1a25736c62b62745710b81,2016-07-12 13:29:41,Ben Gotow,"Misc cleanup, put account ids on dashboard",False
4fb848e91f4452cf0f5513d9edccdaf232750835,2016-07-12 10:08:05,Ben Gotow,fix for re-authing the same account,False
caab8474f76c9342471466a776b552c105cc085b,2016-07-12 07:06:08,Christine Spang,Add Linux setup instructions to README.md,False
87091a414ad921465c03e877520671921a339180,2016-07-12 07:00:28,Annie,Merge branch 'master' into contacts,True
c5dce43da7634017369427fd46681984fa28742a,2016-07-12 07:00:19,Annie,Merge branch 'master' of github.com:nylas/K2,True
d575e63ede6b983865ba9b0ae7b932d90d4d7248,2016-07-12 07:00:08,Annie,replaced console logs with new logger,False
73fc371825f2cbfbe7bb289306da308a9aa85de5,2016-07-12 06:54:18,Ben Gotow,Make the graphs on the dashboard retina 💄,False
52c04eca8cd1d6c679d347735e7fd521ef56345f,2016-07-12 06:46:08,Evan Morikawa,feat(analytics): add Sidebar Opened & Sidebar Closed events,False
666169386041464c5bc1c0d24ffc0ebf6f5015d3,2016-07-12 06:37:45,Evan Morikawa,fix(onboarding): Fix Rx.Observable.fromQuery not defined bug,False
afeb0e7b27ad9aa1f5d0e9730b6eb2420ce4f188,2016-07-12 06:27:43,Juan Tejada,"Create one CloudWatch stream per host

- This prevents `InvalidSequenceTokenException` when running in
production with multiple machines in an elastic beanstalk environment
- See
https://github.com/mirkokiefer/bunyan-cloudwatch/issues/1#issuecomment-193116799",False
413a77c3232157673b7b0d27bda17adfa66a9c67,2016-07-12 06:12:49,Juan Tejada,Log unhandled errors in api and sync,False
039648bae84a9da8d40e0b2e79e150b074161cae,2016-07-12 05:34:30,Juan Tejada,Add bunyan-prettystream to regular dependencies,False
826db2e6f4516cdf169d894e1df378b3ea69566a,2016-07-12 05:27:27,Ben Gotow,Remove redis from pm2,False
74430dd80e6de2ea3c0b205a32c63cc7473f1d7f,2016-07-12 05:26:27,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
492ac21bb6874bc2a61485a2bd7b605519ee8463,2016-07-12 05:26:18,Ben Gotow,Primitive account deletion via DELETE /account,False
caee5dbef0d6186fe6690c22b06aef968984364c,2016-07-12 05:12:15,Annie,Merge branch 'master' of github.com:nylas/K2 into contacts,True
f8b8dfb87f381380f78055064b54624a724b4adb,2016-07-12 05:10:48,Juan Tejada,"Revert to running pm2 in no-daemon mode in dev

- Add a stream for pretty logging in dev mode",False
1fc30fa8104d1733df1407be2ef5ccbf5fe4a801,2016-07-12 05:07:44,Annie,Merge branch 'master' of github.com:nylas/K2,True
e673573fcdc5bf3d96af89de7f35f92b26dba26c,2016-07-12 05:07:39,Annie,added folder view api route,False
ae51646de62dc2a46ddbc2b1544f2531100b7b0f,2016-07-12 05:03:56,Juan Tejada,Comment out new relic for now,False
2dc31cb576cdf2dd6dbae0f23b494e2978a0bc10,2016-07-12 04:54:48,Juan Tejada,Add number of syncing accounts to sync process manager heartbeat,False
8e0cd92bad7fe719178586ae7064deb99a3d965b,2016-07-12 04:32:53,Ben Gotow,Require a logger when instantiating a connection,False
06d31b4d49e3677ca8fc6735da89e30b34445594,2016-07-12 04:31:22,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
3c63268eecfb39890d2b64b873cdb84c8e646797,2016-07-12 04:31:18,Ben Gotow,Return a new token for existing account instead of duplicating accounts,False
d4cd2510db76c5d9dcfc17cf5755d0c93852c1a5,2016-07-12 04:16:52,Juan Tejada,Fix pm2 run scripts,False
960dbdeb8f995d209e4cde7e6ce0be446e44633b,2016-07-12 04:10:36,Juan Tejada,"Update logger for sync process manager

- Log identity data always",False
5085730902d444d299684ea2f4d81c5029ef73fa,2016-07-12 03:52:04,Ben Gotow,"Merge pull request #1 from nylas/contacts

Build(contacts): built contact model, added routes and processor",True
bc10ff453e57c9375ba6c50a1909456fb156de6a,2016-07-12 03:36:36,Halla Moore,Change stop script to use pm2 stop command instead of delete,False
04ab0d9034f8e0cc38e1093a964d7c353ba6263f,2016-07-12 02:53:46,Halla Moore,"Change firstSyncCompletedAt to firstSyncCompletion, now explicitly 14 bytes.",False
0860f3027c87e2514fcbe4f947554f14542df158,2016-07-12 02:53:46,Halla Moore,Fix two small errors,False
1360599ffc921fb15a186cf585bbc4c13e1f1c69,2016-07-12 02:53:35,Evan Morikawa,Fix deafult test account email address,False
b7301f5dc5e72c36ea6460ca6e21a174fe23e641,2016-07-12 02:40:30,Juan Tejada,Fix more error handling in sync worker,False
5868fb520718f41e22ccf766171a4db368983d57,2016-07-12 02:18:00,Annie,make changes requested before pull,False
6ff596b5a7df2e52f444bff7cbee503668ff26cc,2016-07-12 02:16:50,Juan Tejada,Properly log uncaight errors in sync worker,False
8a63ace9e3f618a8e6873d1a86772e5eb330fc88,2016-07-12 01:57:44,Halla Moore,Change config to watch just the 'packages' directory,False
877a6bf6122da17aeff5c56b45e1ef470ad37106,2016-07-12 01:27:18,Halla Moore,Add SyncbackRequest details to dashboard,False
39e5a2ee962238648af945260280d62541417434,2016-07-12 01:05:41,Annie,"refactor(signatures): Removed old signature imgs and made static empty signatures page

Summary:
Refactored signature preferences page to allow more signatures than the previous 1-1 mapping for signatures and accounts. Created a multi select dropdown of the accounts for which a certain signature is set as default for. Added a button into the draft header From field to toggle between saved signatures.

refactor(signatures): Add basic add/remove capabilities to static

refactor(signatures): Hooked up signature actions and signature store for basic functionality

fix(signatures): Cleaned up signature store and started on multiselectdropdown

fix(signatures): Add multi signature toggle select to multiselect dropdown

build(signatures): Built framework for multiselect dropdown

build(signatures): Toggle button functionality for dropdown

build(signatures): Build multi select from components and add debounce

refactor(signatures): Move signature actions and signature store into flux

fix(signatures): Styled composer signatures button/dropdown and fixed preferences checkmarks

build(signatures): Finish main functionality, about to refactor composer signature button into injected component

fix(signatures): Changed position styles

fix(signatures): Fixed background color for dropdown button when blurred

build(signatures): Began to write tests for signatures store, preferences and dropdown

Test Plan: Wrote tests for preferences signatures, signature store, signature composer dropdown and refactored tests for signature composer extension. For signature composer extension I removed applyTransformsToDraft and unapplyTransformsToDraft and tested by sending emails with signatures to different providers to make sure the <signature> tag caused problems.

Reviewers: bengotow, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3073",False
1c4434c136902fa30be0ac30fc0565c5e7834b47,2016-07-12 00:42:38,Juan Tejada,Re-emit error events on bunyan log streams,False
84815ce2fa884d6ebc3992003429dec38c5b0b17,2016-07-12 00:30:20,Evan Morikawa,Add file watching to restart server,False
c0d7902f9fb4b40549d794a28146439fd52cd728,2016-07-12 00:19:11,Evan Morikawa,Add npm run restart,False
98c17c9780f2e9c8627014c6462c0cf000f6ea6f,2016-07-12 00:17:42,Juan Tejada,Fix api logger decorator,False
ff334e169cebb9c1f8ef11ef366b5ab19c3a00cc,2016-07-12 00:13:51,Juan Tejada,Make npm start log output logs too,False
f648016c621463357a7fffb89299ca83ea1eb530,2016-07-11 23:58:53,Juan Tejada,Lock logger versions,False
600245ebcb930f8b0e161b285c933f33e8b18e13,2016-07-11 23:58:53,Juan Tejada,Fix cloudwatch config,False
4ce68e3dd4dda39fa0f659b1bb00d5bf1667dcee,2016-07-11 23:26:11,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
93189b0f22f49d897d55b20858d41da8e4727e62,2016-07-11 23:26:08,Ben Gotow,Try adding newrelic logging,False
dce872fac8166f8102d197ef86bafb67395f1797,2016-07-09 06:00:24,Juan Tejada,"Adds bunyan for json logging on every package!

- Bunyan logs json output, and added a stream to send our logs to
cloudwatch
- Replaces /all/ instances of console.log. Turned eslint rule back on,
so we don't use console.log ever again.
- Added npm scripts to view pretty logs",False
cb20f8cecd149d40e7973d686da5ef1d4df095d7,2016-07-09 05:39:57,Annie,resolved merge -- Accounts and contacts are now both added to serilaization,True
2a776e6cffe4fcd52b727f8c99f97a1a127ca93c,2016-07-09 05:36:21,Annie,"Build(contacts): built contact model, added routes and processor",False
14b5bef0a74ebc78a11f58e9cb87b25a66c7007f,2016-07-09 05:29:00,Ben Gotow,Fix error handling on connection close,False
016bad67b949cd3628409c675fd5e3f960b6f41d,2016-07-09 05:23:01,Ben Gotow,Temporarily patch /account to not check schema,False
26ac02e0bf78ed9ff3d0585fef1ef5acd8aac8ad,2016-07-09 04:06:56,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
8c122a57a32fe17937fe615ff13db513ea9281af,2016-07-09 04:06:50,Ben Gotow,Stop syncing in a hard loop,False
ab8f1b4fbf50188dbaa6dd6d05be530b0e0b7c5d,2016-07-09 04:03:37,Evan Morikawa,Silent transactions if only syncState changes,False
53a2e7e56b8b27478b3dab96aa1d838ad0516a53,2016-07-09 03:25:12,Ben Gotow,"Add ping to dashboard, wait to get shared db",False
3e348252ab53295a58eea71e0189d7ff55b42d6f,2016-07-09 03:11:53,Ben Gotow,Fix issue with default values — just implement in getters,False
4a341b6f02a076371e517a163bc1684e8537e50f,2016-07-09 02:19:56,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
17df581105e60e1e3c92d73496f0dbf9780c54a1,2016-07-09 02:19:51,Ben Gotow,"Use TEXT vs STRING, specify string column lengths",False
e3380508a62d4df26f82ff35f3f4afd2adfb931e,2016-07-09 00:06:51,Aaron Sikes,"Clear notifications when emails are read

Fixes #1393

The objects returned by `new Notification()` have  a `.close()` method.
So we can just keep a list of notifications that have been sent, and
close them when that message has been read.

Conflicts:
	internal_packages/unread-notifications/lib/main.es6",False
7d66cdbcac4722fd825d76eff907ba7ca1b39696,2016-07-09 00:00:33,Aaron Sikes,"Change pending unread notification stack to be a queue (#2517)

* Remove double negative from test label

It always takes me a second to read a double negative, and be sure I
understood correctly. It's also particularly troublesome for non-native
English speakers.

* Change pending unread notification stack to be a queue

Consider the case where a user launches N1, and has 3 unreads since
their last launch. Additionally, after N1 has launched, they begin
receiving a new mail every 2 seconds.

Current behavior would be a notification for 1 of the 3 unread emails,
then every 2 seconds a notification for the most recently received mail.
They would only finally receive notifications for the other 2 original
messages once they stopped getting new mail.",False
d1003fbac45172c95660647b08f724af89e289e4,2016-07-08 23:59:10,Logan Davis,"pgp-plugin update (#2534)

* Fix private key email-adder, add ""no private key"" error

The decrypt UI is seriously confusing some people. This commit
adds an error message that should at least stop them from trying
to decrypt a message without a private key to speak of. Also,
there was a dumb hardcoded true in validAddress.

* Adds incorrect passphrase notification; enables carriage return for popover

The passphrase popover was woefully inadequate. It didn't tell users
when they had the wrong password - it just closed without saying anything -
and you couldn't even use carriage return to submit the password.
This commit fixes those mistakes by buffing out passphrase-popover.cjsx.

* Adds private key popover to decrypt button

The decrypt UI was confusing and didn't provide the user with
an option to get a key imported from the message view. This
mondo commit adds an entirely new popover so that the user
never again will be forced to go to the preferences page.

* Adds more forgiving encrypted block parsing

* Overhauls decryption error handling

The decrypt UI didn't clearly communicate error messages from the
failure in PGPKeyStore.decrypt up to the user. This commit adds
nice error surfacing as well as some pretty colors.

* Fix encrypt modal key miscount error via getKeyContents coercion

On Linux and Windows, fs.watch double-triggers on some actions in
the key folder, for reasons that aren't super clear. This was causing
issues where the encrypt modal would report not having a key loaded
even though the key was totally loaded and saved. This commit sort
of kludgily forces the modal to run getKeyContents for every key
it has saved right before it returns them all. This would probably
be better fixed with a refactor the the PGP Keystore.

* remember to close popover, d'oh

* patch key picker modal styling for Linux and Windows

* response to review",False
4b7b2f20f5b3728cf82154b1953461913fe2a6eb,2016-07-08 23:50:19,Ollie Ford,"removes phishing warning for different subdomains (#2420)

This commit improves on nylas/N1#2343 (which allowed From and
Reply-To to be different aliases @ the same domain) by allowing the
address to differ by a subdomain.

For example, the pairs:

    From: foo@bar.com
    Reply-To: foo@sub.bar.com

    From: foo@bar.co.uk
    Reply-To: foo@other.bar.co.uk

    From: foo@bar.com
    Reply-To: foobar@bar.com
are each now allowed without warning.",False
c78d36bb6590eb61c20639817a06a89df9b8f1e1,2016-07-08 23:44:42,Jonas Strømsodd,"Make display of onboarding page conditional. (#2485)

When running against a custom Sync Engine, viewing the onboarding page
on startup does not make much sense. This here adds code that checks for
the `env` of the Nylas config and skips the onboarding if it is `local`
or `custom`.",False
0db3e21884845ccee17c61139e7ae8d63519d24a,2016-07-08 23:27:41,Aaron Sikes,Mention test focusing and skipping in CONTRIBUTING (#2514),False
68da536d79325963b0ffd912e5e22d60a93173cc,2016-07-08 23:27:12,Carson Ip,"Fix failing clean script (#2554)

The clean script fails since productName is ""Nylas N1"" which contains a
space and it appears to pkill 2 patterns. This is causing the script to
stop in my linux machine. Now the productName is wrapped with quotes to
prevent this from happening.",False
b336e66d310c9d66076006550492e305f2020f21,2016-07-08 23:22:08,Ben Gotow,Update Windows.py to remove Node 0.10x,False
ab3713830c8978778a89434809e5169c057e87e3,2016-07-08 21:42:11,Evan Morikawa,Readme fixes,False
6fecf0e40d6ced73e0fbea96c0faafabd1dd893a,2016-07-08 21:30:57,Evan Morikawa,Add redis to local pm2,False
fbfe693dbde6c083af24d2138611b71ff47402a0,2016-07-08 05:37:24,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
e7affd3f6517964fd235f262c0f176941645a94b,2016-07-08 05:37:19,Ben Gotow,Add dashboard pm2 config,False
aca24ef18a74ac738aa69576c629163ad7091fe8,2016-07-08 05:02:46,Evan Morikawa,Update dockerfile to start with env variable,False
31e4d25448e2cfc1260ec814c17534d047760420,2016-07-08 04:40:35,Evan Morikawa,Add API port to prod config,False
1ff61beec93e02e24f81cb25ea9499fb15ab5c37,2016-07-08 04:38:19,Evan Morikawa,package json fixed,False
2020ee1f19cc2a602e5ff062766683a43550a7e3,2016-07-08 04:36:09,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
f2418cef5746dcba43733bc773707f5b8799bf4e,2016-07-08 04:36:04,Ben Gotow,Minor updates to readme,False
0972592aa5729bb841de1f82061ab808e731ae73,2016-07-08 04:35:44,Evan Morikawa,Add ports to pm2-dev,False
0bfa8023f25d8a88e431107e62702ec7328002e0,2016-07-08 03:57:56,Ben Gotow,"Merge branch 'master' of ssh://github.com/nylas/k2

Conflicts:
	Dockerfile",True
63f66fb7e7e10bd944bff009c7c18a3dec1941b9,2016-07-08 03:55:45,Ben Gotow,Switch to PM2 for dev + prod,False
a71e5c6a63ad71613fb396f2bb2fe22c4384cb1d,2016-07-08 03:01:08,Halla Moore,Merge branch 'master' of github.com:nylas/k2,True
2db11d7dec494629be7c8363ed409aa8a9648dd7,2016-07-08 03:00:51,Halla Moore,Enhance sync stats on dashboard,False
7a4550627176178de2174beb6a9e44ce5f371877,2016-07-08 02:12:44,Evan Morikawa,Update package.json to include lerna in main dependencies,False
1ed55a6ee6085a8d4b0a23737c2af0b2d6a6abbf,2016-07-08 02:07:33,Evan Morikawa,Add production flag to Dockerfile,False
83e7d149a3f064efa82f8f2ac587a2a313b73c7d,2016-07-08 02:06:38,Evan Morikawa,Fix Dockerfile,False
21a89ee45542ed6947a91196fb7ddb64bb918c9c,2016-07-08 02:03:27,Evan Morikawa,Remove Dockerrun.aws.json,False
dfb3935969b8016721da3ab0fb462e6f67d4367a,2016-07-08 02:02:54,Evan Morikawa,Update package.json. Remove Procfile,False
189cf21d2ad168ab8123766b903ac0abdd7f353b,2016-07-08 01:09:31,Evan Morikawa,Commit to test Docker automatic builds,False
ac5fee1c39d6997ffd7c6836cd270a53b50ee258,2016-07-08 00:43:27,Evan Morikawa,Re-add .elasticbeanstalk to gitignore,False
ecb97fa4378a4f8166bd00343795c04cde05e8ee,2016-07-08 00:40:17,Evan Morikawa,"Revert ""Remove sqlite""

This reverts commit f14443a83ea7a59f999667c1a3bf0d1ddd11cd33.",False
05de9f6cffc65ddae8ddadf80245d73f8023cce8,2016-07-08 00:40:01,Evan Morikawa,Remove .elasticbeanstalk from gitignore,False
a97ed5a311669c0a0d213681f999e0a7e2e60223,2016-07-08 00:40:01,Evan Morikawa,Added Dockerrun.aws.json,False
3820521d62fdb0aa466a95bba0189e66f448fe86,2016-07-08 00:40:01,Evan Morikawa,Dockerfile successfully building ping endpoint,False
f14443a83ea7a59f999667c1a3bf0d1ddd11cd33,2016-07-08 00:40:01,Evan Morikawa,Remove sqlite,False
822b8e54e6b4dde8d43aec9a6dbeee34508d44ad,2016-07-08 00:07:55,Ben Gotow,Allow usage with mysql in addition to SQLite,False
40ab07cfdf23c122c2c9c99813633001cdea43c3,2016-07-07 05:19:16,Halla Moore,Add account filtering (by error status) to dashboard,False
44e377eb80f2a34051155ec50ce4070de8ed4d6a,2016-07-07 04:18:47,Halla Moore,Merge branch 'master' of github.com:nylas/k2,True
12560ab71173b5276606d9a8bb9d0f21e3eb9f8e,2016-07-07 04:18:25,Halla Moore,Add ability to apply a sync policy to all accounts from dashboard,False
be277b80048ae4dd9ca459f89c8ca783172762b8,2016-07-07 04:00:35,Evan Morikawa,Add dockerfile,False
2e4427d96e21c3c6a511b45f3c492549c702cf4e,2016-07-07 03:29:56,Evan Morikawa,Add console to ping,False
af9d5da17c36aa5ecd129334b8e1477b23804db6,2016-07-07 02:21:17,Evan Morikawa,"Revert ""Start just nylas-api""

This reverts commit 91d8cfa6c0b8fe4c6df007e095ca4af07e3fd3ef.",False
3068fbbf206e8fd88f5a86cf2aa02fb32b731dab,2016-07-07 02:21:17,Evan Morikawa,Upgrade lerna,False
5d2c52df41308e9a2a00cddbc382c650fe981c37,2016-07-07 02:21:17,Evan Morikawa,Start just nylas-api,False
3bfc5aff609c2c67ab38003bb3af5777c2484f02,2016-07-06 04:15:18,Halla Moore,Merge branch 'master' of github.com:nylas/k2,True
9c342c0c7756f6d1a36cac78eda5cd3215cd5977,2016-07-06 04:11:56,Halla Moore,Add ability to edit sync policy from dashboard,False
e2e827297cfa1656a1b805364520196f08c73219,2016-07-06 02:39:44,Evan Morikawa,"Add authless /ping endpoint that returns ""pong""",False
ed2e184728ffe48541d16cca721ef4d23b361fd1,2016-07-06 01:51:27,Evan Morikawa,Add Elastic Beanstalk to gitignore,False
8b1f012a3c8ad76de98b6db7432c1d7546c1bd3f,2016-07-02 04:19:47,Juan Tejada,"Fix error serialization

- Remove cumbersome NylasError
- Add helper to serialize error when saving to account",False
a43b3fb015d71e5cbbb7772d4cf245289049aef3,2016-07-02 04:11:29,Ben Gotow,Merge branch 'master' of ssh://github.com/nylas/k2,True
8453985b1fdb98f276223ebcba084d656ca95787,2016-07-02 04:11:22,Ben Gotow,Change worker removal so it waits for sync to complete,False
81145eae32c422e7fbd149939281c80437c25230,2016-07-02 01:54:08,Jackie Luo,Change error styling,False
0af1a4379449960389bae291567a40453141d100,2016-07-02 01:45:55,Jackie Luo,Add first sync completion time,False
3ccb7f164b1086aa223a721e698d3027cedf53b8,2016-07-02 00:06:14,Ben Gotow,Fix closing connection twice,False
fd0c4d734c3f00e2c8297b1cf2c17a33117084bf,2016-07-01 23:57:20,Evan Morikawa,Fix delta sync to properly includes sub models,False
05091a4447f85c8279da016a02f0318642525a0d,2016-07-01 22:54:39,Juan Tejada,Update thrown errors to use serializable NylasError,False
80f9ff38e30462024345ec684091769e9c52db6a,2016-07-01 22:49:25,Juan Tejada,Remove dead code,False
a99ffbce3c25641458df25b68bb02011f2329158,2016-07-01 06:01:52,Jackie Luo,Add favicon :snow_capped_mountain:,False
27eba6dfaacee8b666305e1671b6b6d06ebd04ef,2016-07-01 05:54:25,Jackie Luo,Add sync times and update styles,False
84ce3bdeb3138620c804e0b50bf73986e3d1ad63,2016-07-01 05:41:05,Halla Moore,Merge branch 'master' of github.com:nylas/k2,True
c5157b355359941786df6bd6ba832b468e49388c,2016-07-01 05:40:48,Halla Moore,Fixed 'in' filter for threads endpoint,False
ddf73b6b0278396342d4b5a0bede4f89839513ad,2016-07-01 05:34:13,Jackie Luo,Keep track of sync completion timestamps,False
ce61326f7c68ed0b8b630ae5ef3a18a2630777ae,2016-07-01 04:53:55,Halla Moore,Make query keys not camel case,False
7221ae3bb9cb3654c92d887627ea7be485b98c3b,2016-07-01 04:49:57,Halla Moore,Added File filtering,False
f94acfcb9bd395bee77d9def48bc2c4fd8bcedc8,2016-07-01 04:39:02,Halla Moore,Added filename query to threads endpoint,False
d68151a6847313c1966d8616fb94185075b9272f,2016-07-01 04:19:03,Halla Moore,Merge branch 'master' of github.com:nylas/k2,True
aec946f7def15e16ac50cc7f2db5fbebf21a1458,2016-07-01 03:53:34,Halla Moore,Added 'in' query to messages endpoint,False
6225f09018fb175001090528181d8bdc979113f7,2016-07-01 02:52:23,Halla Moore,Added some filter queries for Messages,False
6c3bcf99adab2be6a28dd4c3c58f4701eec8a2fe,2016-07-01 02:08:54,Ben Gotow,"fix(auth): ssl_required => true instead of ""on""",False
04d482650c6b3ffb869e4b171adfaf6e6667279c,2016-07-01 01:58:41,Ben Gotow,Fix processor running out of file descriptors due to re-creating redis connections,False
65a6ea4546ed3f71f416c6f011caca4beb7ce1ab,2016-07-01 01:58:26,Ben Gotow,"Redis takes seconds, not milliseconds",False
3c2b8bcb15109dd295e684cb7b0ae1b0d806a1d5,2016-07-01 01:55:13,Ben Gotow,"Fix account creation redis publish, rename to make more clear",False
ef5c4a29fe216baac3daab0a27e39723b53b7f66,2016-07-01 01:03:10,Ben Gotow,"Fix redis keys, dashboard app, show account active state on dashboard",False
f9952f9fa7cd0d90add221793aea07f45ba05cc8,2016-07-01 01:03:10,Ben Gotow,Fix 500 error when account token does not resolve to account,False
d0666540b9426b2e51feac66b27e247fd3786be6,2016-07-01 00:24:12,Halla Moore,Added syncback tasks for folders,False
4d4a4cec32b57eb4150af36aaed4ffbf8d6cc6e6,2016-06-30 23:34:51,Ben Gotow,Fix backwards logic preventing thread creation!,False
a1419a65a5202f95ecacb7a6919b898de7680799,2016-06-30 22:03:04,Ben Gotow,"Update folderId => folderImapUID, rename messageI to uid",False
b033b94091c623f1e3b1dae0e5e80b4a49107020,2016-06-30 21:59:21,Ben Gotow,"Break Category into Folder, Label, populate Gmail lables for messages",False
c9c52fae1b953047a1d5d5568728f606006cfc9f,2016-06-30 12:59:46,Ben Gotow,Stop sqlite errors - guess N1 version didn't support Node 6,False
5a6daf9556a8dbc7c46456590eb31a5e1a2adf6e,2016-06-30 12:49:57,Ben Gotow,Stop sqlite from waiting 1sec to retry table locks,False
b3b5a5106c6f4f6c765d8607262051adc5850a8f,2016-06-30 07:44:04,Jackie Luo,Add endpoint for file downloads,False
fd7570f6c8fbea2803b34b5ba1699a273cb8ad1e,2016-06-30 07:22:58,Halla Moore,Add various syncback tasks for messages,False
80d80eb3064009515c2c294e2501cf0fca2b4b66,2016-06-30 06:06:34,Halla Moore,Added StarThread and UnstarThread imap tasks,False
2a77196fd95d8e42614f665a5e023b5ba23c648a,2016-06-30 05:53:27,Halla Moore,Merge branch 'master' of github.com:nylas/k2,True
ef11508b38b36f4a2c79d861ae59566175f28fd8,2016-06-30 05:53:18,Halla Moore,Added MarkThreadAsUnread task,False
5323350fb258e390906d230be4b6ec03e1e5b42f,2016-06-30 05:49:03,Jackie Luo,update(readme): Remove Scheduler from plugins list,False
4d7f728a75e598dce97db6a52373a596ad0a7e96,2016-06-30 05:40:34,Evan Morikawa,categoryUID -> categoryImapUID and messageId -> messageHeaderId,False
d3fd671ff6a3a00dde8e3677070cd17c490597a5,2016-06-30 05:31:30,Halla Moore,Update MarkThreadAsRead task,False
6cb67e417c96e558961d0ef367309765179a7623,2016-06-30 04:55:51,Evan Morikawa,Fix to use Imap BOX and simplify move helper,False
c7fa9a782fcad715b08a79b794649c4db6f2600b,2016-06-30 04:42:44,Halla Moore,Merge branch 'master' of github.com:nylas/k2,True
825ce2eba3a7a0824089d35f0c8da7eed3a74d24,2016-06-30 04:42:29,Halla Moore,"Use categoryUID instead of categoryId, change default value to match node-imap",False
b00b1e6d21ef6440bf5d98218752f9ce5a3d7b80,2016-06-30 04:40:45,Ben Gotow,Add replyTo to message model,False
da279590098838f706e6eb812069f618c2f63cdd,2016-06-30 03:37:29,Halla Moore,Changed some variables so that first letter is lowercase,False
fc3796ff669c0fc114ccaf9628c3997261c273b1,2016-06-30 03:28:38,Evan Morikawa,Fix transaction case issue,False
5a56c9a4e4848b8958fd47f179c6aee6472113ff,2016-06-30 03:13:20,Evan Morikawa,AccountId -> accountId,False
9ba3ac1bfdc19d7006ec07c6cec135b0fa797338,2016-06-30 02:55:52,Evan Morikawa,Merge branch 'syncback',True
905d797fd2263e767218fcd6795652d0470c6926,2016-06-30 02:55:42,Evan Morikawa,Remove comments,False
124f0a95798d7425bd0a91a969fef36c0c0f8c11,2016-06-30 02:49:04,Evan Morikawa,Add sigterm,False
a45306729fc4a6d119ce4a700b85fc94334b0030,2016-06-30 02:31:01,Halla Moore,Merge branch 'syncback' of github.com:nylas/k2 into syncback,True
bf39b51e081db2f39090b5f844dbab9c33fb89e9,2016-06-30 02:30:47,Halla Moore,Correct some function names/params,False
6a6e1f4f603122a7980df43e1f474bd2a2ada3a3,2016-06-30 00:59:21,Evan Morikawa,Remove loggin in api,False
2721617665fb638309fed50d4f1e526df3416d51,2016-06-30 00:58:22,Halla Moore,Use CategoryId instead of messageId,False
0e80bce4339ec365eea545569f7feb4a167c0cb3,2016-06-30 00:56:45,Evan Morikawa,readonly false,False
3753d9743af12899bde4ab41a0012795c9c1ce8f,2016-06-30 00:55:38,Evan Morikawa,Fix return,False
d26824771d8e2a6cab747fbee33a5377fff975bb,2016-06-30 00:38:31,Evan Morikawa,Clean up loggin,False
bdfee404e5129edcd6ba366f7067fe22233a9345,2016-06-30 00:37:28,Halla Moore,"Add move imap wrapper, make sure wrapper methods are called",False
7cf59c3c1134121874fac94cbb25af215e242aa3,2016-06-30 00:34:46,Evan Morikawa,Fix retrun value in MoveToFolderIMAP task,False
a25c39965221a59f5524dbf411ff470f79e12095,2016-06-30 00:34:22,Ben Gotow,Downcase remaining model names,False
53d6c6284e35d846aab57272f4e5e59262e48c76,2016-06-30 00:32:31,Ben Gotow,"Support for /threads?view=count/expanded, thread & message JSON includes folders",False
941180c1df19662772c5a0473ad2b6cc077ac163,2016-06-30 00:14:30,Evan Morikawa,Syncback WIP,False
9ff7d3aea57c29c0306672676dee0b60f375de8b,2016-06-29 23:52:38,Ben Gotow,"Add folders and labels to /threads response, version numbers to all models",False
6ecacdd591fc8670d16b486ea4180d93202414ad,2016-06-29 23:06:35,Ben Gotow,"Add account_id to all responses, downcase model ref columns",False
ab19133b20d5d8a19ba007b0f0b6bdd144fdc3c6,2016-06-29 22:43:56,Evan Morikawa,Add SyncbackTask super class,False
cf87325c5d661c8fc1ca8073c98928219ba0203c,2016-06-29 22:43:56,Evan Morikawa,Fix syncback request object,False
8a53dca75500042fe8036369cf6d2768ecf0881d,2016-06-29 22:40:49,Halla Moore,Merge branch 'master' of github.com:nylas/k2,True
ba2d865a5dece96c31c45a6f42b0148b34210b9f,2016-06-29 07:37:49,Evan Morikawa,Cleanup syncback request,False
11a3a8f58e6bc08f0ce25d04ba5da428d6a7b42e,2016-06-29 07:32:24,Evan Morikawa,Cleanup syncback task,False
c7422ffaea4a70be6357d4b18df3ec13322ff98a,2016-06-29 07:13:53,Ben Gotow,Fix bug where always closing connection after sync,False
0189e3e77d8d9a9078a9a7d47a4598c92948aa6f,2016-06-29 07:01:40,Ben Gotow,Break Gmail mailboxes into folders and labels,False
7180ebbb70623b83ed20c605366eeea8a8ebf399,2016-06-29 06:47:11,Evan Morikawa,PUT route works on threads to create SyncbackRequests,False
ad484e8ae1cf386f318050c0ab0d8973771473ba,2016-06-29 06:44:54,Ben Gotow,Add `object` key to all JSON responses,False
306086091d9580daa5701cee311a4776ac083dec,2016-06-29 06:43:49,Evan Morikawa,syncbackMessageActions refactor,False
f5af9c0cb5b8c2b8aff3fa547928dbe892d2076f,2016-06-29 06:43:49,Halla Moore,"Added a syncback task to mark a thread as read, untested",False
222c68a5985825b627c42f3a909438050f31fb60,2016-06-29 06:41:55,Ben Gotow,"Deprecate thread.cleanedSubject, since the only subject is the clean one",False
1d1186cb34e8c42e8767d04ad212494ebd654d76,2016-06-29 06:40:52,Ben Gotow,"Add more attributes to /threads, move processor to it's own process",False
cea7783a5faae466112f76955fa9040e70b1775a,2016-06-29 05:42:45,Evan Morikawa,syncbackMessageActions refactor,False
b867bcb31e948aacdceabf088822a44003501f9c,2016-06-29 04:26:35,Halla Moore,Merge branch 'master' of github.com:nylas/k2,True
2d90c5bb1414e2009ac74d63d9e1f7917b7adca5,2016-06-29 04:14:38,Evan Morikawa,Fixes to sync worker,False
ca0120a8245b5a23bf8f5026dce5838141f87897,2016-06-29 04:07:22,Ben Gotow,Allow sync after errors with env var,False
14cffcf8a5e3422ae18ffda10c7adee550a83602,2016-06-29 04:05:59,Evan Morikawa,Change to notify / observe for syncback requests,False
a10543c1c826a04389683b5b7d90e21c7ecff01f,2016-06-29 04:00:56,Ben Gotow,"Chunk sync of large mailboxes, keep track of synced UID range, not just uidnext",False
0f64b6e58e9a3658ef2c2907525f9ed098b55585,2016-06-29 03:31:41,Halla Moore,Add category filtering to threads api endpoint,False
0f4ed7f4a170131cf42172a8621a688016cbdcda,2016-06-29 02:39:56,Evan Morikawa,Fix package json,False
8108a875eec805ced566adbbb81235638a0eb4ed,2016-06-29 02:27:07,Ben Gotow,Allow trailing slashes on API endpoints,False
eaf19cc5223fa2914dc1a2751857cd1f2fe8c986,2016-06-29 02:25:00,Jackie Luo,Add files endpoint for metadata,False
a00f86660c7eab491a0672d91009e4ae64832dc7,2016-06-29 00:02:18,Jackie Luo,Create file objects from MIME parts,False
c5d753a4344054ca8b986a2f1817791f5ecfa3f2,2016-06-28 12:29:22,Juan Tejada,"Add /very/ basic initial error status to dashboard

- TODO: add option to solve the error",False
f68948c23f2fe3da4bb174db5f917b0dbb1e3d61,2016-06-28 05:08:40,Ben Gotow,Fix population of db fields in processor,False
91887a6e11bda57905e6323e759c52df8248a051,2016-06-28 04:41:36,Ben Gotow,Speed up sync by fetching preferred body block only,False
ed749e0f5131f4107f7b1273c73cf7945a120d02,2016-06-28 04:33:38,Juan Tejada,"Add sync worker error handling

- Handles sync errors in a single place. For now, if error is not a
socket error, will treat as a permanent error, save the error to the
account object, and prevent any other syncing until the error is cleared
from the account object
- Adds a NylasError class that can be extended and serialized. Adds it
to global namespace on all packages and replaces all uses of regular
Error",False
cf421cbb2dfae44687b302d6b5ad98560f071e31,2016-06-28 03:28:09,Jackie Luo,Check In-Reply-To instead of References,False
179f24449ba29edb5295391255175a9b55eaf400,2016-06-28 03:22:05,Jackie Luo,Refactor code and add test for threading,False
5077b3f027b7979399ac007224ef62dce5f419ce,2016-06-28 02:15:11,Halla Moore,Add subject query to threads route,False
94cd088dd778f37ac251f9db0f5ec377c474f617,2016-06-28 01:59:13,Ben Gotow,Commit .env to fix dev environment,False
2e56d3ced43fbd6a999a3d444eeaded7a7f361b7,2016-06-28 01:00:28,Halla Moore,Add timestamp queries to threads route,False
76d873c2b2e6e1df7040a5d493e9732b96112c2a,2016-06-27 23:13:53,Ben Gotow,"Reintroduce concept of `provider`, start work on Gmail",False
ab4c8cf32cce3852f0e332d74e2a5758dfec76d0,2016-06-27 23:05:34,Halla Moore,Add id query to threads route,False
1fe7fdf4b1c2886ae3b64cd7494e9bd38221311b,2016-06-27 22:57:38,Juan Tejada,More sync error handling WIP,False
621f8b5c2bda959c2b6a43edc3d4eb8a87b5365f,2016-06-27 22:45:05,Halla Moore,Add starred query to threads route,False
63b929e59b7fd08d49dbb8f25d45cc501b43f18c,2016-06-26 22:22:03,Juan Tejada,Fix missing promise based error handling in sync-worker,False
dd350a5081d31a37fcde411b11a0f2bad778689d,2016-06-26 14:27:33,Juan Tejada,"Update IMAPConnection api + error handling fixes + misc

- `IMAPConnection::openBox` now returns a Promise that resolves to an
IMAPBox, and IMAPBox contains all of the `fetch` operations. This makes
the dependency between fetch operations and the currently open mailbox
explicit rather than implicit and by forcing the operations to be called on
a box instance and hopefully prevent errors. It will also throw an error
if the constraint is no longer satisfied.

- `fetch` operations now return an observable stream of messages (or Promise for single value),
while preserving the same logic of the original implementation. You can use `.toPromise()` on
the observable to get a Promise that resolves when the observable stream has
completely drained.

- Fixes error handling in a few places and renames some variables",False
63f48ae8171de0ad71c2d9072b79700301cd7d58,2016-06-26 14:14:39,Juan Tejada,Adds hapi-boom for easy error responses,False
1336dea0d46affef3136a7b56d061704e0411ee7,2016-06-26 10:49:05,Juan Tejada,Fix auth response + log errors,False
caaef8d5b56f74037463a33ada30cd03732000e8,2016-06-25 23:55:34,Juan Tejada,"Add /messages/<id> enpoint + support for raw message/rfc822

- When message/rfc822 is requested, fetch ray message from IMAP
connection",False
69e87cbf49bd9821c837d75efa4a5c5e14299e8c,2016-06-25 05:16:41,Ben Gotow,Gmail auth at http://localhost:5100/auth/gmail,False
bc5a4ecf3cfb8b4399c215d151076995660642e0,2016-06-25 04:44:04,Halla Moore,Add unread query to threads route,False
18ad15937fef26336827692079941208fd9b0bd7,2016-06-25 02:37:10,Halla Moore,Change uppercase instance of Joi to lowercase,False
7e2c487034813df832193f44ac3fa9e485e31b62,2016-06-25 00:27:24,Juan Tejada,Update README with auth instructions,False
8f945888e4e05f76c3d732b4bae5bde14b544400,2016-06-24 23:09:30,Juan Tejada,Add missing test fixtures and fix path for reading them,False
ee2dc6c3f674f05866ca3c2aa8c5a759c93dea79,2016-06-24 23:06:57,Juan Tejada,Expect true to be true,False
0ac3c8c31310d5f4fe0bcd12c0b5f2384fd811b3,2016-06-24 23:05:34,Juan Tejada,Add jasmine for message-processor,False
b67a3ae3e4415b14e64bcfb6e8729266371734f5,2016-06-24 06:47:04,Ben Gotow,"Launch dashboard when in dev mode, publish change on acct creation",False
f678045c4f1d80c8b28a55476ce6318c261c08b2,2016-06-24 04:58:51,Ben Gotow,sync db <=> redis with sequelize hooks,False
eac019f5366ff2e64ab5b035c6585b31de4c3886,2016-06-24 04:58:48,Ben Gotow,"Rather than changing policies, just set expiring redis key to track activity",False
09bb7874f8b08b9bfa160b055f7818f898b8804a,2016-06-24 04:22:53,Ben Gotow,Dashboard with a sweet background. Also realtime assignment / policy view.,False
3f5cac4342366db5c0c4b6c82bfc1663ec00f8c3,2016-06-24 04:17:07,Evan Morikawa,Adding in syncback message actions,False
b6f57f3ce8ccfecaa87b4b3f25f54348e9fd6e29,2016-06-24 04:14:03,Jackie Luo,Add threading algorithm,False
f9fe8368992c8c60f8e8d1ecb1a0d24f4d776d28,2016-06-24 03:51:54,Jackie Luo,Fix syntax error,False
5cc4841ac6fd8c3feb9c9d501cdfa8f1c3383750,2016-06-24 03:49:20,Jackie Luo,Add check for Gmail thread ID,False
6ad9cdd322bf9388b0915409fe49606d75809779,2016-06-24 01:45:30,Evan Morikawa,Fixing broken processors,False
8160acc81e375ee2c98519ceb371c80f51e780c8,2016-06-24 00:48:33,Evan Morikawa,Add imap dependency to package.json,False
1460a0ae9f46fa7fbb6affb871239fdacd6cb637,2016-06-24 00:46:15,Evan Morikawa,Rename Refresh to Sync,False
8e692982bb7bf25e63e8bcc774d46a65dc0824b5,2016-06-24 00:32:57,Ben Gotow,"Remove concept of self-limiting workers, will use cloudwatch metrics collection to scale fleet instead of queue length",False
f7c647f7ba93e5c694ca19f333474692d3f78a53,2016-06-24 00:15:33,Ben Gotow,"Return syncs to unclaimed queue after CLAIM_DURATION, just because it's healthy",False
c2e9093b4282a1fa31dbed536465795f8e48656c,2016-06-24 00:15:33,Ben Gotow,Escalate sync policy based on number of stream connections,False
ae54192ed65aab992a082e7e229c801c193c91d9,2016-06-23 23:05:47,Jackie Luo,Update threading and fix typo,False
a917022505b76504f6c20f05342ec1fb9bb9792f,2016-06-23 22:56:41,Juan Tejada,Update order of threading processor,False
ad1683c9a55a16321c5d0a175a6166414dd0d946,2016-06-23 22:41:07,Ben Gotow,Fix reference to __base,False
12d9db8dd924fffa9bd8bd209843fca805f66942,2016-06-23 13:19:26,Ben Gotow,Redis coordination of sync processes / assignment,False
2e9bfa68b56dbcc5c86c202eb76bc379c2e79cad,2016-06-23 13:19:26,Ben Gotow,Refactor DeltaStreamQueue (connection per subscription),False
cb9557437856c1ccc15e48fff63b0110d132c755,2016-06-23 06:04:29,Jackie Luo,Fix associations,False
e64c2ae4c0856b9e3e381fdb9cf168535a0bc0a8,2016-06-23 06:04:29,Jackie Luo,Add basic threading,False
f5f435236fea7a7bcb3cff1d0cd7bf2c2aae3d7d,2016-06-23 05:49:48,Ben Gotow,/auth + remove hardcoded stub in favor of curl request,False
d5d019f9d9ddf636673d51312eeec46f2cecad82,2016-06-23 03:23:23,Evan Morikawa,Plain npm install,False
71167328ddaa5830dcd11b6dc1d765db1caebf27,2016-06-23 03:19:36,Evan Morikawa,Update readme,False
06393dd07c5ded496268bd24fbad2c9c9e1f94e4,2016-06-23 03:14:09,Evan Morikawa,Move categories & messages to new monorepo structure,False
95fbb64d17b94f8a27c444939666e86dd49778cf,2016-06-23 03:12:08,Ben Gotow,"Add /messages, /folders, /account",False
18f2925b434b1e018d433cae4f9a12b66c6dec6c,2016-06-23 03:11:32,Evan Morikawa,Convert to monorepo,False
2c5da59d744feeb5c8af4b785b7d1f14b2b10d19,2016-06-23 02:27:51,Evan Morikawa,Properly pluck out transactionModel,False
02f07882327e17c41e082c7d5d54246bf019e53b,2016-06-23 02:05:55,Evan Morikawa,Improving observable based delta stream,False
54599a21c0d39830184b12e5f27a99bea82d072a,2016-06-23 00:49:17,Evan Morikawa,Ignore storage folder,False
135f16f8d680ff5c36303514500265b3f48d5446,2016-06-23 00:46:41,Evan Morikawa,Add initial observable based delta stream endpoint,False
5bf63f8ea6be0eacc750fee1f109e474955a517d,2016-06-23 00:27:24,Juan Tejada,"Fix message processor pipeline initialization

- Was not actually returning an array of functions from
`processors/index.js`",False
8172cad6228322fca4e2eb8213513949a24ca52d,2016-06-22 23:31:51,Juan Tejada,Fix syntax error,False
c3ed7cbdef414cee607cb3a926526ae7210edaec,2016-06-22 23:30:35,Juan Tejada,"Adds message parsing module + other updates

- Adds an order for the message processing pipeline to ensure that
parsing occurs first
- Adds JSONARRAYType
- Other misc updates",False
19de776e008b1b93d633a4e44c567a02a4959c65,2016-06-22 07:07:00,Ben Gotow,"Encrypt connction credentials, move conn settings to acct",False
b7cd644a83b45a621da4e64605e5d293ad67d63b,2016-06-22 07:00:07,Ben Gotow,More quietly update category sync state,False
647dc1f78c3e725fb831c27f18f4f088ac354a7f,2016-06-22 06:21:47,Evan Morikawa,Default to port 5100,False
e75d0ea16be1f94c767c97c5da6c07f452ff4828,2016-06-22 06:15:25,Evan Morikawa,Add procfile.dev with external redis launcher,False
644af22d40e194462ef94516a18c4dac7767b9ae,2016-06-22 05:55:25,Ben Gotow,Fix merge conflicts,False
2170ee41430831914be21212a5124b2ad995bba4,2016-06-22 05:48:32,Juan Tejada,WIP message-processor: building the message,False
b4e05fcb301d5c3bf82d811c714bd6ca04b78372,2016-06-22 05:47:59,Evan Morikawa,Bind to proper port,False
05795692f1e8eedb9a451b9ac3b44e38e736b801,2016-06-22 05:45:36,Ben Gotow,"More sync improvements, use CONDSTORE, gmail coming soon",False
02fbd6e6251035405ad4d84cc12a8d74ca4105f5,2016-06-22 05:43:48,Evan Morikawa,Add core as package dependency,False
76026207423f70490fa1cad3cac131cea7d77424,2016-06-22 05:41:31,Evan Morikawa,Add Procfile and heroku readiness,False
9dad99801c288ad9d711350642058846232faf10,2016-06-22 05:02:11,Evan Morikawa,Add params,False
fa4ed23621ad9df8063718314a7b3a4a5d50a249,2016-06-22 04:41:47,Evan Morikawa,Put single token in shared db,False
2d4b17ee52e397b90ff48dfa9511b76b37da7092,2016-06-22 04:27:50,Evan Morikawa,Add a delta streaming endpoint,False
e4d12459d073e52c634f78f1737b488bfea14e5e,2016-06-21 06:44:26,Jackie Luo,:art:(tracking): Tweak style,False
29a6448922c7ba64c7ebbcf378435750e7627a84,2016-06-21 06:03:27,Ben Gotow,Initial concept of sync policy,False
f995f6fda150a8bba5cf0f23a3db81fe2c042cb1,2016-06-21 05:58:26,Evan Morikawa,Add delta stream queue on sync side,False
cebce1081f4b5486c1e40e15f2f7536b6b3f47d0,2016-06-21 04:53:09,Evan Morikawa,Fix error & and turn on transaction logging,False
8ed94442c445110bce6245227478e375486ddcfd,2016-06-21 04:33:25,Evan Morikawa,Add transaction logging,False
83dfb664e1d7ffadf376abc59661f4a67251b547,2016-06-21 03:33:02,Juan Tejada,Add initial version of message-processor package,False
de8e09d6b555f50bddd286de18c8988caed51ab4,2016-06-21 03:14:07,Ben Gotow,"Unify operations, fix a few bugs, logging issues",False
6577bd93585aea4000214f5294b8b66169e7c96f,2016-06-21 01:51:10,Evan Morikawa,Update readme,False
3a677a8c2d14f53abbb64176f6a726cb49f38f5c,2016-06-21 00:49:01,Ben Gotow,Create README.md,False
3dc03688e8fe931ecd8793a3602097d59fced7c8,2016-06-20 12:49:16,Ben Gotow,Cleaner sync state machine,False
25270c0b75f736cfa3939703d7d92ace1e527a06,2016-06-19 15:32:32,Ben Gotow,Initial commit,False
20f9e7b3a11383b581265b41588bbb480e107f4a,2016-06-17 19:38:12,Evan Morikawa,fix(win): fix alt-based worker window keyboard shortcut,False
ca2fa9e1da6474d8827fb9c7032847ba9a5cabb3,2016-06-17 19:38:01,Evan Morikawa,fix(analytics): fix identify debounce to prevent phantom profile,False
53eb7f58aa1e5ee1b0ddae7a2dfa334f193ded79,2016-06-17 19:37:05,Evan Morikawa,"fix(github): fix view on Github buttton

Error due to action import.
Convert to ES6",False
54a74e317d4e968348db0f588e8dca68e63cb839,2016-06-17 05:10:47,Juan Tejada,"fix(sidebar): Make sure saved sidebar accts are correct

- Sidebar accounts may become invalid when switching from staging to
prod",False
e87096d7a3cfd31aa36d7d89dfc78ea65b7e4560,2016-06-17 04:07:58,Juan Tejada,"fix(quoted-text): Add option to remove quoted-text, fix styles

- #2323",False
42e876ab1f99270b003e6ed7bc5e8fe055b1c54c,2016-06-17 03:42:19,Jackie Luo,feat(spellcheck): Add option to disable spellcheck,False
36e0e0721d133b4aae6385e98e5f6bb6d8515f02,2016-06-17 03:39:24,Akash Nimare,Fixed broken links. (#2470),False
a04c1f42248b5dce1d1407e0ed34dfb50350aff2,2016-06-17 00:53:06,Jackie Luo,fix(subscription): Change copy to be less confusing,False
7004bf94ce5132a5ea0e3f61ce06f44e2da37d70,2016-06-16 05:18:26,Annie,"fix(label-nesting): maintain nested labels when renaming a label

Summary:
when renaming nested labels, maintain nested path
fixes #2402

Test Plan: created nested labels and successfully tested in dev

Reviewers: juan

Reviewed By: juan

Subscribers: evan

Differential Revision: https://phab.nylas.com/D3028",False
ce8cdf8cd7cd445bc6077b044f4ffb23af70e4ab,2016-06-16 05:00:52,Halla Moore,"fix(specs): Fix specs on Linux

Summary: Specs were failing on Linux, this diff fixes them.

Test Plan: Unit tests

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3029",False
4ed1f590ce8bd87d6f98bfa16a646dca7dea43ad,2016-06-16 03:59:52,Keith Armstrong,"Update broken links for guides, docs, and API (#2455)

Also updated schemes of some links to https for consistency",False
2f48b77d1ab883be2a24f4bf2bc5f4d89195db22,2016-06-15 03:34:18,Jackie Luo,fix(identity): Convert datetimes to milliseconds,False
302b8074e5cea3510b3dab7df837aca8485956e6,2016-06-15 02:32:32,Ben Gotow,fix(mail-merge): Patch to prevent interaction with other ParticipantTextFields,False
0a45a5b039e6a0559b8d885dafc3be54ddfa32f0,2016-06-15 01:56:10,Ben Gotow,fix(keybase): Don't run specs which require keybase API,False
72cd732ebf7d5ac2de35b384dce99b93076e56aa,2016-06-15 01:52:38,Ben Gotow,"Pgp patch (#2430)

* update icons

* style commit

* Debugs export function

The key Export function used to not successfully show items in
their directories and also depend on the most recent attachment
download location. This commit adds a new savedState attribute
just for Keybase keys and also handles the case where that value
is null.

* Forces delete to populate

fs.watch() was acting up and not triggering populates on deletes.
Now deleteKey() just triggers a populate.

* Re-enables decryption of attachments from Enigmail

Decryption of attachments was disabled in the Great Password Popover
Refactor of Early June 2016. This commit adds that feature back
(and makes some changes to getKeyContents to facilitate that
change).",False
5810aeeefcad4354a40109b01eebbdf2baa9ff13,2016-06-15 00:56:43,Ben Gotow,fix(keybase): Invite fetch doesn't need JSON parse,False
04e31546144fcdc43557dcbaa1af34f3a4caaeb0,2016-06-15 00:22:15,Ben Gotow,fix(identity): Show number of days remaining correctly,False
74a8c0e55451868b4d69dd2eab2b4aee647b7c52,2016-06-15 00:13:41,Adrian Grant,Add Website Launcher community plugin (#2407),False
7c696c4db93a928e924f4cb801299826c461a418,2016-06-14 14:15:52,Ben Gotow,bump(version): 0.4.45,False
8c4255ebeb5118820d51558813d36214a65aebf4,2016-06-14 13:53:22,Ben Gotow,"fix(login-links): Cap req to 1.5s, ensure pages always open",False
e1a565b061419fe3a3db3837d22802e26b77be32,2016-06-14 06:10:21,Ben Gotow,fix(keybase): Add a small button to redeem a keybase invite,False
9afe205964922d523057f1883c10f215b99f84c3,2016-06-14 05:02:46,Jackie Luo,:art:(loading): Remove supplement text,False
47115a5000761d4d3ec0962c11b731c0db29f4e1,2016-06-14 04:49:46,Jackie Luo,fix(view-on-github): Import Actions correctly,False
e44e4e27c4da10a97f83906f69499456110d7438,2016-06-14 03:49:01,Ben Gotow,fix(onboarding): Minor asset tweaks,False
76fac0c6c0b2a3b2ba9f7eeb12f1b7a8665d9916,2016-06-14 00:36:53,Ben Gotow,fix(pro): Add manual refresh to identity page,False
b3af7e65143564d405af5a061e00e994f7917aa9,2016-06-14 00:35:11,Juan Tejada,bump(version): 0.4.44,False
3fb755cc4de18e3394fdf37b535604b2fd96c22c,2016-06-13 22:44:15,Evan Morikawa,fix(analytics): move to work window,False
ce16e2e0334c09a481fb06bcfd4a7cea347642be,2016-06-13 06:43:46,Evan Morikawa,fix(identity): enable proper People support,False
8906fe0f848fb01726edb34bcf506fbd7543bf67,2016-06-11 04:25:21,Jackie Luo,fix(activity): Add thread ID to notifications,False
182683cd061c2c5f4644cf76b74d1684a19bba38,2016-06-11 03:06:37,Ben Gotow,fix(pro): Replace `subscriptionRequiredAfter`,False
b3377da4ac92d221575bd5a683e28c721bfb43e1,2016-06-11 01:57:40,Juan Tejada,"fix(send-task): Update to use Message::participants

- Fix participants method signature for correct default params",False
d4d366edc02cc33c160c15e77377648b7843f121,2016-06-11 01:05:56,Ben Gotow,fix(sending): Minor changes to cleanup phase of sending,False
3482ca3145b3b72a8949babc8f8d4df3ac3e5b59,2016-06-11 00:25:59,Juan Tejada,fix(menus): Add missing `Window` menu to win32 and linux,False
03226253806cbbf55e6d7e251862c857ca89f38b,2016-06-11 00:24:47,Evan Morikawa,fix(spec): fix failing draft specs,False
bde97c532bf88f092b2ce302e410ee0b72162caf,2016-06-11 00:24:18,Evan Morikawa,fix(multi-send): show dependent errors in session close task,False
b1a8efc50a06ca0b8c3e6a2a873daa9e260989b6,2016-06-11 00:02:38,Juan Tejada,fix(specs): Fix DraftStore and SendManyDraftsTask specs,False
b0200cc04f3ec780b7c2da27b8dd8aba1ba3c5fc,2016-06-10 23:25:48,Juan Tejada,"fix(mail-merge): Remove unecessary shouldComponentUpdate on decorator

- `shouldComponentUpdate` on ListensToMailMergeSession decorator prevented
the default TokenizingTexField from being rendered even when mail merge
was inactive.
- It incorrectly assumed that the only state the decorated component
cares about was the mail merge session state",False
7daee5ce0f85a60d354afc11fe750dba9a05f27a,2016-06-10 22:02:18,Evan Morikawa,fix(draft): delay draft re-opening w/ errors to allow time to close,False
01814473f5b2b3dd01ee6f022b428e4264d52e34,2016-06-10 12:58:44,Juan Tejada,"fix(mail-merge): Correctly update tokens when new csv is imported

- MailMergeBodyToken now keeps internal state to track when the column
its linked to has changed
- Fix subject regex",False
147f7f7219451908161889937282752c9493f5c8,2016-06-10 06:51:08,Ben Gotow,fix(moves): Improve labeling of ChangeLabelTasks,False
aba4b7d6b9367dbd1af6230ee784748b75e89cee,2016-06-10 06:21:08,Ben Gotow,"fix(emoji): Remove vertical overflow from composer, allow for popups",False
6743f8527830fa5ec58fdd5a4afac5eff58ff610,2016-06-10 05:20:49,Jackie Luo,fix(emoji): Stop checking text outside of current div for matches,False
127b8c1ea2d2c1817928ce242b474f06dc2fc3ed,2016-06-10 04:53:32,Jackie Luo,:art:(tracking): Align thread list with open tracking icons,False
b949d5c8389f34cdb1172565aae3e1c725e7f695,2016-06-10 04:53:15,Juan Tejada,"fix(plugins):Call NotifyPlugins task regardless of metadata sync success

- Before this commit, if any SyncbackMetadataTask for a message failed, we would
never run NotifyPluginsOfSendTask because of the dependency in place.
This caused unintended consequences like open/link tracking not working
if any other plugin failed to syncback metadata, despite the tracking
metadata having been saved successfuly.

- This commit makes it so NotifyPluginsOfSendTask always runs after
the SyncbackMetadata tasks regardless of wether they fail or succeed by
updating the task queue to support this dependency scenario",False
31edbfc361e31aa1e10dcd60c4d6e6db90006e12,2016-06-10 04:41:27,Jackie Luo,:art:(darkside): Add UI tweaks for activity list,False
f593fbf6cdc8355d82fc66a50f1b95bd01c95e8e,2016-06-10 03:51:20,Evan Morikawa,fix(templates): fix new templates from draft,False
7cafc3ac1b5673839266a645770f396bac1639a4,2016-06-10 03:51:20,Evan Morikawa,fix(template): can hit enter to save template names,False
8ef4d8c0f3021421e8d5676e65b42cc99e0571b5,2016-06-10 03:34:00,Jackie Luo,fix(typo): Correct spelling in error message,False
903e5834c1967ddc421d1bc81c9391a0a3b955bd,2016-06-10 03:30:58,Evan Morikawa,fix(templates): detect empty bodies and fix CSS,False
e5521161b7854fb1ad7099869202e201c54cf1da,2016-06-10 02:42:44,Juan Tejada,"fix(themes): Properly set theme on the hot window

- First composer window you open after changing the theme will now have
the correct theme",False
3df5aeafcc6f03f24a5c934b962e4f9a16923231,2016-06-10 02:28:24,Ben Gotow,fix(plugin-ids): Lookup plugin id if pkg is not loaded,False
62126dd1f94726848f2fa1714fa9bafa3f97a4d1,2016-06-10 01:48:01,Evan Morikawa,fix(analytics): improve data,False
316348e02cc386891a004e321d25f7f79a57c12e,2016-06-10 01:01:17,Juan Tejada,fix(build): Fix less lint,False
9680ade34fd4c3ebf253797f35899874e1219d10,2016-06-10 00:27:12,Evan Morikawa,fix(analytics): set super properties on events,False
9569b53d357fcd236995718829cbff044b8acebc,2016-06-09 23:27:31,Ben Gotow,fix(focus): Don't clear focus unless change removes acct,False
4543f4770958d0fbef380077b42044ef3ceba48e,2016-06-09 23:00:27,Ben Gotow,fix(auth): Don't use a persistent session for webview,False
c2f0b727b1ef2a51605f1dc56fc4d1fbf2b622ad,2016-06-09 06:59:46,Ben Gotow,fix(new-event): Make X easier to click,False
fec31c543571bbc4dfc74c32cd415f19b840e58a,2016-06-09 06:55:45,Ben Gotow,fix(account): pro_sub => n1_sub,False
9373aee8fbafbd9c0ac87f812e5ab9c15297b462,2016-06-09 06:55:45,Ben Gotow,fix(prefs): Use labels instead of email addresses,False
167416ee86c0771dad911d0bc195d9b8a1ccc546,2016-06-09 06:55:45,Ben Gotow,"fix(win-manager): Replace sendToWindow, check for window first",False
a80545d2dc9ebbb9125942afe4fd9b556602777b,2016-06-09 05:26:48,Juan Tejada,"fix(composer): Prevent composers in different windows to be out of sync

- Increase arbitrary wait time before closing window so Database ipc
messages can reach other windows with a higer success rate -- this
caused composers in different windows to be out of sync fairly often because the
database trigger event never reached them
- Clears commit timeout when commiting",False
4c0da37b00b4470eced34ae1f6d638bc8c169150,2016-06-09 02:49:40,Evan Morikawa,fix(welcome): pass utm on to welcome,False
3ed9ca605824ffca516af9a5cfe61018938465a2,2016-06-09 02:40:09,Ben Gotow,fix(onboarding): Switch images into appropriate places,False
5ff40f989af82178a8d2f1674a0f80eb88f81410,2016-06-09 02:35:18,Ben Gotow,fix(onboarding): Final tutorial screenshot,False
7d52bb0d3c455a311304d0b43cb088201391518f,2016-06-09 02:18:56,Ben Gotow,fix(onboarding): Don't allow going back into N1 signin,False
45dfcc1a6ce26629e4778b2806ceccff7dfcb230,2016-06-09 02:15:39,Juan Tejada,"fix(composer): Prevent participants field from adding unecessary changes

- This prevents the composer from being marked as not pristine even if
no real changes have been made",False
3f616ccc964d733fb5be7d077820184ab2d4662e,2016-06-09 00:49:12,Evan Morikawa,fix(analytics): Fix send draft analytics,False
5214294e6f710477577013ecfbe58efe12597e2e,2016-06-08 06:49:41,Evan Morikawa,fix(analytics): fix identify,False
b335856d6e5bb8083bf1e32fe879a4b3d3b9b807,2016-06-08 06:49:34,Evan Morikawa,fix(identity): fix parsing of url path names,False
3f9e1e2d9277a3f0c0975eac65ef37e9b9eeef4f,2016-06-08 06:39:27,Ben Gotow,"revert(electron): Downgrade to 1.1.3 to fix segfault

electron/electron/issues/5925",False
adf1113361f7aef39dd6e845aad64509116295cd,2016-06-08 05:11:04,Jackie Luo,fix(plugins): Update plugin descriptions,False
63972d439022268cae5bf45945e3025590ab7bac,2016-06-08 03:20:33,Ben Gotow,fix(keybase): Remove fdescribe,False
38e3897407b71018b77fae01f88ca7f672c94fb3,2016-06-08 03:11:39,Juan Tejada,"fix(search): Prevent from adding duplicate threads to the search index

- We have to manually check if we are inserting a thread to the index
that already exists because the virtual table does not support unique
indexes
- Add versioning to the index to be able to rebuild it for the next
update",False
78166a9d10531dd6d7d7a950b52bf9fd8554263b,2016-06-08 02:55:59,Ben Gotow,fix(keybase): Minor linter errors,False
2b24603a95f03a8e29cf25674b794baa489f7f55,2016-06-08 02:47:26,Ben Gotow,bump(version): 0.4.43 beta,False
c35e9a564d20e3835c80a80f7898e090eb3ebc43,2016-06-08 02:45:54,Ben Gotow,"fix(keybase): Disable by default, remove duplicate dependencies",False
445d98c59a5ad26f1283ab4c36065fd8f3dd8894,2016-06-08 02:22:08,Evan Morikawa,fix(analytics): update people traits,False
c7e2beee8b1e8741bc3bdea861c628caf8d7cf50,2016-06-08 02:08:47,Evan Morikawa,fix(analytics): improved analytics,False
8f89ed79cbb97b0a917e883d3952507db6697e06,2016-06-08 02:00:04,logandavis,"feat(keybase): Adds PGP Encryption Plugin

commit efe58092494c8870072bdf45991c122624bb93e6
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue Jun 7 13:06:25 2016 -0700

    patching specs

commit 15a346b93efa5a21327f6bd7c14ef60ddc0f79bb
Author: Ben Gotow <bengotow@gmail.com>
Date:   Mon Jun 6 17:49:20 2016 -0700

    A few small fixes

commit d4cc62a90d2d4f101b71bc57b5521353d2175219
Merge: 80018c0 17d9c3d
Author: Ben Gotow <bengotow@gmail.com>
Date:   Mon Jun 6 17:32:00 2016 -0700

    Merge branch 'master' into wip/keybase

    Conflicts:
    	build/Gruntfile.coffee
    	internal_packages/onboarding/lib/page-authenticate.jsx

commit 80018c045527dec331118426ce67d82c44926334
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri Jun 3 18:12:39 2016 -0700

    Re-styles decryption interface, temporarily removes file decryption

    The decryption interface was ugly as hell. Now it's aligned with
    the ""Message Encrypted"" notice and also the ugly text input is
    gone - replaced by a much nicer-looking popover. In the course of
    this refactor, file decryption was temporarily deactivated, but
    will return soon.

commit ed1e6232803e2c6b8930f5ed2bd6ccde56542b3b
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri Jun 3 15:39:02 2016 -0700

    Adds more information to key-adder UI

    User testing indicated that the key-adder UI didn't provide
    enough feedback about incorrect inputs and the slow load time
    of key generation. This commit adds a spinning wheel while loading
    and a span describing which inputs are incorrect.

commit 4d7908635cd606a3ebb2607537127dd1c5740a35
Author: logandavis <logankeahidavis@gmail.com>
Date:   Thu Jun 2 18:40:57 2016 -0700

    Touches up search

    Fixes a bug in the search debouncing that was sometimes
    allowing users to modify search queries and not have the
    new query searched. Added messaging to stop people from
    trying to search keybase by email address.

commit 140ae6679758d8ed54d1b6b7bd5c837f84132363
Author: logandavis <logankeahidavis@gmail.com>
Date:   Wed Jun 1 17:35:39 2016 -0700

    Adds import from file and unifies paste in key-adder.cjsx

    User review feedback indicated that key import was a big pain
    point - pasting keys was a pain in the butt, private keys
    could be saved as public keys, etc. This commit is the functional
    overhaul (and refactor) for the key-adder on the preferences
    page. It adds an Import from File function and merges
    Paste Private and Paste Public into just Paste, which autodetects.

commit 297f9ed482f4e83c52e40e479a31ba1bffad3f7d
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 31 21:11:01 2016 -0700

    fix(es6): Converstion broke file uploads by adding body: {}

commit 7815e90c49c70339cd6d26d48e818d4f5f962b7f
Merge: af54f01 0af27ee
Author: logandavis <logankeahidavis@gmail.com>
Date:   Wed Jun 1 14:49:14 2016 -0700

    Merge branch 'wip/keybase' of github.com:nylas/N1 into wip/keybase

commit af54f0165b95447ffa04c1e324e02d892b20d047
Author: logandavis <logankeahidavis@gmail.com>
Date:   Wed Jun 1 14:47:03 2016 -0700

    Bugfixes: clientID not found (from rebase) and modal on new email

    User testing revealed two pretty noxious bugs, one when you email
    someone who's not saved as a contact and one caused by an update
    to mail merge requiring inputs to Participant-Text-Field that
    n1-keybase wasn't provided. This fix patches modal-key-recommender
    to use emails as a fallback to contacts and sets a reasonable
    default for the input to Participant-Text-Field.

commit 0af27ee10666f35f248a4191fe937cde920d6baf
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 31 19:10:11 2016 -0700

    fix(specs): Empty parameter list

commit 87407249c2bfa7737a4609ac89b46c3b5a074f76
Merge: e4c050b 9892473
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 31 18:08:46 2016 -0700

    Merge branch 'master' into wip/keybase

commit e4c050b599fbc83b6249634297483a5683fe3c56
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 31 18:08:42 2016 -0700

    fix

commit 6c7857890df9d277f786b87ab996feeec4089c3b
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 31 18:05:35 2016 -0700

    fix(linter): Minor issue

commit 36197effd6c8ca3648a5010dac874c9a990fb1b9
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 31 18:02:26 2016 -0700

    fix(lint)

commit 73dd4850bf675f983ecfcc5ef65e91b9aa118e16
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 31 17:52:18 2016 -0700

    fix(lint): Don't lint node_modules of packages

commit 15c9d42f2d896f22092465e78cb340d07e0086ac
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 31 17:36:24 2016 -0700

    patch(auth): Remove unused import

commit 8756b2b5314fd0366caf8b2e12a3bc5e527bc593
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 31 17:33:30 2016 -0700

    patch(auth): Temporarily remove auth flow

commit 135395e4afdfcc8ba57667e60fa73ef55e126c2f
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 31 17:25:08 2016 -0700

    linting fix

commit 1049449f211111e704b3e543d2748339bf9cc6fd
Merge: e6a8f9e e1275eb
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 31 15:50:00 2016 -0700

    merge commit

commit e6a8f9ebadcc3d1b1444c8676d15b730a0d7a5c0
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 31 15:19:27 2016 -0700

    move styling, update readme

commit d388eb737ae9febc197bf0fe22d505a28c669639
Author: logandavis <logankeahidavis@gmail.com>
Date:   Wed May 25 16:15:31 2016 -0700

    Add Export Private Key button to preferences

commit f49062639a8f4a67a576b90a02f4b0f06dd492d0
Author: logandavis <logankeahidavis@gmail.com>
Date:   Wed May 25 12:40:23 2016 -0700

    Add Export Public Key button to preferences

commit 847221b6a2c9b1a1e8b817708ed9032803de9261
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 20 15:26:37 2016 -0700

    update readme

commit 1f3f14bf9c69bfea7d7d1ac79c39fe0fe6befd37
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 20 15:23:26 2016 -0700

    Beautify Add Email button, catch naggling bugs

    The old add email button on the preferences page, which
    was not playing nice with the styling of KeybaseSearch, has
    been replaced by the drop-in EmailPopover element. Also, two bugs
    that were causing the console to flip out on normal, unencrypted
    emails were caught and fixed - the Decrypt Button now returns
    false instead of null, and attachments without filenames are
    allowed.

commit a7cb363e357ff996b92946e9685416b98133de0b
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 20 14:54:00 2016 -0700

    Debug and style the encryption popover modal

    The encryption popover was ugly as sin and also lacking in
    some functionality - it unnecessarily showed the email list,
    it contained no reference to the Key Management page, it
    didn't display any links to the keybase profile in question...
    now it is a pretty and functional popover.

commit b4e3f5421558d4d128ffc66125657fc8b1abf1f1
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 17 18:56:08 2016 -0700

    Unborks Import Key popover, obscures password fields

    The Import Key popover on the preferences page was rendering off
    the screen because it was always pointing at the last button
    created rather than the button clicked. Now that's fixed.

commit 20ab9f825d65f40451397c8a1df484bb7e63c593
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 17 17:17:44 2016 -0700

    Fixes identity filename/address management, dedupes search, encodes +

    Bunch of minor bugfixes here. The identity.path refactor broke
    PGPKeyStore.addAddressToKey and removeAddressFromKey, which this commit
    fixes. + characters were being incorrectly encoded in messages as &#43;
    which was breaking message decryption - that's now fixed in message
    preprocessing. Finally, basic Keybase search result deduplication
    is now in place.

commit 8a2a5e6dc3c84ade420b16e36d2954cea661d1f1
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 17 14:13:17 2016 -0700

    Adds private key management to preferences page; beautifies

    Previously, the KeyManager element on the Preferences page only
    exposed public keys, and there was no way to see, edit, or delete
    private keys. Now you can do all of those things. This commit
    also fixes some render-timing issues in PGPKeyStore._populate
    that were causing nonexistent keys to appear (one on key generation,
    one on deletion of the final key) and improves the styling of
    the Preferences page.

commit 3c39431dd6ad3a8c19770c6ddd46d508ee92d4bb
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 13 15:22:40 2016 -0700

    burns the dead code out of preferences-keybase

commit eb7b924d5e00946ebb3e7174f54f2c1dde1ff616
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 13 14:58:51 2016 -0700

    Fix key generation and saving from the preferences page

    An earlier refactor away from key objects and towards identity
    objects borked the old key saving code. This commit refactors
    the key-saving code so that keys can be manually added from
    the preferences page again, and also makes said code much
    clearer.

commit e1f78d0080505102bf421c8c3638fee527d84481
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 11 17:41:24 2016 -0700

    add README of todos

commit c44d7995fc3cc097fb8f98689dd18488920488cf
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 11 17:41:12 2016 -0700

    heavy style pass, misc bugfixes, add assets

commit 47208ca2d947ac4b04c1fec14b433f7c6105fe1d
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 11 14:03:06 2016 -0700

    Decrypting files first pass, problem with unlocking keys

commit fc2a56574c1eb0a7098280f3e7a2ca5d6697340c
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 4 17:52:32 2016 -0700

    Cause message to encrypt on key picker popover close

commit 545392dee9db2754c6b729bd9549c071e1568ddd
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 4 12:04:08 2016 -0700

    light design pass on the modal (now a popover)

commit 2726aab32dd74a68936a7d80d6e49b879f182ee3
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon May 2 15:47:45 2016 -0700

    Key picker modal functional for multiple recipients, still needs lots of cleanup

commit 050114acf36b8654de80726352812e945ac88968
Author: Dakota Nelson <dakota@nylas.com>
Date:   Fri Apr 29 14:52:33 2016 -0700

    Key picker modal functional for single recipient

commit 865c7c8894b30a55e4c6027dd6f03fea5d0bb330
Author: Dakota Nelson <dakota@nylas.com>
Date:   Thu Apr 28 17:31:08 2016 -0700

    modal now allows selection of keybase user

commit 728c995314b3238bdb3222c7d12353ab2e35a65a
Author: Dakota Nelson <dakota@nylas.com>
Date:   Thu Apr 28 10:46:47 2016 -0700

    consolidate key cache into one object, fix all tests

commit 4bdd49ebd60beadf72b7aa099cfded09861768af
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed Apr 27 11:49:54 2016 -0700

    checkpoint commit for key selection modal in composer

commit 7d33d832f6587814f8da142e14f9a7f8256114b9
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 17:46:01 2016 -0700

    Remove infinite loop of doom, match keys properly

commit 7a4c1d60c1f1455e70a190710b59970ab2ed3b2a
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 14:31:41 2016 -0700

    Re-add some of Logan's changes lost in the repo migration

commit 6c1e31601e499f69c8df5b9f1a5244480ec67da1
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 13:52:55 2016 -0700

    slightly improve style on the decryption interface

commit 78f115f59ce09f57621776be4287e1e3a9d047b4
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 13:10:27 2016 -0700

    update keybase profile type translation to include proofs

commit 664c61fdd5e03d9ba4afa40d14673ad7733b1e30
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 11:54:35 2016 -0700

    Replace undocumented 'key' objects with explicit 'identity' objects

commit 0824cc0a522e9d9d8045d7a87ef3b7ec8381090e
Author: Dakota Nelson <dakota@nylas.com>
Date:   Fri Apr 22 13:33:18 2016 -0700

    Remove unused code

commit f0fd315cf7daf64f63d933508a6799ae4b5b4f18
Author: Dakota Nelson <dakota@nylas.com>
Date:   Thu Apr 21 17:24:54 2016 -0700

    Further refactor keybase plugin

commit 086e86f289213789f5796b5b1febee709986b89a
Author: Dakota Nelson <dakota@nylas.com>
Date:   Thu Apr 21 15:53:54 2016 -0700

    Refactor, and a useless commit msg

commit 1fcda3875424a3ba4ba54f25644b43690b153324
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Apr 20 16:16:26 2016 -0700

    Fix linter errors (reported via cd build; grunt lint)

commit fcc937e6b50e43932478437ecf6dabb2f96fa15c
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Apr 20 16:08:42 2016 -0700

    Keybase API was 500'ing - move API adapter to standard (err, data) callback format and make it only call the callback once when error is hit (return after erroring)

commit fd0b4220af13cc80b4c88f9e2e63976a54ac50d4
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Apr 20 15:56:27 2016 -0700

    Fix state were user has no pub keys

commit 13886101fcf63e4e497526c2e039cbb791670c06
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed Apr 20 15:25:30 2016 -0700

    add Logan's changes from the other repo

commit 6e9103b4188414ddd6e01db2c4c50c68ad54caca
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed Apr 20 15:22:34 2016 -0700

    minor styling change to improve keybase popover

commit fd0749a7c1c9202b94dc5a47bad26d8960c17099
Author: Dakota Nelson <dakota.w.nelson@gmail.com>
Date:   Wed Apr 20 12:30:40 2016 -0700

    feat(keybase): Initial commit from n1-keybase repo

commit e1275eb9ea548f76c06eb605b77a62d314f3d10f
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 31 15:19:27 2016 -0700

    move styling, update readme

commit 7f64713cc5d8cfdc59eca3c007cf673e5e2b6dea
Author: logandavis <logankeahidavis@gmail.com>
Date:   Wed May 25 16:15:31 2016 -0700

    Add Export Private Key button to preferences

commit 9d4e2552388f94fb7113ab80906519dce4d7350f
Author: logandavis <logankeahidavis@gmail.com>
Date:   Wed May 25 12:40:23 2016 -0700

    Add Export Public Key button to preferences

commit 166585dba9ece8d5dd529418b934947985ace5a3
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 20 15:26:37 2016 -0700

    update readme

commit f875c4146e98152cf4d050fc5af3c322c2d5fdae
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 20 15:23:26 2016 -0700

    Beautify Add Email button, catch naggling bugs

    The old add email button on the preferences page, which
    was not playing nice with the styling of KeybaseSearch, has
    been replaced by the drop-in EmailPopover element. Also, two bugs
    that were causing the console to flip out on normal, unencrypted
    emails were caught and fixed - the Decrypt Button now returns
    false instead of null, and attachments without filenames are
    allowed.

commit 48713d78381fb7320ce265b84c95f8b1497008f7
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 20 14:54:00 2016 -0700

    Debug and style the encryption popover modal

    The encryption popover was ugly as sin and also lacking in
    some functionality - it unnecessarily showed the email list,
    it contained no reference to the Key Management page, it
    didn't display any links to the keybase profile in question...
    now it is a pretty and functional popover.

commit a607f97f8082a14a29ebd5c2d8b397872ef5456a
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 17 18:56:08 2016 -0700

    Unborks Import Key popover, obscures password fields

    The Import Key popover on the preferences page was rendering off
    the screen because it was always pointing at the last button
    created rather than the button clicked. Now that's fixed.

commit 2afd41894aa297dcd6aec0b785cadbb533377f80
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 17 17:17:44 2016 -0700

    Fixes identity filename/address management, dedupes search, encodes +

    Bunch of minor bugfixes here. The identity.path refactor broke
    PGPKeyStore.addAddressToKey and removeAddressFromKey, which this commit
    fixes. + characters were being incorrectly encoded in messages as &#43;
    which was breaking message decryption - that's now fixed in message
    preprocessing. Finally, basic Keybase search result deduplication
    is now in place.

commit 4824556543dce31b14be81ebe471f8febb55e00c
Author: logandavis <logankeahidavis@gmail.com>
Date:   Tue May 17 14:13:17 2016 -0700

    Adds private key management to preferences page; beautifies

    Previously, the KeyManager element on the Preferences page only
    exposed public keys, and there was no way to see, edit, or delete
    private keys. Now you can do all of those things. This commit
    also fixes some render-timing issues in PGPKeyStore._populate
    that were causing nonexistent keys to appear (one on key generation,
    one on deletion of the final key) and improves the styling of
    the Preferences page.

commit 47c05fc485c80b297b6027f9bdabb5f921be77b3
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 13 15:22:40 2016 -0700

    burns the dead code out of preferences-keybase

commit 6fdf34e5c4188994844052d95d927cab1ed182ea
Author: logandavis <logankeahidavis@gmail.com>
Date:   Fri May 13 14:58:51 2016 -0700

    Fix key generation and saving from the preferences page

    An earlier refactor away from key objects and towards identity
    objects borked the old key saving code. This commit refactors
    the key-saving code so that keys can be manually added from
    the preferences page again, and also makes said code much
    clearer.

commit a1b4b4fdb4b35a844ca490d3e9029dbbf4d7bf24
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 11 17:41:24 2016 -0700

    add README of todos

commit 6747a0a447476ca6af829886ec304d57bc5dd0ee
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 11 17:41:12 2016 -0700

    heavy style pass, misc bugfixes, add assets

commit 8544e4b84341f0bc49a1765c057cbf443c220448
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 11 14:03:06 2016 -0700

    Decrypting files first pass, problem with unlocking keys

commit 428dc6739fb29f833c53e957e7a998abf25460ac
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 4 17:52:32 2016 -0700

    Cause message to encrypt on key picker popover close

commit 9d8ef053beca3ef6bbc910de272f1b98033599bf
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed May 4 12:04:08 2016 -0700

    light design pass on the modal (now a popover)

commit b4a0ad2fa2ac33dbf3333e4beb9ac0df04aa107d
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon May 2 15:47:45 2016 -0700

    Key picker modal functional for multiple recipients, still needs lots of cleanup

commit 6bf96d973c7e19de103695f3d6e3346c8db2dab3
Author: Dakota Nelson <dakota@nylas.com>
Date:   Fri Apr 29 14:52:33 2016 -0700

    Key picker modal functional for single recipient

commit f5f0e6aea8c16aefd3cdcbe19664bed708857693
Author: Dakota Nelson <dakota@nylas.com>
Date:   Thu Apr 28 17:31:08 2016 -0700

    modal now allows selection of keybase user

commit 83f7ad54bcab7c24da033d8fe60a602b27b79ded
Author: Dakota Nelson <dakota@nylas.com>
Date:   Thu Apr 28 10:46:47 2016 -0700

    consolidate key cache into one object, fix all tests

commit f8ec4576dee108584e946a7e4c6b9f17885921de
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed Apr 27 11:49:54 2016 -0700

    checkpoint commit for key selection modal in composer

commit c4dd851402162bcaa7e3b8cebf911d6a57fdfdbc
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 17:46:01 2016 -0700

    Remove infinite loop of doom, match keys properly

commit 537d2b423b9c4210c97bda0bf00cbbd1a4ebc80f
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 14:31:41 2016 -0700

    Re-add some of Logan's changes lost in the repo migration

commit 91d86ad6b69edee59de4938c24143e186ad5523a
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 13:52:55 2016 -0700

    slightly improve style on the decryption interface

commit 321ea22c01a6f346325870049a0664155b7ee71f
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 13:10:27 2016 -0700

    update keybase profile type translation to include proofs

commit b8821490432e582a53e7416b49476f90ab59f230
Author: Dakota Nelson <dakota@nylas.com>
Date:   Mon Apr 25 11:54:35 2016 -0700

    Replace undocumented 'key' objects with explicit 'identity' objects

commit 0999127bcd9c3cd75e17a8a4e6d37c5b53bc22ef
Author: Dakota Nelson <dakota@nylas.com>
Date:   Fri Apr 22 13:33:18 2016 -0700

    Remove unused code

commit 3ddfc4e6946b3ed3e051c561cdda7499d326058f
Author: Dakota Nelson <dakota@nylas.com>
Date:   Thu Apr 21 17:24:54 2016 -0700

    Further refactor keybase plugin

commit 1b5a9de2c9b2084a214619ce7c551ed6e9283a96
Author: Dakota Nelson <dakota@nylas.com>
Date:   Thu Apr 21 15:53:54 2016 -0700

    Refactor, and a useless commit msg

commit 999dd82e225b2d8209ee4f7be3cc0ab43c8e53b8
Author: Dakota Nelson <dakota@nylas.com>
Date:   Thu Apr 21 11:43:02 2016 -0700

    Modify participants func to optionally allow from and bcc

commit 9cdf258f5df9fd34ac94bf9822fdd7256af1bb9a
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Apr 20 16:16:26 2016 -0700

    Fix linter errors (reported via cd build; grunt lint)

commit c14fc59b6f236191b759bda6561c5f343401e8ab
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Apr 20 16:08:42 2016 -0700

    Keybase API was 500'ing - move API adapter to standard (err, data) callback format and make it only call the callback once when error is hit (return after erroring)

commit f0225603abb56b14e540f8419cb212760cf0883d
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Apr 20 15:56:27 2016 -0700

    Fix state were user has no pub keys

commit 818881523c698b1bd368344e9ff29ae870f9aae2
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed Apr 20 15:25:30 2016 -0700

    add Logan's changes from the other repo

commit 69f2003ff11be741b97bbb36a7bb4afd29ac7ecc
Author: Dakota Nelson <dakota@nylas.com>
Date:   Wed Apr 20 15:22:34 2016 -0700

    minor styling change to improve keybase popover

commit 4081ad7ef2b4375f5665904eb2d61992bab9cf4d
Author: Dakota Nelson <dakota.w.nelson@gmail.com>
Date:   Wed Apr 20 12:30:40 2016 -0700

    feat(keybase): Initial commit from n1-keybase repo",False
0387f613e9a1c2211daaf440f3ca376891dcb6e2,2016-06-08 01:37:12,Jackie Luo,fix(onboarding): Add notice about cloud sync,False
cd9987e5aaa5937ee2411bac63948cabe3340a0a,2016-06-08 00:09:52,Ben Gotow,"fix(win32): Pad the search container to prevent clipping

#2376",False
de703bd38ebaf7936a90af7649e5433979bf638e,2016-06-07 23:08:18,Juan Tejada,"fix(templates): Support accented characters in template names

- #2392",False
4a5515e4c9051d6f495214bceb27a149930fdff0,2016-06-07 22:59:52,Jackie Luo,"feat(snooze): Add command for keyboard shortcut

Test Plan: Tested locally.

Reviewers: bengotow, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D3008",False
cb331f14de44a8037325edd9926f59d8468631a4,2016-06-07 22:43:41,Juan Tejada,"fix(mail-merge): Prevent subject from stealing focus from table

- Properly clears savedSelection reference inside MailMergeSubject
component",False
94a759d698232b6ecb25d843d4fe76ad5f97afe2,2016-06-07 06:27:39,Ben Gotow,fix(sidebar): Show icons when hovering over entire section,False
213f2a4e1743303557cba812786515953853399d,2016-06-07 05:53:16,Juan Tejada,:art:(empty-state): Add missing empty-state images,False
544d27bca874fafe0a1a727ae33cc776c370dbaa,2016-06-07 05:49:12,Juan Tejada,"fix(tracking): Remove hardcoded references to tracking plugin ids

- Adds a helper in the package manager to get the id of a plugin",False
6d7dec3b0e815f043adcfc1321fd892226648beb,2016-06-07 05:23:50,Jackie Luo,fix(tracking): Enable toggle button by default unless specified,False
82fd8a1c4b039197f78ccc4107651a17167f8de6,2016-06-07 04:43:29,Juan Tejada,"fix(link-tracking): Properly render tracking bubble for exchange msgs

- In Exchange messages (no multisend per recipient), links in the
message body still have the redirect_url (as opposed to the url). When
traversing the body, we were just checking for the url, so the links
would not be found and we wouldn't render the tracking bubble",False
17d9c3d7175392538345e32e54ea871987f85c2d,2016-06-07 03:50:48,Ben Gotow,"fix(tz): Update moment, internally uses Intl.DateTimeFormat()",False
23ee4b5c76fb1b699a36649910ce2bf4e655ff03,2016-06-07 03:47:26,Evan Morikawa,fix(tracking): Ensure that actions have unique keys,False
af63a67cca4f2fe5e929ab1aa8aa8b5155cf3015,2016-06-07 03:38:10,Juan Tejada,"fix(sidebar): Properly update sidebarAcctIds when all accts removed

- Prevents app from crashing when all accounts are removed",False
a7dde102a812379b26a7d8f754c2915356d25e4f,2016-06-07 03:03:51,Ben Gotow,fix(merge): Settings: add 24-hour clock support,False
899193908ed5ea36dbae8e59757c0181484629f1,2016-06-07 03:01:57,Friedrich von Never,Settings: add 24-hour clock support,False
6a7e45c66fb50c0c46325413ed5f1528bb1b66a8,2016-06-07 00:34:03,Jackie Luo,:art:(tracking): Change references to read receipts,False
c61fdfb3177ccd3316b4267913a6d7de3ee7b33f,2016-06-04 05:31:48,Ben Gotow,"fix(css): Fix CSS regression, remove unused assets",False
cf9941fe5a901f201ed3aa47a3e63b6dc99d0ed1,2016-06-04 05:08:59,Ben Gotow,fix(onboarding): Message for 400+ server error codes,False
849613836addf55cab0d444af1218e050e8fe6a6,2016-06-04 05:04:38,Juan Tejada,fix(mail-merge): Update EditorAPI instance correctly for subject field,False
ddad7d9be778a55eaf05c529f25e96418a221eb0,2016-06-04 04:45:28,Juan Tejada,fix(mail-merge): Trim email,False
e147b59ad056346851810f552c85dba07c3d3607,2016-06-04 04:39:25,Ben Gotow,fix(beforeunload): Chrome 51 - return undefined to continue,False
1f27e0006904f577151020a09ccaf88d2cd4c378,2016-06-04 04:39:25,Ben Gotow,fix(onboarding): Only show the welcome page if not already seen,False
95b3939885ed7eb0bcd7b8231b928b98e0f9f1a0,2016-06-04 04:37:29,Juan Tejada,"fix(mail-merge): Fix validation -- trim email strings

- Don't block send button if validation fails",False
0e808003ff33feb7bd5ca83e5fe79b33fe64da02,2016-06-04 03:40:08,Juan Tejada,"fix(sidebar): Correctly update sidebar when focusing perspective

- When focusing a perspective:
  - If sidebar is unified inbox then don't the sidebar layout
  - If sidebar is for a single account, then update to the appropriate
  single account
- Renames some variables",False
5bd338511a47468f3959da925479bad440bccffa,2016-06-04 01:04:47,Juan Tejada,"fix(mail-merge): Fix broken error handling with multi-send to individual

- As a temporary fix, now passes an option to SendDraftTask to not
perform MultiSendToIndividualTask's which screwed up error handling
- Fixes actual bugs with error handling",False
5b69cea5d519d09fc2810e0f326598efc8994e62,2016-06-03 23:21:39,Ben Gotow,bump(electron): 1.2.1 and React Devtools in dev mode 🎉,False
a00d4f2028ce7a7660f7e7e42875e9599c4e5b02,2016-06-03 17:36:45,Evan Morikawa,fix(lint): fix unused variable,False
e0a805449f29124c7521da2f7f2be20e42066df4,2016-06-03 17:19:48,Evan Morikawa,fix(composer): overlaid component fix for new event card,False
c1bbec25cd898efe5e9df94d5ce0521d7018e8a1,2016-06-03 07:26:09,Ben Gotow,"fix(identity): deprecate updaterId, provide safe access to identity.id",False
16361594c02c24b54340df2ac923a9f6d34315af,2016-06-03 07:26:09,Ben Gotow,fix(sync): Always restart where left off after initial sync interrupted,False
f5a9ae718df615cad6256a78a0041e22a59327fd,2016-06-03 05:26:31,Juan Tejada,"fix(build): Update asar unpack patterns to match top level `examples`

- Any dependencies that have an `examples` directory would not get
packed into the asar, causing the windows build to fail because of path
lengths > 250 characters",False
f5a82569a8aba319c94cc666ca6e3981d5c044e6,2016-06-03 04:30:54,Juan Tejada,bump(version): 0.4.42,False
7730f4fcc27f2626f28da5e0f1995ee20327dec7,2016-06-03 04:23:08,Juan Tejada,"fix(build): Do not try to compile dependencies

- Remove unused peg file",False
44df559cfa084208a71d515bca2e6d03fb7f2ba6,2016-06-03 03:58:16,Ben Gotow,fix(multi-send): Increase timeouts of all multi-send API requests,False
5dc07d68cf3154266292ae0b8e9ab1d3005ec86f,2016-06-03 03:15:51,Juan Tejada,"fix(build): Don't lint files inside node_modules, fix lint error",False
57d0497788aee7a4ec494aa940477364bffcdbaf,2016-06-02 20:54:32,Evan Morikawa,fix(analyitcs): make sure to flush events before they close,False
866f34162e27cf616f6a60ed363730c495c972e4,2016-06-02 19:30:02,Evan Morikawa,fix(onboarding): use proper env,False
d58bb4f07e3f246b28d9f3b67cf7f1a3b7e0b393,2016-06-02 19:15:48,Evan Morikawa,fix(onboarding): properly base64 encode string,False
b5a53a49ee22c84ebe15e8d00db905d909fde45f,2016-06-02 15:46:41,Evan Morikawa,fix(analytics): fix errors in onboarding flow,False
7e0c513805ced012696e4b472e42afeb10e7aec5,2016-06-02 13:08:51,Evan Morikawa,"feat(analytics): update analytics libraries

Summary:
See
https://paper.dropbox.com/doc/Analytics-ID-Unification-oVDTkakFsiBBbk9aeuiA3

Test Plan: Manual

Reviewers: juan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2998",False
f5ab2ea3222c7f2ea49a5cfb12e8e43d973a88b3,2016-06-02 06:32:52,Jackie Luo,feat(activity-list): Scope notifications by accounts,False
8197b2a96f2877ae2dcdbe7732b17cf8ab37134f,2016-06-02 05:56:18,Juan Tejada,fix(sidebar): Properly initialize sidebar accounts,False
3270ac48fc139b88c39d6df8f967a8fa22421606,2016-06-02 05:55:08,Ben Gotow,fix(tutorial): Incorrect strings,False
ac089c4d8df49834a745db9058010f60ef93d9f1,2016-06-02 05:43:46,Juan Tejada,"update(sidebar): Moves accounts in sidebar state to FocusedPerspectiveStore

Summary:
- FocusedPerspectiveStore now holds the state of the accounts that are currently being displayed in the sidebar, i.e. unified inbox or not, which makes it globally accessible state. The SidebarStore just reads this state directly off of the FocusedPerspectiveStore to decide which sections and items to display in the sidebar.
- Updates `Actions.focusDefaultMailboxPerspectiveForAccounts` to take an optional array of `sidebarAccountIds` to set in the sidebar. The default behavior is to show the accounts of the perspective that will be focused. E.g. when selecting an account via the account switcher, it will just show the sidebar items for the single account that was selected, but when adding a new account, we are setting the sidebar accounts to all account although we are still focusing the perspective for a single account.
- Will now show unified inbox sidebar with correctly focused account when new account added.
- Cleans up the code a little bit, but this package still needs major refactor

Test Plan: Missing!

Reviewers: jackie, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D3002",False
11d5b265480bd43592c6423f87f83a42dc846a7d,2016-06-02 04:38:10,Jackie Luo,:art:(participant-profile): Use UI variables,False
8860326065bd01fdc6303af0239d1b195b4fa0d9,2016-06-02 04:25:44,Ben Gotow,fix(account-store): Update fake data import for screenshots,False
5055ba59a9698c9242a83d4b7f0a633a9064a0f2,2016-06-02 04:13:24,Jackie Luo,:art:(load): Update loading screen to new style,False
3615c7ea4926e4454cd36c2b002e7cb510545ca4,2016-06-02 03:06:57,Ben Gotow,"fix(undo): Improve messaging around label changes, modernize undo-redo-store

Summary: Just a small patch to address bad messaging

Test Plan: Run one new test!

Reviewers: jackie, juan

Reviewed By: jackie, juan

Differential Revision: https://phab.nylas.com/D3000",False
311e21e615ebdb974f417759c35303c5c7be23fe,2016-06-02 02:24:23,Jackie Luo,:art:(sidebar): Fix button to add folder/label,False
d40f9de330860d67a2944a99ac3d4eb7db670b28,2016-06-02 01:29:12,Jackie Luo,fix(tracking): Add key and refactor code,False
839c60f5b53753da88fdc7e395e5c694b34d0b0c,2016-06-02 01:07:06,Juan Tejada,fix(build): Fix open-tracking specs,False
58e1ed57ee2397d1067738b2d87774987bc4474d,2016-06-02 00:12:21,Jackie Luo,fix(badge): Add option for total count,False
2f7d64b27a9f7be39749baed63fa2793135405b4,2016-06-01 23:41:51,Jackie Luo,fix(emoji): Remove special casing for Outlook emoji,False
10ac3fcb3002979af57f6e4102680dc4942423d1,2016-06-01 23:40:17,Jackie Luo,"feat(tracking): Add message history for open and link tracking

Summary: Message-specific history for opens and clicks will now be
available in popovers while viewing the message.

Test Plan: Tested locally.

Reviewers: bengotow, evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2995",False
1df70e14f1983a20a3382b6a6393520e94e6b2d9,2016-06-01 09:41:01,Ben Gotow,fix(es6): Converstion broke file uploads by adding body: {},False
66020879102463d0e70422e25138a309ae22f88c,2016-06-01 07:40:11,Ben Gotow,fix(specs): Empty parameter list,False
9892473513728ad21a7f098f7b5677bad6b07abf,2016-06-01 05:35:17,Ben Gotow,fix(category-picker): Update specs for sorting,False
04f5d2968f2f263ce455d6feeb3360685be8ed50,2016-06-01 05:31:02,Ben Gotow,fix(category-picker): Sort categories displayed in picker,False
b160f6d181a8a7e0a21bc97ee485a674f7b889d8,2016-06-01 05:12:03,Ben Gotow,fix(mail-rules): Fix re-ordering of mail rules,False
856334c08890de3a4e2d8004494f6c66f944c2ed,2016-06-01 05:01:24,Ben Gotow,"fix(tasks): Call super.isDependent, wrap model lookup in transaction

Summary:
ChangeFolder/ChangeLabel still need to call super.isDependentOnTask!

Formalize ""retrieve latest models"" part of the performLocal process, ensure that it's always /inside/ the transaction that is going to write the changes. This ensures that queueing two tasks for the same thread at the same time don't cause a race...

...condition between the two tasks (end result is currently arbitrary!)

Add ""move to label"" mail rule to go alongside ""Add Label""

Test Plan: All broken... willfix.

Reviewers: juan, evan, jackie

Reviewed By: evan, jackie

Differential Revision: https://phab.nylas.com/D2999",False
9c04be3e20683f7eed1c0384f08302379580f9c6,2016-06-01 03:05:49,Jackie Luo,fix(themes): Add Less is More to list ordering,False
eb3b26deb7804a68e42937df4edfa8350cb572c2,2016-06-01 02:34:22,Ben Gotow,fix(auth): Wait 150s for Exchange autodiscovery to complete,False
94b59f2562dc2f5e39cc0a939f62af62fb900e7e,2016-06-01 00:54:38,Ben Gotow,"fix(unified-inbox): If a Gmail account is present, show Important",False
2dac16f9ca189efbab625d58e82d49248820495c,2016-06-01 00:54:38,Ben Gotow,fix(pro): Upgrade buttons go to /payment,False
cabc052c1879b6823dc5ab3c42f2c094f7bf80a3,2016-06-01 00:54:38,Ben Gotow,"fix(config): When resetting config, use template file",False
3b42b2d03bbcfd820091cde63f424777cb2c5d2e,2016-06-01 00:38:18,Ollie Ford,"warns suspicious message only on differing domain (#2343)

For example, the following is *not* suspicious:
```
From: foo@example.org
Reply-To: bar@example.org
```

While the following remains suspicious:
```
From: foo@example.org
Reply-To: foo@example.com
``` 

This commit fixes #2342.",False
0cf8ccc0c2820eb284ffb665f8349fd532844fa4,2016-06-01 00:12:20,Juan Tejada,fix(mail-merge): Add missing method in mail-merge decorator,False
147bb38c6a746e604a269685881a7e56cf81e60e,2016-05-28 04:07:49,Ben Gotow,fix(pro): Don't refresh identity unless one is present,False
cf0ad099e15e5749b44760d2e7b4377eb0c890cd,2016-05-28 03:48:12,Jackie Luo,fix(email-frame): Allow events to bubble correctly and pass iframe,False
4a738602ab21f6593e5bfdcb098634657369c0ca,2016-05-28 02:51:19,Ben Gotow,"feat(pro): New Nylas identity provider, onboarding and auth

commit 50d0cfb87cd0e3d518ee91984bfac7d0c6782418
Author: Ben Gotow <bengotow@gmail.com>
Date:   Fri May 27 14:01:49 2016 -0700

    IdentityStore conveniene methods for subscription state

commit 80c3c7b9564ff79b5727f6812620b9436f35f963
Author: Ben Gotow <bengotow@gmail.com>
Date:   Fri May 27 12:03:53 2016 -0700

    Periodically refresh identity, show expired notice in top bar

commit 5dc39efe9829b2e2c14e27486b3163df4157fd17
Merge: 4c4f463 906ea74
Author: Juan Tejada <juans.tejada@gmail.com>
Date:   Thu May 26 15:17:46 2016 -0700

    Merge branch 'bengotow/n1-pro' of github.com:nylas/N1 into bengotow/n1-pro

commit 4c4f463f4b20725bc07e5c8906ecba1de54a6bd1
Author: Juan Tejada <juans.tejada@gmail.com>
Date:   Thu May 26 15:16:48 2016 -0700

    Hijack links inside email that go to billing site and add SSO to them

commit 906ea74807590e6324839b327ada1943814b17fd
Author: Ben Gotow <bengotow@gmail.com>
Date:   Thu May 26 12:02:29 2016 -0700

    Add custom welcome page for upgrading users

commit 2ba9aedfe97679d845262a46b70e93d8e787cec1
Author: Juan Tejada <juans.tejada@gmail.com>
Date:   Wed May 25 17:27:12 2016 -0700

    Add styling to Subscription tab in prefs

commit 384433a338a6fb90c432d2819afc3eee127dbace
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed May 25 16:21:18 2016 -0700

    Add better style reset, more IdentityStore changes

commit c4f9dfb4e4007ff7e785d6d5d459a58078913e7a
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed May 25 15:29:41 2016 -0700

    Add subscription tab

commit bd4c25405a0edc30a3770ac09ee410f75006d73a
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed May 25 14:18:40 2016 -0700

    Point to billing-staging for now

commit 578e808bfccba22854b880c3dc51e01ac164302b
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed May 25 13:30:13 2016 -0700

    Rename account helpers > onboarding helpers

commit dfea0a98615ebdbe94a77f8a752f543bafa8411d
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed May 25 13:26:46 2016 -0700

    A few minor fixes

commit 7110217fd4b477557a05f2b2cde8fbbd50ced9b3
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed May 25 12:58:21 2016 -0700

    feat(onboarding): Nylas Pro onboarding overhaul

    Summary:
    Rip out all invite-related code

    Enable Templates and Translate by default

    Scrub packages page, unused code in onboarding pkg

    Remove resizing

    New onboarding screens

    IMAP provider list, validation

    Call success with response object as well

    Renaming and tweaks

    Test Plan: No tests yet

    Reviewers: evan, juan, jackie

    Differential Revision: https://phab.nylas.com/D2985

commit dc9ea45ca9c7e517732551ab61ac0ab6012263e5
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed May 25 12:52:39 2016 -0700

    Renaming and tweaks

commit 5ca4cd31ce498f77f21e52c3b1996d7973fff803
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed May 25 11:03:57 2016 -0700

    Call success with response object as well

commit 45f14f9b00415f3575b26b0bde3b829f54a19108
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue May 24 18:26:38 2016 -0700

    IMAP provider list, validation

commit c6ca124e6e94261fc91fe04e284658e0968fc586
Author: Ben Gotow <bengotow@gmail.com>
Date:   Sat May 21 11:14:44 2016 -0700

    New onboarding screens

commit dad918d92696e29787c404019e07550b107ec29b
Author: Ben Gotow <bengotow@gmail.com>
Date:   Thu May 19 16:37:31 2016 -0700

    Remove resizing

commit ecb1a569e29ea81085b2e2740dd273c17bc6cc1c
Author: Ben Gotow <bengotow@gmail.com>
Date:   Thu May 19 16:36:04 2016 -0700

    Scrub packages page, unused code in onboarding pkg

commit 3e0a44156cec5dab734cb0d4d10fc0281186f590
Author: Ben Gotow <bengotow@gmail.com>
Date:   Thu May 19 16:33:12 2016 -0700

    Enable Templates and Translate by default

commit 0d218bc86fe987901efd8e8b36afdb4d8be2b29e
Author: Ben Gotow <bengotow@gmail.com>
Date:   Thu May 19 16:30:47 2016 -0700

    Rip out all invite-related code",False
3398640e862efc51eaf9a035ba82602e716c3e34,2016-05-27 23:32:44,Juan Tejada,"fix(mail-merge): Switch to using new overlaid components api

Summary:
- Fixes several selection and focus issues along the way
- Can now preview what tokens will look like when not editing
- Adds decorator to listen to mail merge session changes and removes a bunch of duplicated code
- Gets rid of all imperative code (and specs) that had to imperatively
reach into the dom to update the tokens

Test Plan: - Unit tests

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2989",False
6ba667daa228d9c9234c2e37bbcd1683c3eac63b,2016-05-27 00:57:25,Jackie Luo,fix(draft): Return transformed draft correctly,False
e3b112030ac81e47133e960d6a365b0394e87135,2016-05-26 12:16:36,Jackie Luo,"Revert "":art:(ui-dark): Remove iframe inversion""",False
3d5b21e4b25d8482353e55f53c4ad606391c7994,2016-05-26 02:43:42,Ben Gotow,fix(packages): Show version numbr of 3rd party plugins,False
7bdcde7f3ae00745efadf1347699cf76c14b2712,2016-05-26 02:33:09,Ben Gotow,"fix(ubuntu): Update theme, fix a few strange glitches",False
3fdffb4b8178a4248a6f09b340a49044baf18d1a,2016-05-26 02:33:09,Ben Gotow,"fix(config): removeAtKeyPath => undo, guard with assertions",False
48556bef984aa42515211c56ab80012784b0e5e0,2016-05-25 22:55:36,Juan Tejada,"fix(build): Fix remaining specs (composer-view, send-draft-task)",False
78d27bc62a38d3ae85ba9af2c5a95d36f2f90337,2016-05-25 07:34:20,Juan Tejada,fix(specs): Fix merge conflicts and some specs,False
771ba62baac59a4dbcf2f79d017ee9f028bd1f68,2016-05-25 06:26:15,Juan Tejada,fix(nylas-exports): Remove nonexistent module,False
f3be415a7fb82f2d16f4200e763d325a6b832e70,2016-05-25 06:23:15,Juan Tejada,fix(build): Fix lint error,False
0ec108c9063833e80f63020cbe496374e9426ae4,2016-05-25 05:52:09,Juan Tejada,"fix(mail-merge): Refactor mass sending procedure

Summary:
This diff introduces several updates to mail merge to improve the procedure for sending a list of drafts.
Specifically, sending mass email will now:

- Clear mail merge metadata on the drafts that will actually be sent
- Upload attached files only /once/, and reuse those files on the drafts that will actually be sent
- Minimize database writes for new drafts being created
- Will queue a SendManyDraftsTask that will subsequently queue the necessary SendDraftTasks and keep track of them, and notify of any failed tasks

TODO:
- Add state to MailMerge plugin for failed sends and ability to attempt to re send them

Test Plan: - TODO

Reviewers: evan, bengotow, jackie

Reviewed By: bengotow, jackie

Subscribers: jackie

Differential Revision: https://phab.nylas.com/D2973",False
8799215048919d4c18df6d4301873a1c42a39045,2016-05-25 04:17:49,Evan Morikawa,"feat(scheduler): Add Overlaid Components

Summary:
SEE ASSOCIATED SUBMODULE DIFF

This enables rich React components (like the Scheduler's `NewEventCard`)
to be used in contenteditables.

We introduce the concept of an ""Overlaid Component"". These are rendered
React components that are absolutely positioned on top of an equivalent
""Anchor"" in a contenteditable.

Inside the contenteditable are special `<img />` tags that have an
id corresponding to a particular rich overlaid component. This way, even
if those img tags are cut and pasted or moved, they'll have a mapping to a
  particular component stored in the `OverlaidComponentStore`. Img tags
  are fairly well handled natively by contenteditable and allow you to
  maniuplate these overlaid components as normal text elements.

The `OverlaidComponentStore` is responsible for listening to and managing
the state of the Anchors and their equivalent OverlaidComponents.

We use a decorator called `ListenToChanges` that allows us to wrap
components to update their corresponding anchor. Since we need to know
about ALL changes that could affect rendered height and width, we need to
use a `MuatationListener` instead of the React render cycle.

This is only the initial diff. There are several TODOs here:
https://paper.dropbox.com/doc/Composer-Overlaid-Components-FoZrF0cFggzSUZirZ9MNo

Test Plan: TODO. Manual

Reviewers: juan, bengotow

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2946",False
bf955891d94ba13d241e224539971d57b4905af2,2016-05-25 00:18:33,Ben Gotow,"fix(undo): Move undo/redo to session, properly undo all changes

Summary:
- Simplify undoManager to just maintain the undo/redo history items
- DraftEditingSession manages snapshotting state of draft, hack allows it to also save selection (still hoping to eventually put selection in body HTML as markers)
- Switch from `debounce` to `throttle` style behavior so typing for along time followed by undo doesn't undo away your entire block.

This resolves two issues:
+ Changes to participant fields are no longer undoable because they go straight to the session.
+ Changes to metadata weren't undoable.

Test Plan: Tests WIP

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2956",False
eabdd78935d6f5e3f9f771ca360ee8c98a3e1bb1,2016-05-24 23:54:57,Jackie Luo,"feat(multi-send): Allow multi-send for non-Exchange accounts

Summary:
Updates the send task to use multi-send for emails with link/open tracking metadata sent via SMTP. Places an email without link/open tracking in the sent folder.

TODO: Override send button (i.e., mail merge) and move all of the multi-send tasks to package.

Test Plan: Tested locally.

Reviewers: evan, bengotow, juan

Reviewed By: bengotow, juan

Differential Revision: https://phab.nylas.com/D2974",False
9ed577cf64acf1fe0e371101e3dfe709acfc5f8e,2016-05-24 23:38:40,MAA,Fixing small typo. (#2298),False
9dc44e0630369f0d3bc4df11486bca39ab54da62,2016-05-23 23:04:44,Ben Gotow,fix(dialogs): Use new buttonLabel as needed,False
fb1f6c0d79ad96f591b5a9cdaac33455ff338c70,2016-05-23 23:04:44,Ben Gotow,"bump(version): 0.4.41, Electron 1.1.1",False
40077439d2735ad0b34f3c4a1e21bc63e0f29b9d,2016-05-20 23:30:05,Jackie Luo,"feat(multi-send): Register opens/clicks by individual recipient

Summary: The activity list now shows specifically which recipient
opened/clicked for an event.

Test Plan: Tested locally.

Reviewers: bengotow, evan, juan

Reviewed By: juan

Subscribers: juan

Differential Revision: https://phab.nylas.com/D2971",False
87ea432295b4a009fa0c17825cbd8a227dbfd525,2016-05-20 04:46:00,Hon Nguyen,"fixed bug timezone cannot detect in fedora (#2250)

* fixed bug timezone cannot detect in fedora

* update spec build fedora package

* rpm package for fedora 22

* change code follow coffee-script style

* remove fedora binary file",False
c5e7a4384b884626e95b7b4a6667a5b10a5689ce,2016-05-20 04:43:35,Juan Tejada,fix(mail-merge): Prevent send button from being pressed multiple times,False
7a305a1dd4b7ba221134acda6078870d1e38edea,2016-05-20 03:57:43,Ben Gotow,fix(send-later): Add isValidDraft to specs,False
a72e25171ff8b7870a3864437adf695cea59856f,2016-05-20 03:28:12,Ben Gotow,"fix(pli): Always indent where indicators are, even if blank",False
d2d9b698636d01b97031f138b978bc04ed4ddf9e,2016-05-20 03:27:34,Juan Tejada,fix(window-launcher): Check if instance of hot window is present,False
9b1d22377406b9d3c7a6d871f59d9c225fad9d64,2016-05-20 03:23:42,Ben Gotow,fix(changelog): Additional releas notes,False
f3ff3af9f604156889ddf525453007e1c295cd24,2016-05-20 03:08:54,Ben Gotow,fix(config): Using fs.resolve as path.join,False
2fedf886e664a9ec57d82e148e463bea76840cda,2016-05-20 01:58:28,Juan Tejada,fix(send-later): Check if draft is valid before scheduling send later,False
67ec8fb0e0a07c32f4bdd11aee0348e031259dad,2016-05-20 01:17:21,Juan Tejada,fix(send-later): Update button to show Sending now when time is past,False
e420a7af1f53aa9d261c421c02953e9f698dfcdf,2016-05-20 01:03:31,Juan Tejada,fix(specs): Fix specs for TaskQueue,False
347fcad80ae9d2af0b3162a09fbb9cff1ec34eba,2016-05-20 01:00:13,Evan Morikawa,fix(spec): fix asynchronicity in NewEventCardSpec due to draft session,False
52f3607606193399986fa3a25050c712b920b4b4,2016-05-20 00:58:29,Ben Gotow,fix(win-launching): Only create hot window when one is used,False
ceb4993c62db77da8c81be4bbcfef631bc8cae26,2016-05-20 00:42:22,Juan Tejada,"fix(accts): Display perspective for a newly added acct correctly

- Will wait for categories to be ready before attempting to focus the
inbox for the new account, preventing a blank screen when a new account
is added
- Add temprary action to set the collapsed state of a sidebar action
after adding a new account",False
99a8b4fb046c18452e6ed12dd159d7091d12455a,2016-05-20 00:29:02,Evan Morikawa,fix(spec): remove obsolete account store spec,False
b0e66519fc3213aca36d49d38007ebfe0bb0790a,2016-05-20 00:20:19,Evan Morikawa,fix(spec): fix config setting spy,False
c6f6c7c3a0c835572945cde77d65733d881a9ffa,2016-05-20 00:05:48,Ben Gotow,"fix(tasks): Check Task is in registry, remove any non-tasks when loading",False
c8097f1cd9b79d9bed79a588a7b2ce224e2e44e6,2016-05-20 00:01:21,Evan Morikawa,"fix(tasks): ensure NotifyPluginsOfTask gets properly serialized

Fixes:
https://sentry.nylas.com/sentry/edgehill/group/31200/",False
7c1cc9bd5f3b893991a910413e3b0da34d067299,2016-05-20 00:00:31,Juan Tejada,"fix(sidebar): Add state to determine wether to show unified sidebar

- Adds a piece of global state that will be persisted to
`NylasEnv.savedState` indicating wether the accounts for the sidebar
should be reset whenever the FocusedPerspective changes
- #2257",False
b575ea001808cf61c54316cd30dc4297e356fecd,2016-05-19 23:45:56,Ben Gotow,bump(version): 0.4.40 and changelog,False
7fc3b3a7c5c414895d97ad6b788732d1751d62c9,2016-05-19 22:45:32,Juan Tejada,"fix(hot-window): Correctly manage references to the hot window

- Fixes issue where app was not properly relaunching when all accounts were
removed",False
3dd57e9271621d18d18709d973fc43e7baa0c51d,2016-05-19 06:27:57,Ben Gotow,"fix(accounts): When removing, focus remaining accts before `accountForId()` stops working",False
18f0872794e057e8ba8f1846082c37aed9e4ef15,2016-05-19 06:05:07,Juan Tejada,fix(aliases): Properly set selected state on account update,False
cf6428d94a8067f7cdcd3295fbe34a0d1b8bb900,2016-05-19 05:57:46,Ben Gotow,"fix(config): id was only added recently, use getId()",False
abaa3fe63fcafe33c040a57506c3d659eaa049d0,2016-05-19 05:42:57,Ben Gotow,fix(config): Don't loop config changes through ipc,False
8ad72a43f9e3a62fd5d41b89c435b4114e042b3d,2016-05-19 05:28:06,Evan Morikawa,refator(undo): convert UndoRedoStore from coffee to es6,False
18c8a4a10f5f45fb7d7ac4f8a4c767e551d36978,2016-05-19 05:13:48,Evan Morikawa,fix(undo): can redo more than one undo item,False
b43aaf58f7237eaeadfd588783f37ca115eb49c1,2016-05-19 04:55:06,Ben Gotow,fix(win32): Wait longer before quitting if no windows are open,False
d2d79c6e2de72dad7054451e8eda35907d0f85f4,2016-05-19 04:55:06,Ben Gotow,fix(win32): Ignore path in argv when --squirrel flag is present,False
cf5faadd27c6e1c163027d653d27a56edfebc724,2016-05-19 04:32:57,Jackie Luo,fix(plugins): Update plugins list on install,False
035074d1837c58018fb61f7b79050cbdfb6951be,2016-05-19 04:14:47,Evan Morikawa,fix(db): can manually call _handleSetupError with no args,False
8d88641005a7ee124aad300bb5174f5cc8496fb9,2016-05-19 04:11:24,Ben Gotow,fix(quit): Booleans on globals are not exposed through remote properly,False
69c9d440005b9f5b7d30ef21a3595dbb33be0c01,2016-05-19 04:07:26,Evan Morikawa,fix(scheduler): don't event events 1 second early,False
58572871db39ea7dffeaf81064a65439a7703cab,2016-05-19 04:00:16,Jackie Luo,:art:(templates): Change language and remove gray box in demo template,False
5f7d3ac2e94450f3719a8c3b53f0dc9a6baa6a8b,2016-05-19 03:55:18,Ben Gotow,"fix(pkg-install): Use the package.json name, not the folder name",False
e93a5d7b7f90ddb34a043ec750e44c84ab058f48,2016-05-19 02:51:22,Evan Morikawa,fix(event): add calendar icon to new event card,False
61bd8d662952aa70f5a3c36cd07714ae5fdcff70,2016-05-18 22:40:31,Ben Gotow,bump(version): 0.4.39,False
6cd6253771527a30f79129ecfb6455259c409e0f,2016-05-18 07:58:18,Ben Gotow,"fix(build): prebuild less was using wrong options, cache not used at runtime",False
06360dc75d2b0f50515df0526528628340cb9e65,2016-05-18 07:58:01,Ben Gotow,fix(compile-cache): Write atomically to prevent process collisions,False
15ef74e0e2063dce732a7e983d3676a069fbcc6b,2016-05-18 07:18:01,Ben Gotow,"perf(spellcheck): Limit misspellings to 15, recycle nodes",False
045177b38d5306dcaefde09faf5eb8f110487679,2016-05-18 07:07:20,Ben Gotow,fix(nylas-exports): Avoid repeatedly calling require inside lazyLoad,False
8a5a0ad20917caddd81307bbb9239728ea080ed4,2016-05-18 03:33:49,Evan Morikawa,fix(composer): reduction in composer bootup time,False
b7e32b9c685b5fc047b3bfd51f00288d545bcb3c,2016-05-18 02:53:14,Evan Morikawa,"feat(perf): add perf monitoring to composer open time

Summary:
Add basic globally accessible performance monitoring.

Allows us to measure load times for composer windows (or whatever else we
want) and view the data as a Histogram on Mixpanel

Test Plan: manual

Reviewers: bengotow, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2965",False
9206370fa312f6883e94ee560b6008df16357091,2016-05-18 01:07:46,Evan Morikawa,feat(composer): speed up composer loading & fix deactivate error,False
80638713a183475b51c38ce720bb2eae6ee0d4ce,2016-05-18 01:04:35,Ben Gotow,fix(db): additionalSQLiteConfig is not a function!,False
94016c676f04b0e93b963bbbcdccc7c6664dc8b6,2016-05-17 22:05:48,Evan Morikawa,fix(bootstrap): properly dedupe all node modules,False
3bfc452f5e224a731b10896fb6cccacf11b66cb0,2016-05-17 08:23:26,Juan Tejada,fix(build): Fix lint errors,False
eeb0e8fc5bc83c6d71f142867181674de5012e10,2016-05-17 06:23:42,Juan Tejada,fix(snooze): Fix path to main file in package.json,False
aff550574366eefe99f1d308bd03d644a0c6c547,2016-05-17 04:51:27,Juan Tejada,"fix(snooze): Sentry error: ""Can't create Snooze Category""

- This error was still being thrown for a large number of accounts,
despite the fact that the N1-Snoozed category was being created
- This error was happening when adding a new account which did not already have a
snooze category in the backend:
  - When the account is added the AccountStore triggers more than once,
  causing the SnoozeStore to send more than one request to create the
  same category. Any request after the first one will fail because the
  category already exists
- The fix is not try to create a category unless the accounts have
actually changed",False
705b7ef3308e43cdacd12a8aefa8c0776a106c1e,2016-05-17 03:19:15,Ben Gotow,fix(new-event-helper): Add required windowKey,False
3559f5e41953d53732a65323c771f71d11eca0e6,2016-05-17 03:08:46,Ben Gotow,"fix(config): Move all reads / writes to the main process

Summary:
Moves all reading / writing of config file to the main process,
to avoid needing to write code to lock across processes. This should also
be more efficient than re-loading the file in all processes when it's
saved.

Test Plan: Run tests

Reviewers: evan, jackie

Reviewed By: evan, jackie

Differential Revision: https://phab.nylas.com/D2963",False
eb4aa0e2086d264265b70ae08d55c977d4bd8033,2016-05-17 02:14:41,Ben Gotow,"fix(retry): When tasks fail, try fewer times: 2s, 4s, 8s, 16s, 30s",False
bcf82067ed8f463cf868d56f6a1c12b99bee6ca1,2016-05-17 02:01:44,Evan Morikawa,fix(reporting): fix undefined reference in error reporting,False
61caf7b3636328dc316675b162d9ddbda69407b1,2016-05-17 01:56:33,Evan Morikawa,fix(spec): update NylasEnv specs,False
7d701777209d7e4676d231c2346ffe4216bb0c98,2016-05-17 00:13:48,Evan Morikawa,fix(spec): Convert NylasEnvSpec from coffee to es6,False
5afa549b7003bcc41e5953023fecc715d204bd9c,2016-05-17 00:03:03,Evan Morikawa,fix(error): send all renderer errors to the browser process,False
4d92c88ebe3ad3bd42d3d5736ee4a4e4dc86ed15,2016-05-16 13:56:23,Ben Gotow,fix(connection): account.id => accountId,False
29fc4c80d87af13198915bd2eb577b3521c09980,2016-05-16 12:29:30,Ben Gotow,fix(account): JSON without `label` should not reset label,False
40fc95d878915fe8d27b06ff140fab731191ca3c,2016-05-16 11:55:30,Ben Gotow,"Revert ""refactor(deltas): Update sync-worker to use NylasAPI.longConnection""

This reverts commit 0e10ccbde9df8924efb3354a0aa0a4ad7867ee6e.

# Conflicts:
#	internal_packages/worker-sync/lib/delta-streaming-connection.es6
#	internal_packages/worker-sync/lib/nylas-sync-worker.coffee
#	internal_packages/worker-sync/spec/nylas-sync-worker-spec.coffee
#	src/flux/nylas-long-connection.es6",False
6bbf2c9865132ffc09ca1e6b481af3c6668fa66e,2016-05-16 09:53:31,Evan Morikawa,bump(version): 0.4.38 stable patch release,False
b1c470f03fc2fe09b63f2afc6b564317aad61852,2016-05-16 09:49:36,Evan Morikawa,fix(connection): don't destroy emitter on close,False
dafe2d89bad0f813b52296127b6bc7d407dcf7fb,2016-05-16 04:22:49,Ben Gotow,"fix(babel): Resolve require paths for presets, fix plugin ES6 support",False
3344223bfc78f66dfaf2527b0edad1bce2387bf1,2016-05-15 22:49:03,Ben Gotow,"fix(keymaps): Handle empty keymap.json, recover when saving",False
7de7c53ee2b13542e27a55691e5c38001451e718,2016-05-15 21:44:16,Ben Gotow,"fix(auth): Revert imap => custom, bump package.json 0.4.37",False
5e1c9bf28a6fdb3bdd880ef62b8240866475e43b,2016-05-15 11:01:29,Ben Gotow,fix(linux): Additional menu fixes,False
56257134192498af69ff6f2a99f7c35d4012f5d5,2016-05-15 10:54:27,Ben Gotow,fix(linux): Make F11 show up in menu as shortcut,False
d2281c75d0a342c8697962013ce14de33746c822,2016-05-15 10:35:25,Ben Gotow,"fix(linux): Add libappindicator1 note, improved View menu",False
46c563f7b082676c182b7d0a403c3c37832e1138,2016-05-15 09:43:08,Ben Gotow,fix(babel): linux-updater-adapter missing `.default`,False
4a7cf1b85428bb22c423abb3ef988b0253d6b20d,2016-05-15 09:14:12,Ben Gotow,fix(deprecations): Broken references to `app`,False
421936b1c656d8d1d054ab9b1ef5c63a449f277d,2016-05-15 03:38:43,Ben Gotow,fix(empty-state): Don't show empty state briefly when loading threads,False
a38d65cb2a5b4f2e76a348ab1b36e2326890b8db,2016-05-14 11:33:33,Jackie Luo,:art:(ui-dark): Remove iframe inversion,False
ffef8e3cda49e482b39d08e7354aa87f46443ca2,2016-05-14 06:35:24,Ben Gotow,fix(imports): Don't use relative paths with ASAR,False
fd84d15fbb268124fc2ad374f336a6f4c80c3e4b,2016-05-14 05:44:04,Ben Gotow,"fix(templates): QA pass on templates, resolve #2216",False
71b156e667881465a78533ccf30b8ad3ac011196,2016-05-14 04:55:23,Ben Gotow,fix(err): InspectorFrontendAPI => DevToolsAPI,False
87f81c1c395bc10831d5d9cb8877f556bad470c8,2016-05-14 04:31:12,Juan Tejada,fix(mail-merge): Pass session to injected subject,False
67b6dfc5b026ff95fbbe2cd2785002dc0e47d4ea,2016-05-14 04:27:03,Ben Gotow,bump(version): 0.4.36 and changelog,False
804542ae53919bfe5d9f464ac70e28f1064fa3a0,2016-05-14 03:27:37,Ben Gotow,"build(travis): Drop Node 0.12 build, unclear if supported by babel 6",False
8f29e1cfbeebfc51a3021cd6bd3f1befcdd9d685,2016-05-14 02:46:54,Ben Gotow,"fix(401/403): Unify error bars, query /account, improve reconnect flow

Summary: See https://paper.dropbox.com/doc/Sync-disabling-for-N1-URZmjVpSSxWFvjC62TiFI

Test Plan: Tests incoming

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2959",False
b750b3a31334ba0c71d0c0d10b89a7d382689de1,2016-05-13 04:44:30,Ben Gotow,fix(category-picker): Don't wrap folder names early,False
0441acf94aa5c46118759a72fbfe21e33f41d043,2016-05-13 04:44:30,Ben Gotow,"fix(fastmail): Strip ""INBOX."" prefix from displayNames

This can't be done on the API side because the API serves other customers.

The API will properly handle renames, crates and prepend `INBOX.`",False
2bcd5032a8eabc38a659863d5624db0d4ec7e2a7,2016-05-13 03:53:06,Juan Tejada,fix(specs): Remove fdescribe,False
150ac1e887eb77c2a89e46feeb6de65e3eb2bcb9,2016-05-13 03:51:28,Juan Tejada,fix(specs): Fix spec for DraftEditingSession,False
f60a274f1f321e0f50eb9fdd094574cc68886f1a,2016-05-13 02:58:11,Juan Tejada,fix(build): Fix linter errors,False
bec5982ea3512b8443e16f8fe635832abe8c5958,2016-05-13 02:29:23,Ben Gotow,"bump(electron): Fix remaining deprecated requires, move to 1.0.1",False
26787b77d334c2fabed27b038a2895528996bce8,2016-05-13 01:59:41,Jackie Luo,refactor(focus): Move code for focusing threads to FocusedContentStore,False
a4a41cf6a26a787ad42c5b9e7c4d3a8f3783fc68,2016-05-13 00:29:30,Ben Gotow,bump(version): 0.4.35,False
cac679b119b92e6fa947a699fb43033dfabfecf0,2016-05-12 23:17:41,Juan Tejada,"feat(mail-merge): Add ability to drop tokens in subject

Summary:
Adds ability to drop tokens in subject via a custom rendered subject field which
renders a contenteditable instead of an input.
Decided to completely replace the subject field via injected components for a
few resons:
  - That's the way we are currently extending the functionality of the participant fields, so it keeps the plugin code consistent (at the cost of potentially more code)
  - Completely replacing the subject for a contenteditable means we hace to do extra work to clean up the html before sending.
  - Reusing our Contenteditable.cjsx class for the subject is overkill, but using a vanilla contenteditable meant duplicating a bunch of the code in that class if we want to add

Test Plan: Unit tests

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2949",False
c762cef4e607fdc7b39952e66d1fe1cb2d29c43d,2016-05-12 13:35:26,Jackie Luo,:art:(dark): Update theme colors,False
0a0cc11b5c4d6bc1e78d29a603ba2239fb7d7826,2016-05-12 05:39:23,Ben Gotow,fix(draft-session): Never show body with transforms applied,False
55b4ccbc1f961178573401dc2cab8ba9cec98aa9,2016-05-12 05:39:23,Ben Gotow,fix(pli): Design PLI indicators #2148,False
3ef9da941fb6a7d347e3f8d737267915f465ef0c,2016-05-12 05:08:30,Juan Tejada,fix(build): Fix linter errors,False
eacf54b4eb458fcac49c4c6559027f61de5b8fd8,2016-05-12 04:03:52,Juan Tejada,fix(build): Fix lint issues and specs,False
72e86dde368b0aff58d85c6daa07efeb3cb140a3,2016-05-12 03:06:59,Juan Tejada,"specs(table): Add specs for table components

Summary:
- Add some docs to Table components
- Updates Table components to use a TableDataSource instead of accessing arrays, cleans up code a bit
- Add enzyme lib to have a cleaner and simpler api to write tests for React Components
- Updates decorators to extend from the BaseComponent instead of vanilla Component, this way instance methods are still available on composed components

Test Plan: - Unit tests

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2941",False
54e588313e694f76582db657764ddc6c9f34ca32,2016-05-12 01:02:54,Juan Tejada,"fix(search): Add double quote escaping to search query

- Fixes sentry fts error",False
691edfcd5b7581844417669d3af92e84ea7099bf,2016-05-12 00:53:58,Juan Tejada,"fix(query-subs): Fix `onLastCallbackRemoved` overriding with correct class syntax

- Using arrow function syntax for a class method that is meant to be overriden
will prevent it from being properly overriden
- This caused onLastCallbackRemoved not to be called",False
cf0bde9b142bc15c2dbde22231e26ba20bc92e0e,2016-05-12 00:03:12,Juan Tejada,fixt(print): Update print header logo,False
e7436a37e1c3edc1acb198d506562c6331022611,2016-05-11 23:55:04,Juan Tejada,fix(build): Bump minor react version (fix peer dep resolution),False
904b1ba1f18eabf308f989a64172b9a1670e93ca,2016-05-11 23:27:57,Juan Tejada,fix(extensions): Add name of extension incorrectly applying transforms,False
f334899aff7a35ade821b7b5b9e408f53152b8d7,2016-05-11 23:04:29,Juan Tejada,fix(delta-streaming): Fix stale cursor key in config file,False
de4a69b89a5aef6f1875f9f5b31339ed02910c8f,2016-05-11 07:38:41,Ben Gotow,fix(build): Defer `require` of parent node modules until they're fetched #2184,False
1b0e933977d9370dac5b0c178faf2a3c2b4027b6,2016-05-10 23:23:59,Ben Gotow,fix(accounts): Any account update triggered focus #2165,False
eab8cb9085a51caae0daf075d25829694d211030,2016-05-10 23:03:46,Ben Gotow,"fix(draft-factory): ReplyTo takes precedence over ""from me"" #2175",False
5bf245b3241da4c309604ebdb36703844f50090c,2016-05-10 12:13:36,Juan Tejada,"Revert ""fix(print): Update logo""

This reverts commit a017ae7127aa40c4a7af9da525d1e7b64e3d70da.",False
a017ae7127aa40c4a7af9da525d1e7b64e3d70da,2016-05-10 08:43:32,Juan Tejada,fix(print): Update logo,False
82852350de7725c267b2e943bb367bb8e39ef0e4,2016-05-10 06:04:59,Ben Gotow,"fix(shortcuts): Add Cmd+[, Cmd+] to Apple Mail preset #1332",False
b92d2105b4780be3630c626cffe2df5bed58ce00,2016-05-10 05:58:52,Ben Gotow,fix(spam): Better icons for spam / not spam #2107,False
1347654bbf2d1ac8cbbc8225f9bc7cf226481971,2016-05-10 05:58:52,Ben Gotow,"fix(menus): Always show main win in menu, move Activity #1314",False
7b7073e356dd9208d88eee5a9c096f8ea4eeeaf9,2016-05-10 05:58:52,Ben Gotow,"fix(prefs): ? shortcut for ""Show Keybindings"" #1144",False
f77fc700d14d2f5b00e1e2a27a78038e6493db61,2016-05-10 05:58:52,Ben Gotow,fix(drafts): Support additional deletion shortcuts #939,False
c87680878aadb5ec3d73a56d2e37bb2e394d11bd,2016-05-10 05:58:52,Ben Gotow,feat(not-spam): Unmark items as junk / spam #2112,False
29c81221f252841f3f6b1f4087646d1b7e1a48d4,2016-05-10 05:40:40,Jackie Luo,update(readme): Add themes,False
baca6be7ae725b340c28130fd719a991fcc6f878,2016-05-10 01:48:07,Ben Gotow,"fix(thread-list): Add missing displayName, ES6",False
25a21189cff3326ac2921d79b2f09dee87659927,2016-05-10 01:39:10,Ben Gotow,"fix(notifs): Don't play notification sounds over and over #1910, #2179",False
75bab91395cb8edd70374ac09c2687bafce1946e,2016-05-09 23:12:18,Evan Morikawa,fix(lint): fix minor linter issue,False
5a66162b841be4bcd78c7c2a56ff8d875fb1cf3e,2016-05-09 23:06:46,Evan Morikawa,"fix(win): windows can re-launch with/without dev mode flag

Fixes https://github.com/nylas/N1/issues/2142",False
2eb590eb670879102962a19e63d15a22fe92aa60,2016-05-09 22:21:36,Evan Morikawa,"fix(window): don't show if initialized in background

Fixes https://github.com/nylas/N1/issues/2149",False
813440c6a17d30074bf95d8540a4fabb7735c8c0,2016-05-09 22:16:50,Alexander Adkins,"Added Less Is More (#2168)

* Added Less Is More Theme to internal-packages and README.md

* fixed Less Is More title in README.md

* removed units for values of zero

* updated readme, package title fix, theme topbar fix, message list adjustments",False
a50441c8dff6c9ff606b343233c97d06bd9b3994,2016-05-09 21:31:05,Evan Morikawa,feat(react): add react perf tools package,False
f2fbfbceba65912d88d8cdd1ccd0e3b3802e1d39,2016-05-07 05:16:36,Evan Morikawa,fix(build): rename babel task to .js to be picked up by grunt,False
7c050fb380da23b034bef7f6303e3a4467e8724f,2016-05-07 05:14:30,Robert Stanfield,The horizontal scrollbar was not showing up when viewing an email (#2028),False
5c01292e8b5efe27648f7e89a9f30eb2a14cdff9,2016-05-07 05:12:55,Evan Morikawa,fix(spec): fix injected component spec,False
2d2e459094d654a07467e2639022adb5081899f9,2016-05-07 05:02:34,Evan Morikawa,"fix(lint): final linter fixes

fix(lint): final set of linter fixes",False
2ff92946b7878223124ac07f40fd0b2edf73789e,2016-05-07 04:53:48,Ben Gotow,fix(lint): Various linter fixes,False
7533dc0ac61b17de7fe5cbb4487f30fface052ec,2016-05-07 04:36:16,Ben Gotow,fix(lint): Various linter issues,False
813669f7d470b0d328b6a2f5b4aced5b6774dc30,2016-05-07 03:06:11,Evan Morikawa,fix(lint): fix various linter issues,False
431b652e6282559aa8afc616440af5ba266b9186,2016-05-07 02:41:05,Evan Morikawa,fix(lint): various linter fixes,False
0e2b5501e39c81fe2781767367e1cb6d1f0f82dc,2016-05-07 02:40:28,Ben Gotow,fix(lint): Correct more linter errors,False
3d3b9bf87ff0d53a806636a2a5398eb31b5db5cc,2016-05-07 02:12:09,Evan Morikawa,"fix(lint): fixing various linter errors.

746 left",False
bd444864c84aab522a972a41635967831a1d1410,2016-05-07 01:11:52,Evan Morikawa,"fix(linter): object-shorthand, quote-props

object-shorthand got turned off. We think it's fine to say {foo: foo} if
you want

quote-props is error consistent as neeeded.

Use custom file-by-file rules for global-require",False
b91ebd5504e554272186b4eab2997fd3c022834c,2016-05-07 01:11:09,Ben Gotow,fix(drag): Allow sections of the sidebar to expand on drag,False
6f923b0e91fdf71aa98c815cf5451c5d5d0c6ecf,2016-05-07 00:50:16,Evan Morikawa,feat(babel6): remove eslinter fixer task,False
33d7ab66a48221d85ba7d6b85d3c30b3856a50a3,2016-05-07 00:43:07,Evan Morikawa,feat(babel6): update unused prop syntax,False
d9be81b7f5afc2634ecd67231d688dec83a26f09,2016-05-07 00:30:45,Evan Morikawa,feat(babel6): fix es6 importing from coffee,False
1064a010e2ec2ef36351ef0f29d72ec125d1c17c,2016-05-07 00:25:58,Evan Morikawa,feat(babel6): Use published babel-preset-electron,False
d29848e24261ddcd7e9735d1e62df16a68a5ee53,2016-05-07 00:25:57,Evan Morikawa,"feat(babel6): 1,043 linter errors",False
d568bae3582cb1f8b667cf401d7bb8dc330a9805,2016-05-07 00:25:55,Evan Morikawa,"feat(babel6): 1,240 linter errors",False
b3a71780d77c8b86fa91de046d4a17c2126859cf,2016-05-07 00:25:53,Evan Morikawa,"feat(babel6): 1,393 linter errors",False
5143105e2ec62cf46f3adccec302f13fc3e3ce47,2016-05-07 00:25:52,Evan Morikawa,"feat(babel6): 1,608 linter errors",False
ef1c15083f27764c4fc9f9b877c44f1196101182,2016-05-07 00:25:50,Evan Morikawa,"feat(babel6): 1,770 linter errors",False
47497dba0439d2b19cdd645d35951791c8b0c651,2016-05-07 00:25:48,Evan Morikawa,feat(babel6): Fix emoji data,False
2e2f877ddb7125986b29f62939eae0b870d4521b,2016-05-07 00:25:46,Evan Morikawa,"feat(babel6): 1,774 linter errors",False
5b26322c893cda9635260be7a573a48c55b4723c,2016-05-07 00:25:45,Evan Morikawa,feat(babel6): Add task to fix function spacing,False
d2a4befad7b1f64ffb69bb0e15760af509e8fdde,2016-05-07 00:25:43,Evan Morikawa,"feat(babel6): 2,398 linter errors",False
05515c847ce934ac6ff60e73e84d1f8d12207da4,2016-05-07 00:25:41,Evan Morikawa,"feat(babel6): 2,743 lint errors",False
1def8546037fe717b720d3a97dc8dd29a19b6395,2016-05-07 00:25:40,Evan Morikawa,"feat(babel6): 88,888 lint errors",False
654820d5688fb6a6d5841c9b6b5b45ae4d8918b1,2016-05-07 00:25:38,Evan Morikawa,"feat(babel6): 90,798 lint problems

Fix eslint-task. Grunt doesn't recognize es6 files",False
e054a6ac9104069b96d00e9ffa34b88a28603689,2016-05-07 00:25:36,Evan Morikawa,feat(babel6): Yay all the tests pass,False
2e906d4e166658058692048b0e8b09c5c552601c,2016-05-07 00:25:34,Evan Morikawa,feat(babel6): Don't use _.clone on Model objects,False
57a3e140f40dc6faf230041a3b813fa80091f3e4,2016-05-07 00:25:32,Evan Morikawa,feat(babel6): Fix autlinker spec,False
92d5369f21e582bf3f7ae114893946f2c3f9b384,2016-05-07 00:25:31,Evan Morikawa,feat(babel6): Fix errors in es6 compilation and extending from coffeescript,False
706f92bc9d9063c96ec6b9dbdcb692ef3e4d5397,2016-05-07 00:25:29,Evan Morikawa,feat(babel6): Fix spread operator,False
92199587b37cc9572f5f9b49bf363d6fa8092952,2016-05-07 00:25:27,Evan Morikawa,feat(babel6): Convert message.coffee to message.es6,False
409704fe8f5506210f37eaa5e1cd1afaca54a225,2016-05-07 00:25:25,Evan Morikawa,feat(babel6): Convert account.coffee to account.es6,False
52518199420a5b958394ba97ea86179c72eccc83,2016-05-07 00:25:23,Evan Morikawa,feat(babel6): Replace stage-0 with electron,False
679837316be403f8c81831fae26349416fe836b7,2016-05-07 00:25:22,Evan Morikawa,feat(babel6): Switch to using local babel-preset-electron,False
390007cac93ee19d117e3e4c6ba351cc3527e481,2016-05-07 00:25:20,Evan Morikawa,feat(babel6): fix es6 describe function syntax,False
13e0a8f4426f9c813bd626dc27a2db5a598ff1c3,2016-05-07 00:25:18,Evan Morikawa,feat(babel6): Add test for spec describe,False
18df77c3c0e47f99b0a77faaa82e833b0c3f0a55,2016-05-07 00:25:16,Evan Morikawa,feat(babel6): fix participant field spec,False
2692fce522dacc511b90870717a7968116bd9997,2016-05-07 00:25:14,Evan Morikawa,feat(babel6): Fix destructuring default from exports and update linter,False
50c1fded1437f058ab45ba06e5f56194b476742c,2016-05-07 00:25:12,Evan Morikawa,feat(babel6): Fix FixedPopover spec,False
4e754c660c01d3f50eda84eabc508151c0724815,2016-05-07 00:25:10,Evan Morikawa,feat(babel6): Fix ModelWithMetadata spec,False
84e51ed3d9c637b924f31af9122fdf5fcc5768d9,2016-05-07 00:25:08,Evan Morikawa,feat(babel6): Fix syntax errors and add regenerator runtime,False
a54b540bd43fa4486a6063f4dc0da35dd318ab85,2016-05-07 00:25:06,Evan Morikawa,feat(babel6): Fix linter problems in new es6 files,False
66786931c3e7b7bd5da608ffc84d6c0151679875,2016-05-07 00:25:04,Evan Morikawa,feat(babel6): Remove support for @babel header,False
9e4029036a603a6c46f4893578e10e085ba3a964,2016-05-07 00:25:02,Evan Morikawa,feat(babel6): Rename to js to es6,False
3a6f3b9302b39c7b06af5a00e9fe1378f8a91a75,2016-05-07 00:25:00,Evan Morikawa,feat(babel6): Fix default loading in nylas exports and component kit,False
e355971dd2a22eabd73b46d7b3b303b54e1f99b3,2016-05-07 00:24:58,Evan Morikawa,feat(babel6): Use absolute paths for linter and dont call default on coffee,False
2d553227054d67a949e159af2c640b3eb5b2cfb2,2016-05-07 00:24:57,Evan Morikawa,feat(babel6): Detect when packages don't have a default export,False
21419b9df08028de0754b4ac85c08d330a047c9e,2016-05-07 00:24:55,Evan Morikawa,feat(babel6): Convert to use new es6 require syntax,False
850e703aacdd4f14a3c645feefb3e1ad7df7f935,2016-05-07 00:24:52,Evan Morikawa,feat(babel6): Add babel presets and lint for require.default,False
8db8722f74612e742d3ccad26f5a2926c9b6b23c,2016-05-07 00:24:38,Evan Morikawa,feat(babel6): Initial babel conversion,False
bbdfa85547795d53d41e1d7f1b0e2f18e0888071,2016-05-06 05:35:51,Ben Gotow,feat(keymaps): Edit your keymaps from preferences,False
3d18241ea1ea29bc3db6b3302c8f83896e9c9b25,2016-05-06 00:23:58,Ben Gotow,fix(focus): Always set selection range into editor on focus,False
3f6c2b5f550da27262dea74d629ba843f719d0a0,2016-05-05 23:33:45,Ben Gotow,fix(attachments): Properly handle HTTP errors in addition to socket errors #2136,False
81d1b36ef2baeb2d10f015b704c2825a39bfc409,2016-05-05 23:05:37,Jackie Luo,:art:(darkside): Hide search bar in list mode when items are selected,False
f037cf8e9ffe2a9a5d068e7e485fcccc58f596be,2016-05-05 22:53:35,Ben Gotow,fix(composer): mod+(a|x|c|v) always fall through to window,False
ad706c0609b0ca4e32608a200c7bba128806d58e,2016-05-05 22:15:20,Ben Gotow,Update CONFIGURATION.md,False
cb2913871ee78b3106fd516c55cf5b431e0a2d0d,2016-05-05 08:04:41,Ben Gotow,"es6(*): AutoUpdateManager, ProtocolHandler, more.",False
204f3005c1593d1fd4e4d9960a74328916a38e60,2016-05-05 07:39:28,Ben Gotow,fix(file-drop): Wait for attachments before popping composer,False
d7b21a2d8b3140e3ea5285dd5ad4ac9f4a77f9d4,2016-05-05 07:37:04,Ben Gotow,"fix(windows): Register all hot windows, not just first one",False
3858a8f3252895971d49cd8616650e64fa763ce1,2016-05-05 07:23:04,Ben Gotow,es6(*): Fix application ES6 conversion,False
13f5230afcc102a78807ce2c6ac749608e34062d,2016-05-05 07:09:29,Ben Gotow,bump(changelog): 0.4.33 notes and 0.4.34 bump,False
3cef681d963d17d3aac88a7a7129b380132e9d9b,2016-05-05 05:54:11,Ben Gotow,fix(N1.sh): run with --enable-logging (nylas.sh for prod),False
a4b05a25bed0b5b59cf71f30f32857a5f7e536ef,2016-05-05 05:52:30,Ben Gotow,"es6(*): Application, WindowManager =>ES6, use makeSingleInstance",False
6a4b407cb07ef89c729a30d4fe648d8a3221ae12,2016-05-05 04:55:42,Juan Tejada,"fix(composer): Properly setup editing action listeners on update

- This prevented emoji selection via the popover from working on a new
window because the plugin is loaded after the contenteditable sets up
the action listeners, so we need to re set them on update",False
c85c8d04b7a2eba875e4c3865306aa5f0a969d3b,2016-05-05 03:32:38,Juan Tejada,fix(composer-editor): Remove dead code,False
34f1ca0ba8573357b3da13ef785b0b9c9513b8fc,2016-05-05 03:11:13,Ben Gotow,rm(fullcontact): Deprecated in favor of new contact sidebar,False
66cb0a6a77848327d6020477aa5886c1f9363ba3,2016-05-05 02:57:46,Ben Gotow,"rm(*): deprecated/unused Atom code, user stylesheet support",False
7657598f40f6083ec2bce12a554ebe73258a6d01,2016-05-05 02:14:35,Ben Gotow,fix(read-receipts): Always remove own read receipt images,False
0e10ccbde9df8924efb3354a0aa0a4ad7867ee6e,2016-05-05 01:33:47,Juan Tejada,"refactor(deltas): Update sync-worker to use NylasAPI.longConnection

Summary:
- Remove nylas-long-connection.coffee duplicate code from sync worker package
  and replace with delta-streaming-connection which uses NylasAPI.longConnection
- Replacement for XHR will come in another diff -- still need to clean up and
  fix some edge cases

Test Plan:
- TODO! Will add test coverage for NylasLongConnection and
  DeltaStreamingConnection

Reviewers: evan, bengotow

Reviewed By: evan, bengotow

Differential Revision: https://phab.nylas.com/D2875",False
2b7f3252de888a0cc362a05fac0e08c60321de5f,2016-05-05 00:35:04,Ben Gotow,fix(config): Report JSON parsing errors in a dialog #2102,False
cde329168d24c8fb378ed755f2375253b3f97471,2016-05-05 00:20:54,Ben Gotow,fix(specs),False
4d2f4da08fc8caf7f611b7c9daf55f5b3b670eed,2016-05-04 22:09:30,Ben Gotow,"fix(tracking): Fix saving of ""off"" state #2123",False
a2faa9b83bce20946bb28888d1772511e43b62d1,2016-05-04 21:59:42,Ben Gotow,"fix(keymaps): ""Delete"" => ""Del"" to fix keycode 46",False
4c00cccbee14b00690f04d596d188f88058f9c0c,2016-05-04 21:55:13,Ben Gotow,fix(perspective): Always pop to root sheet when changing #2125,False
9d623dec12db8c4f87c81bcb99d8ab93784fd3d9,2016-05-04 13:04:33,Ben Gotow,fix(send-later): Don't autodelete once draft is marked for send later,False
8925bc02f3bacc2275e2ad13fdafde5b798a9842,2016-05-04 13:01:05,Ben Gotow,fix(drafts): never override body with undefined,False
7a15e369a77bcf2d44928b7a4f7a83fdcfd7b358,2016-05-04 07:34:04,Ben Gotow,"Revert ""feat(mailto): Allow N1 to be default client on windows""

This reverts commit a08eb3e175abd7a98dc844ff6ed9d93bcb00e626.",False
d940f8df0817624c9901b6f80d900ae4fb15e411,2016-05-04 05:46:49,Ben Gotow,fix(config-schema): Explitly mention swipe gesture,False
da2c9145b4c00df68a37c269158e85375e644ee4,2016-05-04 04:55:52,Ben Gotow,bump(asar): Re-create ordering hint,False
c811cc5ce67048d983760cbb6583fd500ecbd155,2016-05-04 04:28:14,Ben Gotow,fix(model): add specs around serializing bad API data,False
2e9ab2cc235156f1c0def97c20a68f4b7c88d849,2016-05-04 04:03:58,Ben Gotow,fix(menu): Copy Link => Copy Link Address #2105,False
e8af794adf826217865a7afa163c441a5003bc01,2016-05-04 03:57:53,Ben Gotow,"fix(unsubscribe): Leave canTrashThreads for now, in use by plugins",False
7976ec6e0eb993342280b9bb393f7fbf178e5966,2016-05-04 03:47:02,Ben Gotow,feat(outline-view): Auto-expand when drag is over item with children #2084,False
a08eb3e175abd7a98dc844ff6ed9d93bcb00e626,2016-05-04 03:17:21,Ben Gotow,feat(mailto): Allow N1 to be default client on windows,False
e637f6871cc1187a3d7758fb71cb2bfa9a8e5196,2016-05-04 02:31:06,Ben Gotow,"fix(db): When replacing obj in a set, keep old body if new body not provided",False
6d2755329b9b279a4871e4e1b0ac706107533300,2016-05-04 02:31:06,Ben Gotow,"fix(send-later): Simplify logic, use changes.addPluginMetadata",False
4d1c3801594ec561151d248d16f36fc7aaa3d1d2,2016-05-04 00:00:41,Evan Morikawa,fix(window): fix error when adding account and serializing bad API data,False
c91341715e830e1e07118639226c57753945da0d,2016-05-03 21:46:53,Ben Gotow,"bump(versions): 0.4.33 beta, Electron 0.37.8",False
d007182000189f13aea91df481b58692836b5754,2016-05-03 12:25:00,Alois,"Add links to Arch Linux's packages (#2097)

* Add a link to the archlinux's package

* Remove duplicate",False
1de17e795ae186ef809e17493bae6b63a107df3f,2016-05-03 07:49:34,Evan Morikawa,fix(lint): fix linter error in spec,False
6421084d88079e691b3c33c627e61f06dbe46f6c,2016-05-03 07:48:13,Evan Morikawa,fix(scheduler): fix scheduler to set uid in extension,False
5f166cc6ff74f0bf1882ebe5cad85b4cf19a4916,2016-05-03 07:44:12,Ben Gotow,fix(sheets): Always change sheet when changing perspective (#2094),False
7024dadb666ba6d7fd5714b49ec95616107b19a4,2016-05-03 07:28:31,Evan Morikawa,fix(spec): fix cache in spec,False
f5c40c6f993355656dc6d1b3737e6e3e9604a4ad,2016-05-03 06:58:46,Evan Morikawa,fix(less): fix themes not loading properly from cache,False
6cf4f8edcdd4deed5f77c453b7ee3704b474c56b,2016-05-03 06:42:09,Ben Gotow,fix(activity-list): Use ContentPreserve to avoid changing link/open color coding,False
cb19021d3160c6b40c2aca7de18d3180181082b7,2016-05-03 06:41:45,Ben Gotow,fix(picker): Invalid call to setState caused by unsub not working,False
65a60f2d96989f8ebc1e0f52e4c1db0a3b72369e,2016-05-03 06:06:23,Ben Gotow,fix(tracking): Calling Actions.setMetadata from applyTransforms no longer works,False
b9f39cd86ef5067d5ef5657a91e27dbc9ef13f07,2016-05-03 04:29:17,Ben Gotow,"fix(tracking): Use colors for link/read receipts, fix parsing",False
287b881dbf0a62b9291fb26a8d65608bcfb77d41,2016-05-03 04:28:47,Juan Tejada,:art:(mail-merge): Remove hardcoded bg color,False
2cc7ee881a55970204b8b0a4d921c62697424bc8,2016-05-03 03:59:34,Evan Morikawa,fix(composer): fix async composer plugin loading,False
16c3a87ed40677106c380b3e1dabfada0c7c3021,2016-05-03 03:24:57,Ben Gotow,"fix(activity-list): Apply ""limit 100"" after sorting, not before",False
2bbcb6f6d249b1b810959d48d8317d81e749ea64,2016-05-03 02:53:05,Ben Gotow,bump(version): 0.4.32 and changelog,False
74b22880aa86f9e93e865f00949edf80d54f1d4b,2016-05-03 02:50:23,Evan Morikawa,fix(composer): don't show popout in composer on output,False
17c9c60cb25371cbcf75d1564bac5e9025fb6f61,2016-05-03 02:31:44,Juan Tejada,fix(mail-merge): Unlink fields when column is removed,False
8b22c4efe5b3981d260ecbf9e4f6e7e391fa346d,2016-05-03 02:17:35,OliverCole,Fix config.json markdown (#2101),False
6895d4e40b00477c63b678df59e3234371a32b9b,2016-05-03 02:04:28,Juan Tejada,fix(mail-merge): Check if contains recipients before sending,False
c3280e6465fbfa2df2ae2782cad08f5d21d16e6d,2016-05-03 01:16:14,Juan Tejada,fix(mail-merge): Add check for valid email address in recipients,False
d9bdd90599ada18d36f7472aebc5231670c9fafc,2016-05-03 01:03:08,Ben Gotow,"fix(emoji): Replace message emoji in DOM, not in html string",False
80f7cdab71b958c5aa390e553745d5a16d0d4d42,2016-05-03 00:45:56,Juan Tejada,"fix(mail-merge): Preserve linked tokens when importing new csv

- If the new imported csv contains columns with the same name as the
imported one, any tokens linked to those columns will be preserved
- Any tokens linked to columns that no longer exist will be removed
- Other fixes",False
953931a62803bd59caf1097bb86300d3dcaff702,2016-05-02 23:54:10,Juan Tejada,"fix(mail-merge): Don't update body tokens unless actually necessary.

- Prevents the contenteditable from stealing focus",False
fb4bd77efdf08f41b168e1f47697d60bd75fc511,2016-04-30 05:40:17,Ben Gotow,"fix(undo): Don't create separate commands, since they bubble separately",False
399d445e98d8265345f2af186f0c7b98506aba96,2016-04-30 05:24:37,Evan Morikawa,fix(specs): fix composer-header specs,False
739d23ffe5b91c82ec63e947faa77ded6cf9089a,2016-04-30 04:49:52,Ben Gotow,fix(lint): Errors in ActionBarPlugins,False
ac29c99f329d85f35c9ff6bbd39fb7f681ad71d6,2016-04-30 04:35:20,Ben Gotow,fix(mail-merge): Autogen headers for CSVs with no headers,False
ebba673671a1c1f90f881c670f128461c1b9647a,2016-04-30 04:28:17,Evan Morikawa,feat(composer): better composer plugin loading,False
31fb621d6b126010564cbfb0e57bfd18752425c6,2016-04-30 04:28:17,Evan Morikawa,fix(draft): metadata changes don't flip pristine bit,False
dec047b18c878a4544b4416a7655552f86dbb7b5,2016-04-30 04:28:17,Evan Morikawa,fix(composer): fix flashing and focus losing in the composer,False
e62bebb8a181a5bad85679445e4786ff90f01d76,2016-04-30 04:26:57,Juan Tejada,"fix(mail-merge): Update regex, plus minor cleanup",False
6b97b9bbd45e5bee7860da17685eac3bca86a792,2016-04-30 04:11:35,Ben Gotow,bump(version): 0.4.31,False
6fc18725e04d002b1fa4d4923037ce55caf25b64,2016-04-30 03:25:43,Juan Tejada,"fix(table): Fix row rendering (also fixes focus)

- When rendering lazy list, need to pass same reference to the renderer
or otherwise a new component will always be mounted",False
4fd66e194feb7226e8886ce8a33334b8367216ab,2016-04-30 02:25:11,Ben Gotow,feat(mail-merge): Import CSV button,False
471f934421ae1a79db57c509ef2d72a714c34ac6,2016-04-30 02:04:15,Ben Gotow,fix(mail-merge): Disable send later while using mail merge,False
38bf9080c284b19fba0a78db919301b6dd24da6e,2016-04-30 01:40:15,Juan Tejada,"perf(mail-merge): Add lazy rendering to table

Summary: Add new LazyRenderedList component and updates Table to use it

Test Plan: TODO

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2936",False
e9ae4def9aa43e46b48858e63d351a01af5c058e,2016-04-30 01:27:04,Ben Gotow,fix(mail-merge): Replace the same token as many times as it appears in body,False
b954071271e462d33ff402ccdd7bb59a8a28b557,2016-04-30 00:45:48,Ben Gotow,"fix(activity-list): Remove image width in favor of intrinsic size, no-shrink rule",False
03080cf109e5bb9e02f70749243a29764b172b17,2016-04-30 00:27:43,Ben Gotow,fix(mail-merge): Fix drag and drop for files vs. chips,False
e2dcc7b4352a75176007adfd65db336811156285,2016-04-29 22:50:59,Evan Morikawa,fix(onboarding): pass along accountId too,False
b82e47ba3475a09b5926cecf538b20add4f1ee10,2016-04-29 22:48:51,Karim Hamidou,"[N1] Changes to allow running edgehill-server locally

Summary: This is mostly config changes.

Test Plan: Tested the Google OAuth flow.

Reviewers: bengotow, drew

Reviewed By: bengotow, drew

Differential Revision: https://phab.nylas.com/D2907",False
dd4054095300d6d3825a71f1b5df2904b746d776,2016-04-29 05:50:39,Ben Gotow,fix(read-receipts): Fix another issue caused by ES6 subclassing Coffeescript,False
6746c1acd1a04b1bb98467583cd0c033f3bc62d3,2016-04-29 05:38:54,Ben Gotow,bump(version): 0.4.30,False
67fcba67692ae8f0f903495c2b5ac38d3433c715,2016-04-29 05:38:54,Ben Gotow,fix(read-receipts): Remove tracking pixels when composing drafts,False
687ecbfcc30ed876cfa4b8d2cc6182add98ec3ff,2016-04-29 05:36:47,Evan Morikawa,fix(onboarding): encode welcome page info,False
821dfc27cee240e19a460e318212c3ac82c90ef8,2016-04-29 05:10:48,Ben Gotow,fix(build): linter errors,False
765d9f30fc5be75b97e3254d37a6b57fbc341582,2016-04-29 04:23:51,Ben Gotow,fix(thread-list): Don't rely on `zip` since it can become off-by-one forever,False
b3ea3353451d06f8646422ece9443e375fcbc066,2016-04-29 03:59:13,Evan Morikawa,feat(onboardin): fix win closing & nav to welcome page,False
b28e2833d8d8ca064ec050e3dcc02e3f883587bf,2016-04-29 02:50:44,Ben Gotow,"fix(activity-list): Add empty state, cap number of items",False
9642484b5eddc381f260e6d19be7eb17bc33afa3,2016-04-29 02:12:30,Evan Morikawa,perf(composer): tweak tooltip animation timing & composer loading,False
c0ac5fe5b27edcdf3a89c4696b20134bdf3f2a3b,2016-04-29 01:49:15,Ben Gotow,fix(config): Remove unnecessary CSON import,False
27bb58e4ed9725f763c768c602b62fb32d94e6c7,2016-04-29 01:47:12,Ben Gotow,"fix(config): Rewrite contents, not just filename",False
7958d8cb5a32d58ae1a4b02e173a5b6266b6b9a9,2016-04-29 01:41:09,Ben Gotow,fix(activity-list): Move button to the right beside compose,False
f5558532c55f6d50f43a3f4b7b9cad5656bffec9,2016-04-29 01:15:29,Ben Gotow,fix(keymaps): Use correct combo for paste+match style #2088,False
3137db3a250406e49763fbf27a216ae9c748171f,2016-04-29 01:12:06,Ben Gotow,bump(version): 0.4.29,False
5d3a8d3f521d06978d724212c0b34c710598c838,2016-04-29 01:10:14,Ben Gotow,"fix(win32): Sharper hamburger, better win32 menu",False
c77b64cbbbd4e896e1eacd29acd2e51c46cbb0d7,2016-04-29 01:02:10,Jackie Luo,"feat(activity-list): Add unread count and click-to-thread

Summary: Shows unread count and focuses thread upon clicking on
notification (desktop or popover).

Test Plan: Tested locally.

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2927",False
1f6c3164d4cdc86e6a145ea32952e77ca1f91a86,2016-04-29 00:32:40,Ben Gotow,fix(mail-merge): Hide button when the user is composing a reply,False
4b71258dee47f7614fbba5baa0cc775a49ce6f74,2016-04-29 00:15:44,Evan Morikawa,fix(sidebar): fix account name styles,False
6a4318d4b799d7424f8c5178f13949af10cb007e,2016-04-29 00:01:42,Ben Gotow,fix(win-management): Focus existing win when renderer tries to open dup,False
c1c7705f09eac10d8b3e89d3e16cac2f766be4a4,2016-04-28 23:50:56,Ben Gotow,"fix(win-management): Track windowKey changes, add assertions",False
e238258dcbeec36ed4699bbb70fe8ad826b53bb2,2016-04-28 23:04:56,Ben Gotow,fix(user-agent): Don't assume Tasks are spawned from renderer processes #2079,False
a69266a75d55bc463e826ca8e6bd45f363f89d90,2016-04-28 22:58:41,Akshar Patel,"Show under Internet Category in Linux  (#2083)

* Update title for system tray

Using only Menu Bar confuses Linux users because ''Menu Bar'' word is only used withing Mac OS. So, also use ""System Tray"" word.

* Show under Internet Category in Linux

Right now, N1 is showing under Programming Category. ""Network"" should be added to show under Internet Category.",False
04cebd51f26540ae435643eac5e4cff51fbc28bf,2016-04-28 22:46:40,Juan Tejada,"fix(cursor): Remove stale cursor from config.cson when cursor error

- #2049",False
fbd77fb5f68f640c867db1ca4c836855d561bee6,2016-04-28 07:50:59,Ben Gotow,fix(build): resolve lesslint issue,False
e995972323b53612c5ad5a965f00b1462b56519a,2016-04-28 07:48:34,Ben Gotow,"fix(win-menu): Display window names, not ""Unnamed Window""",False
24938163125296062d594ea3f4995c247663b425,2016-04-28 06:52:59,Juan Tejada,bump(submodule): Latest mail merge changes,False
71353cdaf18b61d60f7d2f827f7f943b2eaa1a1a,2016-04-28 06:52:32,Juan Tejada,"feat(mail-merge): Add CSV imports, styling, and several fixes

Summary: Adds CSV imports, proper styles to mail merge plugin and fixes a handful of bugs

Test Plan: TODO

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2925",False
7bf842fb0b8bce7777beed4fa513c15143caa299,2016-04-28 06:14:43,Ben Gotow,fix(build): keytar bump broke everything,False
61073da7a0f710d47bf2c3999c257a0fedac2e4c,2016-04-28 03:50:25,Ben Gotow,fix(thread-list): Remove unnecessary extra `trigger`,False
7ce646a1d3fa6610518f5aad33bdda2b7b0a9ecf,2016-04-28 03:50:06,Ben Gotow,"fix(keymaps): Restore missing bindings, handle single keys inside of email frames",False
ac66570b1b21a13efdc650a803507d69e58a9e9c,2016-04-28 02:03:26,Ben Gotow,"fix(keymaps): function kys to lowercase, `-` to `+`",False
14569ec37b74a61dc1b397ad0f6bdde43443904d,2016-04-28 01:54:43,Ben Gotow,"fix(menus): Add Thread menu to win/linux, fix disabling",False
e116eaec48038376a48f5aa8bd13782e80cf014e,2016-04-28 01:37:15,Ben Gotow,bump(version): 0.4.28,False
f818a134dd29380574893f85b9ab0b6e97c5e249,2016-04-27 22:56:23,John McNair,"Parse Office 365 names (#2016)

Office 365 likes to format email addresses as follows:
Last Name, First Name (Some Description) <email@address.org>

This causes Contact.firstName() (and hence sometimes displayName()) to return
""Last Name,"" which looks a bit odd in the message/thread views.

The intent of the commit is to correctly parse these names so that (using the
above example):
- firstName = ""First Name""
- lastName = ""Last Name (Some Description)""
- fullName = ""First Name Last Name (Some Description)""

These behavioral changes only impact names containing a ','.

I don't know that this really provides exhaustive coverage of Office 365, and
keeping the description as part of the last name is not completely guilt free,
but it's not any worse than the previous state of affairs which also has
the description in the same field but combined instead with (misplaced)
first name data.",False
6f13a97e1c2b0d3deca279eb0c8ba84f22144f29,2016-04-27 21:52:23,Selwyn,"Linux launch on start (#2019)

* feat(workspace-section): Add Linux-only warning to launch on start

* feat(system-start-service): Add Linux launch on system start option",False
66eca644cb14caaa0477f461138f739ac003441b,2016-04-27 07:43:48,Akshar Patel,"Update title for system tray (#2041)

Using only Menu Bar confuses Linux users because ''Menu Bar'' word is only used withing Mac OS. So, also use ""System Tray"" word.",False
68bf080b5724a3d94ed89450e7de0de7238280f7,2016-04-27 07:33:43,Ben Gotow,fix(autolinker): Don't match emails that are also URLs #2071,False
8e9346f224786c4768d954cd4468008532856f58,2016-04-27 05:31:15,Ben Gotow,fix(autolinker): Use `getAttribute('href')` because `href` is magic,False
e11181423eae3b489e7e6724cf8a004b3f167d7d,2016-04-27 05:19:33,Ben Gotow,fix(autolinker): Always override title attribute #2056,False
db934cf463c415090ced45b8e2f18d4d70a9213e,2016-04-27 04:23:51,Ben Gotow,fix(sidebar): Fix overflow of account name,False
b23af144e1bb89cd7fd74a115a9c6d3426afd26f,2016-04-27 04:04:17,Ben Gotow,fix(accounts): show messages and coerce config when invalid,False
77f885e86b5cb3357d75b983d66c8182dca5a730,2016-04-27 02:48:23,Ben Gotow,fix(draft-factory): Correctly load messages when creating a draft on a not-loaded thread. Sentry 26671,False
4962d24b4dd7bdcc97a5d6c3f37e43fb13f18a3b,2016-04-27 02:42:57,Ben Gotow,fix(quoted-text): Guard call to children[0] Sentry 33642,False
14acad219704da1497d9688ca4afd04ba736a292,2016-04-27 02:33:08,Ben Gotow,"fix(attachments): Make presentError display underlying error, file optional. Sentry 27089",False
e2ee14bb6097dcbd0dd4a09e04c59bfd7e3fb018,2016-04-27 02:16:25,Ben Gotow,"fix(keybindings): Fix ""Show Keybindings"" button",False
d64fd03c539a76d31a8d45951a6cbaa86342ca40,2016-04-27 01:57:39,Ben Gotow,fix(menus): Customize context menu for mailto #2061,False
e269dc259881bca064d97ff28b42e5b935c171a3,2016-04-27 01:47:29,Ben Gotow,cleanup(config): Additional notes about config.cson => json,False
c543de9e8144cc95dcf7c74354e4dd0823f10742,2016-04-27 01:44:07,Ben Gotow,"cleanup(specs): Remove space-pen. Goodbye, jQuery!",False
80c8d733c88a0bc11340ddd54b9faf2632e46b89,2016-04-27 01:44:06,Ben Gotow,"cleanup(config): Remove unused features, dependencies",False
d7832576b5fadca64dee408ba830cc84160d7ba3,2016-04-27 01:44:06,Ben Gotow,fix(composer): Wait frames not msec on focus out #2033,False
6b12f833d7c6ab4719a16f5ace19ab7050700a5a,2016-04-27 01:44:06,Ben Gotow,"fix(compose): ""compose in trash"", additional specs #2026",False
4ea8b9622cac8d6d482d367b10f197a822390d8f,2016-04-27 01:32:05,Evan Morikawa,fix(win): draft popout windows always send draftJSON,False
fd256b6bef4deefaae22c8b82eb9b46575b908bb,2016-04-26 23:32:02,Jackie Luo,"fix(activity-list): Debounce notifications and add detail to subtitles

Summary: Only sends notifications if none for that thread have been sent
in the last ten minutes/ten seconds, depending on the plugin. Adds
subject/link URL for notification subtitles.

Test Plan: Tested locally.

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2922",False
e42f50178073852a824862f33bc995b5815095bb,2016-04-26 06:00:30,Evan Morikawa,fix(frame): fix link clicking in iframes,False
11ed4781a483f09b249ec17dfcf14932584125b6,2016-04-26 05:27:25,Evan Morikawa,bump(version): 0.4.27 beta,False
c416731d3515bae305413611fc47225615454593,2016-04-26 04:48:23,Evan Morikawa,fix(build): fix lstatSync throwing,False
6a5571715707f10c5847a757f2ae4ec7dfe89412,2016-04-26 04:31:56,Evan Morikawa,feat(package): fix build-resources-task and move submodule,False
25dea6a1364a9e7aab59171aed7795e5f55fd8c9,2016-04-26 03:36:37,Evan Morikawa,feat(package): require `'engines': {'nylas': '*'}` in package.json,False
6d86969d73948a52a412f91a98113381cb726cb2,2016-04-26 02:58:21,Evan Morikawa,fix(path): error if booted from wrong folder,False
483dc7dae9e6a32d4969c02046562ad77931f086,2016-04-25 23:30:08,Evan Morikawa,fix(keymap): stop shift callbacks too,False
fb6101097eb735ed769ba056bc39b24d7952c0b4,2016-04-25 22:48:36,Michael Grinich,remove plugins from readme that fail when building from source,False
4d38ac63100422bb7a7e8ee303af9c842f55abb7,2016-04-25 07:03:34,Ben Gotow,"cson(cleanup): Remove imports, only used for config.cson now",False
4f31785a16f45980155843866f7a125a09a2f55e,2016-04-25 07:02:53,Jackie Luo,:art:(plugins): Fix line breaks,False
b7da2c7b8682556da3c2fc02aae75e61ed58b635,2016-04-25 07:01:53,Ben Gotow,"cson(packages): Remove from specs, deprecate use for for menus, package.json files",False
ba16a717774a69ca7327748b283b3fb1815bf410,2016-04-25 06:57:29,Ben Gotow,"fix(build): CSON => JSON no longer necessary for /keymaps, /menus",False
b98a3bae6075e84c3cfe4c843e6434adfea363c7,2016-04-25 06:02:37,Ben Gotow,fix(build): Run eslint on files inside submodule,False
d8dd9461c2f4110d3f3b4b04be8e4dff21d8fed9,2016-04-25 05:27:55,Ben Gotow,fix(build): Trigger travis rebuild,False
3bfad0c9e1b2b9172a73bd1dbfa5fba5f3cdddb9,2016-04-25 01:51:29,Ben Gotow,fix(*): spec failures related to moment-round again,False
aab39a12da5c24b34bedf8dbf29b07d8cbac3138,2016-04-25 01:23:12,Ben Gotow,mv(packages): move plugins that are incompatible with open source sync engine,False
ed6c25d2f9b8741499025ba783d3f45c38138800,2016-04-25 01:04:56,Ben Gotow,bump(version): 0.4.26 beta,False
e710a83e10ca944832745c2a9132a70bec92f29b,2016-04-24 23:38:33,Juan Tejada,"fix(specs): Fix broken popover specs

- Remove composition with decorator for now
- Fix other specs",False
a46bad4eb73b2b5ba95f21bb4a0905dc787b8af7,2016-04-24 22:46:25,Ben Gotow,"refactor(menus): Major prune of keymaps/commands, real conditional menus

Summary:
Keymaps & menus CSON => JSON, remove AtomKeymaps, CommandRegistry use of CSS selectors, use Mousetrap instead

Important Notes:

- The `application:` prefix is reserved for commands which are handled in the application process. Don't use it for other things. You will not receive the events in the window.

- Maintaining dynamic menus seems to come with quite an overhead, because Electron updates the entire menu every time. In the future, we'll need https://github.com/electron/electron/issues/528 to really make things nice. I will be tracking this upstream.

- The format for keyboard shortcuts has changed. `cmd-X` is now `command+shift+x`

Test Plan: Run tests

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2917",False
021eac7679f6703c31f1a1f6d249f28fcc384682,2016-04-23 06:59:07,Juan Tejada,"feat(mail-merge): Add mail merge plugin

Summary:
Adds Mail Merge Plugin
- Adds new table components to component kit
- Adds new extension points to allow dragging and dropping into composer contenteditable and participant fields and customizing participant fields
- Adds new decorators and other misc updates
- #1608

Test Plan: TODO

Reviewers: bengotow, evan

Reviewed By: bengotow, evan

Differential Revision: https://phab.nylas.com/D2895",False
a8413c8e2f64548047d826de6baa58a0a8f88bb4,2016-04-23 06:11:22,Evan Morikawa,fix(win): speed up composer launching,False
fd61995b92dce9d962deae68710be5b7719cbddd,2016-04-23 06:00:14,Jackie Luo,fix(draft-list): Revert regression for sheet selection,False
ff4cbc8d13faa1909de2307d2f373eadda04e4e1,2016-04-23 05:57:30,Jackie Luo,"feat(activity-list): View message opens and link clicks

Summary:
Adds an activity list view that shows message opens and link clicks in a
chronological feed.

TODO: Add badge for unread notifications and different styling for read/unread
notifications. Click item to jump to corresponding thread.

Test Plan: TODO.

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2915",False
f2a53e57c84b232562777324e1fd60e424c9de02,2016-04-23 04:51:07,Evan Morikawa,fix(win): fix frame settings on windows,False
78b19a4d423724e7e001aa44c5adb875463da6d9,2016-04-23 03:27:33,Evan Morikawa,fix(win): load config earlier,False
e90735ed6e8a3d4e28f48fdb90f0c931363e670c,2016-04-23 02:00:42,Evan Morikawa,"feat(win): faster popout windows

Summary:
This diff is designed to dramatically speed up new window load time for
all window types and reduce memory consumption of our hot windows.

Before this diff, windows loaded in ~3 seconds. They now boot in a couple
hundred milliseconds without requiring to keep hot windows around for
each and every type of popout window we want to load quickly.

One of the largest bottlenecks was the `require`ing and initializing of
everything in `NylasExports`.

I changed `NylasExports` to be entirely lazily-loaded. Drafts and tasks
now register their constructors with a `StoreRegistry` and the
`TaskRegistry`. This lets us explicitly choose a time to activate these
stores in the window initalization instead of whenever nylas-exports
happens to be required first.

Before, NylasExports was required first when components were first
rendering. This made initial render extremely slow and made the proposed
time picker popout slow.

By moving require into the very initial window boot, we can create a new
scheme of hot windows that are ""half loaded"". All of the expensive
require-ing and store initialization is done. All we need to do is
activate the packages for just the one window.

This means that the hot window scheme needs to fundamentally change from
have fully pre-loaded windows, to having half-loaded empty hot windows
that can get their window props overridden again.

This led to a major refactor of the WindowManager to support this new
window scheme.

Along the way the API of WindowManager was significantly simplifed.
Instead of a bunch of special-cased windows, there are now consistent
interfaces to get and `ensure` windows are created and displayed. This
DRYed up a lot of repeated logic around showing or creating core windows.

This also allowed the consolidation of the core window configurations into
one place for much easier reasoning about what's getting booted up.

When a hot window goes ""live"" and gets populated, we simply change the
`windowType`. This now re-triggers the loading of all of the packages for
the window. All of the loading time is now just for the packages that
window requires since core Nylas is there thanks to the hot window
mechanism.

Unfortunately loading all of the packages for the composer was still
unnaceptably slow. The major issue was that all of the composer plugins
were taking a long time to process and initialize. The solution was to
have the main composer load first, then trigger another window load
settings change to change the `windowType` that loads in all of the
plugins.

Another major bottleneck was the `RetinaImg` name lookup on disk. This
requires traversing the entire static folder synchronously on boot. This
is now done once when the main window loads and saved in a cache in the
browser process. Any secondary windows simply ask the backend for this
cache and save the filesystem access time.

The Paper Doc below is the current set of manual tests I'm doing to make
sure no window interactions (there are a lot of them!) regressed.

Test Plan: https://paper.dropbox.com/doc/Window-Refactor-UYsgvjgdXgVlTw8nXTr9h

Reviewers: juan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2916",False
f951d85f45ac0e264f9ec7ea8562ebbb33457ce6,2016-04-23 01:51:23,Ben Gotow,fix(sheets): Attach sheets to the toolbar at correct offset,False
0174b4d20fdc478f0de76a5b05c5682aff488f34,2016-04-22 23:23:11,Ben Gotow,bump(resources): Updates to submodule,False
534eec2d93da2e5d73d911454f0eee957b258c11,2016-04-22 04:30:06,Jackie Luo,fix(draft-list): Select proper sheet when launching in drafts perspective,False
57cd513a669196edc96dbd12d77ce20e77bec6f1,2016-04-21 23:29:59,Ben Gotow,rm(package): N1 does not use activationCommands,False
297e93dc8a2335095d1e4237b9dff3f93b93c7d5,2016-04-21 07:16:58,Ben Gotow,"rm(package): Remove unused grammars, settings, scopedProperties",False
aafd3694ac957e61a85b81ed721aad824c91d24c,2016-04-21 06:17:44,Ben Gotow,fix(message): Re-write nasty code in participants(),False
1f267d8bec78b9ff304c48f10a1a8cdb5db41a53,2016-04-21 03:09:15,Evan Morikawa,fix(spec): fix to run in utc travis,False
aecb6f7953a35d8aaf2211130f313344cd7caf61,2016-04-21 00:57:16,Ben Gotow,fix(attachments): Increase threshold to 12k,False
38804cb816ca6b52cc03479d182930620afcc348,2016-04-20 23:14:32,Ben Gotow,"fix(attachments): Don't show the paperclip for inline attachments < 3k (signatures, etc.)",False
0ebdd2046b58bdd8778b33c46c88c7c4f6cc5613,2016-04-20 22:37:12,Kevin Jose Martin,"Doing write on a GET is invalid. (#2004)

* Doing write on a GET is invalid

* Doing write on a GET is invalid",False
643423f2b003b07e82cbcf22eedda4a58e9e9ae8,2016-04-20 06:16:31,Ben Gotow,"bump(electron): 0.37.6, with fix for inverted tray icon",False
5829e2691f94b0c5a1413faab18aa59f6f5afc1b,2016-04-20 06:12:02,Ben Gotow,perf(db): Use partial indexes added in sqlite 3.8,False
665f9c654ce2f54b335e4821b1fed6023f5b185f,2016-04-20 06:04:19,Jackie Luo,lint(github-card): Change duplicated variable name,False
bfa1ef0d40bfa99c27402bb6721849ee3bfafca9,2016-04-20 05:44:25,Jackie Luo,feat(preferences): Add theme picker button to Appearances,False
4c749426ad7124775cd3678b6b063223d44f3f0c,2016-04-20 04:44:06,Tim Hitchins,"Added link to all plugins section (#2002)

* Added link to all plugins section

* Added correct link - to the nylas repro ;-)",False
c0c39e69b9926ac190fdedb580083ee1eb16d817,2016-04-20 04:43:30,Max Stoiber,"Fix Github Sidebar Plugin (#2003)

Hopefully fixes #1991

I don't have N1 setup locally, so this is a blind shot–would appreciate somebody who has it set up to pull this and verify this fixes the issue, but as far as I can tell it should.

The gist is:

> Looking at the code, what you do is use the `search/users` endpoint to find users by email and taking the repos from there. You then load the repositories of the username, but we can't sort those by most-starred: ""sort string Can be one of `created`, `updated`, `pushed`, `full_name`. Default: `full_name`"" *([src](https://developer.github.com/v3/repos/#list-user-repositories))*
> What we could instead do is use the search API, which **allows us to search for repositories by a specific user and sort by most starred**. This is a tiny bit hacky, but works perfectly fine. E.g. this is the URL for my most starred repos: `https://api.github.com/search/repositories?q=user:mxstbr&sort=stars&order=desc`",False
ca24fc31e9b6724f4b266eb8888612078e76867f,2016-04-20 04:38:58,Ben Gotow,rename(drafts) DraftStoreProxy => DraftEditingSession,False
585dab7cdfce42c3239a034bb7639b0e51063e69,2016-04-20 04:35:15,Ben Gotow,"refactor(composer): Make session, draft available everywhere

Summary:
Up until now, we've been requiring that every plugin control in the composer take the draftClientId, retreive the session, listen to it, build state from the draft, etc. This is a huge pain and is hard to explain to newcomers becaus it frankly makes no sense.

In 0.3.45 we made it so that the ComposerView always has a non-null draft and session. (It isn't rendered until they're available). In this diff, I just pass those through to all the plugins and remove all the session retrieval cruft.

Almost none of the buttons have state of their own, which I think is appropriate.

They do render on every keystroke, but they were already running code (to recompute their state) on each keystroke and profiling suggests this has no impact.

Prepare for immutable

In preparation for Immutable models, make the draft store proxy returns a !== draft if any changes have been made. This means you can safely know that a draft has changed if `props.draft !== nextProps.draft`

Test Plan: Run tests

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D2902",False
7e3e3a6015aa33e2f5675576bfec1b1b554b81a7,2016-04-20 00:24:15,Evan Morikawa,"tests(calendar): adding calendar and scheduler tests

Summary: Adding tests

Test Plan: Tests

Reviewers: juan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2892",False
237bad59d86ec9c11e1970ec4e262d672f5c6f89,2016-04-20 00:02:33,Ben Gotow,"feat(unread/spam): New items in the sidebar for unread and spam

Summary:
Adds a new unified ""Spam"" folder and a unified ""Unread"" view,
which shows all the messages in your inbox which are unread.

Test Plan: Run tests

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2901",False
0e2a875f4d3db46234999c9cd63b892ad22ac740,2016-04-19 05:09:08,Dakota Nelson,Expose ParticipantsTextField through component kit (#1994),False
ea22bde230bbb127c1f5d669e5516583663d6210,2016-04-16 04:35:54,Ben Gotow,"fix(default-alias): Show primary email instead of ""None"", clarify only for new messages currently",False
40ca7587664e24e69f0758afd189236a00ffe061,2016-04-16 00:00:13,Ben Gotow,fix(default-client): Set initial state to fix React warning,False
93131a11c72f5adc04af882a74ec8b2a6e7ca43c,2016-04-15 03:06:51,Ben Gotow,"fix(Inbox): Allow shift-J, shift-K to select threads",False
244a28dffabdf8df091d67ba9ad393b06c44f9d4,2016-04-15 03:03:43,Ben Gotow,fix(related-threads): Show snippet in addition to subject #1683,False
9b34ce73ec6910449214b08d71415e193113b3aa,2016-04-15 02:38:46,Ben Gotow,"fix(Gmail): Allow shift-J, shift-K to select threads",False
6f2329a169e683dbe4f4241d367f21c5dea374a6,2016-04-15 02:33:57,Ben Gotow,fix(view-on-github):  Add readme and fix bug,False
46cc73816ecff5423ecb7557fb768b171b4ccbe9,2016-04-15 02:04:46,Ben Gotow,fix(star): Change action from Star All => Star #1927,False
67d28d4e592b36794163c24867df8b35e75587c9,2016-04-15 00:59:08,Ben Gotow,fix(tray): Don't recreate tray / change image unnecessarily,False
e134483d75b1885a389515978ed70bc3c94a14a0,2016-04-15 00:27:15,Ben Gotow,"fix(lists): Commented out during testing, landed accidentally",False
a6abf801d5ad8776f981653a0fb3045edf5e3718,2016-04-14 06:18:27,Ben Gotow,💄(scheduler): Would you like => I'd like,False
b0fbdf7469cb04eeeb7e66968b0c2c80de984ad7,2016-04-14 06:11:31,Drew Regitsky,fix(onboarding): Add missing return statement when changing endpoints,False
d098c966532beeb9c96a4f464b46a3beb1d7fe4e,2016-04-14 04:43:25,Drew Regitsky,fix(onboarding): Change error notification for endpoint changes,False
5c48464691b1c36e628f301a5748c0f7916537f5,2016-04-14 04:38:24,Ben Gotow,fix(search-bar): Apparently we were not providing keys,False
fe171a0c8c8ec485932619b5f57f064d75ddd762,2016-04-14 04:05:01,Ben Gotow,fix(require): Move more requires to new electron format,False
8e2be2d07606c0e8a7c9702bd932afd00c7b3aff,2016-04-14 03:17:23,Ben Gotow,fix(empty): Use a much faster query for empty perspective,False
a7fbeb015786a14169a303968c973b3211032580,2016-04-14 02:52:43,Ben Gotow,"fix(swipe): Cache isEnabled: false, fix scrolling in Trash",False
bdfa426ecfa2d5f279942f0c2327a242f4719c0f,2016-04-14 02:52:43,Ben Gotow,fix(search): Cannot remove items from search (Sentry 30318),False
cf4cad4cbd1ccca85202815ead5849525f45d8c6,2016-04-14 00:59:39,Drew Regitsky,"fix(api-error): Fix retrieval of `error` field, used for endpoint updates",False
fbc8a66b03bca5b168667120c3498a9e48063591,2016-04-13 22:59:13,Matt Bilker,fix(specs): handle Electron 0.37 remote method calls (#1943),False
217af8d77ca1147950bd7bf60ccf4af955fca851,2016-04-13 07:12:57,Ben Gotow,bump(electron): 0.36.7 => 0.37.5,False
edc4f52da848fb9d70f7eb28b16397f67c5e2e1f,2016-04-13 06:41:27,Koen Punt,"Open links in background when ⌘ key is pressed (#1637)

When you hold down the meta key (⌘), and click on a link in a message,
the target application will not activate, so N1 will stay in the
foreground.
Electron only supports this for OS X",False
8e5f75d8e0999ae689fdb685888f6641300fe2e9,2016-04-13 06:39:13,Matt Bilker,"fix(imports): switch to Electron's require('electron') (#1907)

* fix(imports): switch to Electron's require('electron')

Electron in 0.37.5 phases out the usage of `require('built-in-module')`
in favor of `require('electron').builtInModule`. This commit corrects usage in
some cases that cause N1 to not start under Electron 0.37.5.

* fix(specs): use new Electron remote import",False
cf3422de8d201bdc7d730b0ca169bb639c065974,2016-04-13 06:38:00,Matt Bilker,fix(plugins): expose react-addons-test-utils for spec testing (#1925),False
c460a4f2a485fb308194c3db6954f5ad1ea66764,2016-04-13 06:00:44,Ben Gotow,"perf(require): Don't assume `require` is free, cache deferred imports",False
f396d9eddb7937aa3f2d15aa9cb65e502bdb1c6e,2016-04-13 05:28:45,Ben Gotow,bump(react) 0.14.7 => 15.0.1,False
4cabab5d2af66a303fce387b9c86a56f77261336,2016-04-13 03:21:56,Jackie Luo,fix(composer-emoji): Fix calculation for category positioning,False
d159e1037d8fc1322c3c06d560089b20f9466451,2016-04-13 03:16:03,Ben Gotow,fix(emoji): Improve variable names / diff feedback,False
21a6aff99d3fc2393b9f74a79d5be034e528ee4d,2016-04-13 03:13:46,Ben Gotow,changelog: 0.4.25 release notes,False
f01cb6365f94f7c52bcaf73288f77978a08cd84a,2016-04-13 03:07:14,Ben Gotow,fix(emoji): Don't allow emoji images to be dragged into attachments,False
8613921a55a5e2844f0553e8cf36055a7d2f66d0,2016-04-13 02:59:59,Ben Gotow,"fix(emoji): Re-use img tag to avoid running out of file descriptors

Summary:
On my machine the new emoji picker was causing ""too many open file descriptor""
errors. I think that this was because it was creating 1300 image tags in 50msec.

I refactored this code so that it uses a single image tag and only loads one image
at a time. This could make it slower on some people's machines, but eliminates the
possibility of it breaking the app!

Test Plan: Run tests

Reviewers: jackie

Differential Revision: https://phab.nylas.com/D2878",False
4656fe21d7fc9f1c5de476ade9b1610312022030,2016-04-13 00:33:41,Ben Gotow,"fix(metadata): Add missing joinOnField declaration, assertion",False
8be564cbfbf9e193cac79cf515dce9bd60882670,2016-04-13 00:18:16,Ben Gotow,fix(account-store): Allow updateAccount in all windows,False
96ddd17fc47799dd616dbac5c3de028f9675e7c4,2016-04-13 00:04:45,Ben Gotow,"shrink(emoji): TinyPNG emoji, convert to 32x32",False
3d5fd7510ce3d4c41052b0c86e3a739f86aff58a,2016-04-12 23:13:13,Jackie Luo,lint(utils): Fix linter issue,False
1039ad2c34a1213d5eca421fb674f1ce3f9626df,2016-04-12 22:57:24,Jackie Luo,"fix(composer-emoji): Switch to characters to PNGs (#1898)

* Add PNGs and JSON file

* Add Apple and Twitter emoji

* Fix linter issues and tests

* Get correct path from EmojiStore

* Add emoji regex and update extensions

* Remove the scary regex",False
f53ba0fbbe822ec0b6f5ff29568deb858e565d96,2016-04-12 22:20:32,Ben Gotow,bump(version): 0.4.25,False
436107844d490e329bbf47be86117f2ecbb6910f,2016-04-12 22:20:08,Ben Gotow,"perf(db): Use same subselect for ""related emails"" queries",False
7b03a80d0294960bb90c646589e59d048b56214c,2016-04-12 08:15:36,Evan Morikawa,"feat(scheduler): add an event preview when sending a meeting request

Summary: add event preview

Test Plan: manual

Reviewers: bengotow, juan

Differential Revision: https://phab.nylas.com/D2874",False
f3a872b0c745fa7ae3204775ae17c64a00bf03b2,2016-04-12 07:29:09,Ben Gotow,rm(log): Fix bad log statement,False
c69b192881bcd6973506cbd9dea8d6100ca3629a,2016-04-12 07:22:49,Ben Gotow,"fix(scheduler): Don't cast durations to integers, fix 1.5, 2.5 hour blocks",False
5f75cccc0f0e0b83c3662620345ac4ef7d3a7e28,2016-04-12 07:12:17,Ben Gotow,fix(scheduler): End should work even if the mouse isn't over a time,False
938e9b809367cf35f257b6c5e647800e9d7e0345,2016-04-12 07:03:53,Ben Gotow,fix(scheduler): Make popover width even so it's not blurry,False
f5e5a7ef4c854549ba27d91720f086739a9a0f11,2016-04-12 06:50:28,Ben Gotow,fix(empty): Add padding to empty message,False
ba9d915f00511b6ba9f1fe7524aa3a364d9d4471,2016-04-12 06:37:37,Ben Gotow,fix(scheduling): Enable by default in new installations,False
63343adeac7ae1efa52e917fa7425a110d9e771e,2016-04-12 06:04:52,Ben Gotow,"fix(sync): Handle ""Invalid cursor"" scenario by 💣🔥 away the cache",False
2855c3695f502d83039af35772dfa6198b77b36f,2016-04-12 05:03:27,Evan Morikawa,fix(scheduler): minor style tweaks to scheduler popover,False
66e86d8f80af7caad7f6efc68310f3a31c918fdc,2016-04-12 04:47:58,Ben Gotow,fix(timestamps): Don't crash on null times #1929,False
232f2cbbf5aeea07a167670f46db893f3d1c6aa1,2016-04-12 04:42:05,Juan Tejada,"Revert ""fix(build): Actually make verbose""

This reverts commit 0fd5659aad83571af80273bcf8f0c1c33861d287.",False
0ada532336f3288fb216cd4b68de362ef04624fd,2016-04-12 04:21:17,Juan Tejada,fix(build): Lock spellchecker to 3.2.3,False
0fd5659aad83571af80273bcf8f0c1c33861d287,2016-04-12 04:10:40,Juan Tejada,fix(build): Actually make verbose,False
3658f0e0dac09150e755d4fb19c70ed2a1480925,2016-04-12 03:53:06,Evan Morikawa,"fix(scheduler): fix jumping calendar and add popover

fix(scheduler): fix jumping calendar and add popover

Summary: feat(scheduler): improved calendar picker

Test Plan: manual

Reviewers: bengotow, juan

Differential Revision: https://phab.nylas.com/D2873",False
319667342d4f47689b04a4a8f1d626f68595b399,2016-04-12 03:50:31,Juan Tejada,update(build): Add verbose flag,False
cec811ae3624e0226c78c816339359c1ca8e1268,2016-04-12 03:28:58,Ben Gotow,fix(schedule): Move z-indexes to prevent dropdown layering issue,False
25349295dc80342d0dba07d2f8c98399cc66a440,2016-04-12 03:02:54,Ben Gotow,"fix(schedule): Use draft session to udpate metadata, always save in syncback",False
ebc0072bfc7ec5744be15ccd823b2b29442a64ae,2016-04-12 02:21:58,Ben Gotow,fix(db): Don't blow up over table SCANs with covering indexes,False
f7bfb2aceb155ac03c3298116bad9681b799b890,2016-04-12 02:21:31,Ben Gotow,fix(db): Counts no longer require Thread table join,False
b75ed6f920eff79ee853c0711f79dcda2de0a0dd,2016-04-12 01:59:05,Ben Gotow,"perf(db): Use subselect to improve thread list query perf (53%!)

Summary:
- Use a sub-select query with much better performance to display the thread list
- Perform analyze on tables after launch

The new query is:

```
SELECT `Thread`.`data` FROM `Thread` WHERE `Thread`.`id` IN (SELECT `id` FROM `ThreadCategory` AS `M26` WHERE `M26`.`value` IN ('9m9ks71k06n5rmx82kgues09p','9s9k25q6j1krjgpkovbcjm7d','13b7ufruoymvih07ki0uahlto','dtmhlzz6phr47zp512knhjgf8','16dvjb84bszfh15kgfrjj37i3','aclwmgncdqjfibp51bvgbeik','17qad7jhbp6tozog3klm5zagt','4x4bkbawiq825u4eu3aus8tll','7axr9f5f1lzpwm2rw2ghkirhq','dsnn660af0pmou2gg3nstga8a','361qr5rva1ieby2r0ec3sn0bm','10fyvba7pjyjgeyr5i65i1zri') AND `M26`.`in_all_mail` = 1  ORDER BY `M26`.`last_message_received_timestamp` DESC LIMIT 200 OFFSET 0) ORDER BY `Thread`.`last_message_received_timestamp` DESC;
`
0|0|0|SEARCH TABLE Thread USING INDEX Thread_id (id=?)
0|0|0|EXECUTE LIST SUBQUERY 1
1|0|0|SCAN TABLE Thread-Category AS M26 USING COVERING INDEX ThreadFancyIndex
1|0|0|EXECUTE LIST SUBQUERY 2
0|0|0|USE TEMP B-TREE FOR (only on 200 result items)
```

Which is twice as performant as:
```
SELECT `Thread`.`data` FROM `Thread` INNER JOIN `ThreadCategory` AS `M26` ON `M26`.`id` = `Thread`.`id` WHERE `M26`.`value` IN ('9m9ks71k06n5rmx82kgues09p','9s9k25q6j1krjgpkovbcjm7d','13b7ufruoymvih07ki0uahlto','dtmhlzz6phr47zp512knhjgf8','16dvjb84bszfh15kgfrjj37i3','aclwmgncdqjfibp51bvgbeik','17qad7jhbp6tozog3klm5zagt','4x4bkbawiq825u4eu3aus8tll','7axr9f5f1lzpwm2rw2ghkirhq','361qr5rva1ieby2r0ec3sn0bm','10fyvba7pjyjgeyr5i65i1zri') AND `M26`.`in_all_mail` = 1  ORDER BY `M26`.`last_message_received_timestamp` DESC LIMIT 200 OFFSET 0;

0|0|1|SCAN TABLE Thread-Category AS M26 USING COVERING INDEX ThreadFancyIndex
0|0|0|EXECUTE LIST SUBQUERY 1
0|1|0|SEARCH TABLE Thread USING INDEX Thread_id (id=?)
```

Test Plan: Broken!

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2869",False
ded1b657d33a106250a08a6439a665b11e3b7eba,2016-04-12 01:45:59,Juan Tejada,"fix(thread-list): Prevent empty state from showing when loading list

- EmptyState should only be displayed when the thread-list is actually
empty, not while it is being loaded
- Update ObservableListDataSource to have a state of loaded only when
the requested range is > 0, i.e. when we are actually requesting threads",False
5e4eea2fa268b5313ef342a740e92d5f58f4b21f,2016-04-12 00:31:47,Ben Gotow,bump(version): 0.4.24,False
7183918ab2ac8e10ead274e6e470c430829508ae,2016-04-11 23:18:16,Ben Gotow,fix(auth): Fix missing var. This is why we should go ES6!,False
d9517101d5306d4101353f13030b66357a9c28d1,2016-04-11 20:29:40,Juan Tejada,fix(perspective): Fix specs for FocusedPerspectiveStore,False
92268ad099005454362a13aac7a69b3a7006f25e,2016-04-11 13:13:06,Ben Gotow,fix(initial-sync): Fix sync sidebar showing all the time,False
7a7272eae8d785742fb0b1c02174955a2616ee39,2016-04-11 13:13:02,Ben Gotow,"fix(perspective): Just wait for first CategoryStore trigger to load perspective

The FocusedPerspectiveStore wants to restore a saved current perspective from disk. It needs to wait for the categories to be ready, but it doesn't necessarily need to wait for them to be synced, because it's unlikely unsynced categories are in the saved perspective and it just falls back to unified inbox.

I think there was some dead code in `_onCategoryStoreChanged` that initialized the perspective also, so I merged the two",False
ca9162a2d5206b16cec7a410f70af1c6d63c23b4,2016-04-11 06:01:54,Ben Gotow,bump(version): 0.4.23,False
e160d05d362ea6a0c58ad0cc28287d6733881446,2016-04-11 05:07:33,Juan Tejada,fix(deps): Add moment-round,False
aef785eb12da4bc0aae5db26ea7216d329baa639,2016-04-11 04:50:26,Juan Tejada,"feat(thread-search): Add spinner to indicate search in progress

Summary:
- This diff also restructures the search package in a few ways:
  - Rename package to `thread-search` instead of `search-bar`
  - Move SearchQuerySubscription and SearchMailboxPerspective inside
  package. This allows SearchQuerySubscription to have access to
  SearchActions in a clean way and keeps all of the search related code
  in 1 package
  - Remove SearchMailboxPerspetcive from mailbox-perspective.coffee
- Adds temporary spinner while we get a new design for it

Test Plan: - TODO

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2868",False
286664341b2ac5e3e6d4bab9776e55d0425e2b08,2016-04-10 21:14:24,Evan Morikawa,fix(scheduler): use proper start and end time formats for when block,False
0cc3f32d8eea75b01119314f77aa02aa84e5a36b,2016-04-10 07:37:50,Evan Morikawa,fix(spec): fix bad ref,False
68bb96e83f3a508314739e42c79cbb453c46e9f7,2016-04-10 07:17:52,Evan Morikawa,fix(scheduler): properly formatting when objects for post,False
16e133139315cd975bf6b8ee4151e2dac9f33381,2016-04-10 06:55:01,Evan Morikawa,fix(scheduler): properly set proposals,False
a1b5a232734296dad9526730b1723896350ff025,2016-04-10 06:49:01,Evan Morikawa,"refactor(scheduler): move all event data into metadata

Summary: Moved events into metadata. Removed a lot of code

Test Plan: todo

Reviewers: juan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2866",False
f316c06f7a655edf56bcc03dd6dc41199d8d2399,2016-04-09 04:33:21,Ben Gotow,fix(specs): *,False
b10942a4b3cec205260d029f2c464c021cd7b40f,2016-04-09 02:41:32,Juan Tejada,"update(search): Add search usage reporting + other fixes

Summary:
- Converts SearchQuerySubscription to ES6 to fix method overriding for
  `removeCallback`
- Reports different usage metrics for search
- Removes unecessary data source listener iniside ThreadListStore:
  - This listener focused the first thread on the list, which is
  actually unwanted (#1461)
  - It prevented QuerySubscriptions from being disposed promptly because
  of the remaining listener. They qould only be disposed until the
  subscription triggered once, which is not actually desired behavior
  (e.g. for SearchQuerySubscription)

Test Plan: - Manual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2864",False
c6e24ce9486aa61ad60e8c185b3feae6e9c7f7ac,2016-04-09 02:22:26,Ben Gotow,"fix(sync-errors): Improve display of sync errors and offline status

- Make the retry interval go 2 sec, 3.4s, 6 sec...
- Only show the connection status bar if the interval is > 5 seconds, in case the error was temporary.
- Do not show sync errors in the sidebar. The only available action is ""Try Again"", and we try again on our own. The error is frustrating and the user can't do anything about it anyway.",False
2edc2e5c32237d6a4cd8e3e4cb031ff0b90f88d8,2016-04-09 00:30:03,Drew Regitsky,"feat(auth): Provide reauth param to handle changed server endpoints

Summary:
Notify the backend when auth is a reauth of an existing account by
providing the `accountId`. This lets the backend differentiate between
a new auth (where a new account will be created if the server endpoints
don't match) and a re-auth (where the auth will fail on server endpoint
mismatch, prompting the user).

Test Plan: manual

Reviewers: juan, evan, bengotow

Reviewed By: bengotow

Subscribers: mg, spang, kav-ya

Differential Revision: https://phab.nylas.com/D2833",False
5d96fb227f7a00e612b09be96ed045b74a6854f4,2016-04-09 00:17:12,Juan Tejada,"feat(search-streaming): Add support for new search streaming api

Summary:
- This diff includes code to connect to the new search stremaming API. It converts the old NylasLongConnection into ES6 without any of the cursor management and includes it as part of NylasAPI
- Removes current search error handling because of the new error semantics of the api. If no results are returned a message will be displayed to the user indicating that
- WIP TODO:
  - Replace old NylasLongConnection class with new one and add test coverage.
  I did not replace our  current streaming code with the new ES6 code yet because
  the old code doesn't have test coverage and I don't want to introduce any
  (subtle) regressions to a vital piece of the app.
  - Potentially replace with JSONStreaming library or new http library
  (e.g. fetch)

- Note that Streaming API is not in production yet and only works for Gmail and IMAP (no EAS)

Test Plan: -TODO, manual

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2859",False
3d00837c4a1b24a7958460c4d464d6ad26b6b192,2016-04-08 06:32:04,Ben Gotow,fix(autoscale): Apply vw when width and height are not present,False
d75e7e7facf075e953d056622a46c5acf7585877,2016-04-08 04:01:55,Juan Tejada,fix(search): Escape single quotes correctly,False
6bc42a10dc77e7ffefc238ac4b104023fdf4668b,2016-04-08 03:44:33,Evan Morikawa,"feat(scheduler): better time picker

fix(scheduler): time picker fixed",False
199a900ac158051aa0c4e78c0df9790dd8f010aa,2016-04-08 03:02:51,Jackie Luo,:art:(preferences): Change spacing and button sizes,False
08792f00bd94e8da4a3d40f3b23b278765501ec7,2016-04-08 02:44:20,Ben Gotow,"💄(prefs): Shrink top tabs better, add min-widths",False
37add7741e2f5e6eaabacd5dd46df4de405ad3a2,2016-04-08 02:44:20,Ben Gotow,bump(version): 0.4.22,False
fc2b178d6e42216d50e918fdddfbbbf6c06c8710,2016-04-08 02:42:35,Jackie Luo,:art:(preferences): Adjust textbox styles for signatures and templates,False
e61424b7a52fa362cfd95cb65739f7897abf5440,2016-04-08 00:48:37,Evan Morikawa,fix(tracking): uid uses draftClientId,False
76ccab606e7543fb0e86a9588995c29e81d82211,2016-04-07 22:27:53,Juan Tejada,fix(search): Escape search query properly,False
c0d99153180b4fb6ea14375f6d639c9eaf020119,2016-04-07 22:27:53,Juan Tejada,fix(contact-sidebar): Don't render <select> when no contacts available,False
a2a3e8af3cc23f78d6f312db9fffdcc223f963f4,2016-04-07 22:27:29,Juan Tejada,"feat(thread-search): Make thread search indexing smarter

Summary:
- When accounts change, make sure sync has completed, and only add or
remove threads from the index based on accounts that were added or
removed instead of rebuilding the entire index from scratch

- When thread is updated, make sure to only update the index for threads
that belong to accounts that are not currently in the sync process

- Add more logging and docs

Test Plan: TODO

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2852",False
ba0251fd7ec9ec6d8365c459acd42ce15e171b65,2016-04-07 04:45:46,Ben Gotow,lint(*): Fix linter errors from QA fixes,False
4329f53ce8f946602cee40ffb4d2a39030050b40,2016-04-07 03:21:17,Ben Gotow,fix(fwd): Do not mention Bcc'd recipeints in forward headers #1873,False
15eafa7c553409bd5c09bef77b985d571ae47909,2016-04-07 02:59:28,Ben Gotow,fix(autolinker): Additional test case from #1863,False
f98fedadc01b771bf78ee7d67c845ced6619f615,2016-04-07 02:47:10,Ben Gotow,"fix(autolinker): Add test cases, .ly, url hash chars",False
25b896ccbbff44b745a7c8953dd8609f62d8b7ed,2016-04-07 02:39:51,Evan Morikawa,fix(scheduler): can scheduler on 30 min intervals,False
5311ab6b34ec1f6e6944f506464c6123788a11a4,2016-04-07 02:29:24,Evan Morikawa,"fix(scheduler): removes proposals from metadata when removing event

Also add <tbody> tags",False
5140cf5f07c2f99ca707eb807f3aa53d64879040,2016-04-07 02:29:24,Evan Morikawa,fix(scheduler): can remove proposed times,False
0d4fe7e5e52e7b9bdfaac0e158e1fb18e6b44699,2016-04-07 02:29:24,Evan Morikawa,fix(scheduler): fix time bar scroll height,False
0aa8aeb70ffa5abd634887fd657096c3402d7439,2016-04-07 02:29:24,Evan Morikawa,fix(calendar): today correctly jumps to this week,False
6b2d8203168306e6d7d02f26c9c4654e8c8832c1,2016-04-07 02:29:24,Evan Morikawa,fix(scheduler): fix top banner,False
2226e85e657b69b30d15c396a2aedbd7c47cedcd,2016-04-07 02:24:39,Ben Gotow,"fix(cc/bcc): Make targets bigger, wait longer before declaring focus left",False
db79e4d48a6760af1e7fe299e56b61c472f84de1,2016-04-07 02:24:39,Ben Gotow,"fix(composer): Do not steal focus when it is in other components

This is to fix a bug where changing the ""from"" address to an address with a different signature caused the composer to become focused, hiding the from field.",False
53fb45aec5be1dc8954f2e80d667e744bc01310e,2016-04-07 01:38:44,Jackie Luo,:art:(preferences): Update styling,False
5c2ee75026cff16402331707c9692313ac89ba69,2016-04-07 01:05:30,Ben Gotow,"fix(*): Minor CSS fixes, open tracking fix when only message is draft",False
5f044c22bcc2d2534877a54b16cf9c03cf7bd421,2016-04-07 01:05:30,Ben Gotow,fix(error): Show actual API domain in connection error bar,False
2dbd1a0914ddb06082321b80e7b12049c97ddc40,2016-04-07 00:36:27,Jackie Luo,fix(composer-emoji): Fix tabs to scroll correctly,False
7b3d773c842bf7c38954408fb908684b63901533,2016-04-07 00:20:21,Evan Morikawa,fix(schedule): extracted to own SyncbackDraftEventsTask,False
0086142a883ee13f9b1503ca24b2abe1d1bf50b3,2016-04-06 07:47:13,Ben Gotow,bump(version): 0.4.21 beta,False
1476764d0007448d1f8c196d1e97f4fc6a9d3088,2016-04-06 07:46:58,Ben Gotow,"fix(mail-rules): Only process inbox, never skip threads

Summary:
- Disable processing button while already processing
- Only process mail in the inbox in bulk reprocess task
- Advance through mail using ""after X"" rather than ""offset X"", avoiding the issue where mail can be deleted as you're advancing.

Test Plan: Run existing tests

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2847",False
a84b95359c9df84c1200b44fad55ae8877d39334,2016-04-06 07:33:47,Ben Gotow,fix(db-spec): Accompanying spec changes,False
9eea7f52b91d082c2b43f0ce1857a49ecb4f590d,2016-04-06 07:12:19,Evan Morikawa,"feat(scheduler): add new date & time picker

Summary: Adds a date and time picker to the new event creator

Test Plan: todo

Reviewers: bengotow, juan

Reviewed By: bengotow, juan

Differential Revision: https://phab.nylas.com/D2842",False
f6b24c77ce6733710c6a45ab06e346d865d150f6,2016-04-06 07:02:38,Ben Gotow,"fix(db): Always refresh entire range after unknown changes

Summary: When changes can't be accurately applied to a result set, always refresh the entire range, not just the missing range. This ensures that additional changes being applied while our query is in flight can't cause the result set to include the same item twice.

Test Plan: Run tests

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2846",False
b03e560e300f85527e681d018957ee76678e01da,2016-04-06 06:29:48,Juan Tejada,"fix(drag): Pass correct drag coordinates from event

- Don't use magic event variable without declaring it",False
b0768d337d5b78cd889499df619ba27dd4cac365,2016-04-06 04:45:47,Ben Gotow,perf(*): Make AccountStore / ContactRankingStore less noisy,False
d047cae9ba11dada7ff64a2cc9f14146a07ef77a,2016-04-06 03:49:53,Juan Tejada,fix(scheduler): Fix moment-timezone require,False
695c1e64f36159a1a53a3977f6d66a54e452213f,2016-04-06 03:27:51,Evan Morikawa,fix(scheduler): import from moment-timezone,False
a35d8605d295e61fc28029a5501febbc448dfab0,2016-04-06 03:23:37,Juan Tejada,fix(sync-status): Fix bug caught by specs,False
fc255873de87dea44bc0e9dff45d4700228085bf,2016-04-06 03:23:37,Juan Tejada,fix(react): Fix several warnings in missing imports,False
afd830435976cf68636f1de8756555ac5e4cf427,2016-04-06 02:57:54,Ben Gotow,fix(quoted-text): Correctly update container height,False
e58014a4781697901090fc275562112b726af48a,2016-04-06 02:46:24,Ben Gotow,fix(collapsed-participants): Resize in correct scenarios,False
7d2bf7bed5b66c9e143c3ebf4c88567e4912a707,2016-04-06 02:34:10,Juan Tejada,"fix(sync-status): Actually fix sync status logic

- Must take into account that some accounts have `labels` and others
have `folders`",False
cef7809bd64044c77ca1367d5db31fb06a22e745,2016-04-06 02:13:43,Jackie Luo,fix(theme-picker): Reformat invalid class names,False
eb1f9409ef6331b2421a7873cb4a972334756ceb,2016-04-06 01:59:25,Juan Tejada,"fix(sync-status): Fix logic for checking sync status:

- Only check sync status keys that belong to actual models being synced
- Return false if state object is empty",False
79e15e840822048a01ec9b9134aa5a62f5906c25,2016-04-06 01:59:25,Juan Tejada,fix(thread-search): Correct typo,False
792c0e61f1debe51a6c9d33e3275b76a028dc9d9,2016-04-06 01:40:39,Ben Gotow,"fix(notifs): _.reject does not support dict, Sentry 26699",False
e311f0cb61bb8e8dded133417b87b301afc1a25c,2016-04-06 00:57:33,Ben Gotow,fix(update): Initial autoupdate placeholder for linux,False
f08d59bca2dc66a88b5221229d29285c66814f7b,2016-04-06 00:46:32,Juan Tejada,fix(warning): Add key to react component,False
b445f098541bae8df1732176353baf6234ee01a9,2016-04-06 00:46:32,Juan Tejada,fix(thread-search): Only rebuild index when # of accounts has changed,False
ca5caec97ec3ca8d2b4de78f2ad65363dd04c4b7,2016-04-06 00:39:40,Ben Gotow,fix(from): Align from icon correctly,False
427a743b1854af70fed3e0dd9f1720cb6dd6bfee,2016-04-06 00:31:53,Ben Gotow,"fix(mail-rules): all ""on"" handlers need to be bound functions",False
954ef4ce89e29f5c12c95b99e876ed2182048fcb,2016-04-05 23:58:08,Juan Tejada,fix(prefs): Fix `this` binding in mail rules prefs page,False
2d8f3ec2b08ff41890973044610962c133aba698,2016-04-05 23:44:26,Juan Tejada,fix(sync-status): Ignore keys that arent models when check sync status,False
0b4127bc4b3a5284af34f3ba0d59817b94328895,2016-04-05 07:00:50,Ben Gotow,"fix(composer): Show when rendered, send draft JSON to composer windows",False
227f3345a01f6698153914cf87d3e153993881d1,2016-04-05 06:14:45,Ben Gotow,"fix(db): Remove `-` from table names, which was a bad idea",False
17a629cf6a411434c4a6962f68ef5040817f2b5b,2016-04-05 05:56:48,Ben Gotow,bump(version): 0.4.20 beta,False
8a1aa6e9bb3e6914c279a313537b70b6b95682f5,2016-04-05 05:45:19,Juan Tejada,"feat(thread-search): Add client side search

Summary:
This diff includes several updates:
- Update sqlite version to use FTS5
- Adds new methods to DatabaseStore to create and update Search Indexes
- Currently indexing subject, participants, and thread message bodies or snippets if the body is not available
- Update initial sync to fetch 5000 message bodies per account
- Adds a new SearchMatcher
- Add new thread-search-index package to run in the worker window to
  init and keep thread search index up to date
- Converts Thread to ES6

TODO:
- Remove/Update suggestions dropdown
- Add tests

Test Plan: - TODO

Reviewers: evan, bengotow

Reviewed By: evan, bengotow

Differential Revision: https://phab.nylas.com/D2826",False
79b365e930e13d893ca10eb0b45da10df27f779d,2016-04-05 05:42:59,Ben Gotow,fix(lint): Missing const breaking build,False
a3ede94423a03de7439c05885e4c2aa627a176b8,2016-04-05 05:41:09,Ben Gotow,"feat(offline-status): Show a bar when not connected to the API

Summary:
The TaskQueue does it's own throttling and has it's own processQueue retry timeout, no need for longPollConnected

Remove dead code (OfflineError)

Rename long connection state to status so we don't ask for `state.state`

Remove long poll actions related to online/offline in favor of exposing connection state through NylasSyncStatusStore

Consoliate notifications and account-error-heaer into a single package and organize files into sidebar vs. header.

Update the DeveloperBarStore to query the sync status store for long poll statuses

Test Plan: All existing tests pass

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2835",False
2ea0c3b0787b987c6012f3852463721debfdf28f,2016-04-05 04:36:48,Evan Morikawa,fix(scheduler): add timezone & fix tabbing,False
f1c0a1615d39e5dd630611dd13b73370cf3842ef,2016-04-05 03:52:01,Ben Gotow,"fix(focus): Remove focusedField in favor of imperative focus, break apart ComposerView

Summary:
- Removes controlled focus in the composer!
  - No React components ever perfom focus in lifecycle methods. Never again.
  - A new `Utils.schedule({action, after, timeout})` helper makes it easy to say ""setState or load draft, etc. and then focus""
  - The DraftStore issues a focusDraft action after creating a draft, which causes the MessageList to focus and scroll to the desired composer, which itself decides which field to focus.
  - The MessageList never focuses anything automatically.
- Refactors ComposerView apart — ComposerHeader handles all top fields, DraftSessionContainer handles draft session initialization and exposes props to ComposerView
  - ComposerHeader now uses a KeyCommandRegion (with focusIn and focusOut) to do the expanding and collapsing of the participants fields. May rename that container very soon.
- Removes all CommandRegistry handling of tab and shift-tab. Unless you preventDefault, the browser does it's thing.
- Removes all tabIndexes greater than 1. This is an anti-pattern—assigning everything a tabIndex of 0 tells the browser to move between them based on their order in the DOM, and is almost always what you want.
- Adds ""TabGroupRegion"" which allows you to create a tab/shift-tabbing group, (so tabbing does not leave the active composer). Can't believe this isn't a browser feature.

Todos:
- Occasionally, clicking out of the composer contenteditable requires two clicks. This is because atomicEdit is restoring selection within the contenteditable and breaking blur.
- Because the ComposerView does not render until it has a draft, we're back to it being white in popout composers for a brief moment. We will fix this another way - all the ""return unless draft"" statements were untenable.
- Clicking a row in the thread list no longer shifts focus to the message list and focuses the last draft. This will be restored soon.

Test Plan: Broken

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D2814",False
7d9d7ff0f8e7b4aa63ec4ce86d0b253e7d4e7fff,2016-04-05 03:50:25,Evan Morikawa,fix(console): remove log,False
902526eafc2da2fce410624587fdb09045bb08fb,2016-04-05 03:47:50,Evan Morikawa,fix(react): replace with ReactDOM,False
39c37e10b9a274678760ea74939d2f9ea110b5aa,2016-04-05 03:35:48,Evan Morikawa,"feat(calendar): add week view for quick scheduler

Summary: New Calendar

Test Plan: TODO

Reviewers: drew, juan, bengotow

Reviewed By: bengotow

Subscribers: jackie

Differential Revision: https://phab.nylas.com/D2767",False
3cf2570561373209ec64cc3a197f3aa0ada2ce66,2016-04-04 23:33:52,Jackie Luo,fix(composer-emoji): Replace images with Unicode characters properly,False
4a1c068c297c3f762f1816b289e8a55c6b7f2fac,2016-04-03 02:10:24,Jackie Luo,"Merge pull request #1861 from jamiewilson/darkside

(darkside) correcting window buttons, adding input focus",True
57ee77c982967f1c2998b41f46d633d2d392e79a,2016-04-03 01:32:26,Jamie Wilson,"correcting size of window contol buttons
This addresses issue #1687 on nylas/n1",False
056cabb7f1a39bf18d5a05198414612966913db3,2016-04-02 03:20:56,Jackie Luo,:art:(preferences): Darken tab icons during click,False
e12d901e627a75eb8755e9e01ee0fec92373a83d,2016-04-02 03:19:15,Ben Gotow,fix(thread-list): Constrain details width to ensure attachment icon visible. #1858,False
df7cd90c4a4a0c846dd30f3e3d2096fe70d3258b,2016-04-02 03:00:43,Jackie Luo,fix(templates): Convert to ES6 and allow creation of new templates,False
45ef25fc028058138ecd026bfef1dcf3dfb045df,2016-04-02 02:31:26,Jackie Luo,":art:(preferences): Updates preferences to look prettier

Summary:
Adds new redesigned preferences with horizontal tab bar and refactored code.

Converts Preferences, Plugins, and a few components to ES6.

Test Plan: Tested locally.

Reviewers: evan, bengotow

Reviewed By: bengotow

Subscribers: juan

Differential Revision: https://phab.nylas.com/D2818",False
c1a06e6bcd45db8c083825d6d3fe324f84f96138,2016-04-02 01:35:53,Ben Gotow,fix(mailto): Never launch the default app to handle mailto,False
280e77c7968b8e1d04c154c928cc9f8b7ac3e2ec,2016-04-01 06:44:11,Jackie Luo,spec(composer-emoji): Fix specs for popover,False
d47d8deda0e8869905877f00b428e2ea326be240,2016-04-01 05:38:21,Ben Gotow,Merge branch 'pr/1797',True
1499e4f1add156b0fcca6c51f749537ea71ff3f2,2016-04-01 05:38:08,Jamie Henson,Update README.md,False
14aaf629daf89023daeae9b4b574e65bfd984218,2016-04-01 05:36:34,varlesh,Add link for Arc Dark theme,False
c836310fac42296be48b57870b3d3c0d75aced2b,2016-04-01 05:06:23,Ben Gotow,fix(autolinker): Update regexp to handle reported failure cases,False
74a65bb9c1f3e2871c689f8ddb435acda2ff47c2,2016-04-01 04:40:09,Juan Tejada,fix(build): FIx linting and react errors and popover spec,False
7c8e31486e6e313bc70f3eb10a55359c48773c18,2016-04-01 03:46:22,Ben Gotow,fix(sqlite3): Specify the platform in the binding target directory,False
0211304f1a81d6478d3a82726f81506fee4c6ec1,2016-04-01 03:46:22,Ben Gotow,"fix(inline): Use `vw` for max-width, use DOM rather than regex",False
d49c205dc8d3b057c37cda32f614be48cc31c556,2016-04-01 03:46:21,Ben Gotow,"fix(inline): radial progress, merge body with download data on render",False
06feced278fc7c731fd6df4b7185fcff3dd44c52,2016-04-01 03:24:46,Jackie Luo,"spec(composer-emoji): Add tests for emoji popover

Summary: Adds tests to check that emoji popover is inserting emoji correctly and adding PNGs as expected.

Test Plan: Tested locally.

Reviewers: evan, bengotow, juan

Reviewed By: juan

Subscribers: juan

Differential Revision: https://phab.nylas.com/D2810",False
937aafbe65cd28d16b44f38094a7319e7c26241b,2016-04-01 01:53:12,Juan Tejada,"feat(popover): Add popout animation to popover

Summary:
- Adds popout animation to popover
- Fade out animation is pending

Test Plan: - Manual

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2807",False
c71f4e28d26367c5baeeb4b00390962cdb200161,2016-04-01 00:34:41,Jackie Luo,:art:(theme-picker): Fix oval close button,False
ff08f73f31fa18caceae7f3437cec0422ef43310,2016-03-31 04:22:51,Jackie Luo,:art:(scroll): Fix UI issues in theme picker/emoji picker,False
2613aa083dbaabcec559fa0678397a578e036666,2016-03-31 01:47:32,Jackie Luo,fix(readme): Add closing parenthesis :disappointed:,False
24f589c57f3f365b31b080fbd37151ff47fbec9a,2016-03-31 01:44:55,Jackie Luo,update(readme): Move Ubuntu to bundled themes,False
886328ff7a24b4baf51c6621b80a1fd63446083d,2016-03-29 14:13:12,Ben Gotow,"bump(react): 0.13.2 => 0.14.7

Great breakdown of React changes here:
https://github.com/facebook/react/blob/master/CHANGELOG.md#0140-october-7-2015

Due to deprecation warnings, I don't think this will break third-party extensions unless they were doing really bad things.",False
83aebd99d1b7622c609a473dd45cf7d7f0ec2753,2016-03-29 04:48:41,Jackie Luo,fix(composer-emoji): Render emoji characters on Windows/Linux,False
6406b8714ba80a0ac3298844126d97d59a4ce989,2016-03-28 23:19:47,Jamie Wilson,applying accent color to focused inputs,False
ab20c51bf0cf486671da1e253d924d7b9fcc44f1,2016-03-28 23:19:13,Juan Tejada,"fix(animations): Rename animations to use always lower case

- Fixes issue were folder got commited with wrong name because of git
  ignore case config
- #1829",False
0f8725a7473acc35cdc229b80116a7fc522d0465,2016-03-28 04:21:27,Jackie Luo,:art:(themes): Tweak Taiga to feel more native,False
d8459bb2cd00b19a21c049e38aa79a71e997730a,2016-03-28 04:21:27,Jackie Luo,fix(thread-list): Show emoji in bolded subject lines,False
0d2a6a526487c5c3c8321335ae4af9b0c4bc6820,2016-03-26 06:19:33,Juan Tejada,fix(empty-states): Adjust margins for message correctly,False
2949b66a7a92aaa562fe91feae8ff56688bb8f25,2016-03-26 03:31:14,Ben Gotow,"Merge pull request #1826 from Eldorado234/patch-1

Typo",True
4e878b97bd8fdd43c81e525964c23d3eb0149a14,2016-03-26 03:03:12,Simon Seyer,Typo,False
88c5de4f2bf2613f34f76bbd6df27dd55e1baf97,2016-03-26 02:30:55,Juan Tejada,update(open-tracking): Only display icon when last message has metadata,False
1efa7ffaca29ba55d81ae54b63b187a1adeb684b,2016-03-26 02:30:55,Juan Tejada,"Revert ""fix(open-tracking): Make sure icon only shows in sent perspective""

This reverts commit 5c0b88d25825027c513a4c9095eeba14e2e6d16c.",False
457e06818837c3edee6239994a9405e9effb4fdd,2016-03-26 02:05:32,Jackie Luo,fix(composer-emoji): Only show replacement PNGs for OS X,False
5c0b88d25825027c513a4c9095eeba14e2e6d16c,2016-03-26 01:07:42,Juan Tejada,fix(open-tracking): Make sure icon only shows in sent perspective,False
53a38c84a65128de119c4cc8b44d16bbad2cc708,2016-03-26 01:00:08,Juan Tejada,fix(empty-state): Remove z-index to allow undo toast to work,False
51e98076c73e46f61b262a9b7e9977257885587f,2016-03-26 00:51:41,Juan Tejada,fix(empty-state): Update animation assets,False
52ed1119a02c94c3459e82c4fc48de1f1a00e71d,2016-03-26 00:46:43,Ben Gotow,bump(version): 0.4.19 and changelog,False
aaaf153993435600b8b87a8421557569c8e1db03,2016-03-25 23:26:49,Juan Tejada,"fix(empty-state): Limit scaling factor for animation

- Fix display: none in css",False
a280d5fdbf859fcce90e25e237ef24a68f60fa60,2016-03-25 23:18:32,Juan Tejada,fix(styles): Remove unused style in empty-state.less,False
8e133a065ae6c6a5552f1a1add78b8701b3c6c41,2016-03-25 23:16:32,Juan Tejada,"fix(empty-state): Make sure inbox zero /always/ animates

- Animation plays on mount, so always unmount the empty state component instead
  of hiding it.",False
c2cf2f42276d3cfc378fe6c1c10851bab7a0b99e,2016-03-25 22:35:17,Juan Tejada,fix(tray): Re add old icon assets for tray icon for win32 and linux,False
e56f866551c12e4e195380849061d28384d0b689,2016-03-25 22:26:02,Juan Tejada,"feat(inbox-zero): Adds inbox zero animations and empty states

Summary: Adds inbox zero animations and empty states

Test Plan: Manual

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2801",False
324296eb1ca562f21acec0efc7bd9a5337099532,2016-03-25 08:05:24,Ben Gotow,fix(drafts): Use the appropriate account and alias,False
ab587d48ff4de188cc75e3455c0e6c3d241253db,2016-03-25 08:00:47,Ben Gotow,fix(send): Don't queue an upload task if there are no files,False
59080a6654c29998123bb9c3cd7ae5c0e98713ed,2016-03-25 05:49:43,Jackie Luo,lint(thread-counts-store): Remove semicolon,False
3dc2491af2b2f24676ad4f606c727e9a10fad097,2016-03-25 05:48:50,Ben Gotow,"fix(popover): Add isMounted check, Sentry 20951",False
236e2bfdd55b0a9307b64b177e0192b8df6d7b44,2016-03-25 05:48:50,Ben Gotow,fix(composer): Sentry 9688,False
7c2bd06fbbcd5218f9f023a56d59e696cadc6869,2016-03-25 05:48:50,Ben Gotow,"fix(db): Don't log query plans for SCAN Thread-Counts, which are fine",False
14dff14ac708c50e02ea2716849b4fadcc1ca432,2016-03-25 05:26:49,Jackie Luo,lint(themes): Add import to ui-variables,False
8df402e26fb7c7dcbb30dfb0110c1d97368432d9,2016-03-25 05:23:01,Ben Gotow,bump(version): 0.4.18,False
f0e76db8648359ff5555a71d2a763d7cbbf24d57,2016-03-25 05:18:55,Ben Gotow,fix(counts): typo,False
d78206d4df27e029b192d938ac5c2cbbe769ad93,2016-03-25 05:18:15,Ben Gotow,"fix(counts): Collect metrics about -unread, reset when found",False
7b3018699fdda633a5487b9774019d6ad46cb99d,2016-03-25 05:05:11,Ben Gotow,fix(autolinker): Don't include trailing ? or . in URLs,False
72b0672ac97d6774240e41fb62a6f5f5f0bb7634,2016-03-25 04:49:41,Jackie Luo,fix(themes): Re-add disclosure triangles to Taiga,False
5ef9045d5554f8505194c67361de4cde5b79b113,2016-03-25 04:17:49,Juan Tejada,:art:(selected-stack): Update text color for clear selection btn,False
daeff14a2939e5c9f1e83aef863e5480d14a7aa1,2016-03-25 04:12:05,Ben Gotow,fix(search): Display search API errors in transient notiication bar,False
660d9b6db49531edeec6111f6e841b664f8b84b6,2016-03-25 03:46:43,Ben Gotow,fix(search): Increase search timeout to 45s,False
79977a6336e44ba671b54708b30317c64213372d,2016-03-25 03:44:41,Ben Gotow,"perf(*): Replace _.omit, refresh scrollbar height less often",False
36cda855f7a04b261aeaf8f0a8537c84c43ecc08,2016-03-25 01:02:01,Juan Tejada,"patch(thread-list): Limit number of injected icons in narrow mode to 1

- Update InjectedComponentSet to take a limit for the amount of matching
  components to render",False
3086806446c515f4251a93b039620d0622411436,2016-03-25 00:34:10,Juan Tejada,"fix(specs): Add check when patching Google Inbox keymaps from 07d218d

- This was preventing the specs from running",False
3cdd831e226426c2086a60a192a0b758b5cbb4f5,2016-03-25 00:30:49,Juan Tejada,feat(list): Add `ThreadIcon` injected region to narrow thread-list,False
cff427d710b02f4634d570ab5e0632cd256362da,2016-03-25 00:27:49,Jackie Luo,fix(composer-emoji): Return if no search results are found,False
3544ccf979b22e2cf20c7e03bc378029993cad05,2016-03-24 23:27:12,Ben Gotow,fix(selection): Make the clear selection button a button,False
dcb8478f97a7682e9d7c2b1b5009fb7d6d949196,2016-03-24 23:15:48,Jackie Luo,"feat(composer-emoji): Add emoji button to composer

Summary: The emoji picker allows users to insert emoji to their messages on click. A few emoji that don't render properly in Chromium are replaced with PNGs, both in the composer view and the message list view, but only the Unicode characters are sent in the message bodies.

Test Plan: TODO

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2787",False
454082d4c163eac91be85857f967ad0f30ea2582,2016-03-24 23:12:15,Ben Gotow,fix(undo-redo): Remove initial state check,False
07d218dd6a900903b8583d157a481e51ade70a80,2016-03-24 22:57:27,Ben Gotow,"Merge pull request #1808 from rittbys/master

Changed GoogleInbox to Inbox by Gmail (TEMPORARY PATCH)",True
4d65dbf9bfd5c8869630a77b7ca65b4df762fc61,2016-03-24 22:44:47,Ben Gotow,fix(autolinker): Only match top ten tld's when schme not present,False
52e8e57e4ab2053ac79b2df2a4186e2b0ca7147d,2016-03-24 07:33:21,Ben Gotow,perf(autolinker): Use requestIdleCallback to fix hanging on large bodies,False
b82fccffe5235ac9cf23d466d8e814e6c9ae32ce,2016-03-24 07:14:23,Juan Tejada,fix(date-utils): Fix isPastDate using `moment`,False
2e860f97ec52a2ea0101ba82f2d793e8aa1e1c47,2016-03-24 06:40:15,Juan Tejada,fix(specs): Fix specs for account store token initialization,False
e40f4c58fd33f585d6ed794438c4466659182761,2016-03-24 06:30:46,Juan Tejada,fix(snooze): Correctly display `snoozed until` label,False
3b3f0c0c810d0150e41f9477651e440aca22ebb5,2016-03-24 06:16:24,Juan Tejada,fix(send-later): Close popover in inline composer when msg scheduled,False
d93178893e08e4779fd3e0ad5a4917c0ae5939a7,2016-03-24 06:13:43,Juan Tejada,fix(popover): Reduce animation length to 100ms,False
9a800bf4ef03150b49a333135d77707b65849ffd,2016-03-24 05:46:25,Juan Tejada,fix(styles): Fix styles for attachment and upload items,False
be9c6168403c1a8399b57d94a52fa4cea3737573,2016-03-24 05:31:14,Jackie Luo,fix(composer-emoji): Return null if no matching node is found,False
a8e5d9948ee7d6314ebeeedf8d107a7cc6a07704,2016-03-24 05:18:35,Jackie Luo,fix(composer-emoji): Fix setBaseAndExtent bug,False
412a228ba196831c67b7b5e364ace444aa6d2f4f,2016-03-24 04:32:30,Ben Gotow,fix(mixpanel): Consolidate reply / replyAll actions,False
866de90f746201d708e5c6d53182ae158bedec5c,2016-03-24 04:26:34,Ben Gotow,"fix(tokens): Don't assume that keytar is sync, don't wipe until next save",False
5f559d596cff5465e88fff93595a2a448a4b1ef7,2016-03-24 03:53:13,Juan Tejada,fix(signatures): Fix signature switching between accounts in composer,False
4a8a22e5888d6f9682176c8ee2cfb4bbf6923989,2016-03-24 00:19:47,Ben Gotow,"fix(qs): Handle query subscription errors, => ES6",False
ed1f12d9160bf5cd0e16dd6f728aa7a57a96e555,2016-03-23 07:27:56,Juan Tejada,"fix(attachments): Fix error handling when saving uploads to disk

- Fixes sentry 11705",False
c9c81782c3a4cab5de8c013792995f5c786d78fa,2016-03-23 05:38:54,Dakota Nelson,"Add extensibility in composer recipient chips

Summary:
Allow for injection into the composer's list of recipients to indicate
something about each recipient (i.e. for the PGP plugin, allow an
indicator as to whether or not each recipient has a PGP key
available)

Test Plan: Tested locally

Reviewers: juan

Reviewed By: juan

Subscribers: bengotow

Differential Revision: https://phab.nylas.com/D2761",False
2007ddf0bada9b13744b0d7e5c65e98b291cb44c,2016-03-23 05:07:24,Ben Gotow,fix(attachments): Add warning for ENOSPC as well,False
1e0717b80145969467208cf73437055e70e55c9b,2016-03-23 04:58:36,Ben Gotow,fix(attachments): Present filesystem access errors,False
c265cf0dfac24801e0dd7d11aba3a58f91a807a9,2016-03-23 04:17:51,Ben Gotow,"fix(drafts): Formalize draft factory, add reply ""behaviors"" #1722

Summary:
This diff implements a behavior change described in https://github.com/nylas/N1/issues/1722.

Reply buttons should prefer to focus an existing draft in reply to the same message, if one is pristine, altering it as necessary to switch between reply / reply-all. If no pristine reply is already there, it creates one.

Reply keyboard shortcuts should do the same, but more strictly - the shortcuts should switch between reply / reply-all for an existing draft regardless of whether it's pristine.

This diff also cleans up the DraftStore and moves all the draft creation itself to a new DraftFactory object. This makes it much easier to see what's going on in the DraftStore, and I also refactored away the ""newMessageWithContext"" method, which was breaking the logic for Reply vs Forward between a bunch of different helper methods and was hard to follow.

Test Plan: They're all wrecked. Will fix after concept is greenlighted

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2776",False
7e6141fb47f7200aa04a68c0d0a2587967cb6b09,2016-03-23 03:21:38,Juan Tejada,:art:(composer): Reduce contenteditable min height,False
0f9e70cde71e0a586540e9d53b0f4e7e3da20c52,2016-03-23 03:04:09,Juan Tejada,"fix(tasks): Properly handle DraftNotFoundError in DestroyDraftTask

- Fix reference to actual DestroyDraftTask class inside
  syncback-draft-task",False
1d4e4612d57190763d21287f8381699b9cb04d32,2016-03-23 02:15:07,Juan Tejada,"feat(popover): Add subtle ease-in animation when opening popover

- Closes popover on window resize:
  - Re rendering popover on window resize will be a bit more tricky because
    the FixedPopover only receives an origin rect. The one who
    dispatches the action has the responsability of re dispatching when
    the window resizes
- Fixes tiny behavior in send later popover",False
df354aa50eebc4702e2500a15c1cad420705fcf0,2016-03-23 00:51:25,Ben Gotow,fix(readme): Add --enable-logging flag,False
5aa2b24d72bd6032c103bc2ea4906a55f84230ad,2016-03-22 23:58:55,Juan Tejada,fix(message-list-toolbar): Fix observable for selection & focused thread,False
8f864e76e375bd3e3b51ea6592bba22ee8a72ffb,2016-03-22 23:58:55,Juan Tejada,fix(attachments): Update fn name in ImageAttachmentComponent,False
8ff89dbf480da1557bbbf777f8d0f0b4eb8112db,2016-03-22 13:26:06,Ben Gotow,"Merge pull request #1790 from mbilker/fix-mistake

Fix my mistake with AutoUpdateManager",True
4afcc0501fb8b656abdd7b4ca590670d36443313,2016-03-22 08:05:47,Jackie Luo,:art:(theme-picker): Fix styling for non-Retina displays,False
9e3dbd3873de164a1aeeab6cab6c7023b545dfd0,2016-03-22 06:55:50,Ben Gotow,"fix(template): Rewrite in ES6, add missing windowTypes",False
fce1673aac685a39baf95303910a3894dfd5b5c5,2016-03-22 06:53:26,Juan Tejada,"feat(download-all): Adds download-all button + style updates, more ES6

Summary:
- Adds initial version of download all button
- Converts attachments plugin to ES6 and adds updated styling
- Updates quoted text button
- #905, #1712

Test Plan: - Unit + manual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2769",False
070d09c2337818dc08d4c8eb75e0295ce1880b3d,2016-03-22 06:39:31,rittbys,Changed GoogleInbox to InboxByGoogle (TEMPORARY PATCH),False
510e417cb3b7dc6c2abc7fe48d723ea65ff0a445,2016-03-22 06:06:18,Ben Gotow,"fix(tray): Use total count, not unread count, for tray icon",False
4ddbf1faae09309fb5d152afb8eef49e6ff1ded4,2016-03-22 05:20:10,Ben Gotow,"es6(tasks): Convert all remaining tasks to ES6

Summary: after refactoring some things last week and spending time futsing with coffeescript, I’m pretty convinced it’s worth moving important parts of the app to ES6 to be able to use ESLint as part of our dev workflow

Test Plan: Run existing tests, tested manually. Did not convert the tests in this diff, breaking one part at a time!

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2768",False
687597134d454a3d008e7e621626289a8dd2f058,2016-03-22 00:50:11,Juan Tejada,"feat(selection): Add new display for selection count + update toolbar

Summary:
- New behavior is that the in split mode, you will perform actions on
  the selection via the MessageListToolbar (the toolbar positioned above
  the message list)
- Refactored and moved around a bunch of code to achieve this:
  - Mostly renaming stuff and moving stuff around and removing some
    duplication
  - Update naming of toolbar role to a single role, and update relevant code
  - Converted and refactored a bunch of code into ES6, specifically to reuse the code for the ThreadActionsToolbar at the 2 locations
  - Deprecated MultiselectActionBar in favor of MultiselectToolbar
  - Deprecated old roles
- Punted the animation for the stackable cards in the selection display for now.
- #370

Test Plan: - Manual and unit tests

Reviewers: evan, drew, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2756",False
cc7317d3f700876c080bd4bc8005df98f8519f6f,2016-03-22 00:02:48,Ben Gotow,"fix(composer): Refactor header actions, clean up layout

Summary:
WIP

Remove the mode prop from everywhere, use NylasEnv.isComposerWindow() instead

Test Plan: Run updated tests

Reviewers: drew, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2766",False
6c36f54a601fa51f7a5428f51e1639db850b31b3,2016-03-19 08:26:08,mbilker,"fix(auto-update): mistakenly used remote.dialog

I forgot that the `AutoUpdateManager` is run from the main process",False
38d9c41c0b5c9c3152855a229c53115bf2cc0ecc,2016-03-19 06:42:55,Jackie Luo,fix(theme-picker): Add tabIndex to click to dismiss,False
a88c7db3a5853c66d24a55270221f92d9a3385bb,2016-03-19 06:12:31,Ben Gotow,"Merge pull request #1783 from mbilker/change-dialog-call

Use `remote` exports instead of `remote.require` for dialog",True
8626b006eb88b7ed8343846d913bcb4581be4b85,2016-03-19 05:33:27,Ben Gotow,"bump(version): Notes for 0.4.16 patch, master to 0.4.17",False
c84921225032f23086fa7da389ee1911f34b1ca2,2016-03-19 03:39:00,Ben Gotow,log(sync-state): Send `Account State Delta` to mixpanel,False
ea48721a857ac49bd39c20fe3d469474114c9872,2016-03-19 03:03:18,Juan Tejada,":art:(query-subscription): Update query subscription

Summary:
- Applies code changes that we discussed with @bengotow when debugging
  #1327
- Minor refactoring and reorganization + update specs

Test Plan: - Unit tests

Reviewers: evan, bengotow

Reviewed By: bengotow

Subscribers: bengotow

Differential Revision: https://phab.nylas.com/D2612",False
9aba847a92932180b61d11303db35926c22f955b,2016-03-19 02:33:37,Ben Gotow,fix(onboarding): Focus first field when showing settings #1696,False
815dc58e3aa2185d30b2e1f66f5b5d5a44483cbe,2016-03-19 02:18:14,Jackie Luo,fix(ui-taiga): Remove border-bottom in two-pane mode,False
96186631cdcd6a6e8f93c7063c7ec0348755a127,2016-03-19 02:12:32,Jackie Luo,fix(ui-taiga): Show active list item in single-pane mode (#1751),False
d780740187580e26a892e9b7028dc0ad9c5f76d2,2016-03-19 01:56:03,Ben Gotow,fix(build): Fix failing linter and account tests,False
47a88232426bf83e53e5f1439c8806d09072e128,2016-03-19 01:55:30,Ben Gotow,"fix(queue): Delay retries up to 30s when tasks request a retry

Summary:
This is a critical patch that fixes two problems with the task queue:

1. Tasks in Status: Retry are retried the next time processQueue is run,
   which could be pretty much immediately. Certain scenarios lead to tasks
   running in a hard loop forever.

2. Returning Task.Status.Retry set the retry flags on the task but did not
   schedule the queue to be processed again. So if only a single item in the
   queue was present, it might never be retried again until the user performed
   another action.

Test Plan: Where did the specs for TaskQueue go? There aren't many... need to write more.

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2762",False
26c752ba668d2e4d31178398316f6b77caf43ed3,2016-03-18 23:13:43,Ben Gotow,typo(counts): Fix duration computation,False
5bc00bd55eb79a0a3b62685956ff4d5e31fa96a9,2016-03-18 23:13:43,Ben Gotow,"fix(quick-schedule): Update to use new APIs, remove leftover docs",False
3240635b4c5549de9e5a174a7e9d6ba862d6cd23,2016-03-18 23:11:08,Drew Regitsky,"fix(sync-state): ignore Account.syncState==""stopped"" for now

Valid accounts that are syncing properly can reviece a delta for
Account.syncState==stopped currently, due to some quirks in the backend.
Ignore ""stopped"" until it unabiguously represents an error state.",False
2575cecd59879bc0f0d538d16c0def9ea14b8bb0,2016-03-18 22:37:56,Jackie Luo,bump(node-emoji): Use 1.2.1 with merged PR,False
1f7716baa64193890af9f0e608344badf64f25e2,2016-03-18 22:33:05,Ben Gotow,"Merge pull request #1764 from mbilker/expose-keytar

Add atom-keytar for use in extensions",True
ea540ebf18fe5609a12802d7cc70573496975cea,2016-03-18 10:57:13,mbilker,fix(specs): change to use electron.remote.dialog,False
758b1ccd4ed6cb41ce820df1c0f8ddd6d4947f65,2016-03-18 10:57:05,mbilker,fix(require): use the remote common exports to avoid function call,False
5d985959185179ce2e54d166bd7f7da41a7f3cbe,2016-03-18 07:58:25,Michael Grinich,"Merge pull request #1781 from steelbrain/patch-1

Enhance issue template",True
0ede4b7275f940f93632833718ee9d3877604afe,2016-03-18 07:55:38,Steel Brain,":art: Enhance issue template

There were several issues with the last issue template, here are some of them

- Instructions to user that should've been comments were not, they were shown as part of the issue
- Bullets were used instead of heading, the down side is that they weren't gonna be bullets only. Users were supposed to add paragraphs below them, thus breaking the styling.
- There were no separators in place

This commit addresses these issues",False
868445504f6d718cc983143a42d343c95a1f51ac,2016-03-18 06:55:00,Ben Gotow,bump(version): 0.4.16 beta,False
fe5b75b32a8c9096603feb95c0e38bf243645e2f,2016-03-18 06:54:27,Ben Gotow,"fix(counts): Switch to simpler SQL-based counters, introduce total counts

Summary:
The old approach we were using to track unread counts by category was really complicated because it involved computing changes to counts in javascript and then syncing them back to the database, from each process that was making queries. Rather than try to fix that, this diff moves us to a new approach where the counts are maintained by executing a query before and after threads are modified to unapply / reapply them from the counters. Doing this in the database in the same transactions as the thread modifications themselves ensures the counts are internally consistent with the Threads table.

This SQL approach is also able to compute initial counts way faster - initializing totals and unreads in a 1GB edgehill.db in about 1 second on my machine.

Test Plan: All old tests removed, new tests coming

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2757",False
e767c9a89bb485af66a9dbefc57359803032276a,2016-03-18 06:41:03,mbilker,"fix(exports): rename Keychain to Keytar to reduce confusion

@bengotow requested that the export represent the original module
to prevent confusion and reduce the documentation needed.",False
ccef76326f9f4a8d87a4396c8767af87947b17fd,2016-03-18 04:53:53,Ben Gotow,"es6(tasks): send, syncback and specs converted to ES6",False
b515a5e0e26f96e42bc3efd6ebd948f029f3f5de,2016-03-18 01:44:55,Ben Gotow,"feat(dock-icon): Drop files to attach them to new msg

Summary:
Fix specs

Fix responding to mailto, files at launch

It's super important that `window:loaded` is /not/ sent from index.js because `loadSettings.bootstrapScript` is async and nothing is actually loaded yet. This was causing the app to dispatch the mailto:// links into the main window before a DraftStore existed.

I think this was necessary at one point because we had NylasWindows not using a bootstrapScript? Should not be here anymore...

Test Plan: Run a few new tests

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2737",False
2e2ecf0647b7693ce1e88dc157c6ad8a4c00aa79,2016-03-18 01:41:00,Ben Gotow,"fix(quoted-text): div vs blockquote, signature cleanup #1746

Summary:
Previously we always created <blockquote class=""gmail_quote""> to wrap quoted text. This is not correct.
Gmail uses blockquotes only when it wants visual indentation, and <div>s to wrap other quoted text, like forwarded
messages which are not displayed indented.

This diff updates N1 to match Gmail exactly. Note that for replies, Gmail actually nests a blockquote.gmail_quote
inside a div.gmail_quote.

I also updated signature handling because it turns out the regexp that was removing existing signatures would blow
away any and all divs until it reached a <blockquote> tag.

Test Plan: See updated specs. Manually tested by creating a thread in Google Inbox and then performing fwd and reply in both N1 and Inbox. Results match.

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2750",False
f5a9bac1510727ee85c6b6a507141387f94d3060,2016-03-17 23:44:58,Juan Tejada,"fix(tasks): Don't pass null category to task factory

- This was causing:
  https://sentry.nylas.com/sentry/edgehill/group/20965/",False
a3a03bd086c55a099adb514320114c5a2bbe0626,2016-03-17 08:34:01,Ben Gotow,fix(lint): Actions is defined but never used,False
24933906a7007f7a4e3592958d97e123dea027a0,2016-03-17 07:59:00,Ben Gotow,bump(version): 0.4.15,False
552b66fbaf3b52c58132319ca40b5f29512b16fe,2016-03-17 07:57:12,Ben Gotow,"fix(syncback): Bidirectional transforms, ready-to-send saved state

Summary:
This diff replaces ""finalizeSessionBeforeSending"" with a
plugin hook that is bidirectional and allows us to put the draft in
the ""ready to send"" state every time we save it, and restore it to
the ""ready to edit"" state every time a draft session is created to
edit it.

This diff also significantly restructures the draft tasks:

1. SyncbackDraftUploadsTask:
   - ensures that `uploads` are converted to `files` and that any
     existing files on the draft are part of the correct account.

1. SyncbackDraftTask:
   - saves the draft, nothing else.

3. SendDraftTask
   - sends the draft, nothing else.
   - deletes the entire uploads directory for the draft

Test Plan: WIP

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2753",False
286043492fb77ed79f17170dfa83c0385060ff50,2016-03-16 21:45:11,mbilker,"fix(exports): add atom-keytar for use in extensions

In Cypher, I store the Keybase tokens in `config.cson` currently.
With the recent integration of `atom-keytar`, I can store those
authentication tokens into the system keychain where they are better
protected than `config.cson` just like the account tokens.",False
6b993d07bcf95d1d35909656e32c1d7cfb15c170,2016-03-16 08:31:01,Jackie Luo,fix(ui-variables): Add correct hexcode for @background-color-success,False
55ed1e2f3c30931a9171f951c2ad9565226450ed,2016-03-16 02:07:54,Jackie Luo,sp(composer-emoji): Correct emojis to emoji,False
1a50a535a9809223676229a8b737da0c1e0affad,2016-03-16 01:16:03,Ben Gotow,fix(icon): update assets to fix #1747,False
592e8614069481068cd50d5e6e78602594bd857c,2016-03-16 00:42:30,Juan Tejada,"fix(focus): Show drafts in unfocused state when window is blurred

- See #1695
- Update key commands region to clear focus when window blurs
- Dispatch broswer-window-focus/blur as a window event into the renderer
  window
- Update tray icon to listen to window instead of ipc event",False
030b0b57b4c895a71764ab32066529cab1a12060,2016-03-15 23:50:55,Juan Tejada,"feat(view-mode): Add option in menu to select view mode

Summary:
Also add minor refactoring
#1710

Test Plan: Manual

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2745",False
76d478b67701758ce07eaad681d0515863d82f2b,2016-03-15 23:48:50,Jackie Luo,"refactor(ui-variables): Clean UI variables for consistency/usage

Summary: Shortens and simplifies UI variables so that unused variables are no longer present.

Test Plan: Tested locally.

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2738",False
5c8b8c721f9e00cd0ace46bebf175e3be8cf0017,2016-03-15 23:39:09,Jackie Luo,:art:(plugins): Fixes switch alignment issue in #1743,False
84b9741fa6d8a5b93da3ed0e0005bd99b5380dfb,2016-03-15 23:34:00,Ben Gotow,fix(autolinker): Additional phone number parsing specs,False
92e8a2a7d47504195cb2a2f24f825bd83852a3d1,2016-03-15 23:17:14,Ben Gotow,"fix(autolinker): Add more test cases, improv URL regex",False
7a7496b675a35f1038346f02e55d7c481c8b46fa,2016-03-15 22:01:22,Ben Gotow,"fix(uploads): Display icon regardless of ext capitalization

Note: In the future we really need to consolidate file-upload.cjsx and attachment-component.cjsx. #1700",False
2d8bb9d3f7839ad08d74aa5755e84dfb7406db94,2016-03-15 21:46:28,Ben Gotow,fix(next/prev): Move buttons to correct column #1721,False
492ae69abeca421718d8ae0caacb46d78c96f901,2016-03-15 07:20:43,Jackie Luo,"Merge pull request #1731 from jamiewilson/darkside

(darkside) using new toolbar selectors, svgs, etc",True
b75843bbc03b022be6f774886844ef0f5ec77bc9,2016-03-15 07:03:04,Ben Gotow,"fix(unread): counts should exclude items outside all mail

#1726, #1718",False
18697091215fcb97fd12a780b2e2521524239f65,2016-03-15 06:25:25,Jackie Luo,:art:(plugins): Add theme-specific icon in plugins tab,False
ded7c20fba0d78447f535f249b8876b8fcb1abe4,2016-03-15 05:47:11,Juan Tejada,"feat(tray): Update to new set of icons and behavior for tray (menubar)

Summary:
- See #1698

Add specs

Test Plan: - Unit tests

Reviewers: bengotow, evan, drew

Reviewed By: drew

Differential Revision: https://phab.nylas.com/D2734",False
cff2f71d18268b27d71d337a3ff04c693528f12a,2016-03-15 05:35:49,Ben Gotow,"fix(signatures): Adds default signature, convert to ES6",False
013898ed02916e59b02ec907711528dab2be3b1d,2016-03-15 05:32:00,Jamie Wilson,"using new toolbar selectors, svgs, etc.",False
0b2d7043d7036931a8be51b63af129d1f81c9bc2,2016-03-15 04:09:42,Juan Tejada,fix(specs): Remove fdescribe,False
cfbbcd23d3f01a22430b4f82f305aa1df68c9428,2016-03-15 04:06:39,Juan Tejada,"fix(snooze): Correctly query and create snooze categories per account

Summary:
- Was not properly updating the references to snoozed categories when
  accounts were added or removed
- Update whenCategoriesReady to make sure we listen until category syncing has concluded (Move inside CategoryStore)
- #1676, #1658

Test Plan: - TODO

Reviewers: evan, drew, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2723",False
734a52aa6a059bf833eed259467a101fb83c51f1,2016-03-15 03:44:08,Ben Gotow,"fix(config): Move account tokens to system keychain

Summary:
This diff also adds an account version number to the config so that the AccountStore can tell whether it should reload accounts (depending on whether it was the instance making tthe changes.)

This diff also fixes a tiny issue where un-opened composers threw an exception if you changed accounts.

Test Plan: New tests

Reviewers: evan, drew, juan

Reviewed By: juan

Subscribers: juan

Differential Revision: https://phab.nylas.com/D2726",False
dbf3610c884540a9a7734f1a9252c7855f0b61d8,2016-03-15 01:43:32,Ben Gotow,"hide(zoom): Remove UI for zoom, move to CONFIG.md",False
465831175aa00e3e8a08de6d2791d9e37f516c54,2016-03-15 01:00:54,Ben Gotow,"rm(autolinker): Use our own very simple autolinker

Summary:
Autolinker is a great open source project but it attempts to parse HTML with regexp, is quite slow, and hangs on specific emails https://github.com/nylas/N1/issues/1540

This is super bad, and also super unnecessary. I think this should do the trick.

Note: I changed the urlRegex in our Utils to be much more liberal. It now matches anything that looks like a URL, not just things with the http:// and https:// prefixes. It's used in the LinkEditor and onboarding screen (detecting auth errors with urls) and I think it should be ok?

Test Plan: Need to write some tests

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2725",False
06d7c05aa8d138d02f745600096188014789f7db,2016-03-14 23:52:52,Juan Tejada,fix(acct-menu): Add option to add account from context menu,False
346dd80a324ebf212947c5693adb7fad9d53b85f,2016-03-14 23:52:42,Juan Tejada,fix(specs),False
c185c0d0e4a8fed9c9b40281f05154815d1df5ae,2016-03-14 23:34:45,Juan Tejada,"fix(mail-labels): Don't display `sent` label

Reference #1671",False
fc59d88337763391fc7e1e4ee5385f5cc1af50eb,2016-03-14 22:53:57,Ben Gotow,"fix(spellcheck): Enables spellcheck menu for basic inputs (#1600)

Summary: Just moves some code so we can easily attach spelling menus to the basic inputs.

Test Plan: Updated existing tests

Reviewers: juan, drew

Reviewed By: drew

Differential Revision: https://phab.nylas.com/D2721",False
a3483c0a2bc4afb5cbdf6ab8380c2cd55c8a062d,2016-03-14 22:39:21,Ben Gotow,"Merge pull request #1648 from Eldorado234/patch-2

Fixed text overflow in phishing detection indicator",True
1b4739335f4452faa720914309c5e6a593db531d,2016-03-14 06:33:36,Michael Grinich,use bullets instead of checkboxes,False
fa7f0faa1b66b9340fa0cda39ab1d289d96a8ed7,2016-03-14 05:33:33,Michael Grinich,add hiring note,False
9cc235dbbb52bfcf3cfff3e9f20e5af269141ad0,2016-03-13 01:13:49,Jackie Luo,:art:(themes): Fixes Windows button UI issues in #1649,False
85388c9cb5f8470a139eaf03274232f394fb1598,2016-03-12 07:01:19,Jackie Luo,"Merge pull request #1632 from DavidChouinard/extraneous-scrollbar-fix

Fixes scrollbar display when content is not scrollable",True
270d1210b36aa0f3da84e3b790b92189b5372c66,2016-03-12 06:25:28,Jackie Luo,fix(themes): Add classes for toolbar elements,False
ae4ca595266dac20fcb599fb9b2f0ae1e2d9cc64,2016-03-12 02:57:04,Evan Morikawa,"fix(sidebar): keep trying on 202s

Also fixed a bug where the email could come back with different
capitalization causing a cache miss",False
2d8e65ead44fee98664b73fc2288b333a44f72cc,2016-03-12 02:31:29,Evan Morikawa,fix(sidebar): add info@ to blacklist,False
eea5b7b531c3068e044b7217b5812b076c406f88,2016-03-12 01:13:52,Jackie Luo,update(readme): Streamline plugin lists,False
a61d7b9b3b24f4426194ef3a89a6c537f29d5a8f,2016-03-12 01:05:49,Ben Gotow,fix(message-extension): Exception in base class,False
aaa5bd17b74ee3e33ac7d78991b5e0f26555fbcb,2016-03-12 01:05:49,Ben Gotow,fix(menus): Nylas => Nylas N1,False
257f9a13d9331e701d2d6ce943fabadcabcc6edf,2016-03-12 01:03:06,Simon Seyer,Fixed text overflow in phishing detection indicator,False
5dc07fb739c60ce23c8d0a04c6bd42b8f49d670b,2016-03-12 00:56:49,Jackie Luo,update(readme): Add bundled versus community packages,False
2c723725b61bc4bbf857839667e718f172d91414,2016-03-12 00:32:02,Jackie Luo,fix(themes): Add quick fixes for Ubuntu,False
4bddd302e133def5698546bdacd362b08fdb3b64,2016-03-12 00:29:30,Jackie Luo,"Merge pull request #1629 from ahmedlhanafy/master

Added Ubuntu theme to the internal packages",True
714b55b299a7998bfac25ce6a84f16b39d66ee8a,2016-03-11 23:54:26,Ben Gotow,"Merge pull request #1645 from Eldorado234/patch-1

(darkside) Fixed alignment of message headers",True
9cb8a24de89062f91daf607bf38cc2a91c331a8b,2016-03-11 23:37:52,Simon Seyer,"Fixed alignment of message headers

like the phishing indicator.

Before this change: http://pasteboard.co/2bUg8PU9.png
After: http://pasteboard.co/2bUj2Bmz.png",False
d57ef5a060074500faa2e7e131ff7e3583022f35,2016-03-11 08:39:00,Ben Gotow,bump(version): 0.4.14 and changelog,False
fe11a425cdf923673b0244ed3b3bc20a0db018e7,2016-03-11 08:36:15,Drew Regitsky,fix(templates): fix a null check bug in template contentedtable ext,False
50296ab2d6a7b78ba802da1c6f5b44a08f8b7a18,2016-03-11 08:31:34,Juan Tejada,fix(mail-rules): Prevent from adding locked categories,False
9dc53ee1bd37faa11f999521fbebd72a9bcd51b0,2016-03-11 08:13:02,Drew Regitsky,fix(regexp-utils): Also update the regex101 link with test cases,False
3f017892e0e22a61da00547b5ab29f1a1fd4deb6,2016-03-11 08:11:01,Drew Regitsky,"fix(regexp-utils): Fix urlLinkTagRegex bug
Regex was missing a `?`, so consumed all <a> tags on a single line. Fixed
to be non-greedy.",False
b20bd9631de1dbafff2f9221cb92c3a0ce6637b0,2016-03-11 08:07:45,David Chouinard,Ensure scroll bar state is updated on content change,False
d23f8cfdac9312bdfe818647eff6a0c3b842bd6c,2016-03-11 07:29:06,David Chouinard,Don't show scrollbars if content is not scrollable,False
595bd705149e1dd2c6473fe497dfbdc7e1ba8609,2016-03-11 07:20:19,Ahmed Magdy,Added Ubuntu theme to the internal packages,False
42e5f4c60559477b5299f433223be415d77e84d0,2016-03-11 07:16:23,Juan Tejada,fix(snooze): Fix getter for inbox category in when moving to snooze,False
1c9da2d58659bbe088d3e88977c0eb7134e504ba,2016-03-11 07:04:26,Ben Gotow,"fix(plugin-auth): POST returns 200, no response body",False
d568d66891623deb9387c73a50b88052980e1a81,2016-03-11 06:57:51,Juan Tejada,fix(lint): Fix in MailLabelSet,False
0533cf3cb3e0911c49e2b33a6955aa0219768a53,2016-03-11 06:38:42,Ben Gotow,fix(labels): Do not re-use mail labels if they're removable,False
1e61f2916bf55fd1c818844267caac3879991b38,2016-03-11 06:07:06,Jackie Luo,:art:(theme-picker): Order internal themes and update theme names,False
c98b394c255f0ca36dc000ab2fc3c0d5166eadff,2016-03-11 05:56:25,Juan Tejada,fix(change-labels-task): Update label sets after modelifying,False
21e19cab50fe93b93b42d30fd82405a093aa4bfe,2016-03-11 05:43:17,Ben Gotow,fix(bodies): Message with empty string body showed loading forever,False
a24f67398e25b6763fd54b14adfc4150b94200c7,2016-03-11 05:33:36,Ben Gotow,fix(sync): Do not paginate /metadata unless pluginsSupported,False
963d1d92cb4ba46db1c322aead8d0565c6ade818,2016-03-11 05:19:00,Evan Morikawa,fix(sidebar): return valid person to prevent cache miss,False
23c68df4c09bf51730902b397e25175151cfab0f,2016-03-11 05:14:53,Juan Tejada,"fix(sent): Do not allow sent or drafts to be modified

- Specifically, when dragging from the sent perspective, we should not
  allow the sent label to be removed.
- If moved to trash or spam, `all mail` will be correctly removed from
  the thread, but it will keep sent label
- Show sent MailLabel on the threads",False
b9810d5983a990b659757f9efd76d6b3f85277f0,2016-03-11 05:10:26,Evan Morikawa,fix(sidebar): change optional bit in package,False
8f94012dd79423154032b54b77c83f6655017d88,2016-03-11 05:02:37,Evan Morikawa,fix(sidebar): don't show nulled profiles,False
716533b9f1e3e14376b1e3feff39fda33e4339fd,2016-03-11 05:01:05,Ben Gotow,fix(messages): Replace `calc` with margin to make plugin styling easier,False
554bb69ad6397ec541f5dcb1490420df148b1f73,2016-03-11 05:01:05,Ben Gotow,"fix(labels): Labels should not show ""X"" in wide mode",False
3630a1425f095a93e6e561f0a9f088264b84c8b1,2016-03-11 04:48:57,Jackie Luo,:art:(theme-picker): Adjust styles,False
93cdbf1d6eb543fc5ad1578c1ba663f7d631b1c3,2016-03-11 04:46:32,Evan Morikawa,fix(sidebar): explicitly detect 202 and cache null people,False
ba66a91eca2c183267b55965f0e299d3eedfface,2016-03-11 04:01:50,Ben Gotow,fix(github): Correct minor issue during ES6 conversion,False
85ab3cf0aca16a351d186943c1edeafb105227d9,2016-03-11 03:55:28,Ben Gotow,fix(remove-from-view): Missing invocation for non-Gmail,False
457abbf32905277c07256b435dee48f869d277a7,2016-03-11 03:46:07,Jackie Luo,"feat(plugins): Move uninstall from theme picker to plugins tab

Summary: Move uninstall functionality to the plugins tab in preferences.

Test Plan: Tested locally.

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2716",False
76036e82bd40ff98c24a027d3b35701a7e7c7300,2016-03-11 03:43:31,Juan Tejada,"fix(gmail-labels): Constraint so threads always belong to all,spam or trash

Summary:
- In Gmail all threads /must/ belong to either All Mail, Trash and Spam, and
  they are mutually exclusive, so we need to make sure that any add/remove
  label operation still guarantees that constraint
- Update ChangeLabelsTask to modify the set of labels to add and remove
  based on this rule
- Update tasksFor archiving, moving to trash and moving to spam so they
  don't affect any other labels in the thread, as gmail does.
- Removing from view /will/ remove any current labels, but will also
  move between all mail and trash as needed
- Remove Inbox, Trash and Spam from the CategoryPicker, as Gmail does

Test Plan: - Unit tests

Reviewers: drew, evan, bengotow

Reviewed By: drew, evan, bengotow

Differential Revision: https://phab.nylas.com/D2715",False
e62e63ddbe327af4fa8a63f3be9b761cf5412f8f,2016-03-11 02:57:11,Ben Gotow,fix(trash/spam): Typo `sent` => `spam`,False
96c0b5da29e20627ce495d472a02dfdb366d2386,2016-03-11 02:11:32,Ben Gotow,fix(trash/spam): New inAllMail filter applied to all mailbox views except trash and spam,False
b920cf83df6e4319a3cfe82e94b5c27f9b82cc06,2016-03-11 01:56:57,Jackie Luo,"Revert "":art:(plugins): Change menus to consolidate plugin installation""",False
703bc2efd2013d23e324e57a321008f49c2dde03,2016-03-11 01:38:05,Ben Gotow,bump(version): 0.4.13 beta,False
306440dd3836ed265c510f2bde844ee1f9028d94,2016-03-11 01:38:05,Ben Gotow,fix(onboarding): We should accept IPs for servers during auth,False
c5d9611f2456cb1663cf7a33b6ed6ca2793e8be2,2016-03-11 01:38:05,Ben Gotow,fix(api): Don't display auth failure bar for req with no auth (onboarding),False
12b16092064bb322fb18b20799698af00f823473,2016-03-11 01:38:05,Ben Gotow,fix(onboarding): Make links in error messages clickable,False
9c8237caf329adb9a84dc2ead7ce517f12b53bac,2016-03-11 01:36:59,Evan Morikawa,fix(sidebar): design tweaks to sidebar,False
47e2ef8436de99609a84e670ba073a68d41ae07d,2016-03-11 01:36:59,Evan Morikawa,fix(sidebar): minor sidebar style and padding tweaks,False
e90b783b366ae4da0c51177b69a18c1161281824,2016-03-11 01:24:05,Jackie Luo,fix(themes): Fix linter issues and relink images,False
b67aedfbff71032421efaa16460ca49abce8ee43,2016-03-11 00:45:52,Ben Gotow,:lipstick:(sidebar): Replace icon with person,False
ad9cff4810123b72422cff3ab51b829fa7a6564b,2016-03-11 00:44:02,Jackie Luo,:art:(themes): Move notification heading below toolbar,False
2881909be5200bff8727326c940993cc5f46ab4b,2016-03-11 00:41:15,Jackie Luo,"Merge pull request #1621 from jamiewilson/master

Adding ui-darkside to internal packages",True
c38ef2f34a4fb787d2452379bbab10c942cc3aff,2016-03-11 00:36:48,Evan Morikawa,fix(sidebar): use http basic auth to pass token,False
f706d4d80fefa1096c256c0b2a44784a52196745,2016-03-11 00:36:06,Ben Gotow,"fix(sync): Pull down and associate metadata during initial sync

Summary:
Snooze should wait for categories on all accounts

Fix authPlugin to rembmer `plugin+accountId`, not pluginId, add specs

categories() returned [], categories(acctId) returned {}

dry up sync worker, fetch metadata before anything else

Test Plan: Run tests

Reviewers: drew, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2693",False
041817c589d6b656a89fcb2af4f4fc5f90f81f18,2016-03-11 00:33:38,Ben Gotow,"patch(save): Only save drafts when necessary, avoid sync-engine issues

Summary:
Previously, we have saved drafts back to the user's provider through the sync engine. There are a handful of very serious edge case issues we're working to solve that are creating a bad user experience. (#933, #1175, #1504, #1237)

For now, we're going to change the behavior of N1 to mitagate these issues.

- If you create a draft in N1, we will not sync it to other mail clients while you're working on it.
- If you enable send later, we'll start syncing the draft to the server as before.
- If you created the draft in another client, we'll sync the draft to the server as before.

Fix specs

Test Plan: Run specs

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2706",False
9b682c15e0e8ab276d1d77591e06acab111e8f88,2016-03-10 23:48:32,Jamie Wilson,adding ui-darkside to internal packages,False
7771f8c4f4c56d69ff99587644085e4ba0606672,2016-03-10 08:44:54,Ben Gotow,"fix(bodies): MBP should cache """" so that it updates when new body arrives",False
b1ab520d0e9328fd89ea0761f3973d0c32a3c251,2016-03-10 08:44:54,Ben Gotow,"fix(bodies): Move loading into component, add retry, loading spinner",False
9018ae6a87e517ae88615899cf8545ecebfbff95,2016-03-10 07:41:53,Evan Morikawa,"Revert ""fix(sidebar): use n1_id to verify edgehill server""

This reverts commit ebd2973cf9171d31cd3aed5fc1c52aeaceb6ff13.",False
3a28bb052933e2358658fa2bbbc6ff986ac453e7,2016-03-10 07:27:13,Evan Morikawa,fix(sidebar): fix ordering and add hover state,False
ebd2973cf9171d31cd3aed5fc1c52aeaceb6ff13,2016-03-10 06:57:31,Evan Morikawa,fix(sidebar): use n1_id to verify edgehill server,False
c0a3452a2ea0558bd0a06efd0f7e4eeed8ab0394,2016-03-10 06:24:29,Jackie Luo,:art:(plugins): Add install button in preferences,False
deeaefaeb4170916c11e678a4abb0359e1e3fbfe,2016-03-10 06:24:09,Jackie Luo,:art:(plugins): Switch to switches,False
b7a55218321d0d04d00128971a72f8cfbfd036ff,2016-03-10 06:23:49,Jackie Luo,:art:(plugins): Change menus to consolidate plugin installation,False
c84b4bdd5e4c235241ca673153a9f36d9885b233,2016-03-10 05:50:33,Jackie Luo,:art:(themes): Tweak UI for consistency,False
fcf8fa766c195a5278e20ab6eca8a03d6b282cf7,2016-03-10 05:40:15,Juan Tejada,fix(snooze-button): Change div to button,False
7b3d8b1c25fcadce1bf3cab2697ce5057a3b21ea,2016-03-10 05:22:22,Jackie Luo,fix(themes): Move Taiga into directory,False
12d4bfd95f327c978675c6a4473f2dcb40f239ab,2016-03-10 05:20:07,Jackie Luo,"Merge pull request #1618 from noahbuscher/master

Added Taiga!",True
901302fef6a94442bdf71775373739b114853bd7,2016-03-10 05:14:01,Noah Buscher,Added Taiga!,False
ecb9fa83e8ecb72ed5734a27fee2a52547f1436a,2016-03-10 05:02:15,Evan Morikawa,fix(search): reset on thread change,False
232dd136604b76778ce5431d4564dc902e2237fd,2016-03-10 04:51:27,Ben Gotow,"Revert ""fix(autolinker): PR accepted into 0.24.1, fixes #839""

This reverts commit 2a7a97eebcb7ef049105173493d9af9b235109f2.",False
fe80dfb05a07eb4175b772a01b2739ecc8e7f8d2,2016-03-10 04:51:27,Ben Gotow,"fix(sync): Paginate /threads, etc. slightly slower to aleviate backend load",False
571a464f7e9ee50656b67e5f09973aa5f5f5e5e4,2016-03-10 04:42:06,Evan Morikawa,fix(search): search perf and fix css issues,False
3d3748a86e7fbbc12b17825a392736ab6770b46a,2016-03-10 03:39:35,Ben Gotow,:lipstick:(workspace): Fix #1482,False
3132bedd6d4597e951b87fbf908cbee9c07043da,2016-03-10 03:26:46,Juan Tejada,fix(warning): Check if DateInput has unmounted when clearing state,False
f8e52e7a0d60b409d3c7a8ad1841f2630a54bfb1,2016-03-10 03:14:44,Evan Morikawa,fix(spec): fix message timestamp spec,False
c616ded31815db34fc2a3db8070e0b6bf6230570,2016-03-10 02:47:20,Evan Morikawa,feat(sidebar): add timestamps to related messages,False
2d972ea4622af3af0e8fd36707371e2d4d39cf6d,2016-03-10 02:16:10,Evan Morikawa,fix(sidebar): ui tweaks to narrow sidebar,False
3d4e8054e3baabdd3d951a6e8c427e23de314ec7,2016-03-10 01:41:16,Juan Tejada,fix(warning): Remove unused Popover require,False
19f4efb50cb62cb111a9a72ea0067da26bc704f7,2016-03-10 01:36:27,Juan Tejada,"fix(signatures): Correct regex to properly replace existing signature

- Fixes #1561
- Add more specs",False
80942db92bf3f6740900b3d400a5dc9782d0f968,2016-03-10 01:10:56,Ben Gotow,:lipstick:(onboarding): Minor style changes to account choose page,False
703686d3222c5821b80ce40f2076b2ef8bb7f599,2016-03-10 01:10:56,Ben Gotow,"fix(sent): Sort sent view by most recent sent message, not received",False
58004b29a76959bebc180b629fea9091c83ee90c,2016-03-10 01:03:31,Evan Morikawa,"feat(sidebar): Add thread list of currently selected participants

Summary:
WIP. I added a collection index to make displaying the threads of a
currently selected participant on the sidebar easy and fast.

The problem is that the `participants` of a thread, while a collection of
`Contact` objects, have no ""ids"" for those contact objects.

One idea was to create the join table but access contacts by email instead
of id. This required a minor change to the way the data is entered in the
join table.

This means the sidebar can now simply do:

`DatabaseStore.findAll(Thread).where(Thread.attributes.participants.contains('foo@bar.com'))`

While I didn't for this initial test, we could also/instead create the
`Message-Contact` join table. The trick about a Message-Contact table is
that I believe we'd have to create additional columns further specifying
which field we're interested in.

The following two queries:

`DatabaseStore.findAll(Message).where(Message.attributes.to.contains('foo@bar.com'))`

`DatabaseStore.findAll(Message).where(Message.attributes.from.contains('foo@bar.com'))`

would require additional columns in the `Message-Contact` join table
because currently the only columns are `id` and `value`.

In the case of the sidebar use case, I think the Thread participants is
what you want to see anyway.

Unfortunately an email-centric scheme can't distinguish between
`noreply@phab.com <Evan>` and `noreply@phab.com <Juan>`. I actually think
this may be a good thing since I think most people think in terms of email
address as the unique key anyway and for the use case of showing related
emails in the sidebar I'd rather overshow than undershow.

This solution seems to be working pretty well in initial testing, but I
want to see if you guys can think of anything this may subtly screw up
down the line, or if you can think of a simpler way to do this.

Test Plan: todo

Reviewers: juan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2687",False
a017cab3a80ce443d3415904a9f5c76cca8637f6,2016-03-10 00:59:47,Juan Tejada,"fix(deprecate-utils): Add location where deprecation warning was issued

- Resolves #1599",False
e3fc29ee365d09969482d8da9d69a4882aebdebc,2016-03-09 23:35:46,Juan Tejada,"remove(popover): Remove Popover in favor of FixedPopover

Summary:
- FixedPopover now correctly adjusts itself when overflowing outside
  window, in all directions
  - Updates styles
  - Adds specs
- Remove Popover and popover.less, and refactor all code that used it in
  favor of the new FixedPopover

Test Plan: Unit tests

Reviewers: drew, evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2697",False
22dfd4d0c4b4ede8c936ae2c09bb00d94a8b092e,2016-03-09 20:33:05,Evan Morikawa,fix(spec): fix nylas api specs,False
f0fbd108385a1e579e04209b4b1d1806761387ba,2016-03-09 08:03:24,Ben Gotow,bump(version): 0.4.12 beta,False
3e8f7fbfd74fbd71a882a38fc2422e3b8dc81022,2016-03-09 08:02:47,Ben Gotow,"fix(downloads): Properly handle network errors, retries of downloads",False
1fc389c80458d76663317a2044483d8182e2bc98,2016-03-09 07:11:22,Jackie Luo,fix(theme-picker): Fix linter issues for ES6,False
5be8811e3309727ab1b76cb6351bf94cc4942b22,2016-03-09 07:02:23,Jackie Luo,fix(theme-picker): Move launch command to activate(),False
f526bb27360506140320d509172321d16f3af150,2016-03-09 06:38:35,Jackie Luo,"feat(theme-picker): Uninstall themes on click

Summary: Themes can now be uninstalled by clicking a button in the theme picker, instead of going to `~/.nylas/packages` to delete the directory.

Test Plan: Tested locally.

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2700",False
327eb43932b607c2180b5e614c39fcab472e4edd,2016-03-09 05:36:04,Drew Regitsky,"fix(sync-errors): Handle account deltas indicating sync issues

Summary:
Changes the delta code to handle new deltas on the Account object,
which are triggered by changes in sync state indicating various backend
issues. Saves the sync state in a new field on the Account object, which
is persisited in `config.cson`.

Includes several UI changes to display more information when an account has
backend sync issues. Adds better messages and new actions the user can take
based on the type of sync issue.

Additionally, fixes bug in action bridge that was preventing multi-arg global
actions from working.

Test Plan:
Manual, by testing different sync state values and triggering deltas from the
backend

Reviewers: juan, evan, bengotow

Reviewed By: evan, bengotow

Subscribers: khamidou

Differential Revision: https://phab.nylas.com/D2696",False
dc32533bf8073a8c6958a1e24b5fa33c0c726714,2016-03-09 05:21:11,Jackie Luo,update(readme): Add Material,False
0c430a470c4d3653d90507a1aa789e456ff9341e,2016-03-09 04:51:28,Ben Gotow,"bump(asar): 0.10, use ordering feature we PR'd [TEST CI]",False
0393ab38dac9a19b93b29863fe2e71608661d135,2016-03-09 03:44:02,Ben Gotow,"Merge pull request #1506 from nylas/osx-shortcuts-improvement

Add Mail.app keybinds",True
cd715359f59c5a00c1e8aee0943aee7ca8b09cc4,2016-03-09 02:53:18,sdewith,"Some fixes

Fixed based on Ben’s feedback, should be good to go now.",False
3c0b86233d539c863038a590ec0cfb6e75bb47b7,2016-03-09 02:44:06,Ben Gotow,"fix(body-processor): Observe the db to clear cache. Fixes #1133

Summary:

Test Plan:

Reviewers:

Subscribers:",False
099b525bf3c46f011bae0ed49bd6b38e9aaefd66,2016-03-09 00:32:42,Ben Gotow,"Merge pull request #1592 from brycedorn/patch-1

add toogabooga theme to readme",True
2376dd1a0f0a3ffb719f9da625fa7ef25df90c00,2016-03-09 00:24:39,Ben Gotow,fix(specs): Override configDirPath when running specs within app. Fixes #1133,False
025d4b4081aa6de4a502c7b5e6d652c5b24995f6,2016-03-09 00:04:12,Ben Gotow,fix(launch): Do not create global symlinks to `N1` and `apm`. Closes #1553,False
2a7a97eebcb7ef049105173493d9af9b235109f2,2016-03-08 23:52:08,Ben Gotow,"fix(autolinker): PR accepted into 0.24.1, fixes #839",False
0f395b8918499775c2d30a0a04c8f0c95c3a7f95,2016-03-08 23:32:10,Evan Morikawa,fix(lint): fix linter issues,False
b2db5190c80a5da40b0a7fb25a62ddc602d9e68a,2016-03-08 10:24:43,Drew Regitsky,"test(plugins): Add specs, refactor/fixes for open and link tracking

Summary:
Add specs to test the components of open tracking and link
tracking. Notably does not test the overall functionality, which
still needs specs.

Test Plan: adds specs

Reviewers: juan, evan, bengotow

Reviewed By: evan, bengotow

Differential Revision: https://phab.nylas.com/D2667",False
f1d39595917ffb4e6d4496fe295ae391e05c5682,2016-03-08 09:44:58,Drew Regitsky,"fix(send): make send/syncback draft tasks cooperate, fix task ordering tracking

Summary:
Fixes an issue with sending where certain conditions could result in a
duplicated message.

Fixes task dependency logic for draft syncback and send. Changes `createdAt`
on tasks to instead be `sequentialId`, assigned when the task is queued, to
track order of enqueueing. Renames `isDependentTask` => `isDependentOnTask`
and adds comments for clarity.

Test Plan:
Specs updated. Might be good to add some later to test this particular
edge case.

Reviewers: juan, evan, bengotow

Reviewed By: evan, bengotow

Differential Revision: https://phab.nylas.com/D2681",False
8961781ed530bdd79e92af2a5fcede0897d23525,2016-03-08 07:54:31,Drew Regitsky,fix(msg-ctrls): reorder hidden options to reduce accidental error reports,False
43857d4b79f89591cc52224fde4f7176d44db551,2016-03-08 07:49:17,Ben Gotow,fix(autoload-images): Bar disappears when you choose to load images,False
9fd0f82aa5d81433a4dbdb365db25ecf0b296576,2016-03-08 07:49:17,Ben Gotow,:lipstick:(search): Show focus around search input,False
37af2ba42c71d2502c8d799e96108e8333be827f,2016-03-08 07:46:37,Juan Tejada,"fix(remove-from-view): Fix logic for delete/remove-from-view behavior:

Summary:
- Separate gmail's remove-from-view and delete behaviors and write logic
  for each of those
  - Remove MailboxPerspective::{canArchiveThreads, canTrashThreads,
    removeThreads} and some unecessary code in TaskFactory
  - Instead, add MailboxPerspective::tasksForRemovingFromPerspective (I
    know its a bit of a mouthful)
  - I initially tried to put all of the logic for each execution path
    inside the TaskFactory by checking perspective types, but it made
    more sense to use the polymorphism already in place for the different
    perspective types.
  - There is a default delete/remove-from-view behavior which is
    configurable via simple ruleset objects. The gmail behavior is
    configured in this way.
- Update swipe css classes based on destination of threads
- Fixes #1460:
  - Update logic to display archive/trash buttons and context menu options correctly
    when selected threads can be archived/trashed (not based on
    perspective)
  - Same for swiping
- Add a bunch of specs
- Convert some code to ES6
- TODO write some docs for new functions

Test Plan: Unit tests

Reviewers: drew, evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2682",False
848bb09f846a24b1e51d89695e43e015fc1e3e35,2016-03-08 06:14:54,Juan Tejada,"fix(date-utils): Add localization to date formats

Summary:
- Setting the locale in moment was not sufficient to actually use the
  correct localized formats.
- Moment provides localized format via the formats : 'L', 'LL', 'll',
  etc. See: http://momentjs.com/docs/#/displaying/format/
- Updates to set our date formats based on localized formats:
  - Unfortunately, localized formats always contain the year, so I
    manually removed the year from our short format.
- Actually fixes: #1515
- Fixes bug where setting nextWeek or thisWeekend returned incorrect
  date if the current day was saturday or sunday
- Add specs

Test Plan: Unit tests

Reviewers: evan, drew, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2688",False
cdbfb842374d6309c84923c4e4f9c7f65c9bb4b1,2016-03-07 22:54:21,Bryce Dorn,add toogabooga :water_buffalo:,False
7758cf2a610581f3d93f0857e7ab55a9a0a8bff7,2016-03-07 06:07:36,Jackie Luo,spec(theme-picker): Remove filter for theme picker spec,False
22189f91e66afb44941a47706958e526fc8bad85,2016-03-07 06:06:28,Jackie Luo,:art:(theme-picker): Add inline style to close button,False
2fe8650cc4cd5f2a0b838361541ed816bbf6b604,2016-03-07 04:55:52,Jackie Luo,fix(theme-picker): Fix linter issue,False
02ca6ff73ececf62def68d5d75ef15268c7252ba,2016-03-07 04:17:49,Juan Tejada,bump(submodule): Add eslint to arc,False
765c80496389750658829120caee0bad77c33d16,2016-03-06 05:22:21,Ben Gotow,"Merge pull request #1574 from mxstbr/master

Fix link to cypher",True
1dcb7ace963e88631f1e7f8ad4a8919aeb6383e5,2016-03-06 01:43:15,Ben Gotow,bump(version): 0.4.11 beta,False
5f2d6c2e3597d45063846ee3d8f5b7155648bdc9,2016-03-06 00:54:37,Jackie Luo,fix(theme-picker): Update spec to work with iFrame rewriting function,False
092983aaf463ecdc3b3093284dff85f635bcd96c,2016-03-05 22:47:00,Max,Fix link to cypher,False
8b93d34c186624c750533300031b6b458e93d66f,2016-03-05 06:29:02,Jackie Luo,fix(readme): Update theme starter link,False
36ac03de5dae10039ac10bf415adc6d0e6ebed30,2016-03-05 06:27:10,Jackie Luo,update(readme): Add link to theme starter code,False
ba0312501acd3c8a499a7ca2c3265bb73839cebe,2016-03-05 05:04:48,Jackie Luo,"feat(theme-picker): Add visual theme picker to menu

Summary: Adds a new visual theme picker to the menu that allows users to select different themes based on color palettes and then change their themes live.

Test Plan: Test included.

Reviewers: evan, bengotow

Reviewed By: evan, bengotow

Differential Revision: https://phab.nylas.com/D2669",False
b1c65279900e2afd4fbe47d07ffc77065104a932,2016-03-05 03:23:26,Evan Morikawa,feat(onboarding): update account-choose page,False
ec187ab63f74268656face2ba649e1ddd6056306,2016-03-05 03:18:16,Evan Morikawa,feat(onboarding): restyle step 3,False
1b69adb1bb7011d68e6041e744cf448d95a2af85,2016-03-05 03:18:16,Evan Morikawa,feat(onboarding): style page 2,False
6a690723ae52ec29087238821c4491af71d9d001,2016-03-05 03:18:16,Evan Morikawa,feat(onboarding): style page 1,False
5a3f7ad26cc903b20daacf384935e8415b843a76,2016-03-05 02:59:18,Ben Gotow,fix(auth): re-enable ssl_required checkbox with backend support,False
c79e60cd57120a43c7e23b93a04dd3a774359adc,2016-03-05 01:07:11,Evan Morikawa,fix(win): fix minor styling for buttons on windows,False
1dae837828e3764e615584cead6ac33ede1b1822,2016-03-05 00:46:43,logandavis,"Allow testing against local auth stack

Summary:
This commit changes how N1 parses config.cson very slightly
so that when ""env"" is set to ""local"" N1's auth flow can be
tested against local copies of Nylas' auth servers.

Test Plan: I tested it manually against a local auth stack. It worked!

Reviewers: bengotow

Reviewed By: bengotow

Subscribers: kav-ya

Maniphest Tasks: T6690

Differential Revision: https://phab.nylas.com/D2671",False
30fd7ff25f678e6c0c4db5e681381944b5612b7b,2016-03-05 00:44:54,Jackie Luo,update(readme): Update themes and add new plugins,False
248467894e9364b03da9287660e4ec200ae1c10d,2016-03-04 23:58:48,Juan Tejada,fix(lint),False
ba0a2f0294fc44a1d011d85fa445b04ec0540203,2016-03-04 07:44:03,Ben Gotow,"fix(onboarding): Do not load themes in the onboarding window

Do not load user themes into the onboarding window, because it uses a wide range of hard-coded colors and assets and should always be on-brand.",False
7219dd91d749f02f7d482501c08c46a7a4cb0df7,2016-03-04 07:30:43,Ben Gotow,"fix(downloads): Replace stripped extensions, remember folder",False
e7ebf0ba2cb3a6abb4c958fa3ccf7812988a0dbc,2016-03-04 07:00:36,Evan Morikawa,feat(quote): add new quoted text detector for quote strings,False
4e05fc45c80a047f0068d538075ff96949013a09,2016-03-04 07:00:36,Evan Morikawa,fix(quoted-text): add test case for intentional quote text failure,False
422f2f08e50534601a247dba5071d4c0b302452b,2016-03-04 06:33:14,Ben Gotow,build(32-bit): Move a few docker files out of root of repo,False
2a69385918164636f964530ed8d72c1e0e2447f6,2016-03-04 04:09:15,Ben Gotow,fix(phishing): Tie to MessageStore so it works when msgs aren't ready,False
78fb480642e61d6ddc3e495a86abbf2852cc7171,2016-03-04 03:46:54,Ben Gotow,:lipstick:(bars): No email address overflowing phising / autoload images bars,False
6a190f36f85c490280797145b85af957a67fe2bb,2016-03-04 03:40:41,Ben Gotow,"Merge pull request #1342 from mbilker/linux-32bit-docker

[RFC] Linux 32-bit Docker build",True
cc145132da5ed17bee1436403802e9a046f319bb,2016-03-04 03:16:41,Mehdi Rejraji,"Updated Regex to exclude mailto: links only

The rationale being it's covering all of the cases while still having a good performance.
Tracking a non-standard URL is not a user experience problem in a way. It's embedded in a <a href> tag.",False
2d2b9aefa613879d9c83e10fefbbc6f0000c800c,2016-03-04 03:16:41,Mehdi Rejraji,"Match only valid URLs for link tracking

As of now, link-tracking creates link tracking for every <a> tag, no matter the href attribute. This commit only creates link tracking for valid URLs.
The reason I wrote a new regex instead of rewriting linkTagRegex is that this regex is used by message-list.
https://regex101.com/r/jD5zC7/3 vs https://regex101.com/r/cK0zD8/2

Resolves: #1525",False
1023600c7e2dcfb3eab790c9c33225383c692015,2016-03-04 03:15:28,Juan Tejada,fix(lint): Fix linter error in specs,False
0fd2d107b213f4c2d6d190f7ffd81fe531451de6,2016-03-04 02:08:42,Juan Tejada,"test(plugins): Add snooze and send later specs

Summary:
- Also refactors the code a bit for testability and maintainability
- Fixes #1515

Test Plan: - Unit tests

Reviewers: evan, drew, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2651",False
a8a0154c44c6e8fcf9254a7e84b4c069965801c6,2016-03-04 01:40:03,Ben Gotow,"fix(MessageContainer): Fix state, prevent from getting different messages. #1175

Summary:
This fixes a serious issue where drafts could appear to be sending if
they were located in the same index of the message list as a draft which was
previously sending.

Under the hood this was due to two bad programming choices:

1) State based on props in MessageContainer requires correct implementation of
   componentWillReceiveProps. This is definitely an anti-pattern.

2) Using item index rather than clientId as the key for items in the MessageList
   caused containers to be given a different message prop when one was inserted,
   rather than just shifting the existing ones down and inserting a new one.

Test Plan: Not sure how to test this really...

Reviewers: drew, juan

Differential Revision: https://phab.nylas.com/D2673",False
9a06db85db5f10771b3268410d831a017376f0ba,2016-03-04 01:39:16,Ben Gotow,"fix(drafts): Lock drafts when they're deleted so they can't be revived by deltas

Summary:
When we delete drafts, they can sometimes come back because we receive deltas about them,
find that they're not in the cache, and re-save them.

This diff fixes that by permanently incrementing the optimistic change count, which was also do
to prevent deltas from changing threads while we're in the middle of a request that will change
them further. (This may not actually be necessary anymore, because we'd ignore the delta anyway
due to it's out-of-date version?)

Test Plan: Run a couple new tests

Reviewers: drew, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2665",False
7dfd0cddf5fe931d822688e430615317d64f2278,2016-03-03 08:28:07,Jackie Luo,Bump version for node-emoji,False
cc328e890689bf2c8b5014a79acc73dcc454727d,2016-03-03 07:17:47,mbilker,fix(startup): remove beta references,False
385931ca9e0e938ff8893bde643c33af12e2741a,2016-03-03 07:17:47,mbilker,"fix(launch): convert Atom's launch script for N1

Addresses #411

The `N1.sh` launch script fails to account for running from
`/usr/{local/}bin/nylas` where it would throw an error saying
it couldn't find the electron binary.

The Atom launch script works just fine and takes that into account.
The installed launch script here is a reflactored Atom launch script
that properly accounts for running the `nylas` executable and locates
the actual binary accordingly.",False
c2aa575dc42a4880f0eb43d06e4447a174e9bd25,2016-03-03 05:54:37,Evan Morikawa,fix(lint): fix linter error in search-match,False
96df4873f053b1a9923c9e9ca8a96105df5f9b9c,2016-03-03 05:36:40,Evan Morikawa,fix(composer): fix minor spacing issue on popout composer,False
9a576015ed83d494f88f8e44a30b84925ac18984,2016-03-03 04:30:01,Evan Morikawa,fix(find-in-thread): minor rename fixes,False
800f3a041bef69e14014827b2f5a337a50359347,2016-03-03 04:16:27,Evan Morikawa,"feat(find-in-thread): add the ability to find in a thread

Summary: Find in thread

Test Plan: todo

Reviewers: bengotow, juan

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2660",False
53446f91aeaf4659d8d2292c8c858fdc64e27e9a,2016-03-02 23:58:32,Ben Gotow,fix(hidden-messages): Address diff feedback from @jstejada,False
f413386b801ac976f792302173275cb51427d474,2016-03-02 23:35:17,Ben Gotow,"feat(hidden-messages): Filter trash/spam messages. Fixes #1135

Summary:
By default, the messages in a thread are now filtered to exclude
ones moved to trash or spam. You can choose to view those messages by clicking
the new bar in the message list.

When you view your spam or trash, we only show the messages on those threads
that have been marked as spam/trash.

Test Plan: Run a couple new tests

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2662",False
a950b40175ae91f05654816823049acad30d6b94,2016-03-02 07:04:36,Ben Gotow,rename(specs): A few more task renames,False
597b8215d6a2d12ff6c0514a163c5347a6fddc24,2016-03-02 06:59:23,Ben Gotow,rename(tasks): Add the -task suffix to all tasks,False
2c28c66a8a395394d9761e248f8828f2f591606b,2016-03-02 06:54:37,Ben Gotow,"test(send): Improved coverage of metadata logic, file uploads

Summary: Just new specs. Tested by manually breaking lots of things in SendDraft

Test Plan: Run new tests

Reviewers: juan, drew, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2649",False
11c119393ecfbf7a21eb76b5800b0fbabf6bc9df,2016-03-02 05:32:20,Evan Morikawa,"fix(account): re-add token if a new one comes in

Summary: fix(account): allow users to reconnect accounts if auth has failed

Test Plan: manual

Reviewers: bengotow, juan

Differential Revision: https://phab.nylas.com/D2663",False
a421ee2a80118758bc3ab0be67690ae26ac589e8,2016-03-02 05:03:02,Evan Morikawa,fix(account): re-add token if a new one comes in,False
5efb41031c168d0a929e5dd02d15804925e5dc18,2016-03-02 04:20:35,Ben Gotow,"Merge pull request #1469 from e2corporation/readme-custom-envs

README Update",True
ba07727fc43913b370f1cc984bff3ca8cc22a227,2016-03-02 04:20:10,Ben Gotow,"Merge pull request #1520 from mbilker/lint

Correct eslint errors from Travis",True
f13fc466111449309dd96e08d055361ff1f7f05c,2016-03-01 21:28:29,mbilker,"lint(*): correct eslint errors, warnings still exist

There are warnings in `spellcheck-composer-extension.es6` for the `while (true)`
loops.",False
af6f544cc98d386732ab175afd4874be0ad00c1a,2016-03-01 10:16:30,Jackie Luo,"fix(composer-emojis): Insert emoji on tab, fixes #1511",False
3fc6582718277afd7cfa21a10ce6cd61092b3451,2016-03-01 08:17:22,Ben Gotow,"es6(*): convert 20+ source files used in example packages to ES2016

There could be a few lurking bugs. Please test!",False
759b613f6287c5de3d592439946ffa3b52526703,2016-03-01 01:47:14,sdewith,"Add Mail.app keybinds

Added jumping, search focus, select, star and archive keybinds to Apple
Mail keymap",False
3508e7b9d7064f5d76af55fb96c60f128e20ae48,2016-03-01 00:27:09,Ben Gotow,"Revert ""bump(electron): 0.36.9. Fixes #911""

This reverts commit 3f211a023c2f664f049607dd631752afd9986574.",False
c3123b1d45e40f91c6b80bb0e8d63c6ccea114eb,2016-03-01 00:07:48,Juan Tejada,fix(specs): Update spy on `persistModel` to reflect actual behavior,False
3f211a023c2f664f049607dd631752afd9986574,2016-03-01 00:06:30,Ben Gotow,bump(electron): 0.36.9. Fixes #911,False
e4394e92d0732e8550af5eb1996b4fd82b03cbd9,2016-02-27 22:10:39,Julien Chinapen,"Example Update

Update code snippet to show `env: custom`

Signed-off-by: Julien Chinapen <j.c@shogun.io>",False
bbda8181284145b8c245f31d50385af75d4511da,2016-02-27 19:20:04,Julien Chinapen,"README Update

Updating Contributing guidelines to make note of the `env: custom` option so that a Sync Engine in a local environment may be accessed on an alternate IP.

Also APIRoot must contain quotes around the URL otherwise a config validation will be thrown.

Signed-off-by: Julien Chinapen <j.c@shogun.io>",False
822a42cb5af31ed472b5d1c4dad83e91d462a6ac,2016-02-27 07:36:40,Ben Gotow,fix(aliases): Work window should reload when an alias is added,False
cae9feaff727e07452a47a82f8db998717769e4d,2016-02-27 06:19:46,Ben Gotow,temp(onboarding): Remove checkbox for option not yet on prod,False
3a1fcc513b43a2f9b2cf9eac5010b48110c89813,2016-02-27 06:15:21,Ben Gotow,bump(version): 0.4.10 and changelog,False
76c9f26153868085c5b252d20a246bbfd7c8b74f,2016-02-27 06:09:45,Ben Gotow,"fix(plugin-auth): Once plguin auth succeeds, don't do it again",False
29cf1fedcdfc185db9ca210915560900773c6c80,2016-02-27 04:56:26,Juan Tejada,"fix(templates): Open manage templates from composer window

- Fixes #1433
- Make Action.openPreferences global",False
8f184f2896efdb54bca5585108d0d11262bbdde4,2016-02-27 04:43:33,Drew Regitsky,fix(message-controls): add accountId to debug values copied to clipboard,False
011431f93a7bbd435a8b0de0316a1c1aa7991f21,2016-02-27 04:30:56,Ben Gotow,fix(threads): Right-align the timestamps in the thread list,False
6ec0045677e7a83d10656fbdeb41339ce2154d4c,2016-02-27 04:10:16,Ben Gotow,:lipstick:(print): Fix #1425,False
5691fc88caf6047179d65ca0833f91578d6fbac5,2016-02-27 03:22:19,Ben Gotow,"fix(config): Store cursors with sync state, avoid constant config.cson writes

Summary:
Previously we were storing sync cursors in config.cson. They were by
far the most frequently updated piece of data in config. To make things worse,
all the writing was happening in the worker window - the main window was just
seeing the changes on disk and reloading.

I believe there's an edge case which causes the main window to read the config
file when it's mid-write and empty. This causes the accounts array to become
empty in the AccountStore and lots of downstream issues. It's also then possible
for the main window to write a config change of it's own and empty the file
permanently.

Test Plan: A few new tests to make sure this is backwards compatible.

Reviewers: juan, evan

Reviewed By: juan, evan

Differential Revision: https://phab.nylas.com/D2642",False
3fe03000cf233d8bebebdac0f9a0522dc91e8c74,2016-02-27 02:58:42,Ben Gotow,bump(submodule): theme and plugin installation reporting fixes,False
00109f28efa661bd1e771113e452ec3862c1b632,2016-02-27 01:59:11,Drew Regitsky,fix(message-controls): update email address for reporting,False
b93182920f75f1cecd3f3275e5001af7ffa64510,2016-02-27 01:56:20,Drew Regitsky,feat(message-controls): Option to copy message IDs/metadata to clipboard,False
73ddd39cb2df1ad79fc36489f1c4ddd5fa770313,2016-02-27 01:10:59,Ben Gotow,"fix(402s): Handling of Message Rejected, error messages with more detail",False
038f348281e8d3d93355fdb2eed093c8e682ffcb,2016-02-27 00:54:00,Juan Tejada,fix(lint),False
7ba13d0f0a98faab11b44fea4a968ea8e86c071b,2016-02-27 00:31:01,Juan Tejada,"fix(aliases): Fix regression to properly create/update/remove aliases

- This fixes #1428
- Add specs",False
24ca99e9257895ec03d08828bc03c30035bbda51,2016-02-27 00:25:31,Ben Gotow,fix(focus): Focusing quickly enough can throw. Sentry #14942,False
7d92f725524ce4bc13b4d9077563e56b3d125069,2016-02-26 22:58:45,Evan Morikawa,fix(tray): windows tray opens window on click,False
250434e302e4135b8740cc9f1eed220a094e2874,2016-02-26 22:50:08,Evan Morikawa,"Merge pull request #1441 from mbilker/fix-tray-icon

Rename tray icon files for Windows and Linux",True
b736d4ffc2529b958e9d2cec8f5b1d0de8e11156,2016-02-26 22:15:58,Michael Grinich,"Merge pull request #1405 from P0WW0W/master

Less is More Theme",True
653897470673636193ba5eed6f771e5f3101a6ed,2016-02-26 22:07:20,mbilker,lint(system-tray): code style consistent with rest of file,False
f0914d5a8a45bd25fa57f096157c96a9fd77d50f,2016-02-26 21:53:53,mbilker,fix(system-tray): rename icon files for Windows and Linux,False
1debed15d79fb31bfb7b7f310b7ed697abbf4ddf,2016-02-26 19:51:25,Alexander Adkins,Update README.md,False
7ca523a0d9d1a85df958e7022bb867617da7c5ea,2016-02-26 08:28:44,Evan Morikawa,fix(download): ignore non message deltas instead of erroring,False
0b6272422d72efbdb765954ca3e3e617b22b32f9,2016-02-26 06:42:10,Evan Morikawa,fix(account): notify if we have bad accounts,False
fbd0aa35e688b9d681636628f3db2da1d78b5bce,2016-02-26 06:39:55,Drew Regitsky,fix(draft-syncback): fix bug preventing new draft metadata syncback,False
2b3516d92a7a591c873258d11919131b0a92bb1e,2016-02-26 06:34:32,Evan Morikawa,fix(travis): fewer builds,False
080ff933f22fdc4d4efa0a3dd2501c4e1118be34,2016-02-26 05:58:56,Ben Gotow,fix(metadata): Saving on non-existent models should not throw,False
24939caa783852a52bfa05e58742a52059116f32,2016-02-26 05:50:58,Drew Regitsky,fix(metadata): update metadata version when processing deltas,False
79b800c2a31e89552bea1fb44636c39f21222fee,2016-02-26 04:08:49,logandavis,"Re-add SSL checkboxes with name ssl_required

Summary:
Now that IMAP auth without SSL is enabled,
those checkboxes that weren't doing anything can come
back.

Test Plan:
This change isn't fully tested and should be thoroughly
inspected (on staging?) before rollout. The N1 end works and sends
parameters correctly, but a 401 prevented local testing of the
interface between N1 auth and sync-engine auth.

Reviewers: bengotow, drew

Reviewed By: drew

Subscribers: kav-ya

Maniphest Tasks: T6666

Differential Revision: https://phab.nylas.com/D2632",False
91a589bd32120a3cc292be150a808eb49e4cd551,2016-02-26 03:40:21,Ben Gotow,bump(version): 0.4.9 and changelog,False
c5f112f846335251f2b33ccdb4e55438bb210dee,2016-02-26 03:32:58,Juan Tejada,fix(snooze): Do not display snooze buttons unless looking at inbox,False
a63bc9e4b01c175c91a7e7888f5a6d6a05ef5dbb,2016-02-26 03:31:15,Evan Morikawa,fix(analytics): fix send later and snooze analytics,False
1d130e15c89a33bea128659a30013c88c420af45,2016-02-26 03:09:30,Ben Gotow,perf(snooze): Don't wrap snooze label in unsafe container,False
ddb2de7b65bf6b65598492744d694e9733c5f9e6,2016-02-26 03:02:59,Ben Gotow,fix(link/open tracking): Update error messages,False
5694b3e4fbea1ae7b2f07bbb64ea1d2cf20e1d7d,2016-02-26 03:02:58,Ben Gotow,fix(snooze): Hide N1-Snoozed from the category picker,False
3edec42f066ccd6f396bb8a8ff712d78400a9236,2016-02-26 03:02:09,Evan Morikawa,fix(analytics): clean up events,False
e6e893223193cf8ade07afefbf2f1df52047bc09,2016-02-26 03:01:34,Evan Morikawa,fix(composer): focus on the absolute end when clicking near the bottom,False
f22fdbae492837e4b1a7ce774fbd6fa8a0b5cba2,2016-02-26 02:42:40,Juan Tejada,"feat(snooze): Add snooze date label to snooze threads

- Adds a new InjectedComponentSet for the role 'ThreadList:Label'.
- Adds a new label to the thread list indicating the snooze date if the
  thread has been snoozed
- Coerces MailLabel to achieve this. This is a temporary hack, we should
  design a better view to display snooze date information",False
f75eddb5185166d48353ed27aaced1094422e58b,2016-02-26 02:24:18,Ben Gotow,"fix(link/open tracking): Remove intermediate metadata states, extra db lookup, dead code",False
18be81098e58d2f1d82dc90eb6ae9e0c29605c1e,2016-02-26 02:04:09,Evan Morikawa,"feat(analytics): add analytics to send later, snooze, tracking",False
097bc94cd7cdd76e0aef9679a0cda146927ea473,2016-02-26 02:00:20,Drew Regitsky,"fix(composer-buttons): Fix broken icons on overflow, make buttons wrap",False
32862ad95106401742315eae3721414dd210276e,2016-02-26 01:36:45,Evan Morikawa,fix(popover): set min-width on popovers,False
3e67d0b4512e087a8153db3ef45f0f3cd48f9d99,2016-02-26 01:25:57,Juan Tejada,"fix(date-utils): Update semantics of 'Tonight'

- If it is past 8pm, it will snooze until midnight",False
265eb2d4e9f800e69402f5573d0ee4c2b3d3149d,2016-02-26 01:25:11,Evan Morikawa,"fix(plugin): better errors if plugins are malformed

Fixed read assets",False
9330f005498083c85b629ec9d298e9dc39621bfa,2016-02-26 01:12:38,Juan Tejada,:lipstick:(composer): Properly align 'X more' token,False
f4e6a6e2aace1e81afce522e20a1a8b66d497aa3,2016-02-26 00:35:07,Ben Gotow,sp(translate): Transalate => Translate,False
164ac49fa522e5c1b944bbe7b3e0ecddfb3893b8,2016-02-26 00:12:21,Juan Tejada,"feat(snooze): Update message in toast when snoozing

- Adds new arg to ChangeLabelTask and ChangeFolderTask to override
  default description
- Adds custom description to task when snoozing",False
91c05d5ab21b2a44bdf7664be9d106cee371a706,2016-02-26 00:08:56,Ben Gotow,"fix(swipe): Ignore err, since stdout = '' is an expected case",False
7d05523b0f2b6ab7fb0c6ac1f930e51aa2a157b1,2016-02-25 23:54:29,Juan Tejada,fix(plugins): Add headers for composer popover + Fix in snooze popover,False
717d20f96e2f89aff47f90b5cc2e278fe83ebb7e,2016-02-25 23:36:17,Evan Morikawa,fix(composer): minor padding fix in composer,False
7682a7fa1cc0c6b03e4eb217aec5a6f24407e678,2016-02-25 10:36:06,Ben Gotow,:lipstick:(sidebar): 1px fix for @drew ;-),False
a5fe9cdf1810f7928add69792dacc1c9618df5c1,2016-02-25 10:31:23,Ben Gotow,"fix(swipe): Make it easier to close snooze-confirm swipe state, fix double-popover issue",False
428d37b4fe66d4b10a9238247ee69167db99a078,2016-02-25 10:31:23,Ben Gotow,"fix(swipe): Count '' as ""natural scrolling enabled"" on Mac OS X

This value is returned if the user has never touched the system preference option at all.",False
0c320d3a2850769ec902457cc2603609845acf2a,2016-02-25 10:11:54,Jackie Luo,fix(composer-emojis): Adjust width for overflower,False
0553b7bde3f3ad346db6723eb446ab65d04d5adf,2016-02-25 09:35:21,Ben Gotow,"fix(snooze): A few minor popover adjustments. See desc.

- Rather than have a `showing` prop on the fixed popover, I just remove it and put a span in it's place when it's gone. This means we always get componentDidMount when the popover appears and simplifies when to focus it's content.
- The fixed popover implements esc and blur behaviors itself
- The fixed popover uses the background-secondary color and works in dark mode
- The snooze items have hover and active states",False
9f047359e6774f5367639d508a82294c046beb10,2016-02-25 09:35:21,Ben Gotow,fix(thread-list): Invisible div extending into thread list blocks clicks,False
b2074eefc61d7bf7bd0f95501703990bf042fade,2016-02-25 09:35:21,Ben Gotow,fix(star): Bulk star icon has never shown current state(?!),False
bb88d7be40910ef0607b50b6704daee49a8e7375,2016-02-25 08:37:15,Jackie Luo,Add Sunrise to README,False
80deadd5c7751902ef571992b0230f09e165bbc2,2016-02-25 07:52:54,Juan Tejada,:lipstick:(plugins): Add error messages back to plugin dialogs,False
162aac494345e2919fa92c2d16b0161472f0ceca,2016-02-25 07:45:55,Ben Gotow,"fix(build): Don't delete plugin package.json files, restore ellipsis (@sdw consulted HIG!)",False
68d08fda850bada5350df01254934c8a3dfb68ac,2016-02-25 07:34:42,Evan Morikawa,fix(toggle): Will always turn off read receipt config on error,False
6fe36c72a5a3cf33f9bef4351122445d55c778cd,2016-02-25 07:26:52,Drew Regitsky,fix(snooze): options text capitalization: title case => sentence case,False
d6a3abdbe03aaa8b2a4e78b9c096186ee59bbc50,2016-02-25 07:23:31,Juan Tejada,fix(lint): Fix lint errors,False
4c22fa7489581ef4a855fe499fd26cff18c78d92,2016-02-25 07:15:14,Drew Regitsky,fix(send-later): options text capitalization: title case => sentence case,False
4aecf745ac27b32043149d4383831ded2a2efc29,2016-02-25 07:04:18,Juan Tejada,"fix(plugins): Several minor fixes:

- Fixes styling for snooze quick action button when thread selected
- Fixes snooze popover input debouncing
- Other interaction fixes",False
059b229d65f240827ee8bc9999c6156e1570bc22,2016-02-25 06:56:09,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
5a3527a4fc0f369c3e56edd535207eb3f758942e,2016-02-25 06:55:57,Jackie Luo,:art:(floating-toolbar): Fix height for floating toolbar pointer,False
e96848653e2ae4f5e5597ddf81882122bce9f7c0,2016-02-25 06:50:12,Ben Gotow,fix(sync-draft): Accept the thread id given to the draft server-side,False
82e674292a6d173c3b92f12b2090cabe4a24ee3c,2016-02-25 06:36:28,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
1c995f094ce88a8dd76367fa3f477d5b1a9c5a36,2016-02-25 06:25:17,Drew Regitsky,fix(open-tracking): quick CSS fix to thread list icon,False
cbed789b94ce096566cb021906e9735809e1f86a,2016-02-25 06:21:34,Evan Morikawa,fix(snooze): look at allCategories instead of userCategories,False
3f23db60024b91dbb279b5ad43d47bc2ad696b4a,2016-02-25 06:14:16,Ben Gotow,:lipstick:(snooze): Fix swipe-to-snooze animation,False
ceff83302bd928c44d2c91f685895ed305085b78,2016-02-25 05:59:12,Drew Regitsky,fix(plugins): Change server URLs for open/link tracking to final values,False
5a71018755f8b364cd918f916a128a169417abaa,2016-02-25 05:52:30,Juan Tejada,"fix(popover): Unmount any fixed popover that's already rendered

- Fix input styles for fixed popover",False
77500aadcc273c949897d49180966ee099418b03,2016-02-25 05:41:00,Drew Regitsky,fix(sidebar): Only show add folder icon on hover,False
8e502d5fe5f68b97c84f15f47823a9be22ed4cf6,2016-02-25 05:38:25,Ben Gotow,fix(swipe): Don't allow touch-up to re-settle already settled swipe gestures,False
f0e76019fddf551f4a9254ecd45b020787c93968,2016-02-25 05:36:08,Evan Morikawa,"fix(error-handling): handle offline for link tracking & read-receipts

Fix offline error handling of link tracking and read receipts

Fix ellipses for tooltips

Allow you to change the title in the error box",False
3187d2f0d1ad58c1cd98178f9fdf144c837908ae,2016-02-25 05:03:57,Juan Tejada,"fix(snooze): Fix quick action button, remove italic from popover",False
793941ef92d3e81ed433d420cd0407418b8131f7,2016-02-25 04:55:11,Evan Morikawa,fix(read-receipt): message status updates live,False
6458a90edaaaf43aa73bfa618efe42140a221913,2016-02-25 04:41:03,Juan Tejada,fix(snooze): Close popover on error,False
2eefbc28d3b34f3d12a1cf12b8629c61b735da3b,2016-02-25 04:38:53,Juan Tejada,fix(snooze): Close popover when opening a new one,False
bae079dcc643679b4c195ee29440c1c971f376e0,2016-02-25 04:36:06,Juan Tejada,fix(snooze): Only allow snooze from inbox,False
b09ae2d317a3cc8711d205cad2308e215869499f,2016-02-25 04:32:42,Juan Tejada,fix(popover): Correctly position pointer,False
f7b1209b5cc91cf3e7d09239e57423a11ac918e0,2016-02-25 04:32:42,Juan Tejada,"fix(fixed-popover): Reposition when overflowing on `left` direction

- This is a temporary solution",False
1c5869c8670ad9a6d29bc03b4f63f55e1adcd5d1,2016-02-25 04:16:09,Evan Morikawa,feat(tracking): sticky tracking state and consolidate component,False
bb321f4bd2dae8e56694f3c93fca075c79dd312a,2016-02-25 03:42:07,Ben Gotow,:lipstick:(composer): Shadow on pointer of floating toolbar,False
bb824f36facdd79d420a30afed9256ae8f4bb2b2,2016-02-25 03:19:15,Ben Gotow,"fix(feedback): Remove feedback btn, update ""N1 Help"" in menu bar",False
5e34c889c67fc5da19f4eb31c49e8cafa8bcf8d0,2016-02-25 03:14:56,Ben Gotow,:lipstick:(send-later): Minor draft list styling changes,False
030d86e3bd121f7358d01024f1c6d63c56695c9b,2016-02-25 02:46:53,Ben Gotow,fix(snooze/send-later): Change chrono config to always prefer dates in future,False
ecf3909f7d3cd1fc1148e0347e26e1e96ff66466,2016-02-25 02:46:35,Evan Morikawa,fix(read-receipts): fix padding and styles under selection,False
29785c209e9ab295e47a2eafa5b3a6313c7bf30a,2016-02-25 02:32:18,Drew Regitsky,fix(read-receipts): threadlist icon vert align and placeholder when missing,False
4158e598e0767f1141e9f0f43715539d714938fd,2016-02-25 02:25:00,Evan Morikawa,fix(tracking): tracking pixel won't register if it's from you,False
ada4256dc82bc9a61c576f82532bb3a1ad41b9a8,2016-02-25 02:01:56,Evan Morikawa,fix(lint): fix less and js linter issues,False
9dd7a9600aee862ce2e50d2b58f3634e0cc2c12d,2016-02-25 02:00:12,Evan Morikawa,"fix(tracking): fix link tracking and read receipt plugins

Fix broken links in link tracking and read receipts

Fix bug in email frame where it wouldn't adjust the height even when
content changed

MessageItem bodies automatically clear the MessageBodyProcessor cache when
the message contents (including metadata) change.

Remove unused Account stuff from nylas-observables

Plugins appIds properly read if there's an environment set",False
90b9570f91214f94bae44416aae13235ca0bb431,2016-02-25 01:56:56,Ben Gotow,fix(send-later): Resolves a variety of small bugs from QA,False
f88445af15e9287d912812ff4fe61eee07840f50,2016-02-25 01:47:39,Drew Regitsky,fix(plugins): more fixes to open/link tracking urls,False
0550b092b74e84e8d30619edf928d89a86d0c5f7,2016-02-25 01:30:40,Drew Regitsky,fix(plugins): fix open tracking and link tracking URLs,False
e02b924efb9e18d08f2152a9604f26b59d38083d,2016-02-25 01:20:43,Juan Tejada,":lipstick: (send-later): Update placeholder copy, again",False
300d5dbc7f811a384811a9877f09d18182242027,2016-02-25 01:15:47,Juan Tejada,"fix(sidebar): Prevent error in snooze item when category doesnt exist

- Add Snooze category to locked and hidden categories to prevent from
  directly moving stuff to it and showing up in the user categories
  section",False
42062f23db36fb2bd6f22c956edb2f25f384cc57,2016-02-25 01:02:12,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
630448634c5d2673c9ab459531bd4c0c3196a875,2016-02-25 01:01:32,Jackie Luo,":art:(composer-emojis): Remove pointer and adjust styling

Summary: The floating toolbar now takes an optional boolean to decide whether it shows the pointer.

Test Plan: Tested locally.

Reviewers: evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2628",False
3f591763801c1c378391b48c6227ea84524cfdf6,2016-02-25 00:52:54,Juan Tejada,":lipstick: (popover): Properly apply styles to input inside popover

- Fix tabindex in send later popover
- Update placeholder copy",False
ce17d8ab1eed54e5628785af8105ca2e75df8216,2016-02-25 00:20:21,Juan Tejada,feat(snooze): Add snooze item to sidebar,False
3125d4d2ff8806bb5f1b0c8dc829a4aee9b9e303,2016-02-24 23:58:08,Juan Tejada,:lipstick: (snooze): Add quotes to popover placeholder,False
c0da487e023215a51d6d2520822856c7ed57de3b,2016-02-24 23:57:16,Juan Tejada,fix(snooze): Close all popover types when submitting date with enter,False
c485ad8d66570a108f641fb204cad183acfd5f2d,2016-02-24 23:43:41,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
ef0cf7e3dd748a4922f21c92bd5c11ac8d4440cf,2016-02-24 23:42:38,Jackie Luo,":art:(composer-emojis): Fix styles in emoji picker

Summary: Adjust sizing, padding, etc., to fit better with overall app design.

Test Plan: Tested locally.

Differential Revision: https://phab.nylas.com/D2627",False
b7a6643f76c8eff82d4ebc72538bed127c19a6e9,2016-02-24 23:28:11,Juan Tejada,fix(date-utils): Stop mutating the moment prototype,False
b106bed2a49f05286ff0faff56f3cbe541050269,2016-02-24 14:34:57,Ben Gotow,"fix(*): misc fixes for warnings, appearance of PL indicators",False
9f87ab25dda9be0d0c84c3c746d9958a513d589e,2016-02-24 13:49:55,Juan Tejada,"fix(signature): Update signature when account is changed in composer

Summary:
- Fixes #1239
- Adds action in composer view to indicate when draft partcipants have
  changed. This seemed like the simplest way to listen for this change without
  adding another extension point
- Updates signature plugin to listen to this action and update signature
  accordingly
- Adds test

Test Plan: - Unit tests

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2614",False
a7dd2222f92491f92e83f7b8d9012e0014deeb45,2016-02-24 13:32:10,Juan Tejada,"fix(date-utils): Revert to accessing protype directly - fix lint error

This reverts commit ba5b4cc1e0f533375c86678ae9f3e43784e7d14d.",False
7ec30d0c7b622c70ba894a11293f896aaa8fa844,2016-02-24 12:56:06,Juan Tejada,"fix(system-tray): Move Tray to main process

Summary:
- Fixes #1223
- Still uses a package in the renderer process to listen to changes in
  the unread count and have access to the canvas api.
- Renderer process will write icon to disk and inform main process that
  it should update the icon

Test Plan: - Manual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2613",False
ba5b4cc1e0f533375c86678ae9f3e43784e7d14d,2016-02-24 12:32:39,Ben Gotow,"fix(send-later): Override moment's __proto__ - oclock wasn't ""sticking""?",False
d34f30cc3e1197c9445ae591b86c64a433b12fb7,2016-02-24 12:25:47,Juan Tejada,":lipstick: (plugins): Clean up constants in plugins

- Fix some eslint issues",False
3a55a126b691aad396cddb3a3cc61785f97fa265,2016-02-24 12:09:18,Juan Tejada,fix(snooze): Fix react component warnings,False
9315ee33855f3ef01cd1d8075960187761e817e9,2016-02-24 11:59:49,Ben Gotow,fix(metadata-plugins): Add production app ids,False
4788ec2dd15a8b3507ba5646d750684f93294722,2016-02-24 09:38:43,Juan Tejada,fix(styles): Fix popover styles caused by incorrect merge,False
a5ee19766016dd423bed578700f63f6027512b6c,2016-02-24 09:33:42,Juan Tejada,"feat(snooze): Adds initial design pass and update snooze popover

Summary:
- Add FixedPopover, an absolutely positioned popover component to use for swipe snoozing:
  - This component needs to be finished, as its current behavior is primarily for the snooze plugin
- Updates popover.cjsx to properly render pointer for thesnooze popover for the `down` direction
- Adds new design assets
- Adds date input to snooze popover

Test Plan: - TODO

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2624",False
0237b8cfd228039ae5c398ab30045edc0f81a9da,2016-02-24 08:49:43,Drew Regitsky,fix(metadata-plugins): update all appIds and URLs for staging,False
50a104c1fda8edabc4238e3b9ca7bc12405cf905,2016-02-24 08:28:07,Evan Morikawa,fix(link-tracking): fixes in link-tracking,False
dd6cefc3f88c2a3070d33301a57ff57483f0e0d6,2016-02-24 08:28:07,Evan Morikawa,fix(read-receipts): Style fixes to link tracking and read receipts,False
9d11da4a5e5ef772db6a70e94807841d5e9ba3e4,2016-02-24 08:28:07,Evan Morikawa,feat(read-receipts): show status on MessageItem,False
9ef84e476a714ea9bf7071f9d80717f911884ae8,2016-02-24 08:05:24,Ben Gotow,"fix(auth-failure): Warn of disconnect on 403s, fix logic",False
7e96a169a284f15338a045a42d989f3daa685e5f,2016-02-24 07:21:10,Ben Gotow,:lipstick:(plugins): Updated assets and a bit of error handling,False
b7485e0699db241cd46845fc54beb436039c5ccf,2016-02-24 06:16:46,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
0a12df5dc6ff968329c8c21c24ef654eb9fe4664,2016-02-24 05:26:34,Ben Gotow,:lipstick:(toolbar): Baseline fix for mark as read,False
6eed3ce0549deadcafa4d66adfaf67727249ccae,2016-02-24 05:10:44,Ben Gotow,fix(composer): Redo toolbar styling with theme variables + minor fixes,False
686a3f4fdade84364bcc19a11a4d1642d44c9a17,2016-02-24 04:07:10,Ben Gotow,":lipstick:(snooze): Quick action styling, draft pencil alignment",False
d674a665fed525ca00815cf52d4553100193424b,2016-02-24 04:07:10,Ben Gotow,fix(send-later): Re-order so send later always appears beside send,False
ac5266a1a51baa6bdcc9f57771cfe7ffd356c562,2016-02-24 03:48:49,Evan Morikawa,fix(linter): fix less linter error,False
f76acfa4419fb7e62ab4ce39796aca2b36c31870,2016-02-24 03:47:11,Evan Morikawa,fix(inbox-zero): don't show inbox zero when syncing,False
a1a126893ca6cd317bea0e904d3bc53fa6fac519,2016-02-24 03:42:02,Evan Morikawa,fix(img): png-crush images,False
eb09929ae722039e36b05f2c4674bec38b2b8953,2016-02-24 03:25:31,Evan Morikawa,fix(composer): fix styles in popout composer,False
9541343835ea92473003edfe44c0754cb9ad649c,2016-02-24 03:22:18,Ben Gotow,:lipstick:(send-later): Lots of styling of send-later,False
6349a1ff0c5daa4f4b601ef82036cf584cba4427,2016-02-24 03:12:10,Evan Morikawa,feat(composer): new composer footer and icon design,False
5d8461381e71bc9affcba1b2f591509d9c791699,2016-02-24 01:04:08,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
cdd015cfab7c5bb7511ee3b09a1720163393b4cd,2016-02-24 00:20:08,Evan Morikawa,feat(inbox-zero): add minimal graphic to inbox when no threads,False
c0123e2b701640b442fd2526b713ae6f6103d3d8,2016-02-24 00:18:36,Ben Gotow,:lipstick:(onboarding): Incorrect button padding during onboarding,False
5aa0d315e057ac0414d667723cbdaa417579160b,2016-02-24 00:08:19,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
8ed28f76d166626691d56da3cbc7d022033b3c8b,2016-02-24 00:05:08,Ben Gotow,:lipstick:(icon): A delightful seafoam green icon,False
9bc7bbac6170623b88c5e9e74dd23709bda6e1b6,2016-02-23 07:38:32,Drew Regitsky,hack(plugin-auth): temporarily disable confirmation dialog for plugin auth,False
625c419b72fa96f520f348a81fc3164f01b76d77,2016-02-23 07:11:38,Ben Gotow,bump(verison): 0.4.8 beta,False
9de55ea5dabab068cb1762d620603d8ce5e9b374,2016-02-23 07:11:32,Ben Gotow,fix(list): Don't drag the item being edited. Fixes #1386,False
55df92588f2c0dc0aabaca5175b814b0a014ac0a,2016-02-23 05:38:44,Ben Gotow,fix(list): Restore keyboard cursor to single pane mode,False
549ae38b6c8c62f791d2a40b07e37c986e53aca6,2016-02-23 05:38:10,Ben Gotow,"fix(swipe): Better animation, callback for action completion",False
42793e6b0c7654acf9081de4144bdd8babea22cb,2016-02-23 03:00:12,Ben Gotow,:lipstick: Minor visual tweaks to win32 + dark mode,False
ef45bb07ecc0f777459d7d3e035e51e64344714d,2016-02-23 00:42:49,Ben Gotow,"feat(swipe): Touch support (for MSFT Surface and others), natural scrolling detection for Mac OS X

Bonus - you can test touch events in Chrome using device mode: https://developer.chrome.com/devtools/docs/device-mode",False
b923086c2a2595d4be7805643a5d6293e253f1e9,2016-02-23 00:27:22,Ben Gotow,fix(drag): Patch for crash on dragging threads,False
54ecb2bd58fb79e8503600c03d47cf9ef7f1a106,2016-02-22 23:44:34,Ben Gotow,:lipstick:(search): Fix clear button positioning,False
20510a1e8fc0a6d510042d82700ab07dab4defc9,2016-02-20 08:55:29,Ben Gotow,fix(copy): Sending draft => Sending message. Resolves #1275,False
b6ebefe1cabb82a83ba5c896f4579ac96914311a,2016-02-20 08:49:43,Ben Gotow,"fix(compose): More defensive check when switching from address, see description

This fixes #1341, but is more restrictive:

- You cannot switch From: accounts if the draft was retrieved from the sync engine (authored via Gmail or via another copy of N1. The sync-engine gives drafts a non-null threadId)

- You cannot switch From: accounts if the draft is a forward from an existing thread.

These two restrictions are unfortunately necessary to ensure that we don't have to download attachments we don't have to re-upload them to another account on the sync-engine. We could write code for this in the future but it's going to be gross.",False
5c8c13996562687b8a2408addf8f83715baf1df1,2016-02-20 08:37:22,Ben Gotow,"fix(print): Add print button to preview, don't print immediately (Fixes #1352)",False
9f8f1750cc3a2d65ade1b9426565540e1c71f5ce,2016-02-20 08:29:17,Ben Gotow,fix(compose): Enable esc-to-cancel from Cannot Send dialog (Fixes #1383),False
f1cd1056cc9bb3703b0030389c4522e06c3e6402,2016-02-20 08:24:20,Ben Gotow,fix(attachments): fixes + specs for download `on-receive` option,False
840b48c2df7db5de7e9ed0a699ff58d21a3076af,2016-02-20 08:22:49,Ben Gotow,":lipstick:: Experimental app icon, fix for merge conflict",False
55e1c85964abcdf272dbdf05169d342864065aa7,2016-02-20 07:52:45,Ben Gotow,bump(version): 0.4.7 beta,False
592374c0dc2cfccc570cb9ea1517e273da077b9b,2016-02-20 07:52:28,Ben Gotow,"feat(swipe-to-*): Gesture support and animation in thread list

Summary:
This diff does two things:
- It adds a new SwipeContainer that makes it easy to implement swipe gestures. This is built into listTabular, so you can create a list and define onSwipeLeft/Right to enable gestures.

- It adds support for basic add/remove animations to the thread list. This works by adding a CSS transition to `top` and also leaving removed rows around for a specified time. (these times need to match.) Pretty much just cloned the core idea from TimeoutTransitionGroup.

Test Plan: No tests yet

Reviewers: evan, juan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2581",False
fb4e806afec09d1458736d52cdc6a77d1c824b24,2016-02-20 05:05:48,Evan Morikawa,"feat(menu): add right click menu

Summary:
Adds a right click menu to the thread list
Moving to folders and labels #TODO

Test Plan: TODO

Reviewers: bengotow, juan

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2609",False
95aba569798ccda558b9e0f63927775cc4961c8b,2016-02-20 05:01:51,Ben Gotow,fix(sending): Tiny fix for strange vertical space when sending,False
34f530ce71d290082739ce0b9234b8ffa471631b,2016-02-20 04:20:36,Bernd Verst,"Changes the Gmail auth domain from edgehill.nylas.com to n1-auth.nylas.com

Summary: Changes the Gmail auth domain from edgehill.nylas.com to n1-auth.nylas.com. This URL is displayed in the browser.

Test Plan: Manually built N1 and verified signin flow works with new subdomain.

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2540",False
703d7bc2e0bf91e7b495ce85be3529b6d881eeb6,2016-02-20 02:54:04,Juan Tejada,"fix(transaction): Trigger changes only after COMMIT has been executed

- Fixes #1327
- This caused the dataase query inside QuerySubscription to, on occassion,
  return stale results from the database because the database hadn't
  finished writing. This consequently caused the QuerySubscription to
  build and incorrect result set.",False
199a62d70e145e0683cab555e48fd65bc6bbd678,2016-02-20 02:12:56,Drew Regitsky,"feat(new-plugins): add open tracking and link tracking plugins

Summary:
Adds two (very similar) plugins - Open Tracking and Link Tracking.
Both can be enabled via a button in the composer. Open tracking
inserts a tracking pixel right before send, and link tracking replaces
all links with tracked redirects. Both plugins use the new Metadata
service to store their open/click counts, and have backend servers to
respectively serve the pixel image or handle the redirects. Requests
also trigger a metadata update to increment the open/click counters.

Test Plan: Manual for now

Reviewers: evan, bengotow, drew

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2583",False
aedc09b2b3dc997a914914d1147f7033765a697b,2016-02-20 01:24:02,Juan Tejada,fix(metadata): Correctly call modelify for latest models when setting metadata,False
b65c4104b4d8e0d8e60053b459378672c16ff13e,2016-02-20 00:59:31,Ben Gotow,lint(emoji): Fix lint failure from spacing,False
97f968a8089a8c803daec5c951afe4d14f6bb03a,2016-02-20 00:50:36,Karim Hamidou,"[auth] Change a Google OAuth parameter

Summary:
Some of our users who reauth are getting weird errors from Google — it seems that in some cases Google OAuth doesn’t pass us a `refresh_token`, even though we ask for one by passing `approval_prompt=force` (I’ve landed a commit to log more details about this in edgehill-server —- https://github.com/nylas/edgehill-server/commit/6e984ffa268d8523b6f98be8532c4ebfaa2d1536 — but this won’t fix the problem).

Apparently, Google recently « soft-deprecated » `approval_prompt` in favor of a new parameter called `prompt`, which does mostly the same thing (https://developers.google.com/identity/protocols/OAuth2WebServer#formingtheurl)

This diff replaces `approval_prompt` by `prompt`.

Test Plan: Tested by authing a Gmail account and checking that it worked.

Reviewers: bengotow

Reviewed By: bengotow

Subscribers: emfree

Differential Revision: https://phab.nylas.com/D2557",False
98529dc7a8bb8ccab6cf079a6bcdf127e5b3748f,2016-02-19 23:58:02,Ben Gotow,fix(participants): Update specs to reflect that spacing is now in CSS,False
c3ca9c4a9ef2e33b0570d172b8d1724141c83cd4,2016-02-19 05:39:30,Ben Gotow,fix(launchscreen): hack until renderer sync fixed upstream,False
d722153de7037ef499861ed2665792a7c13082a7,2016-02-19 05:19:45,Ben Gotow,fix(lint): LESS lint issues,False
b6a1674173e85a71716ea534e1cb86498f8787f3,2016-02-19 04:51:42,Ben Gotow,"💄: White buttons, dropdown / popover cleanup, hairline dividers",False
a673a698fd6182608359e30f989dd785e0bc6874,2016-02-19 02:53:25,Michael Grinich,"Merge pull request #1350 from jamiewilson/patch-1

Adding Darkside theme",True
74bb98b337c099dd44cce1b8948804090a6917d0,2016-02-19 01:44:18,Juan Tejada,"fix(draft-list): Display `,` separated participants list",False
d0bdeb3a02bdd59f2f8d3b4adb3b2758f769213a,2016-02-19 01:36:29,Juan Tejada,:art:(composer): Fix `show-more` token style in collapsed participants,False
9f820854d4923324719969178229c1f8a228a183,2016-02-19 00:35:13,Juan Tejada,fix(issue-template): Update formatting,False
bb52510c876745ee5e7e04441f9efa32c82c2708,2016-02-19 00:14:03,Juan Tejada,fix(snooze): Check if snooze category is defined when creating,False
a841417011aad244d8d13ebeb1e417056be041bc,2016-02-18 23:36:21,Juan Tejada,"feat(snooze/send-later): Add snooze and send later plugins

Summary:
- Add initial version of snooze and send later plugins
- Tests are missing since this will probably heavily change before we are done with them

Test Plan: - TODO

Reviewers: drew, bengotow, evan

Reviewed By: bengotow, evan

Differential Revision: https://phab.nylas.com/D2578",False
21ce6355a51f4ea50958862efe8c1a71cec909eb,2016-02-18 23:33:18,Ben Gotow,gh: Issue template isn't actually displayed as markdown,False
42d43cf80247fc0b0161c7154f8cd76c8e2a682d,2016-02-18 23:25:52,Ben Gotow,gh: Initial commit of issue template,False
7ca844bd75839db2687401e4bee0987b803129a1,2016-02-18 11:51:23,Ben Gotow,"fix(onboarding): Missing require for Actions, bad CSS",False
0217e5a509ac9c475649b775d784311f33a8ab07,2016-02-18 04:30:33,Juan Tejada,"feat(metadata): Switch to storing metadata on models

Summary:
 - Adds a class ModelWithMetadata which models can now extend from
 - Instances of this class can query metadata for a plugin via
   `obj.metadataForPluginId(pluginId)`
 - To observe changes on metadata it is sufficient to observe database changes on
   the model. e.g.:
   `DatabaseStore.findAll(Thread,
   [Thread.attributes.pluginMetadata.contains(pluginId)])`
 - To set metadata a new action has been created: Actions.setMetadata
 - Adds a helper observable in nylas-observables to query for models with
   metadata
 - Merges CreateModelTask and UpdateModelTask into SyncbackModelTask
 - Update SendDraftTask ans SynbackDraftTask to handle metadata changes

Test Plan: - Unit tests

Reviewers: drew, evan, bengotow

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2575",False
458b0fbe9186839f346d747adf8c5e081e823bad,2016-02-17 09:54:17,Michael Grinich,Add Waffle.io on deck badge to README,False
7ca04c579e8c6cbf16195743416e213fc58eca20,2016-02-17 07:33:22,Juan Tejada,"fix(account-prefs): Update account save logic to prevent incorrect saves

- This fixes #1354 and #1235
- This issue was caused because the account details preferences
  component was keeping as state all of the account object fields. `setState` works
  like `extend`, so when the account changed, state was set to the new set of account fields,
  but the old values were only removed if they were overriden, and remained the
  same if the field did not exist in the new state object.
  Specifically, when a new account was added, setState was called with
  `{..., defaultAlias: undefined}` which did /not/ remove the  the defaultAlias
  from the previous state.
- Switched to managing state with a top level key `account`",False
139f25e12f61e5cc451a5928ea86ace2d314b123,2016-02-17 06:56:45,Juan Tejada,"fix(account-store): Update focused perspective after triggering

- This prevents account store changes from propagating in the incorrect
  order",False
8f6dff7da82b70b93086e59a242eca9e4a0eed57,2016-02-17 01:11:15,Ben Gotow,"fix(important): Remove todo, reference to usesImportantFlag. Fixes #1331",False
a9f7274bcfa88a7a6c6f53416fe2025b18ba7a59,2016-02-17 01:10:23,Ben Gotow,fix(undo): Queuing an empty array should not trigger undo-redo store,False
38e4765eac8b06b6c97a11985ef509f0aed673c2,2016-02-17 01:01:29,Jamie Wilson,"Adding Darkside theme

Can be seen here: http://jamiewilson.io/darkside/ and here: https://github.com/jamiewilson/darkside",False
cc686feabba2022e6a21aa1a70e8d638b0e34c1b,2016-02-16 23:13:15,Ben Gotow,"Merge pull request #1324 from sethvargo/sethvargo/apple_mail

More closely match Apple mail shortcuts",True
fd162ac4da60ee06c359b918129e528c93102ef1,2016-02-16 07:42:17,mbilker,fix(publish-nylas-build): return undefined to prevent grunt interpreting as failed build,False
dce7484e44483e9645612f1eb05d4b98602e37ac,2016-02-16 06:56:00,mbilker,fix(mkrpm): remove spaces before/after `=`,False
d1c3ecb07465d3d82a3f6fdf1a7f3842ad691545,2016-02-16 06:37:09,mbilker,fix(docker): add build dependency libgnome-keyring,False
13e5434abcb7fb7b6b55abf02c2e1af7f4010433,2016-02-16 06:36:20,mbilker,fix(mkrpm): add in missing `then` command,False
37005ca80b669417677a88850468ff58914b8620,2016-02-16 06:35:01,mbilker,fix(build): add python as build dependency,False
8b4c660c1086fd2ff0205bbfe5397783a598b6a9,2016-02-16 06:23:33,Juan Tejada,fix(mail-rules): Fix undefined reference to ReprocessMailRulesTask,False
eb2f45534e088ccfd38403d112cb15fbf1bb3ccf,2016-02-16 06:13:08,mbilker,fix(build): typo with PUBLISH_BUILD environment variable,False
0fcd9d0a22c844be75cab9982d2131efa54626aa,2016-02-16 06:11:13,mbilker,fix(build): use special docker build file to run appropriate build tasks,False
e64f573d8a062140cbfdc8abdf3c580adb7027e3,2016-02-16 06:11:08,mbilker,fix(build): add ubuntu 32-bit docker build,False
752e0bb25a7c529d2a240df84db55141e827f458,2016-02-16 04:44:05,Seth Vargo,More closely match Apple mail shortcuts,False
3298a38d6a4b015e6ef19403d1981fd2147f1900,2016-02-16 04:42:41,Evan Morikawa,"fix(composer): fix dissapearing participant bug w/ multiple composers

If you had multiple composers on a single thread, all but the last
composer would lose its participants. This was because once it loaded the
participants would blur and trigger a request to set the participants to
blank. That request was async so by the time it was resolved the draft was
loaded and the request erroneously went through",False
58d3c1d7cf59294847ace8b0daa7c41db205baa8,2016-02-16 03:21:02,Evan Morikawa,"fix(onboarding): remove ssl-enabled checkbox

Until it's implemented in the backend",False
60f7290564b2c03c6ce7854dcb1b4c889e9e530e,2016-02-16 03:04:23,Evan Morikawa,"fix(messages): fix jumping message list on draft focus

We were erroneously jumping to an individual message when you focused on
it.",False
d80edbf7f373f56e490394a3eaa79eeeaa09af6c,2016-02-16 02:16:33,Evan Morikawa,"fix(message): fix collapse unset when new thread delta

The minification bit was erroneously getting reset when a new thread
update delta came in due to an object equality check instead of an id
check.",False
10564db50a81fac9bf739b6b834fc70bef1c17f0,2016-02-13 03:22:06,Evan Morikawa,fix(analytics): no longer track tasks,False
42204ddecf1f5cd33b0983915f41d95bcd2fb0fe,2016-02-13 03:20:20,Evan Morikawa,"fix(composer): allow link paste without tooltip

Also fix style issues with link text.

Fix cmd+k link editing when nothing is selected.

Make confirm button only appear when there are changes to be made",False
7bbd41bea4d4dbe92b3dd80d81eaa3e7e71b896b,2016-02-13 01:12:11,Jackie Luo,"fix(composer-emojis): Add spec, allow adjacent emojis, fix toolbar positioning bug

Summary:
Adds tests to the emoji picker.

The emoji picker should also now be able to add emojis consecutively (without spaces).

Finally, the toolbar positioning bug (emoji picker appearing in front of typed text, the toolbar manager appearing in the upper left corner when empty lines are selected) should be fixed so that the toolbar appears directly above/below the selection area.

Test Plan: Tests included in diff.

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2551",False
5f1b8633c7fa26eb212b24ec631b22b84f8b8991,2016-02-13 00:26:36,Evan Morikawa,fix(analytics): delay closing of onboarding window,False
ac52589de59eba54dcd4f02633185089791923f1,2016-02-12 23:55:28,Evan Morikawa,fix(analytics): add onboarding welcome event,False
daa2a66063f99dc543ed64401c6958c156a3d9a2,2016-02-12 23:50:14,Ben Gotow,fix(outline-view): Make text larger in the sidebar,False
226cf4ce644cc12c3fdbc7c8c126eca2a143efc0,2016-02-12 06:48:24,Ben Gotow,fix(search): Compile immediately to avoid truncating. Fixes #1307,False
9021b02a6c7407b58c00713b8f1bb5aebb7fc83a,2016-02-12 06:45:15,Evan Morikawa,fix(win): bump windows-shortcuts,False
6fbb7f73d300b3ed1e38a96cb1937167855ca856,2016-02-12 06:23:59,Evan Morikawa,fix(win): bump windows-shortcuts fork,False
2de93c614b7f8f92756ca8665835c9da7831e726,2016-02-12 06:00:28,Ben Gotow,fix(contacts): Stop auto-capitalizing phrases and emails. Fixes #1308,False
03a33e5270a16b88ea44d34b457292d79e897eae,2016-02-12 04:55:24,Ben Gotow,"🎨: Fixes, labels in narrow thread view, better label wrap",False
aaf68b25c81c75499fca320a15b754464376a51c,2016-02-12 03:22:53,Evan Morikawa,fix(win): add windows-shortcuts to asar exclude,False
c4135ee23c24bd6d0b7dda66f2d3ba91eaae5973,2016-02-12 02:45:59,Juan Tejada,:art:(popover): Remove hardcoded width from code -> move to stylesheet,False
ab527ab3a5bbfe3346590a241162ae3405d0bc56,2016-02-11 07:17:10,Drew Regitsky,fix(plugin-auth): more fixes to plugin auth,False
a987a496f343129b1738d1680c785528e1ad0a81,2016-02-11 05:17:59,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
e91c9b82f514f14a3e6b2824d6598c65d3c0d4b6,2016-02-11 04:09:13,Ben Gotow,"Merge pull request #1283 from rittbys/master

Change the title bar to say Nylas N1 instead of Nylas",True
793fc5ef2cde267364c1a8d2f5c8c38ca85e54b7,2016-02-11 02:09:13,Ben Gotow,fix(min-height): Reduce minimum window size to 250px. Fixes #1293,False
765cfaad24f1df78f262e08db3b0e9670ee8ae5d,2016-02-11 01:02:39,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
b21bb4bc9b000cf14b12741bff08a28e53de1b11,2016-02-10 23:08:10,Ben Gotow,fix(build): LESS lint issue,False
ae2f03ac968ecdb994a0e797c7b1e5a25715c3b1,2016-02-10 09:40:33,Juan Tejada,"fix(focused-persepective): Init saved perspective correctly

- When accounts changed and the saved perspective could reference
  accounts that no longer exist and cause all sorts of errors. This is
  fixed.
- Add specs
- Fixes some sentry errors",False
71a5662553b2005fc4c44a4318b973cea4e2e9b6,2016-02-10 09:15:24,Ben Gotow,"🎨: Smaller buttons, smaller toolbar, smaller text

This should not be considered final, but we do plan to shrink the size of the entire UI slightly to match platform conventions.",False
7b2b5dd6c2cc833324345386217c14d8da5d4ec3,2016-02-10 08:06:09,rittbys,"Changes to be committed:
	modified:   src/browser/nylas-window.coffee",False
be428ef83ab799ee2c353874be9f6fed1b563408,2016-02-10 07:01:29,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
013888bdc492ed489d0e04607606f7de904dff02,2016-02-10 06:00:05,rittbys,"Changed the title bar to say Nylas N1 instead of Nylas

 Changes to be committed:
	modified:   static/index.html",False
aef2abdc9eab3bb9e359697b7720feaf22b89703,2016-02-10 05:46:56,Evan Morikawa,Rename windows updater files,False
f3c64c387116654ea768100dfc4931cd0a8169d7,2016-02-10 05:20:55,Drew Regitsky,fix(plugin-auth): change auth function params,False
f8e30513f80d92da0d48dacb6dcb850adde7476b,2016-02-10 04:32:11,Ben Gotow,fix(important): Icon does not update from nextProps,False
ee17baacc730f73a2623ceb7258d73e10e113610,2016-02-10 04:32:11,Ben Gotow,fix(csp): other URL schemes don't count as '*' 😶,False
5470aaaf3d19d100f7168d5c0548c7c289824d53,2016-02-10 03:00:23,Jackie Luo,"fix(composer-emojis): Add spec and allow adjacent emojis

Summary:
Adds tests to the emoji picker.

The emoji picker should also now be able to add emojis consecutively (without spaces).

Test Plan: Tests included in diff.

Reviewers: evan, bengotow

Differential Revision: https://phab.nylas.com/D2551",False
c9c5af6573f126a403df2ceb738dc7c4fd608ccb,2016-02-10 01:33:43,Evan Morikawa,"fix(updater): update to Squirrel.Windows 1.2.3

grunt-electron-installer 1.2.1 includes a bump to squirrel 1.2.3",False
5e9e2b5f472c854bcc6ad924ae858d63bc17516e,2016-02-10 01:13:30,Evan Morikawa,fix(win): fix typo in nylas-win-bootup,False
78f1473ca3f74f96d221dfd1d619cd0bf46842e4,2016-02-09 12:12:29,Ben Gotow,"fix(csp): Allow image-src *, fixes #1254",False
6e49dbd2c3a93cba926bf46dae08340247555db4,2016-02-09 08:05:23,Ben Gotow,"bump(*): Electron 0.36.7, version to 0.4.6",False
99952bc2fae77649d228501f36d1e795f35c7d4f,2016-02-09 07:12:48,Ben Gotow,fix(delete-category): Resolve regression in error message (#1244),False
d4e7b7e712e8f24ef7f2db4f4fd6d8c2462fb576,2016-02-09 04:22:07,Ben Gotow,fix(readme): Force github to refresh cache of screenshot,False
9bed0e6380ea1b9e2f57d8129f7b317ff88ff9b9,2016-02-09 00:01:13,Ben Gotow,fix(tray): Do not show count on Mac OS X when 0. Fixes #1233,False
e5a424c5bf4787dc3143a4e8507490ca820395d8,2016-02-08 02:09:47,Ben Gotow,bump(changelog): Notes for 0.4.5,False
9e14f2207f9a8330f1e4595b14c8a470e2346b3a,2016-02-08 00:53:19,Ben Gotow,"perf(accounts): Use cached contact objects in accountForEmail

This method is called for every contact on a thread in the thread list, so I figured we should see if one version was faster. I ran this test code:

```
d = Date.now(); for(var ii = 0; ii < 10000; ii ++){ $n.AccountStore.accountForEmail(""ben.gotow@gmail.com"") }; console.log(Date.now() - d);
```

The other approach which calls meUsingAlias takes `3784ms`, and this version which uses the alias contacts cached in aliases() only takes `264ms`. Confirmed that the tests still pass.",False
39e92afac34299d407f8fbcf6038f202c89215fa,2016-02-08 00:40:48,Ben Gotow,fix(threads): Circular include blocking FocusdPerspectiveStore. Sentry #11763,False
88b86c2fb4bacc04cf55cd234336ce87bcf7e51d,2016-02-07 15:04:30,Juan Tejada,:art:(contact): Reuse AccountStore.accountForEmail inside `isMe`,False
562d121bd6c0d26b8a618086dfc25f2b8e0d683a,2016-02-07 14:38:38,Ben Gotow,fix(categories): Fix Sentry #11613,False
58725b98efc49e45b3dd98a6ba04a1c83f0b545d,2016-02-07 14:09:11,Juan Tejada,"fix(account-store): Correctly check alias email inside `accountForAlias`

- Add spec",False
fcc8ca8b0737005e5ad506e3c034dcbb758ed9cd,2016-02-07 01:05:01,Ben Gotow,fix(system-start): Do not continue when checkAvailability returns false,False
aa5d6da0da4be67d227bfeac40c26a82ff715c1d,2016-02-07 00:58:14,Ben Gotow,fix(remove-from-trash): Fixes Sentry #11551,False
a2547dc9b2ad9738e6002c5d4107136efbce7f4b,2016-02-06 15:08:56,Ben Gotow,fix(contacts): Allow for contacts with no emails (Sentry #11535),False
e405e595d2b444a265bd0438b67c9d30092c7aef,2016-02-06 14:51:17,Ben Gotow,"Merge pull request #1210 from mbilker/fix-remote-undefined

Define the remote variable",True
89c5279d7d84feaed32c4f8121102b5d17583066,2016-02-06 11:50:03,mbilker,"fix(events): define the remote variable

This code triggers when a window is supposed to close, but this error
causes the DevTools to open and the window not exiting",False
0e661ec996cc1bc7b8123bce80e3e8c364d2ea37,2016-02-06 08:41:27,Ben Gotow,fix(undo): Ensure undo bar dismisses after re-appearing,False
a6d8783daeb3d69b808b226df7d3e723ea3951ac,2016-02-06 08:12:29,Ben Gotow,"fix(messages): Field label was always ""To""",False
ca31ee10bdbd9fd4405f4e948f4b2b4d4c754678,2016-02-06 08:06:48,Ben Gotow,feat(perspective): Restore through NylasEnv.savedState,False
e6a2bf3f4f791a5a5a6591f7af287dd4bf0724e4,2016-02-06 05:15:13,Ben Gotow,bump(changelog): Release notes for 0.4.4,False
1cd49d952d0f8859e53b9fad55faff4f8eb246c8,2016-02-06 05:03:07,Ben Gotow,"fix(message): Allow height to be 0, remove 150px min height",False
50bd559623fc3c7560645f9246d40b34d5b131da,2016-02-06 04:07:55,Ben Gotow,fix(tray): Fix accidental conversion to NaN,False
3e8ce3d2ff00fda848c59b5c3d6adb51465c1a63,2016-02-06 04:00:10,Juan Tejada,fix(account-store): Set focused perspective when account removed,False
f15244e8ef01b17fb8e73e69b189a4959a887c1a,2016-02-06 03:59:02,Ben Gotow,fix(search): Don't show loading dots forever if requests fail,False
199150188ded1525e6d7a1fc8234a155148aeb92,2016-02-06 03:55:07,Juan Tejada,"fix(sidebar): Handle edge cases for sidebar shortcuts

Summary:
- Update menus and shortcuts correclt when accounts change or focused
  accounts change
- Move menu logic into SidebarCommands to remove duplicated logic
- Make `Window` menu also contain checkboxes

Test Plan: - Manual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2534",False
57e7df8356ee37a4df1b7f99b676fe20e7d7beb6,2016-02-06 03:19:18,Ben Gotow,"fix(db): Allow string attributes to be null. Never coerce to """"

- Fixes a bug where reply_to_message_id = """" when we receive drafts from the sever.
- In general behavior should be consistent with API. Since they allow null we should too.",False
ddb91b7e7547d28c6e41f67e8d2a79aee658badf,2016-02-06 02:55:54,Ben Gotow,"fix(zoom): Disable ""double tap to zoom"" behavior",False
cc8a32e22ff93d33adda1591f1edd3e19d595951,2016-02-06 02:41:09,Ben Gotow,fix(toolbar): Don't show the toolbar when rangeInScope is null,False
8a40af68303f8c4b1acc13e5efdaa316851fcdd0,2016-02-06 01:30:58,Ben Gotow,fix(labels): Re-order so adding/removing same label does nothing,False
eb5b849a032dfae0872b274359ea8bc782382c0e,2016-02-05 23:47:41,Ben Gotow,revert(list-selection): Using clientIds had unintended consequences,False
2b6ed11828ff9f85233134440d6221e436c2ca20,2016-02-05 23:25:27,Juan Tejada,"fix(sidebar): Display correct keyboard shortcuts in account switcher

- Fixes #1203",False
1afd3801182727ad3b8ad21be3d30f584733be1b,2016-02-05 09:50:33,Ben Gotow,lint(outbox): 😞,False
835e7fe9c88ddcf6c6a6cec6fc834297d485488e,2016-02-05 09:45:15,Ben Gotow,perf(outbox): Only trigger when send draft tasks are present,False
bbc4b792c9c412540373c450077138e2a3816ae1,2016-02-05 09:44:26,Ben Gotow,fix(db): QuerySubscription should trigger if interim changes did not impact result set,False
dea29261799239b7639b74fcae27d443c9ea6138,2016-02-05 09:43:49,Ben Gotow,"perf(threads): Add an index specifically for the ""starred"" view",False
cbfad02d2b3201f34629e0547f7399735e1af6df,2016-02-05 09:43:43,Ben Gotow,"perf(threads): Add shortcut for common case in `emailIsEquivalent`, avoid `RegExp.exec`",False
1ca2e930ef4e9e50efd2680c229ef23c7f9c3658,2016-02-05 09:43:37,Ben Gotow,perf(threads): Cache aliases to avoid GC thrashing in `isMeAccount`,False
40bfab40c0566c63f5712c622d7809dc2bcecd82,2016-02-05 09:42:55,Ben Gotow,revert(nylas-env): Moving windowEventHandler init broke menus,False
c0e8dc7ccb46ca886f9c3d7d5819a3d4e0ae3ca0,2016-02-05 07:49:26,Juan Tejada,fix(styles): Fix less lint error,False
359487a132156a91796a9d1250e0757d3c0ecca2,2016-02-05 07:48:22,Juan Tejada,fix(thread-list): Fix drag and drop to new folders/labels,False
774957a5ff7cfc447dda0cbe8cdd8e7770c8670c,2016-02-05 04:28:47,Juan Tejada,"update(sidebar): Update sidebar design + context menus

Summary:
- Removes account switcher almost entirely
- Update context menu to edit and delete sidebar items
- Gross hardcoded position and size for the switcher icon -- will likely update with later redesign

Test Plan: - Visual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2527",False
91240f8979ce683665d1848892cfa8a5de4d9e01,2016-02-05 03:44:24,Ben Gotow,"feat(outbox): Sending status now appears beside drafts

Summary:
This diff adds an ""OutboxStore"" which reflects the TaskQueue and
adds a progress bar / cancel button to drafts which are currently sending.

- Sending state is different from things like Send later because drafts
  which are sending shouldn't be editable. You should have to stop them
  from sending before editing. I think we can implement ""Send Later""
  indicators, etc. with a simple InjectedComponentSet on the draft list
  rows, but the OutboxStore is woven into the DraftList query subscription
  so every draft has a `uploadTaskId`.

- The TaskQueue now saves periodically (every one second) when there are
  ""Processing"" tasks. This is not really necessary, but makes it super
  easy for tasks to expose ""progress"", because they're essentially
  serialized and propagated to all windows every one second with the
  current progress value. Kind of questionable, but super convenient.

- I also cleaned up ListTabular and MultiselectList a bit because they
  applied the className prop to an inner element and not the top one.

- If a DestroyDraft task is created for a draft without a server id, it
  ends with Task.Status.Continue and not Failed.

- The SendDraftTask doesn't delete uploads until the send actually goes
  through, in case the app crashes and it forgets the file IDs it created.

Test Plan: Tests coming soon

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2524",False
2a692456b3acd9266f6cb0a035df2d162f2b0dd4,2016-02-04 23:24:01,Dakota Nelson,"Disallow Gmail accounts from entering IMAP flow

Summary:
The error message from D2515 is being upgraded to also disable the
continue button so that a user is unable to sync an @gmail.com account
using the IMAP flow.

Test Plan: Tested locally.

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2516",False
21201d7d167b66580874a02f1441105b1c16773e,2016-02-04 07:41:23,Bernd Verst,"Removes the MessageListNotificationBar editable component in favor of the existing MessageListHeaders

Summary: Removes the MessageListNotificationBar editable component in favor of the existing MessageListHeaders

Test Plan: Manually built N1 and verified the MessageListNotificationBar no longer appears as editable component.

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2523",False
3202a57d009d960438a9035633b253801f04df66,2016-02-04 07:40:56,Jackie Luo,"fix(composer-emojis): Fix bugs around null nodes and whitespace

Summary: Corrected the linting errors and changed some of the logic around tracking typed text and triggering properly.

Test Plan: Tested locally.

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2522",False
940da2d26eb3af25b082c42a484fbeda9b1decbb,2016-02-04 07:33:11,Ben Gotow,fix(errors): onerror contains an error..,False
8b7c1aaa01f6ddc87ca0e0d888f385b747489319,2016-02-04 05:57:11,Ben Gotow,"fix(send-action): Make dropdown trigger secondary send actions

We can come up with a new UX for this later, but for now this is important for consistency with the Reply/Reply-All/Forward picker and others in the app that perform actions rather than changing selection. Also makes it possible to choose to ""Send and Archive"" /without/ making it the future default, which will be nice when there are many you may want infrequently.",False
b29b087a9f916eb8c7abb3ca37a872c303b54486,2016-02-04 05:13:22,Ben Gotow,💄(emoji): Add an icon / description to emoji package,False
4a1638906bbedeef6e5eff4db73c288a5c4b20c5,2016-02-04 05:11:28,Ben Gotow,fix(draft-store): Don't require plugins to implement finalizeSession,False
21ba15c5a5c633b15c27d5115b6d4dd22a6756cb,2016-02-04 04:44:02,Dakota Nelson,"Warn when entering Gmail address in imap settings

Summary:
Users have been configuring their Gmail accounts using the IMAP
authentication method, which causes problems. Attempting to do so will
now create an error message.

Test Plan: Tested locally.

Reviewers: bengotow

Reviewed By: bengotow

Subscribers: mg, emfree

Maniphest Tasks: T6621

Differential Revision: https://phab.nylas.com/D2515",False
918090a4e1105b99b323a59882c33c55a3c029fc,2016-02-04 04:36:52,Evan Morikawa,"feat(error): improve error reporting. Now `NylasEnv.reportError`

Summary:
The goal is to let us see what plugins are throwing errors on Sentry.

We are using a Sentry `tag` to identify and group plugins and their
errors.

Along the way, I cleaned up the error catching and reporting system. There
was a lot of duplicate error logic (that wasn't always right) and some
legacy Atom error handling.

Now, if you catch an error that we should report (like when handling
extensions), call `NylasEnv.reportError`. This used to be called
`emitError` but I changed it to `reportError` to be consistent with the
ErrorReporter and be a bit more indicative of what it does.

In the production version, the `ErrorLogger` will forward the request to
the `nylas-private-error-reporter` which will report to Sentry.

The `reportError` function also now inspects the stack to determine which
plugin(s) it came from. These are passed along to Sentry.

I also cleaned up the `console.log` and `console.error` code. We were
logging errors multiple times making the console confusing to read. Worse
is that we were logging the `error` object, which would print not the
stack of the actual error, but rather the stack of where the console.error
was logged from. Printing `error.stack` instead shows much more accurate
stack traces.

See changes in the Edgehill repo here: https://github.com/nylas/edgehill/commit/8c4a86eb7ee1a06249a9ae35397e2084a09ad1dc

Test Plan: Manual

Reviewers: juan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2509",False
74db6eb90ff7329cd9050d6a02134fae8a95ee47,2016-02-04 04:35:36,Jackie Luo,"feat(composer-emojis): Add emojis to composer

Summary:
Emojis can now be added in the composer window with colons and the emoji names (referenced by the same names used on Slack/GitHub/etc.).

When using the correct syntax, if there are emojis that match the text typed, they appear in a dropdown floating toolbar.

Selection works with either mouse clicks or arrow keys (plus `Enter`).

Currently, the toolbar won't trigger if the colon is adjacent to a non-whitespace character.

Test Plan: TODO: Will write tests soon!

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2505",False
3024d055640299d44d583a163639a8ca271e1529,2016-02-04 04:25:48,Ben Gotow,bump(version): 0.4.2,False
6e35ce7dd748c22b36e3b1f61b6c3773e9124f75,2016-02-04 04:21:46,Bernd Verst,"Use vertical layout for MessageListHeaders, MessageListNotificationBar, Draft:Footer

Test Plan: No new tests. Visual verification.

Reviewers: bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2514",False
f74278d067ff78600794cdacd2c86016801e42cb,2016-02-04 04:06:02,Ben Gotow,build(*): Add travis reporting to Slack,False
1e02d8c9c0e0f0144e67f333436bd45ac5dec5ce,2016-02-04 00:54:29,Juan Tejada,"fix(message): Limit number of collapsed recipients in message

Summary:
- `from` participants now have their own line
- `to` participants in collapsed mode merge `to`, `cc`, `bcc` as in
  gmail, and start in separate line from `from`
- number of `to` participants in collapsed mode is limited, and also overflows
  with an ellipsis with css in case its too long
- /some/ cleanup
- Unsuccessfully tried to update the css for the message item header to convert to a flexbox. Wrapping the `from` address when the text is too long is still a TODO
- Fixes #1113

Test Plan: - Manual

Reviewers: bengotow, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2507",False
a038b23cabe5f530acf8bd0e582437ce2dc61eba,2016-02-03 22:50:40,Ben Gotow,"lint(tray): Fix ""new Number"" not allowed",False
8b895068e21b5dee86adaef28723a977bf0f0501,2016-02-03 01:58:06,Evan Morikawa,"feat(metadata): add cloudState that sync with Metadata service

Summary:
Now all plugins get passed a `cloudState` object to their `activate`
method.

The `cloudState` object is an instance of `CloudState` and acts like a
key-value store backed by the yet-to-be-implemented Metadata service.

It has a `get`, `getAll`, and `observe` method. The `observe` method
returns a new `Rx.Observable` for the given key.

It has a `set`, and `unset` method that doesn't actually mutate state, but
rather dispatches new `Task`s to Create, Update, and Delete `Metadata`
objects.

The whole object is backed by `Metadata` objects. Since these are standard
Database Objects that will appear on the delta sync streaming API, any
updates from the server will automatically propagate down to listening
views via the `Rx.Observable`s.

Additionally, there is a new `N1-Send-Later` stub plugin that demonstrates
how to use the `cloudState`.

There are few other minor refactors included in this diff:

**Generic CUD Tasks**: There is now a generic `CreateModelTask`,
`UpdateModelTask`, and `DestroyModelTask`. These can either be used as-is
or trivially overridden to easily update simple objects. Hopefully all of
the boilerplate rollback, error handling, and undo logic won't have to be
re-duplicated on every task. There are also tests for these tasks. We use
them to perform mutating actions on `Metadata` objects.

**New `boundProps` for `InjectedComponents`**: When making the
`N1-Send_later` plugin, I realized that the injected component needed to
get the `cloudState` somehow. Traditionally components would require
Stores and load data that way, but these are setup at `require`-time. Now
that `cloudState` only is available on `activate` we needed a way to get
the data to the components. There's now the concept of `boundProps` which
will be props added to the Component when it gets injected. This required
changing the return signature of `findComponentMatching`, which got
renamed to `findComponentDataMatching`.

**Failing on Promise Rejects**: Turns out that if a Promise rejected
due to an error or `Promise.reject` we were ignoring it and letting tests
pass. Now, tests will Fail if any unhandled promise rejects. This
uncovered a variety of errors throughout the test suite that had to be
fixed. The most significant one was during the `theme-manager` tests when
all packages (and their stores with async DB requests) was loaded. Long
after the `theme-manager` specs finished, those DB requests were
(somtimes) silently failing.

**Globally stub `DatabaseStore._query`**: All tests shouldn't actually
make queries on the database. Furthremore, the `inTransaction` block
doesn't resolve at all unless `_query` is stubbed. Instead of manually
remembering to do this in every test that touches the DB, it's now mocked
in `spec_helper`. This broke a handful of tests that needed to be manually
fixed.

**ESLint Fixes**: Some minor fixes to the linter config to prevent
yelling about minor ES6 things and ensuring we have the correct parser.

Test Plan: new tests

Reviewers: drew, bengotow, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2419",False
5051bdbd61db5418ae0d771300679266f4ecd557,2016-02-03 01:54:59,Ben Gotow,fix(tray): Order of operations causing exception,False
180294e70c10618f268b1360e9b3153e64bf46c0,2016-02-03 01:48:37,Ben Gotow,💄(tray): Use locale string so unread count uses comma notation,False
c6a150a091488dc4039d7338f06f5bc64b9d34fd,2016-02-03 01:09:53,Ben Gotow,"fix(warnings): Warnings due to props not provided before React.cloneElement

See https://github.com/facebook/react/issues/4494",False
277bdc4e105eb405e074d969d5266681262d24de,2016-02-03 01:03:08,Ben Gotow,💄(composer): Account dropdown aliases styling,False
fd9850b74d78453ac04af667831a6078745fdecf,2016-02-03 00:42:28,Ben Gotow,💄(thread-list): Correct top border on selected threads. Fixes #1189,False
460956bc37ed42afd51818186c73620f09af7007,2016-02-03 00:29:44,Juan Tejada,"fix(sidebar):Correctly update sidebar by listening to FocusedPerspective

-  Clean up AccountSwitcher a bit",False
bdabd1de62f51f47b739dcdc5b3ab28927dac2ab,2016-02-03 00:28:24,Juan Tejada,"Revert ""fix(sidebar): Correctly update sidebar when a notif is selected""

This reverts commit 0828badb921c81a9779b2e52ab4829bf0db07410.",False
236c5ddc53e666f60dc21bbf81f7612d3c16f45e,2016-02-03 00:14:18,Juan Tejada,"fix(sidebar): Correctly update sidebar when a notif is selected

- Clean up AccountSwitcher a bit",False
11429727f9b2976288a3cbe206bf73b840e14b42,2016-02-02 23:45:20,Ben Gotow,fix(composer): Attachment check ignores uploads. Fixes #1190,False
6a14d5b5610367ab569ca48d4b8804c3bec7b0cc,2016-02-02 09:37:36,Juan Tejada,"fix(lint): Fix new eslint rule introduced with babel-eslint upgrade.

See https://phabricator.babeljs.io/T6925",False
d9c4739f782a997b1a166b5d355765afc87ea956,2016-02-02 08:42:06,Ben Gotow,"fix(contact): Converge on displayName(), don't show account label in ThreadList. Fixes #1157",False
aade6a6579c9fdbfc38d11689e2f5bb97bd94e76,2016-02-02 08:42:06,Ben Gotow,rm(Nilas-contact-elements): Remove unused package,False
c67bab052a9999f163079db54c8ecbd61994d7c0,2016-02-02 08:04:42,Juan Tejada,fix(prefs): Fix selector for default account for send,False
9408feb7aac255af90315b0f8c347f1d9b933ac7,2016-02-02 08:04:42,Juan Tejada,fix(default-alias):Show correct list of accounts and aliases in composer,False
c0142a6c418870489f7ce94efb0685aac722a8e8,2016-02-02 08:01:04,Ben Gotow,bump(version): 0.4.1 Beta,False
617e2aed095cc1f03ceeae237fb973690cfd2eaf,2016-02-02 07:10:42,Juan Tejada,"fix(remove-from-view): Update remove from view (shortcut) behavior

Summary:
- Now behaves exactly like in Gmail:
  - If viewing inbox, it will archive or trash, depending on setting
  - If viewing starred, will unstar
  - If viewing trash, will move to inbox
  - If viewing label, will remove label (no folder support)
  - No op otherwise
- Updates TaskFactory helpers and adds some helper methods
- Updates specs

Test Plan: - Manual

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2492",False
648bf1b30985f037ced43fa2caceaba2f962cdad,2016-02-02 07:03:18,Ben Gotow,fix(send-and-archive): Was disabling signatures due to name collision,False
809f51f96094b7a975d431552b83d92e01686b68,2016-02-02 03:36:54,Ben Gotow,"feat(reorder): Re-order mail rules (#1074) and accounts (#631)

Summary:
This implements EditableList re-ordering via a new prop callback.
You can drag and drop items in the mail rules list and the accounts list.
Note that you can't drag between lists - right now this is just to enable
re-ordering.

Test Plan: No new specs yet

Reviewers: evan, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2495",False
ea99c57e464856eea561b3c6fa6e021de73a6871,2016-02-02 02:48:16,Ben Gotow,"feat(rules): Add ""Starred"" as an available mail rule filter (#1074)",False
46f331c0b1cc6d7c960b1f4ebb4694296601ee11,2016-02-02 02:15:52,Juan Tejada,"fix(alias-list): Editable list wont create empty items

- Update alias coercion to include name by default",False
a00adca3e5c6135a10212880a433daa132fd9081,2016-02-02 01:51:42,Juan Tejada,"fix(shortcuts): Add shortcut to mark as spam, fixes #765

- Minor cleanup + docs",False
3453cfecb52f2967d9148961cb4e948b14af3fce,2016-02-02 00:52:23,Ben Gotow,fix(mailto): test case / parsing for url encoded To field,False
32cb3fdb7a90939671d46f2ecc024f43b7586a32,2016-02-02 00:38:15,Ben Gotow,fix(eslint): Avoid eslint/eslint/issues/5125 by specifying escope version,False
db1cd95a64616329e466563d8dce53ea1b44a0ac,2016-02-02 00:19:34,Ben Gotow,fix(zoom): Don't zoom the onboarding window,False
5ac5b55f53a51b7d108e9379c6e646e624dab500,2016-02-01 23:31:17,Ben Gotow,"bump(spellcheck): Fixes #1168, #895, #855, #1158

https://github.com/atom/node-spellchecker/issues/30",False
039be8d8dbc2ed6b20b5c0441bb6928b64e95f2e,2016-02-01 22:01:05,Evan Morikawa,"Merge pull request #1177 from mbilker/update-csslint

Bump grunt-contrib-csslint to to ~0.5.0",True
7c5790258e4fc3d77a31f8024033aa4129eef4a4,2016-02-01 20:40:12,mbilker,bump(grunt-contrib-csslint): update to ~0.5.0,False
bf0f3828dc5cc4667bae87519d5d0b573f7b5951,2016-01-31 04:30:20,Ben Gotow,fix(thread-list): Remove dup accountIds to avoid extra work,False
0abc5d5defcdb057120d726b271933425b75b415,2016-01-30 08:55:31,Ben Gotow,security(*): Disable `eval` in all windows (#1159),False
e37c95bb4db68870259b7b266e9d429c0ce64d5e,2016-01-30 08:31:47,Ben Gotow,fix(send+archive): Update to use focused perspective,False
c8d8bd0aeea28c255f2708af3bd6271de71c9d86,2016-01-30 07:26:57,Ben Gotow,fix(thread-list): AccountId resolution for items outside loaded range,False
ec553b0c3d36d23c08085b4a3f47c70013d0a8e2,2016-01-30 06:41:54,Evan Morikawa,fix(pref): check for mounting on async launch service,False
e6360cf18b7f070851a839d7935c74eee9251ddf,2016-01-30 06:29:51,Ben Gotow,feat(screenshot-mode): Minor fix to unmount method,False
d61becc549a1cb6aedcac6891d328f3b63f65601,2016-01-30 06:09:07,Ben Gotow,feat(screenshot-mode): Tiny feature for removing PII when taking debug screenshots,False
3c9db9bd85cb3dd1172f38fe9301f1f00a64a3a5,2016-01-30 05:36:33,Ben Gotow,"fix(activity): ""Long Polling"" => ""Delta Streaming"" because we don't really poll.",False
eec7c829ced7a4935d69b8ad8112e3dd25b7e853,2016-01-30 05:22:40,Ben Gotow,fix(dropdown): Open up or down depending on position,False
2027901debd31c47576db9af099a90e5a4421ef3,2016-01-30 04:15:53,Ben Gotow,"fix(uploads): Consolidate logic, use Promisify, path.join",False
960d2cf67b0d87b19365448d6c291bf9a6ff569a,2016-01-30 04:13:52,Ben Gotow,fix(drafts): Increase syncback delay to 10s,False
a3b686e54695cd4af96e8383ec4745d3c79e0160,2016-01-30 03:54:33,Juan Tejada,fix(electron): Update api usage to `require('electron')`,False
d8e139764abc5e2d6cb9365075b900363ee17213,2016-01-30 03:54:33,Juan Tejada,"fix(electron): Update `beforeunload` event handler (see details):

- This fixes unresponsive draft items in the draft list, i.e. draft
  windows would not reopen after opening them the first time.
- The `beforeunload` handler will no longer hide a window before its
  actually closed. To reduce visible latency when closing, we moved
  saving window state to the `unload` event handler.
- Before unload was hiding the window before actually closing it. A
  hidden window causes chromium to throttle its renderer process for
  performance, even though `pageVisibility` was set to true (see
  https://github.com/atom/electron/issues/3225 for more detils).

  NylasEnv.finishUnload is used in this context: When a `beforeunload`
  callback prevents the window from closing, it can close it at some point
  in the future using finishUnload. NylasEnv.finishUnload uses _.defer to make
  sure we don't call `close` inside the `beforeunload` call stack so the
  window doesn't go crazy.

  However, since _.defer was being called in the renderer process of a
  hidden window, the deferred callback execution could end up delayed by
  a second or more, which effectively delayed closing the window by a
  second.

  If we tried to reopen a window with the same window props, e.g. a
  draft window, before it was actually closed, the app would go crazy
  and wouldn't open it.

  So now we just don't hide windows on beforeunload",False
48a64e7fefca0f79b4e784fc9710f618c03e0415,2016-01-30 02:04:58,Ben Gotow,fix(focus): Don't clear when item is scrolled out of retained range,False
86c154db9d405e1a81bd1c11a348a3a9ca61a2a6,2016-01-30 01:26:53,Ben Gotow,fix(mail-rules): Preserve through db version change until cloud metadata service is ready,False
5c6a40ae96eaee1ab08d66bd1c58664260f976e7,2016-01-30 00:48:28,Juan Tejada,fix(styles): Actually fix styles for faded recipient list,False
f4f9db9310b40858a957545bc1eac9b82fb14493,2016-01-30 00:43:25,Juan Tejada,fix(styles): Fix styles for faded recipient list,False
6c8a8bca8cd5d5fb1182fc8a76ab4fe64dcb4f6f,2016-01-30 00:33:52,Juan Tejada,fix(styles): Cleanup less files for account sidebar and switcher,False
178f843a0d3726ba6c5b166b5d3ec68ce0e888b2,2016-01-30 00:28:28,Ben Gotow,fix(contacts): Bound the size of the ranked contact cache,False
180da72b773e0016696e8d4853205e5947bed8e6,2016-01-30 00:19:45,Ben Gotow,fix(notifs): Categories inside Threads need accountId. Fixes #1155,False
21ebd82ece28d7c9665517b02bc6f956671fa05e,2016-01-29 23:51:49,Juan Tejada,fix(sidebar): Update sidebar correctly when an account added or removed,False
0606d9009eae5537abac8ed3198048fe048cd3ba,2016-01-29 23:46:20,Evan Morikawa,"Merge pull request #1145 from mbilker/fix-linux-spellchecker

Fix logic for en_US default dictionary on Linux",True
c674be10eccd19528a014245cea17a14c6181f91,2016-01-29 23:31:11,Juan Tejada,fix(lint): Indentation,False
f1a908051812b49c119f12a1296dcb3dbf1fbb71,2016-01-29 22:59:25,Ben Gotow,"feat(me): Display ""Me (Account Label)"" in unified inbox",False
21aa4b429117f3938a0a35a986b8a5324d1904ee,2016-01-29 14:12:56,Ben Gotow,"perf(accounts): Cache `accountForId` - need ordered map...

In general, we call the functions in AccountStore and CategoryStore / constantly / and inside of critical places like thread list render. Would be nice to create a safe and generic way of caching things and invalidating them when data changes.",False
08935e104494c20868cd6011408a5fbf216e6aa1,2016-01-29 14:07:32,Ben Gotow,fix(msg-list): Stop computing timestamps inside invisible tooltip,False
0aac00756a9a30a3b8a7ebf9e4e8432edc9936cf,2016-01-29 14:01:58,Ben Gotow,fix(query): Invalidate in-flight updates when query changes,False
183cbaff173765898c33c8294632fd5d2ece6f13,2016-01-29 14:01:10,Ben Gotow,"fix(config): `observe` fires immediately, causing re-renders",False
140162dcd389b2cf28c4ba231655b20224ada0dc,2016-01-29 12:50:19,Ben Gotow,"fix(db): Pool, flush change records rather than cancel queries",False
45d897ce0a8bdf1199acf05dcd9528d339e2599f,2016-01-29 12:50:19,Ben Gotow,fix(json-blob): ClientIds on JSONBlob should just be key,False
d3766c199086706868f5bd39915660bb577486b5,2016-01-29 09:25:42,Juan Tejada,"fix(thread-model): Remove check that prevents thread to update correctly

- Since Thread#labels and Thread#folders are now aliased to
  Thread#categories, Thread#fromJSON had to populate the categories array
  correctly. However it, was only being populated from json if the
  categories array was undefined, which prevented the categories from
  being populated when API updates were received.",False
be73b8bea8255233752808f2fb0f8f72c2cb573a,2016-01-29 09:23:12,Juan Tejada,"fix(account-switcher): Don't display ""All Accounts"" when only 1 account",False
6da8b2c82403b2ff12a8414771dbaaf800491b6b,2016-01-29 08:40:01,mbilker,"fix(spellchecker): add back in split call

Fixes the spec test when only the language (e.g. 'en') is supplied and still
recognize the language.",False
a559e41ba0be33333638011c8fcff5a54a646e4b,2016-01-29 08:40:01,mbilker,fix(spellchecker): check both replacements of '_' and '-' in dictionary array,False
dbdd460e718aa63bdc5d953ebbc8f7c3a161ba49,2016-01-29 08:40:01,mbilker,fix(spellchecker): broken array check logic for en_US default,False
4b68f4704041f76f391c142f4f35fb43f3641879,2016-01-29 08:04:59,Greg Bowler,"Check metaKey and ctrlKey presence for multi platform support

Fixes #388",False
6620779ee2f66b780dba0900fd483de608aad239,2016-01-29 07:37:43,Evan Morikawa,"fix(message): fix truncation of messages

It would seem the document.documentElement.scrollHeight can return 0 when
the document.body.scrollHeight reliably returns the correct height.
Changed to fallback to various height checking mechanisms.

Fixes #425
Fixes #1102
Fixes #1153",False
256b240b70f7093f9d72de612d2d0d9e2daf4be1,2016-01-29 06:55:36,Evan Morikawa,"fix(quoted): fix quoted text issue with single blockquotes

Fixes #1084
Also fixes broken tokenizing text field specs
Also protects `MessageBodyExtension`s from errors",False
25db6c696dd2afbef0ea577a470a8fb9d98c5611,2016-01-29 06:27:24,Ben Gotow,fix(labels): Never show labels UX for threads split across folders,False
ef5a8fc8e904e08d06a42dc9f20edaaf5d1deef6,2016-01-29 06:27:24,Ben Gotow,fix(important): Hide important in message column of unified unless Gmail,False
ef7c98af2c2dde9174933fd9f22fa14163e64e85,2016-01-29 06:27:24,Ben Gotow,fix(account-sidebar): onToggleCollapsed => onCollapseToggled,False
f4ed37c1e13ce29c43ba4a2593467bcaef113728,2016-01-29 06:27:24,Ben Gotow,fix(drag-drop): Fix drop styles in account sidebar,False
b276445c8629c26c6d7d5b2406c74f2c9828aeb7,2016-01-29 06:07:07,Evan Morikawa,"fix(composer): don't blur input field when app blurs

Fixes #852",False
cfc937e661550635093d622a799bf3e521f80d0e,2016-01-29 05:58:10,Evan Morikawa,fix(sql): fix single quote escaping in array queries,False
c83a6899ac9d57c6bda23ec7e32dd35edea787f8,2016-01-29 05:55:17,Juan Tejada,fix(syncback-category-task): Correct request path when updating,False
896c1e1fe95edd6db7c92a7c3ef1d3467601ec31,2016-01-29 05:51:21,Juan Tejada,"fix(sidebar): Prevent editing items in OutlineView when not allowed

- Fix check in OutlineViewItem",False
15cafbac4d7ac30cd29f1effbe71fa0cd8ac3760,2016-01-29 05:36:27,Evan Morikawa,"fix(apm): no longer overrides apm

Summary: Fixes #39

Test Plan: new tests

Reviewers: juan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2481",False
0fe0542bf92a073509713bc869cbee6600da16f1,2016-01-29 05:31:22,Ben Gotow,fix(unified): Add a unified icon. designer gets back tues.,False
a4e37c66f48f06d4cb94ad287a706c32d69dc56a,2016-01-29 05:18:08,Ben Gotow,fix(specs): Re-enable draft-store specs,False
eb3b308dc832dc23ca86a4202d704fb18293bad0,2016-01-29 05:18:08,Ben Gotow,bump(version): 0.4.0 beta,False
74c72e09150d2e4a5e583e0d5a6602a431844657,2016-01-29 04:58:15,Juan Tejada,"add(docs): Add docs for OutlineView and OutlineViewItem

- Renames some stuff",False
e39662983da25644bd55e61f526c894a8daa23a3,2016-01-29 04:57:03,Ben Gotow,"fix(important): Fix bugs in ""important"" label categorization",False
52a7a6625f3ac99c0d870c90ad0278308b3889d1,2016-01-29 04:29:17,Ben Gotow,fix(linter): Switching between Coffee + ES6 is hard...,False
d1415585d5b97de33ed153ee6eb992f9acf4716c,2016-01-29 04:26:15,Ben Gotow,"fix(contact-search): Keep only ranked contacts, query for others. Massive perf boost.",False
bb6f74d5f272b6194a775dbc351af86acc664b6b,2016-01-29 04:21:31,Drew Regitsky,fix(templates): small CSS fix in preferences page,False
14edd8a7c7d0806d8730169dce52bccdb5ce0a3e,2016-01-29 03:56:56,Evan Morikawa,fix(keymap): don't use alt key in Windows keymaps,False
bca538bb28b835ab01ea792c025407447f736952,2016-01-29 03:48:44,Evan Morikawa,fix(keymap): change win32 keymaps to use ctrl-alt instead of cmd-alt,False
f00f7c56f8dfb1a4e88ae3605a863565272ba585,2016-01-29 03:41:50,Juan Tejada,"add(specs): Add specs for MailboxPerspective

- Renames canApplyToThreads -> canReceiveThreads and applyToThreads ->
  receiveThreads
- Add initial specs and better documentation for
  MailboxPerspective.canReceiveThreads.",False
79c103ae152d65104788dd233442c3186df733e9,2016-01-29 03:00:08,Juan Tejada,"fix(perspective): Update MailboxPerspective.canApplyToThreads

- Checks if the account ids of the threads that want to be applied are
  contained inside the perspectives account ids. E.g.:
  - I can move thread from account A to unified inbox or inbox A, but
    not to inbox B.
  - I can move threads from account A to a folder in account A but not a
    folder in account B
- Update data transferred in drag + other minor updates",False
14a2ae928b3079df0ae53751e4fe84d7fe4cc85f,2016-01-29 02:53:10,Michael Grinich,add levelup theme,False
24bf09b81ee5f5abab6f7c6075e5801f441ae0c0,2016-01-29 01:33:23,Evan Morikawa,fix(resources): update build resources link,False
d2dd04d51f66c39217663c44b37aeeab750ec214,2016-01-29 01:32:27,Evan Morikawa,fix(resources): update build resources link,False
67edcc836fbf3629b449bf14041e6d433ca3b89d,2016-01-29 01:32:08,Evan Morikawa,"feat(startup): new option to launch on system start

Summary:
adds new option to launch on system start

Also adds the `--background` flag to launch N1 in the background (aka not
show the main window).

Test Plan: Manual

Reviewers: bengotow, juan

Reviewed By: juan

Differential Revision: https://phab.nylas.com/D2474",False
63102ba7327fa7ad592affe83cb2912887d8be71,2016-01-29 00:44:04,Ben Gotow,"fix(message-list): Spec fixes, all stubs need accountId",False
09c82c76a3b7c7190d1e44531715a5a1ceebdfa3,2016-01-29 00:40:05,Juan Tejada,fix(count): Fix unread count for badge and tray icon in mac,False
03cbcd91febe1b53cb89b9812b21c95c35010a0b,2016-01-29 00:32:27,Juan Tejada,update(analytics): Add missing action: removeAttachment,False
3b03f141b13fea023ff92a16faa028b048cb3eb7,2016-01-29 00:16:33,Ben Gotow,fix(message-list): Only display labels when usesLabels(),False
0baff09d427a202f6775f8ae85c7bd00d1c3d8d3,2016-01-29 00:08:02,Ben Gotow,Update analytics to remove references to deleted Actions,False
3e5312dc39f71d0f2c04777c79f7b904cc2179d5,2016-01-28 23:33:32,Ben Gotow,Remove indexes which used accountId as the first param... not faster,False
cf7b8f1a47d2a0d8586003e91ca858c4b8d11835,2016-01-28 15:05:29,Juan Tejada,Prevent creation of context menu twice for nested items of OutlineView,False
8be8bfcab2d2eaaa632fd63247889b562138cbb3,2016-01-28 14:59:33,Juan Tejada,Fix in upload store when deleting draft,False
6b274593ddffb9c37daea741aa976af30d69f5e7,2016-01-28 14:59:18,Juan Tejada,Increment max width for sidebar,False
f74ee7b6c2fcff4737eb6871bfc91d60843ac6e5,2016-01-28 14:18:45,Juan Tejada,Fix specs,False
3343000f8646cf5c2fbe4345e4a428a2827908ae,2016-01-28 14:03:22,Juan Tejada,"Update file uploads (see details):

- Add uploads field to Message and removes cache from FileUploadsStore
- Updates draft via session from DraftStore
  - This makes everything way cleaner
- This fixes bug when creating draft with uploads and the opening it in
  new window
- Updates specs",False
8b0a3a69db87659419212d32ede48d1176ca3fe1,2016-01-28 13:32:55,Juan Tejada,Update OutlineViewItem to focus end of input when editing,False
bf2cebc08fffdbb1a8961570f8976260a908a435,2016-01-28 12:46:17,Juan Tejada,"Add folder/label renames

- Updates OutlineView to reuse OutlineViewItem for creating new items
- Adds ability to edit outline view items via double click or right
  click
- Cleans up css and code and sidebar item
- Updates SyncbackCategoryTask to update categories as well
- Adds 405 to permanent api error codes",False
4ed14d137e27111c1302ea4d26d283f05374e4b4,2016-01-28 05:08:01,Juan Tejada,Misc fixes for FileUploadStore,False
bd675ba0c1dd8b2af0b3b66f134989f3fea1b8e4,2016-01-28 03:19:34,Juan Tejada,Fix ComposerView specs,False
ff3213f0036f3d496dae05431f16445519ba502d,2016-01-28 02:03:27,Juan Tejada,Rewrite tests for FileUploadStore,False
dcb712641a01732c2d3c503be413084507571702,2016-01-28 01:25:19,Ben Gotow,Fix problem with * a shortcut,False
7908ff7899dda5acaecf8448adc708f81860456a,2016-01-28 01:15:02,Ben Gotow,Basic fixes for drag and drop,False
a77c9548d1d9434eb1675e7c7f88459ada400e38,2016-01-28 00:44:11,Ben Gotow,Fix sidebar when an account doesn't have a standard category,False
e29335ae9109e9da7c2c23ce1893ff7c89c4fbf2,2016-01-28 00:43:58,Ben Gotow,"Fix exception ""Cannot read property 'replaceModel' of null""",False
b043c30565f9697c2a1f2d6c604f41f3209ee581,2016-01-28 00:43:39,Ben Gotow,Optimize QueryResultSet so offset lookups are O[1] after initial scan,False
32ccaad1e72bb6160b5b5fcc4921f29061f1fd40,2016-01-28 00:01:54,Ben Gotow,More spec fixes,False
3b3b19a1726ca4e14cd6ed6fd4a93698aa0e08d7,2016-01-27 08:42:51,Ben Gotow,Spec fixes,False
fb1324f14ebaa66bfc2954417fd0d9bb3a5a25fd,2016-01-27 08:18:58,Juan Tejada,"Inits FileUploadStore from current state in the filesystem

- Removes uploads when draft is deleted
- Misc fixes and renaming",False
695af8b98379b7fed45061ff97b3a48c1b7014f6,2016-01-27 07:33:01,Ben Gotow,More sending fixes - attachments working!,False
24c751c2aef7fa4c7dfb87798a229f5b5b45a8fb,2016-01-27 07:03:09,Ben Gotow,More fixes to send draft task,False
d6f8873b0c2eb7c8ce678b583f2ed92231494e9c,2016-01-27 06:51:52,Juan Tejada,Fix progress var instantiation in send-draft task,False
22d99479084f83c255156de58aa495a30ef67369,2016-01-27 06:28:20,Juan Tejada,Misc fixes for FileUploadStore,False
820973cfa5fdd1ad55bfa1156c6d1b2c4d48cfd6,2016-01-27 06:11:49,Ben Gotow,Fixes to the SendDraftTask,False
bbe2f803204c6639eb029a313d1cb0a68d795047,2016-01-27 05:14:44,Ben Gotow,A few other changes,False
c8bd09a26049e3478b89bf48853ec47d15b2b6af,2016-01-27 05:14:44,Ben Gotow,Begin cleanup of Send Task,False
c7812b9c4621a2a3d232f5eec10d4d4f19d6fe34,2016-01-27 05:14:27,Juan Tejada,Fix in FileUploadsStore,False
8cb14d509fd9007001ccbb2d718b0e878b262230,2016-01-27 05:06:38,Juan Tejada,Refactor FileUploadStore and composer attachments - WIP,False
15776c8ec6ffb04120eb091a8bc62d6a2793058d,2016-01-27 04:19:05,Ben Gotow,Fix the message that appears when upgrading the mailbox,False
b32bf6577465db7863096315eb684da5f48dfb9c,2016-01-27 03:25:26,Juan Tejada,Fix when checking if draft is a reply when getting accounts for send,False
4f3de3fc97ee1793867a3dc32509c8fbca13e255,2016-01-26 08:37:28,Ben Gotow,Fix for bad @props,False
b13ca724f16cd6c172c1c5ba522c2c1d74010028,2016-01-26 07:50:54,Juan Tejada,"Add ability to select account to send from

- Adds settings option to select default account to send from",False
b94c2e35e4767bc9a48312e41aeb8f9e95c9f8b8,2016-01-26 07:32:56,Ben Gotow,Fix AccountStore.current() references in private packages,False
0ef4911b226b73499cca2f9384c9b4463c67c661,2016-01-26 06:58:29,Ben Gotow,"Merge branch 'master' into unified-inbox

# Conflicts:
#	internal_packages/feedback/lib/feedback-button.cjsx
#	internal_packages/thread-list/lib/thread-list.cjsx
#	src/flux/stores/draft-store.coffee",True
bb03e52e33011c3d424f5920c07b9d0314aa42d0,2016-01-26 06:38:38,Ben Gotow,"Clean up action bars, random exceptions",False
e4553ffb1ea5f05f700a135e23ec3e5719d48848,2016-01-26 06:07:34,Ben Gotow,Fix drafts,False
6b950bdb31e4e8d46b2b82f77b376694ed65d798,2016-01-26 04:25:01,Juan Tejada,Fix editable list input styles,False
71abd8bcd7dfe6b8159cdeba51702da671412c44,2016-01-26 04:24:54,Evan Morikawa,fix(composer): disable plugins during composition events,False
db29a52a991b952d433a75f81c51513678e37f8f,2016-01-26 04:13:50,Juan Tejada,Fix FocusedAccountStore: remove unnecessary accountstore listener,False
392753233e879029daf5b93a6aaf3714e700fd59,2016-01-26 03:44:09,Evan Morikawa,"feat(send): Send and Archive

Summary: Send and Archive plus a new setting.

Test Plan: new tests

Reviewers: bengotow, juan

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2446",False
8c38b1bce86d3cad61b850b968385b9cb1f72631,2016-01-26 03:17:41,Ben Gotow,Fix for search bar issue with threads not appearing,False
c6bf3eba01175f82f0d5688b06f84efeb8e5dc94,2016-01-26 03:14:05,Ben Gotow,"Fix for selection update issue, delete items + scroll up issue",False
84bf7dded69637848f4586eafff735750083a946,2016-01-26 01:42:16,Juan Tejada,Fix NylasAPI specs and ContactStore specs,False
617224be2967c2b17c28d654e5ce1bafeccee4a1,2016-01-26 01:12:39,Ben Gotow,More spec fixes,False
c9e5b68f1618f471cb92b2b1730ce77dc907af4f,2016-01-26 01:05:23,Ben Gotow,More database-related spec fixes,False
6a28cd8cda73e8690d0c014dbd150394fa495e36,2016-01-26 00:41:57,Ben Gotow,DatabaseTransaction / QueryBuilder spec fixes,False
fcb75fbf1a170c8b57282f4ac895478144144201,2016-01-26 00:37:40,Ben Gotow,CategoryPicker / PerspectiveStore spec fixes,False
b9316f1a662045f559a8923a7286bde3107d8754,2016-01-26 00:10:41,Juan Tejada,add(exports): Add Rx to nylas-exports,False
71070e3c8ff72697b5c9956ca5946b0a905e017c,2016-01-25 07:08:50,Michael Grinich,Add Berend theme,False
01ad2837540a28fae3d877d432b41502fa0c07a1,2016-01-23 06:25:29,Juan Tejada,Fix more task specs,False
5cf20c256d091a2ae0d4915043d817ce7df0774a,2016-01-23 06:00:28,Evan Morikawa,"fix(link): auto populate urls. Fix links across nodes

Fixes #1116
Also fixes an issue where links wouldn't create properly across multiple
nodes

This was due to a bug in the `select` method. We use the DOM Range API to
more robustly select a node.",False
5057ad3d2088f9cdb0ee38a77596a524029260c8,2016-01-23 05:03:49,Evan Morikawa,"fix(keymap): the remove and go to prev/next keys were reversed

Fixes #924",False
c5dc9544e1d9c5185092e62b0401efce341c207b,2016-01-23 04:22:19,Juan Tejada,Fix specs for destroy and syncback category tasks,False
ad05cc05cc65271a94da0dfdc089cbeac10d0059,2016-01-23 03:17:54,Juan Tejada,Fix MutliSelectSplitInteractionHandler specs,False
27ff4d2de2f5b6b85894e495ee8c35f9a7112955,2016-01-23 01:28:24,Juan Tejada,Show window when switching accounts if it isnt visible,False
d8424288809336fac21ca0d735189037d352543a,2016-01-23 01:15:36,Ben Gotow,"Rename formatResult, don't assume it's an array",False
eb3223580b28411da82147842ce7e7304c39eaef,2016-01-23 00:06:15,Evan Morikawa,"fix(composer): list creation edge case fixes and tests

Fixes #1064",False
c8df59f196c5069067b6c9bf98264a86f8e101a3,2016-01-22 23:46:46,Ben Gotow,update(readme): Add Todoist for N1,False
313c42185c820cac99214c54d417b99ab69d539c,2016-01-22 07:38:50,Jackie Luo,Add weather plugin to README,False
96739cb40023c562cdbf9c7d7975433f09edf25a,2016-01-22 07:33:30,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
3692c03cb26f8754b315c9894941577fa560a354,2016-01-22 07:33:18,Jackie Luo,Add Reflux,False
6b144b867ddf0c6315ca6c304d50045609ed90de,2016-01-22 06:37:57,Juan Tejada,Fix MultiSelectListInteractionHandlers specs,False
946d81bf2010a6189f08df3580eeb4c14cda9e69,2016-01-22 05:30:18,Ben Gotow,"Rebuild SearchSuggestionStore to fix errors, appearing after search committed",False
53c258b9d1ab229e171c42fee30b81f4938ee08e,2016-01-22 05:30:18,Ben Gotow,ContactStore always searches all contacts,False
4e9bf5cc23c27ac343abc1a24f80a0d80f8e7eea,2016-01-22 05:30:18,Ben Gotow,_version was conflicting with superclass property,False
8d8ed03e0c01e35455e70efc8266fcfe351f52fd,2016-01-22 04:01:27,Ben Gotow,Update CHANGELOG.md,False
e3b880325084f395a9c3554a069e01f9e9812936,2016-01-22 03:43:48,Juan Tejada,"Update sidebar to hold state for selected account

- Ensures that it displays the correct set of sidebar items even when
  the perspective changes
- Also sets up hotkeys to switch currently focused accounts",False
7458fdd4db7a19d4f8461645038832439001986a,2016-01-22 03:16:04,Ben Gotow,"TaskFactory now returns N tasks for performing standard actions, undo uses arrays",False
0fe308f75e6a8207d1476b636e5fcf6080301823,2016-01-22 00:27:27,Michael Grinich,Add Solarized Dark,False
f772f9ce0e75264428cf3841c4a5740e08e5b249,2016-01-22 00:12:31,Ben Gotow,fix(contributing): Mention syncEngine.APIRoot,False
03c76cf2559a7c907efaeea57a4b12743cbfa57a,2016-01-22 00:01:05,Ben Gotow,"Merge pull request #988 from mbilker/allow-custom-sync-engines

Allow custom Sync Engine specified in `config.cson`",True
c8305cc04d359859927c8521444ad92833b87b94,2016-01-21 23:45:22,Evan Morikawa,fix(link): allow links with no `closest` method to open,False
b12ed2f4648a708333a705fe0b1ad0ca3a027536,2016-01-21 10:46:43,mbilker,fix(nylas-api): namespace the custom sync engine to `syncEngine`,False
d91966c5fba1d32ea4afae85d98d0b90b5e4678a,2016-01-21 10:39:50,Evan Morikawa,fix(console): rm console trace,False
d667efea2be547756b39f5ca9c080ba5f0dad1b7,2016-01-21 10:30:01,Evan Morikawa,bump(version): 0.3.46,False
11c0af653df66311e6b880a99d5958763837197e,2016-01-21 10:26:56,Evan Morikawa,"fix(link): fix link focus and UX issues

Fix FloatingToolbar position

Fix link-editor to refresh on new props

Fix link content changed

Fix link width",False
979c29e24fbfdcb4932fcea2bd33d7aed02631e0,2016-01-21 09:00:12,Juan Tejada,Decrease OutlineView children indentation,False
f38e9da828fe4393f16980b822ecf98595e7c00e,2016-01-21 08:52:33,Juan Tejada,Update default collapsed value for sidebar items in unified inbox view,False
2f444db8c1b33b46227a8c2cd6f4a36a22bba548,2016-01-21 08:25:51,Ben Gotow,bump(version): 0.3.45,False
1510413752055e415edbfffd8c234f554d7a3dc8,2016-01-21 07:17:59,Juan Tejada,Fix styles for outline view heading,False
7705317576e19a9d3121af261ab19cdf4a23b71c,2016-01-21 07:10:18,Ben Gotow,Disable SELECT DISTINCT unless we know we need it,False
7ff836d00911cb1705f98911e4f93f5f0f228d4a,2016-01-21 06:57:06,Ben Gotow,"Optimize offsetOfId, shouldn't throw if models contains undefined",False
015a985032353d4f0589055ded60fa8095932c99,2016-01-21 06:39:15,Ben Gotow,"fix(onboarding): Minor style changes, headers for EAS",False
1756abab852548c1501cc453bcdf3eca16028357,2016-01-21 06:39:15,Ben Gotow,fix(newsletter): Don't make API request if email is the same,False
af50e23ea4936b165148ad04bf7a416882f9c634,2016-01-21 06:39:15,Ben Gotow,fix(onboarding): Loosen RegExp so `a.com` and `a.b.c.d.com` are valid,False
86cbd3aae93c27d0b81eab117ddeea8f7ab85525,2016-01-21 06:39:05,Juan Tejada,"Add collapse capabilities to OutlineView

- Make user category sections collapsible when in unified view
- Get rid of dumb CategoryHelpers class",False
1c0ed5c113d4a0ffd0ea705b375387d512a3a2ed,2016-01-21 06:13:11,Drew Regitsky,"feat(plugin-auth): add plugin auth function in NylasAPI

Summary:
Adds two new functions in NylasAPI to allow auth and unauth of
plugin backends. The `authPlugin` function should be called within
plugins before taking any action that requires offline account access
from the plugin's backend server. The `unauthPlugin` function will be
used by N1 internally to revoke offline account access for plugins.

Test Plan: manual for now

Reviewers: bengotow, evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D2440",False
c2ceb6fd6cf0925ceb9937144cad90fd77feef8b,2016-01-21 04:05:20,Evan Morikawa,"refactor(toolbar): allow toolbar extensions in contenteditable

Summary:
This is a refactor of the toolbar in the contenteditable. Goals of this
are:

1. Allow developers to add new buttons to the toolbar
2. Allow developers to add other component types to the floating toolbar (like the LinkEditor)
3. Make the toolbar declaratively defined instead of imperatively set
4. Separate out logical units of the toolbar into individual sections
5. Clean up `innerState` of the Contenteditable

The Floating Toolbar used to be an imperative mess. Doing simple
functionality additions required re-understanding a very complex set of
logic to hide and show the toolbar and delecately manage focus states.
There also was no real capacity for any developer to extend the toolbar.

It also used to be completely outside of our `atomicEdit` system and was a
legacy of having raw access to contenteditable controls (since it all used
to be directly inside of the contenteditable)

Finally it was difficult to declaratively define things because the
`innerState` of the Contenteditable was inconsistently used and its
lifecycle not properly thought through. This fixed several lifecycle bugs
with that.

Along the way several of the DOMUtils methods were also subtly not
functional and fixed.

The Toolbar is now broken apart into separate logical units.

There are now `ContentedtiableExtension`s that declare what should be
displayed in the toolbar at any given moment.

They define a method called `toolbarComponentData`. This is a pure
function of the state of the `Contenteditable`. If selection and content
conditions look correct, then that method will return a component to
render. This is how we declaratively define whether a toolbar should be
visible or not instead of manually setting `hide` & `show` bits.

There is also a `toolbarButtons` method that declaratively defines buttons
that can go in the new `<ToolbarButtons>` component.

The `ToolbarButtonManager` takes care of extracting these and binding the
correct editorAPI context.

Now the `<LinkEditor>` is a separate component from the `<ToolbarButtons>`
instead of being smashed together.

The `LinkManager` takes care of declaring when the `LinkEditor` should be
displayed and has properly bound methods to update the `contenteditable`
through the standard `atomicEdit` interface.

If users have additional contenteditable popup plugins (like displaying
extra info on a name or some content in the composer), they can now
implement the `toolbarComponentData` api and declaratively define that
information based on the state of the contenteditable.

Test Plan: TODO

Reviewers: bengotow, juan

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2442",False
4ef95212ad1e0cedb891ad0f02e4d1d4cc7ba16f,2016-01-21 02:44:34,Juan Tejada,Fix Category require,False
e5aaefc45a5fda74b59ab784dddd0a2b3fde6b1c,2016-01-21 02:34:06,Ben Gotow,Change the sidebar to use Flexbox for container,False
f99edda2506fd1a217487d6f3f857b168c72ba8b,2016-01-21 01:52:47,Ben Gotow,fix(readme): Broken link to Message View on Github,False
8b9b6a04673d6372f3bb6b9f2261dafd3aeb1d6c,2016-01-21 01:00:57,Ben Gotow,rm(tooltip): Tooltip package no longer in use,False
08e93b287f956294d006b646ce50f50a8c9a4e61,2016-01-21 00:56:14,Ben Gotow,"rm(intercom): Point feedback to support.nylas, shrink button",False
f0dec2d5434f35fd23f7e4abb093a37ad6e40e63,2016-01-21 00:26:00,Ben Gotow,bump(version): 0.3.44 beta,False
d561fe5b7103d00c594d717721d5f87920f59591,2016-01-21 00:19:27,Ben Gotow,fix(auth): Increase timeout to 60s for Exchange auth,False
6ae7fb7aefbef9a0936cdaea5af4bc4d2566dd57,2016-01-20 23:54:45,Drew Regitsky,"fix(templates): fix when the ""no templates"" message is displayed",False
f2acba48eeaceb55c68fbf86770e4d9e817828a8,2016-01-20 13:12:50,Juan Tejada,"Add account switcher back to sidebar:

- Account switcher can now switch between all accounts and each account
- Updates FocusedPerspectiveStore and Actions.focusDefaultMailboxPerspectiveForAccounts
  to focus a perspective for accountIds instead of for a single account,
  and updates methods
  - Adds helpers to CategoryStore and MailboxPerspective
  - Updates key commands to allow switch to unified inbox",False
955e8b899fb4060756f2588ba49e2201318c9688,2016-01-20 06:26:25,Jackie Luo,Merge branch 'master' of github.com:nylas/N1,True
a5e20f19c2e815acaef2d6de5f726cf6d2cddd37,2016-01-20 06:25:52,Jackie Luo,"fix(message): Message time no longer selectable

Summary: Closes #910.

Test Plan: Manual. Tested locally.

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2453",False
67a194f5fa3ae9e2800a97a3c699cf98e0d725fd,2016-01-20 06:15:02,Ben Gotow,"Merge pull request #966 from cllns/standardize-am-and-pm-capitalization

Standardize capitalization to am/pm, for message-list",True
ec22f7bebf318920cd6366dab88d3e2b489a3f60,2016-01-20 06:12:31,Ben Gotow,"Merge pull request #1041 from mbilker/script-fix

Allow additional parameters specified on command line",True
f8e98f2112aa7f8de6dbefd2eaf22317b71bb594,2016-01-20 06:02:03,Jackie Luo,"fix(message): Message time no longer selectable

Summary: Closes #910.

Test Plan: Manual. Tested locally.

Reviewers: evan, bengotow

Reviewed By: bengotow

Differential Revision: https://phab.nylas.com/D2453",False
f14087a7217bd7e917e5da0b13294acff817f9a9,2016-01-20 04:24:44,Sean Collins,"Standardize message-list capitalization to AM/PM,",False
4e795e79d304e6e0f2d94ea5bfa56850189bec6f,2016-01-20 03:21:57,Ben Gotow,"Merge pull request #1029 from mbilker/phishing-detection

Set Phishing Detection package name to the correct value",True
596c8c340897423c8df29b6bd7d26d6bb77154c1,2016-01-20 00:21:52,Juan Tejada,"Fix collapsing behavior for non perspective sidebar items

- Assign unique id for sheet and draft sidebar items",False
a8a26a86fc05fcaf72d467b8aef4f2a3baf723d6,2016-01-19 15:04:22,Michael Grinich,Update README.md,False
6f0c70e5a7dd4fb2cf3eceffdbeab3e2b4cc9fd5,2016-01-19 13:30:08,Ben Gotow,Don't wait for all requests to succeed before displaying results,False
07df74f823c1788220b5d3cbfeb5057c77816e18,2016-01-19 13:30:08,Ben Gotow,Show the important icon whenever any account in the perspective supports it,False
d59247407304f7936a3d7e8492ff093181a19d03,2016-01-19 12:52:46,Juan Tejada,"More account sidebar refactor + sections for unified inbox

- Refactors some of the old code which was :hankey:
  - Makes SidbarSection a factory for different types of items for the
    OutlineView
  - Decided not to create a OutlineViewItem.Model class since the only
    purpose it would serve would be to validate getters for props or for
    documentation, both of which are already done via React.PropTypes.
- Adds sections when looking at unified inbox and integrates with new
  mailbox perspecitve interface
- Updates OutlineViewItem a bit + styles
- Tests missing",False
fbbc325a84f5856ec024b803f34cf9b4894ebcce,2016-01-19 12:07:49,Ben Gotow,Update SearchSubscription to support basic multiaccount search... seems to work?,False
64a1040ba55f2e8a8b83de0a2c4e3192fa889d85,2016-01-19 08:58:23,Michael Grinich,Update README.md,False
0e3d2b75dcc68a8e3e39fdb2757ec7b2a5b9b6d0,2016-01-19 01:26:52,Juan Tejada,Fix merge errors,False
fa6a2fa5c675372c6f758ac1cff5407a3b27bdc9,2016-01-19 01:18:34,Juan Tejada,Minor fixes and style updates,False
3ee00ac3675231e394bb64eed6094262b6286d36,2016-01-19 00:02:43,Michael Grinich,Update README.md,False
02703998da3396da952d9bf302b9fcfa345e3e5c,2016-01-18 15:17:09,Ben Gotow,Fix for broken thread serialization. We now coerce folders/labels => categories and never go back.,False
5859565a192dda446b586b2193560af08d640f4e,2016-01-18 15:01:54,Ben Gotow,Make a few changes to AccountSidebar - needs to use accountIds?,False
3ee96b714b9fb3ee28154e7059b5c0b24a2cbffc,2016-01-18 15:01:35,Ben Gotow,"Remove current()? references, use Perspectiv.forNothing instead",False
b7144d9402302f9e87eb6f663bd70b821afe05e9,2016-01-18 14:23:03,Ben Gotow,"Merge branch 'unified-inbox-bg' into unified-inbox

# Conflicts:
#	internal_packages/account-sidebar/lib/account-sidebar-store.coffee
#	internal_packages/account-sidebar/lib/main.coffee
#	internal_packages/category-picker/lib/category-picker.cjsx
#	spec/stores/focused-perspective-store-spec.coffee
#	src/flux/stores/focused-perspective-store.coffee
#	src/mailbox-perspective.coffee",True
1e5b26a818e1e7ad314867fac23e86c20f95ca7d,2016-01-18 14:17:04,Ben Gotow,Unified inbox mailbox perspectives working (sidebar disabled atm),False
351a602b86c73f267f3b9dcfc0567209db1a8ce7,2016-01-16 06:25:21,Juan Tejada,"AccountSidebar package refactor:

- Creates OutlineView generic component and uses that instead of custom
  code
- Refactors AccountSidebarStore:
  - Split the generation of the state tree into smaller functions
  - Adds different types of account sidebar items and sections, which contain
    logic and props necessary to be rendered as OutlineViewItems, and
    removes that logic from the store
- Removes WorkspaceStore.SidebarItem and removes the ability to register
  new sidebar items. If people want to add something to the sidebar they
  can just register a Component via the component registry and use the
  OutlineView component
- Removes the DraftListSidebarItem, which was basically duplicated code
  for an item but with a different data source. This is now handled
  generically by the account sidebar by rendering OutlineViewItems with
  different props and handlers
- Clean ups here and there:

- TODO
  - Add AccountSwitcher
  - Revisit calculation and generation of the state tree. Should the
    parent store contain and update the entire state all the time.
    Should separate items inside the tree have their own data sources?
  - This would avoid having the AccountSidebarStore listen to a bunch of
    different other stores, and the specific logic wold be contained
    inside each item type.",False
eb9fc4f2249b4559dce6de7de45dbc15774680c5,2016-01-16 05:09:32,Ben Gotow,WIP,False
1ac84f4013735aef5dd9a6b5c1303a7a69694ad5,2016-01-16 03:56:07,Ben Gotow,Clean up the MultiselectList implementation a bit,False
74e21bce16603a20ed5e208fa668da33f85d6819,2016-01-16 01:46:21,Evan Morikawa,"feat(tasks): add Create, Update, Destroy tasks plus spec & lint fixes

Summary:
1. **Generic CUD Tasks**: There is now a generic `CreateModelTask`,
`UpdateModelTask`, and `DestroyModelTask`. These can either be used as-is
or trivially overridden to easily update simple objects. Hopefully all of
the boilerplate rollback, error handling, and undo logic won't have to be
re-duplicated on every task. There are also tests for these tasks. We use
them to perform mutating actions on `Metadata` objects.

1. **Failing on Promise Rejects**: Turns out that if a Promise rejected
due to an error or `Promise.reject` we were ignoring it and letting tests
pass. Now, tests will Fail if any unhandled promise rejects. This
uncovered a variety of errors throughout the test suite that had to be
fixed. The most significant one was during the `theme-manager` tests when
all packages (and their stores with async DB requests) was loaded. Long
after the `theme-manager` specs finished, those DB requests were
(somtimes) silently failing.

1. **Globally stub `DatabaseStore._query`**: All tests shouldn't actually
make queries on the database. Furthremore, the `inTransaction` block
doesn't resolve at all unless `_query` is stubbed. Instead of manually
remembering to do this in every test that touches the DB, it's now mocked
in `spec_helper`. This broke a handful of tests that needed to be manually
fixed.

1. **ESLint Fixes**: Some minor fixes to the linter config to prevent
yelling about minor ES6 things and ensuring we have the correct parser.

Test Plan: new tests

Reviewers: bengotow, juan, drew

Differential Revision: https://phab.nylas.com/D2419

Remove cloudState and N1-Send-Later",False
268757c25984c52fdf6f3c8ec6f33c1fb25e219a,2016-01-16 00:57:14,Karim Hamidou,"[N1] Validate input in the signup dialog

Summary:
This diff bundles a number of small usability fixes to the ""Create account"" window. It notably:
- forces users to enter required fields before moving on to the next step
- validates email addresses and domain names

Test Plan: Tested manually by going through all the possible auth flows.

Reviewers: evan, juan, bengotow

Reviewed By: bengotow

Subscribers: bengotow

Projects: #edgehill

Differential Revision: https://phab.nylas.com/D2377",False
ea934939a152973ddd38965a17c477070fd2578e,2016-01-16 00:31:59,Drew Regitsky,"fix(mail-rules): tiny CSS fix to ""+"" button in mail rules",False
560f659643461b705ad0e6a0f00dd2992b0ab5ac,2016-01-15 22:44:07,mbilker,"fix(N1.sh): allow additional parameters specified on command line

This prevents Electron saying it cannot find the main entrypoint, when
using the `--test -s` parameters on the command line to spec test plugins.",False
dbb996fd795b3a50fae42222b366e166a8d805a6,2016-01-15 09:13:40,mbilker,fix(phishing): set the package name to the correct value,False
6b6f2b39d308fde25a80e5e0d83a453b3078a1ff,2016-01-15 04:34:17,Ben Gotow,More renaming of view => data source,False
85e65e913548588b47576582a143c1726a9701a2,2016-01-15 03:34:51,Ben Gotow,Some basic thread list cleanup,False
273679a861b6f9ec2b599e0a869d4dbf3ee96ebc,2016-01-15 01:56:54,Ben Gotow,DataView => ListDataSource,False
88b901d8a50470de991a70d4e55c25108cebb174,2016-01-15 01:33:06,Ben Gotow,"New QueryRange specs, fixes",False
9814d80d5a9d8e4442315c1c033e528315ec00ef,2016-01-15 00:55:52,Ben Gotow,"New MutableQueyResultSet specs, fixes",False
cb5f2985eff92756a9fef5cac145035dd15656bf,2016-01-14 06:50:34,Ben Gotow,"Merge branch 'master' into unified-inbox

# Conflicts:
#	spec/stores/file-download-store-spec.coffee",True
c8dcab5e6a5c0f9f1998675dca4761c712915a0b,2016-01-14 05:39:53,Ben Gotow,"build(linux): Ensure that target files are not group writable

Should fix #710. Will move all 0775 => 0755 and 0664 => 0644",False
c5d4b10c7d98b7bf93117a1f2c7b43492fd9e43c,2016-01-14 03:50:44,Juan Tejada,"Fix CategoryStore sorting:

- Also fix Category model specs",False
4f5aea03dd8b79573f6d782b8421a835211b2d60,2016-01-14 01:38:41,Drew Regitsky,"fix(templates): rewritten ""welcome"" file / example template",False
5bdb097bb83f83851dd9b3c101282bdce2b38a5e,2016-01-14 01:15:48,Ben Gotow,fix(newsletter): Checkbox refreshes properly when switching accounts,False
5bae17600e59cb041189844031c8cdbdba9fd898,2016-01-14 01:09:35,Ben Gotow,"Merge pull request #998 from nylas/set_s3_content_type

set the ContentType when uploading packages to S3.",True
59964b04c8b8091d50f30affcae610f51c775490,2016-01-14 00:42:39,Karim Hamidou,set the ContentType when uploading packages to S3.,False
bdf545a519d4ad67d71e774d6a72ef3f0f2daa47,2016-01-13 21:16:54,mbilker,fix(nylas-api): allow custom Sync Engine specified in config.cson,False
b95f1f7cb48a07bb72bcb579c0bf0abd57d80d59,2016-01-13 08:49:16,Ben Gotow,bump(version): 0.3.43 and changelog,False
c64f9440d288b3a505257ccbe6b57c623c07f302,2016-01-13 08:41:47,Ben Gotow,fix(specs): Spec fixes for 37e1f6bb,False
e49a7610447c5f2388114ce48d319aeb32782090,2016-01-13 08:39:57,Ben Gotow,"fix(contenteditable): exportedSelection isn't always an inst of ExportedSelection

This is a temporary fix that makes this function more robust to @innerState.exportedSelection not being an ExportedSelection instance.",False
37e1f6bb0b8d82fd3556e38f2ba9df2fb5d45c67,2016-01-13 08:33:04,Ben Gotow,fix(spellcheck): Unwrap nodes with simpler code with less side effects,False
890db385f91b73cf67d0affc6675414a560c5c5c,2016-01-13 08:15:27,Juan Tejada,"fix(warnings): Don't issue a warning for attachments when word attach in
signature

- Fixes #912",False
b44ab5670b81af81e5f8ca2fa3b8dbb5281da619,2016-01-13 06:44:17,Ben Gotow,fix(unread): Mark as read twice without visiting another unread thread,False
e87766ebd5662a8afd8d94272311b02a31050442,2016-01-13 05:28:37,Ben Gotow,bump(version): 0.3.42 (testing Windows autorestart),False
7c371d88f7f23073bb323b6a777aab333a29c2fc,2016-01-13 05:16:00,Ben Gotow,bump(version): 0.3.41,False
8c5b7b919d28fd2c12ff51a0fb9249fb68b70d8f,2016-01-13 05:06:44,Evan Morikawa,fix(squirrel): remove apm from path,False
b8c1280383cd0c778e31db2f7a4d9064ef63f571,2016-01-13 05:03:01,Evan Morikawa,fix(lint): fix linter issues in template store,False
60eb7afa1295a3dc55e8a217ab68d4ee21587d56,2016-01-13 04:47:30,Evan Morikawa,fix(squirrel): fix win32 update to enable restart and launch from path,False
760c8769b306b5823ad6f7068e3f4809e93b3611,2016-01-13 04:46:59,Ben Gotow,fix(accounts): Spec fixes for a03e8f70,False
48ea9e6198c04736896f5f6ff625b94cf2db7e5d,2016-01-13 04:42:43,Juan Tejada,"fix(fullscreen): Restore fullscreen if app was closed in fullscreen

Fixes #671",False
a03e8f704be1f93a010f896c1a5121a9968a3447,2016-01-13 04:38:56,Ben Gotow,fix(accounts): Load accounts before adding a new one,False
7bbcbbe29a83860b0b2e5b04b669d4cbeaa0de67,2016-01-13 04:09:16,Ben Gotow,fix(sp): illegial => illegal 🙏,False
329c6471817ee21b0f81051309868a2ed52af639,2016-01-13 04:01:34,Ben Gotow,fix(paste): Keep `<div>` tags so pate between N1 emails works,False
b035b0ba73176ebd136ce055a7c4cb94860d489c,2016-01-13 03:39:37,Drew Regitsky,fix(templates): insert template no longer overwrites signature,False
54f464d999461cd004825f36556e49f2cf026920,2016-01-13 03:22:01,Ben Gotow,fix(drag): Drag and drop files with illegial path characters,False
619c753cf3d203dfba4dd7d1a49135f332850521,2016-01-13 03:22:01,Ben Gotow,"fix(downloads): Escape all illegial path chars, don't make regex from path.sep",False
806edd7215845a2f1221328ec588c949ee438f01,2016-01-13 03:22:01,Ben Gotow,fix(packages): Default icon for third-party packages,False
b4690783ac828a9c05d54891702ca56a17a9a4e4,2016-01-13 03:22:01,Ben Gotow,fix(composer): `whilePreservingSelection` should not call select if not activeElement,False
9558d21efad11da61cf078db73f865012c05d683,2016-01-13 03:22:01,Ben Gotow,"fix(selection): ExportedSelection must properly represent ""None""",False
46889203a6f8b8d94eaacefd7dc8a56fbf938ca9,2016-01-13 03:16:50,Juan Tejada,fix(styles): Add bottom margin to templates plugin message,False
f679f7c21437ff176aee198162d079386c94b472,2016-01-13 02:14:38,Drew Regitsky,"fix(templates): fix several bugs in templates plugin
Fixes behavior when there are no template files, prevents renaming/creating
with an empty name, fixes yet another way to accidentally make yellow text,
misc small style fixes",False
1c12fe3d6aab98e3b8b7a855a9600566adcc8bbd,2016-01-13 02:06:19,Juan Tejada,"fix(composer): Fix focus behavior when signature present and when
clicking outside:

- When focusing the composer via click inside the contenteditable region or via
tabbing, last text node before the signature (or blockquotes) will be focused.
- When focusing composer by clicking outside contenteditable region, it
  will default to default contenteditable focus behavior via new method:
  `nativeFocus`",False
b14b7086abdac79113c22639633458a63675dc61,2016-01-12 23:58:34,Ben Gotow,fix(indicators): Remove duplicate `description` key,False
c1f98f2fb39afa6f73fe19f02c1bfe1622886d16,2016-01-12 23:48:41,Ben Gotow,fix(readme): Remove link to plugins repo,False
fe625d8f6d6bf1f72b4e9ecf5917b1ec3640fb43,2016-01-12 23:19:56,Juan Tejada,Update names to use perspective instead of view,False
90fedbf131a5345a839714110b08b617688763a6,2016-01-12 23:02:34,Ben Gotow,"Perf: Category

Rather than computing the types ahead of time when the object is created and generating methods, keep a few standard methods around and change the hardcoded names to maps so the lookup is O[1]",False
d4241921617d1eb4c56ca98f11ccd2792c621600,2016-01-12 22:40:52,Ben Gotow,"Perf for thread list. See description

- ComponentRegistry: findComponentsMatching often returns zero results but makes a lot of transient data structures. Add a cache to make it O[1]

- Contact isMe is called a zillion times to compute thread participant display. Checking the AccountStore had been required was slow.

- getStandardCategory is also called a ton. Rather than create a filtered array and then searching that, just search the existing array.",False
4b11b0586dcd3fb121af8c324d4e6958b355e148,2016-01-12 22:15:05,Ben Gotow,fix Item id / clientId issue breaking thread list,False
5c491d16af6f0d7f36cffe769cb0a1c0a23b0cc4,2016-01-12 21:50:55,Ben Gotow,"Merge branch 'master' into unified-inbox

# Conflicts:
#	internal_packages/events/lib/event-header.cjsx
#	spec/stores/file-download-store-spec.coffee
#	spec/tasks/event-rsvp-spec.coffee
#	src/flux/tasks/event-rsvp.coffee",True
3b3d6a0a3b22cbdd6db2ba694c39eec930b3ca6a,2016-01-12 21:43:43,Ben Gotow,bump(version): 0.3.40,False
0360c59460d5bcdfab540150479763c703c87b7b,2016-01-12 07:43:42,Ben Gotow,fix(composer): Fix tabbing from body to subject,False
6ad46442627c93f40b29f362cf410dfacf0bd70f,2016-01-12 07:24:40,Juan Tejada,Fix issues in AccountSidebarStore and MailboxPerpective#isEqual,False
963d86cfd3705df7aff15be9060ffe42926e533d,2016-01-12 07:14:55,Ben Gotow,fix(composer): 30px area would focus wrap instead of contenteditable. Fixes #935,False
0aa4b88e1e6c5355168a13f2fbcc90a9fb0bb53f,2016-01-12 07:14:17,Ben Gotow,"fix(composer): Focus last element, not just text node",False
51319b5c8dd7e06aef31de05a328676ce717dba0,2016-01-12 07:01:03,Ben Gotow,"fix(spellcheck): Redo node creation each time, optimize findSimilarNodes

findSimilarNodes was taking 20% of total execution time because my test email was a jenkins error report with thousands of text nodes.",False
a0e83f1935488835c9d3fe278c2d01c44f8b12ca,2016-01-12 06:02:25,Juan Tejada,Fix SuggestioStore -- update to use NylasStore,False
149d86cb56def4f3763889ad80da7107e51f5d47,2016-01-12 05:56:41,Ben Gotow,Fix search suggestions using old-style store,False
391504b07d784f5ae68424e9108f80b1e580abfa,2016-01-12 05:54:12,Ben Gotow,Fix flattening of categories not working since they're maps,False
dbc3b85659ac3529ed7d776f0980aecf6ad56933,2016-01-12 05:51:05,Ben Gotow,Bump submodule reference,False
d81927d953a4d55f8fcd0d09d2fb1f5a46e82070,2016-01-12 05:46:35,Ben Gotow,Remove query formatting that used to match ElasticSearch,False
7f2c8481ff7975c284c0abb23b6abad07092b1a3,2016-01-12 05:44:21,Juan Tejada,"Fix more specs:

- SearchBar
- EventRSVPTask
- ContactStore",False
10cb1952267fbfd234aef6cec49b13ce4e04eda3,2016-01-12 05:28:10,Ben Gotow,Search bar fixes,False
2849cce07792d31c530b512a54268596d387d07f,2016-01-12 04:58:31,Drew Regitsky,fix(templates): fix two bugs breaking templates plugin rename and search,False
a8c563f09d70331042324bc3ff069a55536b3b80,2016-01-12 04:54:46,Ben Gotow,Updated QuerySubscription specs,False
9f5e07f9c53251e1f34bf337db6888ad7fec138e,2016-01-12 04:46:50,Juan Tejada,"Fix tests for AccountSidebarStore

- Switches to using CategoryStore to reduce complexity
- Update CategoryStore.categories to retun all categories when account
  is null
- Inits AccountSidebarStore._account based on the currently focused
  MailboxPerspective",False
04c6be4dfe8b8d004f1873d263bc1cf476c0502c,2016-01-12 03:41:48,Ben Gotow,"AccountStore no longer tracks index, Actions.selectAccount gone",False
53d26b38a85b4b5b48a8184b053cfac1b6faf94b,2016-01-12 03:28:22,Juan Tejada,Fix Contact and Thread specs,False
e62ddf5d636cabdcfe996bdf0a54c8f4ac2931aa,2016-01-12 03:17:39,Ben Gotow,Fix ModelViewSelection specs,False
e803b66a1a1287a550599fc2d5e6894c53a997e5,2016-01-12 03:14:54,Juan Tejada,Wrap FileDownloadStore in describe block,False
a4d33be4f274780d8014ad79bd66b48cd13ed6f7,2016-01-12 03:10:42,Ben Gotow,More spec fixes,False
5c74f230724ea45324724de2b7ac64c19efd7522,2016-01-12 03:09:25,Juan Tejada,Remove fdescribe,False
31388437487082a155f2cdafb5a804940bf7b496,2016-01-12 03:08:44,Juan Tejada,Fix AccountSwitcher specs,False
2c7626a3556b2611e3c86fabeb6d562381c34994,2016-01-12 03:01:35,Juan Tejada,Fix ThreadListParticipants spec,False
9847e58b7f88e27a187280730f19d84717c778c5,2016-01-12 02:53:59,Juan Tejada,"Fix CategoryPicker specs

- Add NylasUtils.mockObservable helper",False
2c74b38323cbade5b013cd1346acfbe00c1aee85,2016-01-12 02:53:35,Ben Gotow,"fixes for draft store specs, contact.isMe now returns true if it matches any account",False
d98eca2cca924af81f7de7c351643b5e7ed25687,2016-01-12 01:56:27,Juan Tejada,Add rx-lite-testing,False
6a735da033d77038227c01f315c1bf4f69467351,2016-01-12 01:50:26,Ben Gotow,"fix(rsvp): Check that you are a participant, support aliases. Fixes #962",False
f3464c7db365ece93ff89e3a043da7731defa945,2016-01-12 01:19:05,Ben Gotow,fix(downloads): Replace path.sep when saving files - Sentry 8749,False
1de3a4707739adfbcac2df04de74b92f82a4a135,2016-01-12 01:16:20,Evan Morikawa,"feat(composer): can outdent blockquotes allowing you to reply inline

Summary:
You can now break up blockquotes (as in quoted text areas) by pressing
""delete"" at the start of a line. This allows you to reply inline.

Test Plan: new tests

Reviewers: bengotow, juan

Reviewed By: bengotow, juan

Differential Revision: https://phab.nylas.com/D2421",False
f6579ceaa43e186bb04de0ba26e981ebb67eccaa,2016-01-12 01:09:14,Juan Tejada,Fix misc errors that made the app crash,False
55f1c537e25d46903af9d7bce4eb888847b1ea61,2016-01-12 00:44:34,Ben Gotow,"fix(quoted-text): Fix + test case for Sentry 8323, body el is quoted text",False
a3d1287ce8e8082acaa9cc2db1c3cc91181bfa76,2016-01-12 00:26:17,Ben Gotow,fix(notifications): Fix notification removal [Sentry 8957],False
f7420152df4ecbaf3189a99669fbde705df20f4a,2016-01-11 23:59:57,Ben Gotow,fix(readme): Fix broken links to examples #943,False
a4b1e1b1477822c15acad326fc3bccad69f39c42,2016-01-11 23:29:05,Ben Gotow,bump(version): 0.3.39,False
5158ab1e380f2625628a58bfb8d06533bd05a599,2016-01-11 05:55:31,Juan Tejada,"fix(injected-component): Correctly call methods to the injected instance

- Adds check to `_runInnerDOMMethod` to check if inner is an UnsafeComponent and
relay the call appropriately
- Removes duplicated logic from `_setRequiredMethods`",False
bb9f9d4b8405b1d8fba3c315d4bef4b7213416c9,2016-01-09 08:15:26,Ben Gotow,"fix(composer): Temporary patch for broken focus

Long term, we need to refactor this so that it's either entirely controlled or uncontrolled. Potentially use focusin?",False
d265bf124861a3888e667988a686cf69af53f1c9,2016-01-09 07:33:18,Juan Tejada,"fix(category-store): Fix issue with observables in CategoryStore

- Removes use of observables from category store and keeps a big cache
  of categories per account
- Upates Category Observables with new helper observables
- Updates CategoryPicker and AccountSidebarStore to use observables
- Misc fixes",False
373d224f0c8ca420fa8cf5489df5f639f8abb819,2016-01-09 07:17:49,Ben Gotow,fix(scroll-region): top:0 or height:0 are valid for scrollToRect [sentry],False
99f67494880a7af6d637d7c27f7b7812ab14baff,2016-01-09 06:13:09,Evan Morikawa,fix(composer): undo/redo now properly restores selection on new msg,False
2beeccdecd6ff698b45d93ea785cac6d0e29a7d1,2016-01-09 04:56:35,Ben Gotow,PreferencesStore pull current account from FocusedPerspective,False
80658e7cf2c124257e008c44812e6ce43d9a0af0,2016-01-09 04:43:56,Ben Gotow,Merge branch 'master' into unified-inbox,True
de02e17fdb69a1be820c7173df5df5cec6e7a9f3,2016-01-09 04:40:54,Ben Gotow,fix(zoom): Only set zoom to valid numeric values,False
2ddafe7154bda0e08c11db1938221879cd783964,2016-01-09 04:28:31,Ben Gotow,Rename MailViewFilter => MailboxPerspective,False
8fc1c34c7b0d0f21c7add26c926156687b0e6a59,2016-01-09 04:07:52,Ben Gotow,bump(version): 0.3.38,False
f026974baeded6fb8682d4b598a808bf3ac3f603,2016-01-09 04:01:33,Ben Gotow,"Merging in new observables for thread list

commit 7a67c1fd349c575a91b162024cc03050e86574c9
Author: Ben Gotow <bengotow@gmail.com>
Date:   Fri Jan 8 11:14:07 2016 -0800

    WIP

commit 891f23487827a447ec95406ef26f1473a0c07de6
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Jan 6 15:25:09 2016 -0800

    WIP

commit 3c323cd4beb2df2fae2439a556d3129404d942cc
Author: Ben Gotow <bengotow@gmail.com>
Date:   Mon Jan 4 17:46:11 2016 -0800

    WIP

commit ec7090ea9e1969fea2ea583f80a9a2ac41e6c8b0
Author: Ben Gotow <bengotow@gmail.com>
Date:   Mon Jan 4 17:22:07 2016 -0800

    Remove unused LRUCache

commit e10c3919559d3c364cb7bb94d19094a2444c10f3
Author: Ben Gotow <bengotow@gmail.com>
Date:   Mon Jan 4 16:21:37 2016 -0800

    rm(database-view): Performance refactor of thread-list

    Summary:
    This diff removes the old DatabaseView class, which included lots of gross optimizations that have since been duplicated in QuerySubscription and makes the thread list use the QuerySubscription class.

    This diff also substantially replaces the QuerySubscription class. The new implementation actually makes more queries but is less gross and more straightforward. It leverages a couple findings from database profiling:

    - Because of the sqlite page cache, asking for ids you've previously asked for is very fast.
        + Don't bother sorting in memory to avoid a query, just ask for ids again and fill in any missing objects.
    - Loading and inflating models is 4x+ slower than just grabbing ids

    I've also added more convenience classes around database queries:
    - QueryRange: Represents {offset, limit}, and can do boolean intersections
    - QueryResultSet: Better than passing an array of 50 items when you really mean items 150-200. Also tries hard to be immutable.

    This diff doesn't fully remove the concept of a ""ModelView"" because it's used /everywhere/ in the multiselect list source. There's a small shim that we can remove when we refactor that code. Ideally, I think we should rename ModelView to ""MultiselectListDataSource"" to follow iOS conventions (eg UITableViewDataSource). RIP 80char lines?

    Test Plan: They've gone to hell. WIP.

    Reviewers: evan, juan

    Differential Revision: https://phab.nylas.com/D2408

commit 32607eee8aafb7fa98b866347bdd2c0b963a602c
Author: Ben Gotow <bengotow@gmail.com>
Date:   Mon Jan 4 09:56:34 2016 -0800

    WIP

commit 5ab5fe74e94db6904bd77d224720ad9fc69fe6a7
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Dec 30 22:56:46 2015 -0800

    redo scrollbars to not require counts

commit 361bb192d072dc8a69fd3ef143cad7bed214ebdc
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Dec 30 17:50:57 2015 -0800

    wip

commit 079394de1cc3344fb6568efe00a52d7fc97fbd27
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Dec 30 13:49:11 2015 -0800

    wip

commit 65142be03c27c653fe1147fdde6c2f9b046ade22
Author: Ben Gotow <bengotow@gmail.com>
Date:   Wed Dec 30 01:23:20 2015 -0800

    wip

commit 5d412ec276be1104175ad0f43c9d54e1cea857bf
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue Dec 29 22:49:58 2015 -0800

    Refactor start

commit d2b6eea884fcd2bd81ebe3985f2b2636a510c493
Author: Ben Gotow <bengotow@gmail.com>
Date:   Tue Dec 29 18:51:53 2015 -0800

    RIP DatabaseView",False
9f998d19649ff1bc4dc0f0c24a5d4ca4d934a9a9,2016-01-09 03:52:13,Juan Tejada,"refactor(rip-current-account): Rips out AccountStore.current

Summary:
- WIP: Need to fix tests and some errors!
- Refactors Category class to hold information about its type
- Refactors CategoryStore to rely on observables instead of local caches
- Adds and updates Observables and helpers
- Refactors ContactStore to hold entire cache of contacts instead of per
  current account
  - Same for ContactRankingStore and other stores
- Refactors method names for AccountStore + some helpers
- Updates MailViewFilter to hold an account
  - Adds basic Unified filter
- Replaces AccountStore.current calls with either:
  - The account of the currently focused MailViewFilter
  - The account associated with a thread, message, file, etc...
  - A parameter to be passed in
  - Arbitrarily, the first account in the AccountsStore

Test Plan: - Unit tests

Reviewers: evan, bengotow

Differential Revision: https://phab.nylas.com/D2423",False
f8ca14e5704dea9fb3a968766450301c9936632c,2016-01-09 01:18:14,Ben Gotow,style(message-list): Correct alignment of dropdown. Fixes #659,False
7e24a1346684af677327690cb99c818a14c7ac33,2016-01-09 01:02:32,Ben Gotow,feat(zoom): Allow users to override interface zoom. Fixes #699,False
e5efa80216b25a76eacc1650ebaaabde5692c4a4,2016-01-09 00:27:48,Evan Morikawa,test(draft): new tests for promise chain in send draft,False
eceac4046cdad2aa457ef30dd9b8368f9c009fec,2016-01-09 00:22:37,Ben Gotow,fix(specs): Minor change to templates package for Travis,False
75419273d55d76b298eccb4131d38f65c75b5973,2016-01-09 00:17:41,Ben Gotow,fix(lint): Fix linter issues in template package,False
1dbefa566b6b07b051b22bc88225049e2344ec7b,2016-01-08 23:46:45,Ben Gotow,bump(version): 0.3.37,False
7474c79c611fcb48f1ffd38e074ffdb125eb1dd1,2016-01-08 23:36:16,Ben Gotow,"Revert ""bump(electron): 0.35.4 => 0.36.2""

This reverts commit da607dd5085703d84a014bdab1ebc38b721901e0.",False
348aa69a17b7a99c1dfe44dc1012ea54dfb4c78c,2016-01-08 10:43:07,Drew Regitsky,"fix(templates): disable outdated tests in templates plugin for now
TODO: update and rewrite tests for templates plugin",False
f0336b98229d9ee8e10b8115ae72d8b7083459a0,2016-01-08 08:14:40,Ben Gotow,feat(newsletter): Manage subscription directly from N1,False
53d23d330b566ca3b976312efd6d39718119c81a,2016-01-08 04:53:54,Ben Gotow,"rename(templates): Use ""Quick Replies"" name in plugins screen",False
4abe7cbd482fa11b9a208ce0f953545ba5b573af,2016-01-08 04:29:10,Ben Gotow,rm(mispelled): Stranded package.json file,False
84f0d4669f08c7b1f0e349255b9388078b0e8725,2016-01-08 04:27:34,Ben Gotow,Merge branch 'bengotow/consolidate-plugins',True
f250fe25285421700cc6cae4c23a1b6bdfe1a452,2016-01-08 04:26:34,Ben Gotow,"fix(examples): examples => packages, move away from installing them",False
68ec9701d1e982f322e7b20a4d1a1ed4907fec33,2016-01-08 04:10:13,Michael Grinich,add predawn,False
b0a7408d0502ecac10d98d3d578ce2de74e2188a,2016-01-07 23:44:12,Michael Grinich,header size,False
704ecea745f1ce3b4535c2a4df8cde68e711b85d,2016-01-07 23:42:25,Michael Grinich,Move links to plugins to this repo.,False
3e3e2ca666dab54e551dccd8f4f09053630c3557,2016-01-07 05:25:14,Evan Morikawa,Add 'default' tasks,False
da607dd5085703d84a014bdab1ebc38b721901e0,2016-01-07 02:50:27,Ben Gotow,bump(electron): 0.35.4 => 0.36.2,False
e0339e9e1856d376500032a69b51572575016a5d,2016-01-07 01:14:20,Ben Gotow,"fix(keymaps): Display composer keymaps, fix Apple Mail",False
38e8e0171b70edb44c4d4278d5554a94ee7483e9,2016-01-07 01:01:43,Ben Gotow,"Merge pull request #913 from colinking/button_order

Reorder archive and trash icons",True
f14a480d309d0d8434a9ddc2dca94455328e8c9d,2016-01-07 00:52:41,Colin King,Reordered archive and trash icons,False
7fabcf657724a5ca86bbfeadc1bd5bc74e7a5857,2016-01-06 23:21:42,Ben Gotow,fix(rules): Overflow in the prefrences sidebar. Fixes #908,False
beb38c85c07aa84b49cd51a93035f09d4ac1a60f,2016-01-06 07:21:02,Ben Gotow,fix(rpm): Treat-deb and-rpm as separate platforms on N1Server,False
a9c586cf2b421e28b2edb6f0451bbcdbd04f277b,2016-01-06 07:02:11,Ben Gotow,fix(rpm): Upload RPM builds following naming convention,False
9bd77dc44945ed98ffae877612d9ce1661c0a439,2016-01-06 06:15:53,Ben Gotow,"Merge pull request #903 from mbilker/fix-debian-icons

Copy app icons to `hicolor` on Debian",True
821ac7bb17e2abae8a48dd6ef23fb7fa4964d008,2016-01-06 05:58:25,Ben Gotow,bump(changelog): New features / fixes in 0.3.36,False
e380ecef723ccfc56a54b30a68ccc5a9fcdd50b7,2016-01-06 04:14:14,mbilker,fix(mkdeb): specify hard path to icon files,False
e8239a92ab98b459be9fb3b6f3fe9fe2a529b4f6,2016-01-06 04:01:55,Ben Gotow,"fix(sig): Remove selectEnd, place cursor before sig

Summary: When focusing the composer, select the end of the last text block above any signatures / quoted text (which can be visible by default in Fwd:).

Test Plan: Run tests

Reviewers: juan, evan

Reviewed By: evan

Differential Revision: https://phab.nylas.com/D2411",False
3754dd2d9101be0a046f4c657dc202cd87ee2cbe,2016-01-06 01:54:49,mbilker,fix(mkdeb): copy app icons to hicolor on Debian,False
a4e25da9e2cbedad3e182d29bce0181ff1b09913,2016-01-06 01:15:05,Ben Gotow,bump(version): 0.3.36,False
1d19533fd835840ca99416d0100a522597f6a0cb,2016-01-06 01:04:26,Ben Gotow,"fix(focus): Minor changes to composer focus logic to focus new drafts

Summary:
Remove FocusTrackingRegion—all CommandRegions should be focusable, and nesting the two creates varying behavior based on which is the parent

Calling focus() on an injected / unsafe component should always do /something/. Try the inner React method, inner DOM method, or call on ourselves

Rename contentEditable._focusEditor to ""focus"" since it intends to replace default focus behavior

In ComposerView, always change focus via setState, never by calling focus() directly. Rather than tracking `_lastFocusedField`, just focus whenever the activeElement isnt within the focusedField. Make body initial focus when draft is pristine...

...(ensures new drafts are focused)

Test Plan: Run tests

Reviewers: evan, juan

Reviewed By: evan, juan

Differential Revision: https://phab.nylas.com/D2406",False
d8a510326fae3d481e9dde2ccffcfbc70d502b73,2016-01-06 00:55:36,Ben Gotow,"fix(icon): Use app icon on win32, use correct path on Linux",False
4f80e43a46be4ec56c4b3fefe0b5134aed43682c,2016-01-06 00:23:23,Ben Gotow,"Merge pull request #892 from colinking/hoveractions_injectable

Move quick actions inside of flexbox with injectable component set",True
71c287823738d405c90ddba92e75817cd9669d91,2016-01-05 23:33:35,Ben Gotow,"Merge pull request #899 from mbilker/fix-linux-grunt-install

Grunt `install` task: Replace `shareDir` with `linuxShareDir` to reflect global changes",True
777ba0f91d9bc39a637890abcf897e752fbc5cbe,2016-01-05 08:38:20,mbilker,"fix(grunt): replace shareDir with linuxShareDir to reflect global changes

The `install` task would fail since `linuxShareDir` was undefined for the
template `.desktop` file.",False
87946866880710c53a4384ece9b6dde512dc4911,2016-01-05 06:55:59,Colin King,"Moved all quick actions within flexbox from injectable component

Fixed linting issues

Moved away from ComponentRegistry towards InjectComponentSet children",False
a68b03a23e887bc491d1c6bc4a7f5257d97f2741,2016-01-05 06:09:43,Evan Morikawa,fix(build): debian packages use different share dir,False
247bb15ab47003c1765db67337d8c022d8f17eae,2016-01-05 01:44:46,Ben Gotow,"Merge pull request #866 from mbilker/remove-module-list

Remove log of integration test package installation by default",True
5030787d884ac54484f8df0263a802a07f2fc0a1,2016-01-01 04:16:48,Ben Gotow,"Merge pull request #876 from nylas/Inbox-Shortcuts

Inbox shortcuts",True
